{"version":3,"file":"kendo.spreadsheet-common.cmn.chunk.js","names":["util","parseColor","Group","Path","Rect","Matrix$1","Rect$1","drawText$1","__meta__","id","name","category","description","depends","hidden","chunk","getDate","dayOfWeek","addDays","firstDayOfMonth","browser","JSZip","columnName","colIndex","letter","Math","floor","String","fromCharCode","displaySheet","sheet","test","replace","displayRef","row","col","rel","aa","isFinite","Ref","constructor","this","type","clone","hasSheet","_hasSheet","simplify","setSheet","absolute","_arow","_acol","relative","_args","adjust","_row","_col","_trow","_tcol","_forRow","_start","_delta","toString","print","forEach","callback","obj","call","map","intersect","_ref","intersects","ref","NULLREF","isCell","toRow","toColumn","first","lastRange","size","rangeAt","_index","nextRangeIndex","previousRangeIndex","eq","reference","r1","r2","CellRef","RangeRef","topLeft","bottomRight","UnionRef","single","refs","refs1","refs2","length","i","len","concat","replaceAt","forEachColumnIndex","forEachAxisIndex","forEachRowIndex","forEachRow","_callback","forEachColumn","axis","sorted","index","indexOf","push","sort","a","b","valid","renameSheet","oldSheetName","newSheetName","toLowerCase","display","NULLREFClass","NameRef","super","ret","trow","tcol","mod","abs","arow","acol","toRangeRef","height","width","leftColumn","rightColumn","topRow","bottomRow","forRow","start","delta","Error","tl","br","endSheet","normalize","_containsRange","range","_containsCell","cell","contains","Array","that","some","Boolean","_intersectRange","a_left","a_top","a_right","a_bottom","b_left","b_top","b_right","b_bottom","max","min","tmp","c1","c2","rr1","rc1","rr2","rc2","changes","relTL","relBR","collapse","toCell","startRow","endRow","startCol","endCol","intersecting","filter","union","topLeftRow","topLeftCol","bottomRightRow","bottomRightCol","modified","result","resize","options","limit","bind","num","value","top","left","bottom","right","move","rows","cols","tr","slice","x","u","reduce","empty","theRef","join","newRefs","splice","FIRSTREF","SHEETREF","Infinity","messages","nameBox","errors","modifyMerged","openUnsupported","shiftingNonblankCells","insertColumnWhenRowIsSelected","insertRowWhenColumnIsSelected","filterRangeContainingMerges","sortRangeContainingMerges","cantSortMultipleSelection","cantSortNullRef","cantSortMixedCells","validationError","cannotModifyDisabled","insertRowBelowLastRow","insertColAfterLastCol","tabs","home","insert","data","cut","copy","paste","merge","unmerge","delete","hide","unhide","bringToFront","sendToBack","defaultSheetName","toolbar","sheetsbar","columns","rowHeight","columnWidth","headerHeight","headerWidth","excel","fileName","forceProxy","proxyURL","pdf","area","paperSize","landscape","margin","title","author","subject","keywords","creator","date","defaultCellStyle","fontFamily","fontSize","useCultureDecimals","locale","ALL_REASONS","recalc","selection","activeCell","layout","sheetSelection","editorChange","editorClose","keys","INSERT","DELETE","BACKSPACE","TAB","ENTER","ESC","LEFT","UP","RIGHT","DOWN","END","HOME","SPACEBAR","PAGEUP","PAGEDOWN","F2","F10","F11","F12","NUMPAD_PLUS","NUMPAD_MINUS","NUMPAD_DOT","B","I","U","N","H","A","R","RX_UNICODE_LETTER","RegExp","isUnicodeLetter","ch","memoize","f","cache","Object","create","arguments","apply","arabicToRoman","n","literals","values","roman","shift","romanToArabic","r","digits","v","l","c","d","m","prev","charAt","withExit","Return","ex","getterCache","FIELD_REGEX","getter","field","safe","key","fields","_","indexAccessor","isPresent","idx","deepExtend","destination","deepExtendOne","source","property","propValue","propType","destProp","Date","getTime","isFunction","isPlainObject","guid","random","chars","support","scrollbar","refresh","isNaN","_scrollbar","div","document","createElement","style","overflow","overflowX","zoom","clear","innerHTML","body","appendChild","offsetWidth","scrollWidth","removeChild","toCamelCase","str","strMatch","g1","toUpperCase","hasOwnProperty","kendoGetComputedStyles","element","properties","computedStyle","styles","defaultView","getComputedStyle","getPropertyValue","currentStyle","insertAfter","newElement","after","parentNode","insertBefore","nextSibling","_activeElement$1","activeElement","e","documentElement","isBlank","isDate","isString","isNumeric","parseFloat","fn","proto","getPrototypeOf","CalcError","code","intlValue","intl","culture","localeInfo","createKendoObj","calc","kendo","spreadsheet","runtime","FUNCS","FUNCS$1","Context","formula","ss","parent","resolve","val","self","resolveCells","_resolve","error","undefined","isArray","asMatrix","maybeRoundFloatErrors","arrayFormulaRange","_arrayArg","onFormula","context","formulas","loop","add","getRefCells","pending","exec","cellValues","wantNulls","getRefData","Matrix","fetchName","nameValue","Formula$1","ValidationFormulaContext","workbook","isMerged","force","func","fname","args","bool","cells","set","line","h","el","isRange","each","Number","hiddenInfo","getData","argmax","end","pos","get","getNA","includeEmpty","eachRow","eachCol","mapRow","mapCol","JSON","stringify","transpose","unit","j","multiply","s","va","vb","adds","sign","y","determinant","C","L","k","t","inverse","augment","imax","sameRef","Formula","handler","printer","absrefs","onReady","setArrayFormulaRange","forceRefs","lcsheet","deepClone","parentContext","ctx","level","next","setTimeout","reset","affectedSheet","operation","formulaRow","formulaCol","formulaSheet","formulaMoves","newFormulaRow","newFormulaCol","prevRefs","newRef","prevRange","compileArgumentChecks","functionName","forced","arrayArgs","main","haveForced","canBeArrayArg","hasArrayArgs","comp","cond","substr","allowError","typeCheck","Function","limitPrecision$1","forceNum","round","err","parseInt","toPrecision","withErrorHandling","makeSyncFunction","check","doit","xargs","arrays","makeAsyncFunction","count","makeCallback","unshift","defineFunction","log","window","console","kendoSpreadsheetArgs","argsAsync","defineBuiltinFunction$1","isAsync","impl","dateToJulianDays","julianDaysToDate","jd","year","month","day","ord","ORDINAL_ADD_DAYS","isLeapYear$1","co","th","comatrix","thmatrix","elmatrix","sqrt","BASE_DATE","DAYS_IN_MONTH","yr","daysInYear$1","daysInMonth$1","mo","validDate","da","unpackDate$2","serial","packDate$2","MS_IN_MIN","MS_IN_HOUR","MS_IN_DAY","unpackTime$1","frac","ms","hours","minutes","seconds","milliseconds","serialToDate$2","packTime$1","hh","mm","dateToSerial$2","time","getHours","getMinutes","getSeconds","getMilliseconds","getFullYear","getMonth","parseDate","format","formatting","makeDateFormat","parseExactDate","defineAlias$1","alias","orig","kendoSpreadsheetAliases","ParseError","message","InputStream","input","peek","eof","croak","readWhile","predicate","readEscaped","escaped","lookingAt","rx","skip","forward","msg","Node","node","NullNode","packDate","unpackDate","packTime","unpackTime","serialToDate","dateToSerial","daysInMonth","isLeapYear","daysInYear","limitPrecision","defineBuiltinFunction","defineAlias","prototype","remove","attr","text","nodeName","children","NULL_NODE","Element","TextNode","nodeValue","HtmlNode","html","insertHtml","HTML_CONTAINER","firstChild","attrs","text$1","Tree","root","appendTo","render","cached","cachedChildren","cachedLength","replaceChild","syncAttributes","removeAttributes","cachedAttr","cachedValue","setStyle","setAttribute","removeStyle","cachedStyle","removeAttribute","cssText","className","createTextNode","nodes","lastChild","child","dom","RX_COLORS","RX_CONDITION","parse$2","decimalPart","sections","haveConditional","sec","readSection","op","maybeColor","readFormat","tok","readNext","part","maybeFraction","fraction","sep","decimal","split","am","pm","color","custom","maybeCondition","print$1","out","printToken","fmt","padLeft","adjustDecimals","diff","adjusted","TokenStream2","parts","ahead","restart","runtime$1","calendar","days","abbreviated","wide","months","narrow","ampm","fraclen","toFixed","eltime","fill","formatInt","declen","lastPart","shouldInsertMinus","iv","skipMinus","numbers","symbols","group","chf","formatDec","decimals","last","digNumber","intpart","decpart","pow","checkCondition","condition","compileFormatPart","hasDate","hasTime","hasAmpm","percentCount","currency","scaleCount","separeThousands","intFormat","decFormat","checkComma","intPart","decPart","isNegative","matchedCurrency","output","percentSign","TEXT","compile","localCulture","section","tree","found","padRight","exp","parse","span","__dataType","visibility","textAndColor","ast","OPERATORS_STANDARD","OPERATORS_COMMA","ops","cls","OPERATORS","SEPARATORS","DEC","ARG","COL","setDecimalSeparator","withDecimalSeparator","save","_separators","TRUE","FALSE","getcol","charCodeAt","getrow","parseReference","noThrow","OUT","stream","TokenStream","is","parseFormula","parseExpression","addReference","allowEOF","commas","maybeBinary","parseAtom","parseFuncall","parseArray","upper","maybePercent","my_prec","his_prec","parseNameDefinition","def","nameRef","defAST","makeFormula","prec","withParens","parenthesize","arg","td","needParens","makePrinter","evRef","evFuncIf","evaluate","evFuncAnd","evFuncOr","evFunc","evArguments","evBinary","evUnary","evMatrix","makeInterpreter","FORMULA_CACHE","hash","identity$1","RawTokenStream","token","fixCell","addPos","forEditor","thing","startToken","endToken","begin","refRange3D","refCell3D","refSheetRange","refSheetCell","refRange","refCell","funcall","isFirst","g","space","isWhitespace","EOF","tokens","isDigit","isIdStart","isId","symbol","quote","getRC","has_dot","number","readNumber","readSymbol","isOpChar","isPunc","FORMAT_PARSERS","registerFormatParser","p","tokenize","parseSqref","existingFormat","patterns","monthFirst","intlService","comma","dot","localeCurrency","currencies","rxnum","getNumberRegexp","rxcur","suffix","has_currency","has_percent","repeat","NUMBER_FORMAT_RX","FormulaContext","fsheet","frow","fcol","sheetByName","sheetIndex","states","sheetByIndex","_grid","startCellIndex","cellRefIndex","endCellIndex","_properties","iterator","at","_displayString","arrayRange","tlRow","tlCol","vrow","vcol","_value","clearTimeout","_formulaContextRefresh","batch","KEY_NAMES$1","Mac","navigator","platform","isAlphaNum","keyCode","keyName","event","EventListener","target","observer","handlers","_handlers","_observer","keyDownProxy","keyDown","mouseProxy","mouse","touchProxy","touch","threshold","_pressLocation","_attachEvent","on","events","eventType","addEventListener","_removeEvent","removeEventListener","altKey","handleEvent","rightClick","which","button","pageX","pageY","dx","dy","eventKey","metaKey","ctrlKey","shiftKey","catchAllHandler","destroy","alphaNumRegExp","ACTIONS","up","down","pageup","pagedown","ENTRY_ACTIONS","tab","enter","backspace","CONTAINER_EVENTS","wheel","contextmenu","mousemove","CLIPBOARD_EVENTS","mouseup","EDITOR_EVENTS","esc","FORMULABAR_EVENTS","assign","focus","FORMULAINPUT_EVENTS","SELECTION_MODES","rowheader","columnheader","topcorner","autofill","ACTION_KEYS","SHIFT_ACTION_KEYS","ENTRY_ACTION_KEYS","Controller","view","container","clipboardElement","clipboard","scroller","tabstrip","nameEditor","onNameEditorEnter","onNameEditorCancel","onNameEditorSelect","onNameEditorDelete","editor","onEditorChange","onEditorActivate","onEditorDeactivate","onEditorUpdate","listener","scrollHandler","onScroll","mouseDownHandler","onMouseDown","_enableEditorEvents","onSheetBarSelect","onSheetBarReorder","onSheetBarRename","onSheetBarRemove","executeCommand","_execute","enable","keyListener","barKeyListener","barElement","inputKeyListener","cellElement","_workbook","execute","command","trigger","_preventNavigation","reason","deactivate","showError","openDialog","_activeTooltip","activeSheet","onContextMenuSelect","item","getAttribute","drawing","_sheet","_activeDrawing","removeSheet","isAddButton","insertSheet","canInsertRef","oldIndex","activeSheetName","moveSheetToIndex","newIndex","axisManager","onCommandRequest","_viewPortHeight","clientHeight","isActive","isEditorDisabled","resetEditorValue","nameForRef","scroll","onWheel","deltaX","deltaY","deltaMode","scrollWith","preventDefault","onAction","action","moveActiveCell","onPageUp","scrollDown","onPageDown","onEntryAction","shouldPrevent","selectAll","undoRedoStack","redo","undo","disabled","casual","activateEditor","navigateInSelection","onShiftAction","modifySelection","appendSelection","onMouseMove","resizingInProgress","selectionInProgress","object","objectAt","positionResizeHandle","removeResizeHandle","_renderComment","pane","originFrame","_startResizingDrawing","stopPropagation","startBox","drawingBoundingBox","startDragging","triggerChange","dragging","onEditorEsc","openCustomEditor","_setFormulaSelections","highlightedRefs","startSelection","_selectionMode","startResizing","openFilterMenu","handle","closest","location","translateCoords","direction","startX","startY","onContextMenu","draggingInProgress","selectForContextMenu","selectDrawingForContextMenu","isComposite","select","showUnhide","showUnmerge","selectionIncludesHiddenColumns","selectionIncludesHiddenRows","selectionIncludesMergedCells","objectRef","targetType","originalEvent","prevent","constrainResize","resizeHandle","resizeHandlePosition","_dragDrawing","drag","aspect","offsetY","offsetX","onMouseDrag","clientX","clientY","resizeHintPosition","selectToLocation","frame","scrollTop","startAutoScroll","onMouseUp","completeResizing","completeDragging","completeSelection","stopAutoScroll","activeEditor","refAtPoint","onDblClick","sel","onCut","menuInvoked","clipBoardValue","_pasteImage","blob","img","Image","src","URL","createObjectURL","onload","revokeObjectURL","onPaste","plain","clipboardData","files","file","trim","external","hasHTML","hasPlainText","DOMStringList","types","items","kind","getAsFile","onCopy","scrollLeft","scrollRight","box","getBoundingClientRect","noDrawing","loc","cellLocation","extendSelection","lastKnownCellLocation","autoScroll","_autoScrollTarget","boundaries","finalLocation","viewObject","_scrollInterval","setInterval","clearInterval","column","filterColumn","filterMenu","createFilterMenu","close","openFor","_saveEditorValue","arrayFormula","_range","isInEditMode","_lastEditorValue","onEditorArrayFormula","onEditorBarFocus","activate","rect","activeCellRectangle","tooltip","onEditorCellFocus","scale","insertNewline","onEditorBlur","defaultPrevented","isFiltered","onEditorAction","_casualEditing","deactivateEditor","onEditorShiftAction","_inputForRef","intersectingArrayFormula","onDialogRequest","additionalOptions","pdfExport","excelExport","ev","RangeTreeNode","NilNode","skew","temp","heir","ValueRange","RangeTree","findrange","ranges","RangeList","firstRange","pop","rangeValue","rangeStart","rangeEnd","expandedValues","rangeIndex","sortedIndices","valueComparer","indices","comparer","expValues","sourceStart","sourceEnd","targetStart","intValues","Iterator","getState","setState","state","toJSON","fromJSON","vals","unique","SparseRangeList","_defaultValue","lastRangeStart","Property","list","dst","JsonProperty","ValueProperty","formats","toExcelFormat$1","propertyBagSpec","sortable","serializable","PropertyBag","rowCount","columnCount","defaultValues","cellCount","specs","lists","spec","cloneFormulaTree","validation","_resize","new_rows","new_cols","old_rows","cell_count","scaleIndex","scaleNode","si","prop","iter","iterators","hBorders","leftBorders","rightBorders","addBorder","forEachProperty","cloneFormulaValue","ALL_PROPERTIES","TRANSPOSE_FORMAT","DATE_FORMAT","compileValidation","validationHandler","parsedFromDate","parsedToDate","from","dataType","fromIsListValue","fromIsDateValue","to","toIsDateValue","validationExport","validationComparers","comparerType","valueToCompare","toValue","to_value","allowNulls","from_value","_getListData","resultOptions","Validation","showButton","tooltipMessageTemplate","tooltipTitleTemplate","messageTemplate","titleTemplate","_formatMessages","fromFormula","toFormula","_setMessages","tooltipTitle","tooltipMessage","cube","array","_getOptions","optionsResult","compareValue","compareFormat","getValue","calculateFromCallBack","prevFrom","prevTo","greaterThan","lessThan","between","equalTo","notEqualTo","greaterThanOrEqualTo","lessThanOrEqualTo","notBetween","measureText","PROPERTIES","Range$1","Range","skipHiddenCells","skipHiddenRows","isHiddenRow","skipHiddenCols","isHiddenColumn","_normalize","partition","_set","noTrigger","topLeftRef","forEachMergedCell","isValue","_get","_property","_resizedRef","existingFormatType","toExcelFormat","t1","intlVal","looksLikeANumber","_useCultureDecimals","exit","__","_forFormulas","intersection","canEditArrayFormula","_getValidationState","ci","ri","_validation","_merge","mergedCells","_mergedCells","mergedRef","vi","props","isAutofill","setProp","propName","isFilteredRow","includes","clearAll","contentsOnly","formatOnly","keepBorders","wrap","clearContent","clearFormat","isSortable","cantSort","mc","_getMergedCells","primary","secondary","cant","merged","hasMerged","_sortBy","ascending","isFilterable","clearFilters","_filterBy","clearFilter","_filter","hasFilter","intersectingMerged","propertyName","origRef","_rows","forEachCell","cellState","dr","dc","origin","rowDelta","colDelta","internalClipboard","isExternal","externalClipboard","_adjustRowHeight","rowRange","_columns","sum","textHeight","getTextHeight","hasValue","defStyle","_defaultCellStyle","flag","draw","insideBorders","insideVerticalBorders","insideHorizontalBorders","measureBox","setProperty","baselineMarkerSize","normalizeText","ERR_INCOMPATIBLE","ERR_NO_DIRECTION","FillError","linearRegression","mx","my","s1","s2","findSeries","series","forEachSeries","findStep","q","clone$1","getType","lst","findStringList","match","stringLists","strl","_previewFillFrom","srcRange","destRange","dest","horizontal","descending","hint","srcIdx","fillFrom","STRING$1","FUNCTION","_defaultPrevented","isDefaultPrevented","Observable","_events","eventName","one","original","eventNames","handlersIsFunction","unbind","sender","Widget","setOptions","_setEvents","getSize","currentSize","_size","offsetHeight","_activeElement","SheetEditor","formulaBar","_active","barInput","formulaInput","cellInput","syncWith","_triggerUpdate","_blur","viewWidth","scrollerElement","scrollbarWidth","viewElement","_rect","position","querySelector","clientWidth","maxWidth","noChange","inputType","popup","visible","isKeyboardAction","toggleTooltip","notEqual","isArrayFormula","classList","toggle","oldRect","newRect","ampRegExp","ltRegExp","quoteRegExp","aposRegExp","gtRegExp","htmlEncode","Axis","_count","_hidden","scrollBarSize","_refresh","positions","includesHidden","nextVisible","nextUntil","pred","advanced","nextPage","pageSize","prevPage","firstVisible","firstHidden","lastVisible","lastHidden","prevVisible","prevUntil","locate","startSegment","endSegment","lastPage","total","_pixelValues","offset","startOffset","startIndex","endOffset","endIndex","current","indexVisible","nowCount","PaneAxis","headerSize","_axis","hasHeader","defaultValue","frozen","viewSize","_viewSize","paneSegment","Rectangle","intersectsRect","toDiv","Grid","_headerHeight","_headerWidth","isAxis","totalHeight","totalWidth","cellRef","rowRef","colRef","rectangle","PaneGrid","rangeDimensions","rangeRef","grid","hasRowHeader","hasColumnHeader","rowOffset","columnOffset","mergedCellLeft","mergedCellTop","boundingRectangle","scrollBoundaries","widthCompensation","heightCompensation","scrollBottom","Sorter","_lists","ascendingComparer","descendingComparer","sortBy","li","typeA","typeB","localeCompare","AxisManager","forEachSelectedColumn","forEachSelectedRow","includesHiddenColumns","includesHiddenRows","deleteSelectedColumns","indexes","_saveModifiedFormulas","deleteColumn","deleteSelectedRows","deleteRow","hideSelectedColumns","hideColumn","hasRight","hasLeft","hideSelectedRows","hideRow","hasBottom","hasTop","unhideSelectedColumns","unhideColumn","unhideSelectedRows","unhideRow","addColumnLeft","base","insertColumn","addColumnRight","addRowAbove","selectedRows","insertRow","addRowBelow","AutoFillCalculator","rectIsVertical","startRect","endRect","autoFillDest","cursor","quadrant","pivot","opposite","cornerResult","expanding","lower","further","bottomLeft","topRight","EdgeNavigator","rangeGetter","prevLeft","nextRight","nextLeft","prevRight","boundary","SheetNavigator","autoFillCalculator","colEdge","columnRange","rowEdge","unionWithMerged","leftCol","rightCol","setSelectionValue","_sheetRef","mode","addToExisting","refForMode","startAutoFill","scrollInto","determineDirection","viewPortHeight","originalSelection","currentOriginalSelectionRange","makeWordMovement","newSelection","updateCurrentSelectionRange","originalActiveCell","selTopLeft","selBottomRight","isFirstCell","isLastCell","setSelection","currentNavigationRange","done","navigatedAway","singleCellSelection","nextNavigationRange","_view","previousNavigationRange","shouldSkip","resizeAutoFill","_autoFillOrigin","punch","preview","updateAutoFill","currentSelectionRange","leftMode","rightMode","topMode","bottomMode","originalSelect","selectionRangeIndex","subset","bottomCol","isCol","firstVal","numberToDate","dateToNumber","identity","o","SheetDataSourceBinder","acc","_normalizeColumns","_dataSource","_header","_boundRowsCount","dataSource","fetch","_sheetChangeHandler","_sheetChange","_sheetDeleteRowHandler","_sheetDeleteRow","_sheetInsertRowHandler","_sheetInsertRow","model","getters","normalizedRef","normalizedRefs","setValues","record","valueIndex","colValueIndex","currentValue","reader","_skipRebind","_changeHandler","_progressHandler","_errorHandler","_change","_requestStart","_error","createSheetDataSource","_progress","getterIdx","kendoDate","today","isToday","logic","or","and","operatorsMap","doesnotcontain","doesnotendwith","doesnotstartwith","lastIndexOf","endswith","gt","gte","isempty","isnotempty","isnotnull","isnull","lt","lte","neq","startswith","dateRegExp","convertValue","ignoreCase","accentFoldingFiltering","toLocaleLowerCase","transformFilter","operator","itemProp","typedGetter","transformCompositeFilter","combiner","filters","extendedFilter","filtersObj","dateToSerial$1","serialToDate$1","Filter","prepare","matches","substring","ValueFilter","_values","_dates","_blanks","blanks","dates","CustomFilter","_logic","criteria","_criteria","_matches","criterionValue","criterionType","valueType","TopFilter","_type","DynamicFilter","_predicate","_average","aboveAverage","belowAverage","tomorrow","yesterday","nextWeek","sameWeek","thisWeek","lastWeek","nextMonth","sameMonth","thisMonth","lastMonth","nextQuarter","quarter","thisQuarter","lastQuarter","nextYear","sameYear","thisYear","lastYear","yearToDate","initDynamicFilter","setFullYear","setMonth","firstWeek","secondWeek","MODIFIED_FORMULAS","DEFAULT_SHEET_STATE","Selection","_activeCell","currentOriginalNavigationRange","expanded","changeActiveCell","triggerSelect","panes","_currentView","EDITORS","registerEditor","Sheet","_reinit","activeCellCustomEditor","background","italic","bold","underline","verticalAlign","textAlign","_filteredRows","_frozenRows","_frozenColumns","_suspendChanges","_showGridLines","_gridLinesColor","_sorter","_viewSelection","_editSelection","_formulaSelections","_drawings","newRows","newCols","oldRows","oldCols","_resizeAddRow","_resizeAddColumn","_resizeDeleteRow","_resizeDeleteColumn","_resizeForJSON","colCount","_selectionState","_inEdit","_navigator","_axisManager","_name","_sheetName","_state","_sheetState","accessor","_field","suspendChanges","_valueChanged","setDataSource","dataSourceBinder","columnIndex","_copyRange","sourceRangeRef","targetRef","nextRefTopLeft","nextRefBottomRight","nextIndex","nextBottomIndex","targetIndex","_restoreModifiedFormulas","wb","_adjustReferences","_sheets","_forValidations","adjustNames","topLeftCell","rowIndex","skipDataSourceInsert","frozenRows","nextRef","isEnabledRow","skipDataSourceDelete","frozenColumns","isEnabledColumn","_filterRow","showGridLines","gridLinesColor","numRows","numColumns","forEachFilterHeader","columnRef","forEachRange","doIt","initialPosition","_initialPosition","_resizeInProgress","_autoFillInProgress","_autoFillDest","_autoFillPunch","_autoFillHint","_autoFillDirection","autoFillRef","autoFillPunch","autoFillInProgress","_draggingInProgress","hintPosition","handlePosition","_visualRange","comment","_commentRef","_resizeHandlePosition","_resizeHintPosition","refBox","refBoundingBox","previous","_selectionInProgress","operatingRange","expandedRef","selectionState","trims","_focus","activeCellSelection","selectedHeaders","allCols","allRows","maxRow","maxCol","rowState","colState","rowSelection","colSelection","all","isInEdit","_viewActiveCell","viewSelection","hyperlinks","clearDefaultStyle","link","toCss","borderTop","borderBottom","borderRight","borderLeft","json","drawings","_sort","_compileFormula","_compileValidation","Drawing","activeCellRef","_refreshFilter","resetFormulas","resetValidations","revalidate","curValidation","_copyValuesInRange","suspended","filterRef","_clearFilter","getAxisState","setAxisState","currentRef","withCultureDecimals","addDrawing","drw","removeDrawing","usesImage","image","opacity","anchor","PAPER_SIZE","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","a10","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","b10","c0","c3","c4","c5","c6","c7","c8","c9","c10","executive","folio","legal","tabloid","mm2pt","cm2pt","cm","in2pt","inch","unitsToPoints","in","getPaperOptions","getOption","CONT","GUIDELINE_WIDTH","distributeCoords","heights","pageHeight","maxEmpty","headerRows","headerCoords","curr","header","ceil","doLayout","wholeRect","rowHeights","colWidths","relrow","relcol","rh","cw","forScreen","rowspan","colspan","nonEmpty","shouldDrawCell","emptyCells","pageWidth","scaleFactor","fitWidth","hyCoords","yCoords","xCoords","boxWidth","boxHeight","headerCells","orlast","orderCoords","orderCells","sameBorder","dBorders","drawLayout","ncols","nrows","addPage","endbottom","endright","isInside","page","append","content","clip","fromRect","matrix","multiplyCopy","translate","hCenter","vCenter","transform","guidelines","moveTo","lineTo","stroke","guideColor","borders","Borders","drawCell$1","bordersGroup","vert","rendered","horiz","url","imageUrl","r2d2","drawText","applyIndent","indent","paddingLeft","paddingRight","boxSizing","lineHeight","padding","font","makeFontDef","textDecoration","whiteSpace","overflowWrap","wordWrap","vtrans","textGroup","drawFn","center","paper","multiPage","autoPrint","Container","addVert","border","addHoriz","pb","_context","RESIZE_HANDLE_WIDTH","EDIT_BUTTON_WIDTH","DOT","viewClassNames","fixedContainer","editContainer","cellEditor","barEditor","topCorner","filterHeadersWrapper","filterRange","filterButton","filterButtonSelected","horizontalResize","verticalResize","icon","iconFilterDefault","sheetsBar","sheetsBarActive","sheetsBarInactive","cellContextMenu","rowHeaderContextMenu","colHeaderContextMenu","drawingContextMenu","paneClassNames","vaxis","haxis","vborder","hborder","rowHeader","columnHeader","mergedCell","mergedCellsWrapper","selectionWrapper","autoFillWrapper","columnResizeHandle","rowResizeHandle","resizeHint","resizeHintHandle","resizeHintMarker","resizeHintVertical","selectionHighlight","cellBorder","asURL","drawCell","collection","showGrid","maybeLink","href","shouldDraw","defaultBorder","toHSV","toCssRgba","outline","fontStyle","fontWeight","classNames","Pane","getIconHTMLString","isVisible","_currentRect","_rectangle","_selectedHeaders","renderData","renderSelection","renderAutoFill","renderEditorSelection","renderFilterHeaders","headerClassName","renderResizeHandle","paneClasses","itemSelection","allHeaders","cont","borderColor","activeCellRange","absRow","absCol","_activeFormulaColor","_directionClasses","ttOffset","contentWidth","toplevelElements","borderWidth","renderDrawings","backgroundImage","drawingResizeHandles","filterIconRect","_addDiv","filtered","classes","selections","colorClass","selectionClasses","_renderCustomEditorButton","autoFillRectangle","cssClass","ed","btnClass","isLastColumn","_buttonOutOfVisiblePane","_editorInLastColumn","btn","activeFormulaSelection","colorClasses","active","cellClasses","theGrid","KEY_NAMES","PRIVATE_FORMULA_CHECK","FormulaInput","opt","autoScale","filterOperator","scalePadding","minLength","formulaBarWidth","wrapper","_highlightedRefs","_formulaSource","_formulaList","_tooltip","_sync","_keydown","_keyup","_input","_paste","getPos","getSelection","lookup","focusNode","focusOffset","anchorNode","anchorOffset","collapsed","lookupNode","nodeType","setPos","eiv","_setRange","createRange","setStart","setEnd","currentRange","getRangeAt","startContainer","endContainer","removeAllRanges","addRange","formulaSource","itemClick","_formulaListChange","tokenCtx","_tokenContext","_mute","activeToken","completion","nextToken","_replaceAt","_focusId","_isFormula","_navigated","_move","_keyDownTimeout","_syntaxHighlight","focusFirst","_focusTimeout","focusNext","focusPrev","focusIndex","focusLast","point","touches","_editorToSync","_textContainer","computedStyles","_span","_cellTooltip","show","startsWith","_canInsertRef","strictMode","canReplace","afterPoint","canInsertBetween","isOpenParen","newValue","rest","innerText","textContent","txt","refClasses","refIndex","parens","isCloseParen","open","isMatchingParen","knownFunction","reverse","listWrapper","FormulaBar","formulaInputDiv","NameEditor","readData","forEachName","combobox","SheetsBar","onSheetReorderEnd","onSheetRemove","removedSheetName","confirmation","onSheetSelect","selectedSheetText","onSheetRename","onAddSelect","selectElementContents","selectNodeContents","cellBefore","table","trs","cellAbove","prevRow","addCell","backgroundColor","borderRightColor","borderBottomColor","sdval","sdnum","sibling","borderLeftColor","borderTopColor","HtmlTable","_height","_width","addColumn","addRow","toDomTree","role","within","View","_chrome","_dialogs","_formulaInput","firstElementChild","clipboardContents","_sheetsbar","createContextMenus","enableClipboard","isClipboardDeactivated","nameBoxRef","formulaBarInputRef","_tabstrip","formulaCellInputRef","createSheetBar","openDialogCallback","createTabStrip","_executeCommand","cellRectangle","isColumnResizer","w","isRowResizer","isFilterIcon","isAutoFill","isEditButton","drawingAt","drx","dry","paneAt","selecting","containingPane","_pane","_destroyFilterMenu","_filterMenu","selectClipboardContents","preventScroll","scrollIntoView","willScroll","_destroyDialog","edit","editRange","dialog","reopenEditor","currentDialogs","errorMessages","onClose","dialogOptions","scrollbarSize","contentHeight","resizeDirection","renderResizeHint","renderClipboardContents","status","canCopy","multiSelection","selectionView","primaryMergedCells","secondaryMergedCells","_uid","reTable","tables","contentStr","Clipboard","_content","_externalContent","_internalContent","iframe","canPaste","pasteRef","pasteOnMerged","pasteOnDisabled","intersectsMerged","originActiveCell","_isInternal","parseTSV","newState","doc","contentWindow","write","program","head","richState","parseHTML","rowData","colData","uid","includeUid","tablesArr","foreign","setStateData","stripStyle","borderObject","vBorders","isExcel","txtElem","rowSpan","colSpan","ignoreColspan","COMMAND_TYPES","AUTO_FILL","CLEAR","CUT","EDIT","PASTE","VALIDATION","noop","Command","rejectState","validationState","_forEachCell","DrawingUpdateCommand","_drawing","_orig","_previous","DrawingCommand","InsertImageCommand","_blob","addImage","DeleteDrawingCommand","ReorderDrawingsCommand","_origIndex","_newIndex","_reorder","BringToFrontCommand","SendToBackCommand","TargetValueCommand","_target","ColumnWidthCommand","RowHeightCommand","HyperlinkCommand","_link","_prevLink","_prevUnderline","_hasSetValue","GridLinesChangeCommand","PropertyChangeCommand","PropertyCleanCommand","ClearContentCommand","rowValues","nullValues","changeType","EditCommand","_editRange","_exec","InsertCommentCommand","TextWrapCommand","_rowHeight","AdjustDecimalsCommand","BorderChangeCommand","_style","_batch","noBorders","outsideBorders","allBorders","leftBorder","rightBorder","topBorder","bottomBorder","MergeCellCommand","horizontally","vertically","FreezePanesCommand","_topLeft","unfreeze","PasteCommand","_clipboard","_event","_clipboardContent","_targetRangeRefs","clipboardContent","_processPaste","_adjustPasteTarget","multipliers","sourceRows","sourceCols","refToSelect","rangeToSelect","multiplier","targetRangeRefs","compare","topLeftA","topLeftB","sourceData","_targetRanges","_populateTargetRange","_targetRangeDimensions","targetRangeRows","targetRangeCols","rowsMultiplier","colsMultiplier","AdjustRowHeightCommand","ToolbarPasteCommand","detectClipboardAccess","execCommand","CutCommand","_eventType","rangeValues","currentRow","CopyCommand","queryCommandSupported","ToolbarCopyCommand","cannotUndo","AutoFillCommand","_origin","autoFillData","ToolbarCutCommand","FilterCommand","SortCommand","expandRange","ApplyFilterCommand","filterRule","exists","valueFilter","customFilter","ClearFilterCommand","HideLineCommand","UnHideLineCommand","DeleteCommand","_expandedRange","_expand","_indexes","_undoOne","DeleteRowCommand","DeleteColumnCommand","AddCommand","_pos","AddColumnCommand","AddRowCommand","EditValidationCommand","OpenCommand","fromFile","excelImportErrors","SaveAsCommand","extension","saveAsExcel","saveAsPDF","NameCommand","nameDefinition","DefineNameCommand","defineName","DeleteNameCommand","undefineName","commands","freeze","__proto__","UndoRedoStack","stack","currentCommandIndex","canUndo","canRedo","STRING","ENTITIES","amp","quot","apos","nbsp","CODE","UCS2","START_CDATA","END_CDATA","END_COMMENT","START_COMMENT","END_SHORT_TAG","END_TAG","END_DECLARATION","QUESTION_MARK","LESS_THAN","GREATER_THAN","SEMICOLON","EQUAL","AMPERSAND","QUOTE","APOSTROPHE","SHARP","LOWERCASE_X","UPPERCASE_X","EXIT","parse$1","callbacks","selector","$tag","readChar","readAsciiWhile","skipWhitespace","eat","isHexDigit","isNameStart","isName","xmlTag","xmlName","xmlAttrs","xmlComment","xmlEntity","xmlContent","xmlString","what","arg1","arg2","parseXML","Deferred","_progressHandlers","_resolved","_rejected","promise","Promise","reject","_reject","notify","progress","then","onFulfilled","onRejected","onProgress","MAP_EXCEL_OPERATOR","greaterThanOrEqual","lessThanOrEqual","ERROR_LOG","readExcel","deferred","FileReader","async","loadAsync","readWorkbook","zip","readAsArrayBuffer","SEL_CELL","SEL_COL","SEL_DEFINED_NAME","SEL_FORMULA","SEL_MERGE","SEL_PANE","SEL_ROW","SEL_SELECTION","SEL_SHEET","SEL_STRING","SEL_TEXT","SEL_SHARED_STRING","SEL_VALUE","SEL_VIEW","SEL_SHEET_VIEW","SEL_HYPERLINK","SEL_PROTECTION","SEL_VALIDATION","SEL_VALIDATION_FORMULA1","SEL_VALIDATION_FORMULA2","SEL_VALIDATION_INSANE","SEL_VALIDATION_SQREF_INSANE","SEL_VALIDATION_FORMULA1_INSANE","SEL_VALIDATION_FORMULA2_INSANE","SEL_COMMENT","SEL_AUTHOR","SEL_COMMENT_TEXT","xl","strings","readStrings","relationships","readRelationships","theme","readTheme","byType","readStyles","tag","relId","byId","dim","sheetDimensions","bytes","activeTab","integer","vbProcedure","localSheetId","withErrorLog","loading","sheets","recalcSheets","loadSheets","ready","entry","queueSheet","readSheet","defaultColWidth","toColWidth","defaultRowHeight","toRowHeight","pts","formulaRange","formula1","formula2","customFilterLogic","customFilterCriteria","valueFilterBlanks","valueFilterValues","sharedFormulas","nCols","prevCellRef","relsFile","deferredStyles","closed","styleIndex","sty","stop","ht","acRef","xSplit","ySplit","addAutoFilter","colId","getCustomFilter","dynamicFilterType","getFilterVal","percent","blank","leave","sqref","showErrorMessage","allowBlank","showDropDown","errorTitle","applyStyle","comments","commentFile","relative_file","readComments","drawingFile","readDrawings","getContentType","filename","jpg","jpeg","png","gif","wmf","getFileName","cdr","sel_two_cell_anchor","sel_ext","sel_one_cell_anchor","sel_from","sel_to","sel_row","sel_col","sel_row_offset","sel_col_offset","sel_blip","relkeys","File","Blob","excelToPixels","cx","cy","colOffset","brCell","brX","brY","authors","authorId","ourOp","equal","Q1","Q2","Q3","Q4","M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","BORDER_WIDTHS","none","thin","medium","dashed","dotted","thick","double","hair","mediumDashed","dashDot","mediumDashDot","dashDotDot","mediumDashDotDot","slantDashDot","DEFAULT_FORMATS","xf","inlineStyles","shouldSet","applyName","xfId","namedStyles","side","setBorder","setFont","fonts","fills","formatCode","setFormat","numFmts","protection","locked","Id","Target","Type","entries","names","promises","SEL_BORDER","SEL_FILL","SEL_FONT","SEL_INLINE_STYLE","SEL_NAMED_STYLE","SEL_NUM_FMT","INDEXED_COLORS","toCSSColor","getXf","borderId","fillId","fontId","numFmtId","pivotButton","quotePrefix","addBool","getColor","defaultThemeColor","rgb","indexed","themeColor","colorScheme","tint","toHSL","patternType","diagonalUp","diagonalDown","diagonal","vertical","wrapText","SEL_SCHEME_RGBCLR","SEL_SCHEME_SYSCLR","scheme","swap","arr","events$1","loadBinary","xhr","XMLHttpRequest","response","getResponseHeader","onerror","responseType","send","Workbook","_images","_imgID","_sheetsSearchCache","_onUndoRedo","_validationContext","_names","_sheetChanging","_sheetInsertColumn","_sheetDeleteColumn","_sheetHideRow","_sheetHideColumn","_sheetUnhideRow","_sheetUnhideColumn","_sheetSelect","_sheetDataBinding","_sheetDataBound","_sheetProgress","_sheetCommandRequest","commandOptions","getWorkbookCommand","cleanupImages","toIndex","fromIndex","sheetName","insertIndex","getUniqueSheetName","sheetNameSuffix","_bindSheetEvents","nameref","newSheet","_clearSheets","_loadImages","ids","images","sheetParamsFromJSON","localName","saveJSON","readAsDataURL","_readExcel","toDataURL","toBlob","saveAs","SpreadsheetWidget","options$1","_controller","_autoRefresh","_bindWorkbookEvents","_bindViewEvents","_resizeHandler","_keyDownHandler","_keyDown","controlKey","activeSheetIndex","nextSheetName","prevSheetName","createSheetEditor","_handleTypographicalEmphasis","_workbookChanging","_workbookChange","_workbookCut","_workbookCopy","_workbookPaste","autoRefresh","_workbookExcelExport","_workbookExcelImport","_workbookPdfExport","_workbookInsertSheet","_workbookRemoveSheet","_workbookSelectSheet","_workbookRenameSheet","_workbookInsertRow","_workbookInsertColumn","_workbookDeleteRow","_workbookDeleteColumn","_workbookHideRow","_workbookHideColumn","_workbookUnhideRow","_workbookUnhideColumn","_workbookSelect","_workbookChangeFormat","_workbookDataBinding","_workbookDataBound","_workbookProgress","_viewUpdate","_viewMessage","_onContextMenu","packDate$1","unpackDate$1","equals","binaryCompare","_cosh","_sinh","_tanh","_gcd","_lcm","forIFS","chunks","parseCriteria","fetchSumRange","continuation","sumRange","_extreme","nth","order","_avg","_var_sp","divisor","avg","_stdev_sp","_percentrank","exc","nlt","ngt","_covariance","ax","ay","$a","$b","toResolve","$value","$m","$n","cos","sin","acos","asin","tan","atan","$num","$base","PI","$radians","rad","$degrees","deg","$x","$y","$number","$significance","$mode","$multiple","mult","$digits","$numbers","prod","$a1","$a2","coef","$values","seen","$args","$m1","$c1","$m2","$c2","m1","$range","numericPredicate","$criteria","$sumRange","$array","$nth","res","$percent","discard","$data","$bins","bins","$order","asc","variance","stddev","significance","$array1","$array2","_fact","fact","_combinations","f1","f2","p1","p2","_percentile","rank","_percentile_inc","_percentile_exc","$k","$p","$quarter","AGGREGATE_FUNCS","fetchValuesForAggregate","fetchValues","_binom_dist","cumulative","weeksInYear","_days_360","method","d1","d2","$funcId","$options","funcId","$ref","ignoreHidden","$successes","$trials","$probability","$cumulative","$alpha","alpha","$successes_min","$successes_max","$number_f","$number_s","$probability_s","$row","$col","$abs","$sheet","$index","$approx","approx","resultCol","$areanum","areanum","colRange","$thing","$type","cmp","$rows","$cols","$height","$width","resultRow","$year","$month","$date","fw","sy","dow","wk","$hours","$minutes","$seconds","$time","$start_date","$months","$days","$holidays","holidays","inc","$end_date","$method","$text","$min","$max","$roman","rom","$radix","$minLen","radix","minLen","$code","RX_NON_PRINTABLE","Hyperlink","$decimals","dec","denomitator","$text1","$text2","$substring","$string","$start","string","$noCommas","noCommas","$length","$newText","newText","$oldText","oldText","$format","$link","$value_if_error","valueIfError","RXCACHE","makeComparator","lc","compLT","compLTE","compGT","compGTE","compNE","compEQ","$lower_limit","$upper_limit","ll","ul","ERF","ERFC","GAMMALN","GAMMA","$beta","GAMMA_DIST","GAMMA_INV","$z","NORM_S_DIST","NORM_S_INV","$mean","$stddev","NORM_DIST","NORM_INV","$A","$B","BETADIST","BETA_DIST","BETA_INV","$deg_freedom","chisq_left","chisq_right","chisq_left_inv","chisq_right_inv","$actual_range","$expected_range","ac","chisq_test","$lambda","expon","poisson","$deg_freedom1","$deg_freedom2","Fdist","Fdist_right","Finv","Finv_right","Ftest","fisher","fisherinv","Tdist","Tdist_right","Tdist_2tail","Tdist_inv","Tdist_2tail_inv","$tails","Tdist_test","$standard_dev","$size","confidence_t","confidence_norm","gauss","phi","lognorm_dist","lognorm_inv","$x_range","$prob_range","prob","$known_y","$known_x","slope","intercept","pearson","rsq","steyx","forecast","$const","$stats","linest","logest","$new_x","trend","growth","$rate","$nper","$pmt","$pv","FV","$fv","PV","PMT","NPER","$guess","RATE","$per","IPMT","PPMT","$start_period","$end_period","CUMPRINC","CUMIPMT","NPV","IRR","$nominal_rate","$npery","EFFECT","$effect_rate","NOMINAL","$dates","XNPV","XIRR","ISPMT","$cost","$salvage","$life","$period","DB","$factor","DDB","SLN","SYD","$no_switch","VDB","$settlement","$maturity","$frequency","$basis","COUPDAYBS","COUPDAYS","COUPDAYSNC","COUPPCD","COUPNCD","COUPNUM","$issue","$par","ACCRINTM","$first_interest","$calc_method","ACCRINT","$pr","$redemption","DISC","$investment","INTRATE","$discount","RECEIVED","$yld","PRICE","PRICEDISC","MAX_IT","EPS","FP_MIN","f_abs","S","an","cof","ser","pi","BETALN","BETA","gamma_inc","g_series","g_contfrac","ap","gln","aj","bj","M","ab","plow","betastd_pdf","betastd_cdf","beta_lentz","m2","del","qab","qam","qap","betastd_inv","cdf","cds","obsv","expect","eij","lnf","_mean","me","_var_sq","arr1","arr2","n1","n2","va1","va2","e2","gr1","gr2","tail","t_st","df","md","v1","v2","u1","u2","q1","q2","z","x_","p_","lw","y_","whipNumberArrays","s3","t2","_mat_mean","Mat","_mat_devsq","mean","sq","Y","X","konst","stats","Xt","line_1","Y1","y_y1","SSreg","SSresid","line_5","R2","degfre","err_est","line_3","F_sta","line_4","SCP","line_2","W","new_X","root_newton","guess","max_it","eps","f_d","rate","nper","pmt","pv","h1","fv","h2","per","ipmt","tn","ts","te","monthlyPayment","cip","flows","npv","npv1","nominal_rate","npery","effect_rate","cost","salvage","life","period","db","factor","prior","dep","no_switch","interest","_getGDA","gda","oldValue","_interVDB","life1","term","remValue","intEnd","lia","vdb","nowLia","intStart","_edate","_daysBetween","basis","_borderCoupons","settlement","maturity","freq","sett","periods","_borderCoupons_fw","frequency","settl","matur","mat","daysInYear2","issue","par","year_days","brace","prev1","next1","nrc","accr","annual","_numCoupons","pr","redemption","investment","discount","yld","beg_settl","settl_end","beg_end","den","yf","commonEngine"],"sources":["kendo.spreadsheet-common.cmn.chunk.js"],"mappings":"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","ignoreList":[],"sourcesContent":["import { u as util, q as parseColor, G as Group, b as Path, R as Rect, M as Matrix$1, B as Rect$1, D as drawText$1 } from './kendo.drawing.cmn.chunk.js';\n\nconst __meta__ = {\n    id: \"spreadsheet-common.cmn.chunk\",\n    name: \"SpreadsheetCommonCmnChunk\",\n    category: \"web\",\n    description: \"A reusable outputed chunk of code\",\n    depends: ['drawing.cmn.chunk', 'date-math.cmn.chunk', 'common.cmn.chunk', 'jszip-esm.cmn.chunk'],\n    hidden: true,\n    chunk: true\n};\n\n\nimport { g as getDate, d as dayOfWeek, e as addDays, f as firstDayOfMonth } from './kendo.date-math.cmn.chunk.js';\nimport { b as browser } from './kendo.common.cmn.chunk.js';\nimport { J as JSZip } from './kendo.jszip-esm.cmn.chunk.js';\n\n/* eslint-disable camelcase */\n/* eslint-disable no-nested-ternary */\n/* eslint-disable max-params */\n/* eslint-disable no-unused-vars */\n/* eslint-disable no-else-return */\n/* eslint-disable no-param-reassign */\n/* eslint-disable eqeqeq */\n/* eslint-disable no-bitwise */\n\n// WARNING\n// == into === to make JSHint happy will break functionality.\n\nfunction columnName(colIndex) {\n    const letter = Math.floor(colIndex / 26) - 1;\n    return (letter >= 0 ? columnName(letter) : '') + String.fromCharCode(65 + (colIndex % 26));\n}\nfunction displaySheet(sheet) {\n    if (/^[a-z_][a-z0-9_]*$/i.test(sheet)) {\n        return sheet;\n    }\n    return \"'\" + sheet.replace(/\\x27/g, \"\\\\'\") + \"'\";\n}\nfunction displayRef(sheet, row, col, rel) {\n    let aa = \"\";\n    ++row;\n\n    if (!isFinite(row)) {\n        row = \"\";\n    } else if (rel != null && !(rel & 2)) {\n        row = \"$\" + row;\n    }\n\n    if (!isFinite(col)) {\n        col = \"\";\n    } else {\n        aa = columnName(col);\n        if (rel != null && !(rel & 1)) {\n            aa = \"$\" + aa;\n        }\n    }\n    if (sheet) {\n        return displaySheet(sheet) + \"!\" + aa + row;\n    } else {\n        return aa + row;\n    }\n}\n\n/* -----[ References ]----- */\n\nclass Ref {\n    constructor() {\n        this.type = \"ref\";\n        this.sheet = \"\";\n    }\n\n    clone() {\n        return this;\n    }\n    hasSheet() {\n        return this._hasSheet;\n    }\n    simplify() {\n        return this;\n    }\n    setSheet(sheet, hasSheet) {\n        this.sheet = sheet;\n        if (hasSheet != null) {\n            this._hasSheet = hasSheet;\n        }\n        return this;\n    }\n    absolute(_arow, _acol) {\n        return this;\n    }\n    relative(..._args) {\n        return this;\n    }\n    adjust(_row, _col, _trow, _tcol, _forRow, _start, _delta) {\n        return this;\n    }\n    toString() {\n        return this.relative(0, 0, 3, 3).print(0, 0);\n    }\n    forEach(callback, obj) {\n        callback.call(obj, this);\n    }\n    map(callback, obj) {\n        return callback.call(obj, this);\n    }\n    intersect(_ref) {\n        return this;\n    }\n    intersects(ref) {\n        return this.intersect(ref) !== NULLREF;\n    }\n    isCell() {\n        return false;\n    }\n    toRow(_row) {\n        return this;\n    }\n    toColumn(_col) {\n        return this;\n    }\n    // UnionRef overrides these, to access its subranges.\n    first() {\n        return this;\n    }\n    lastRange() {\n        return this;\n    }\n    size() {\n        return 1;\n    }\n    rangeAt(_index) {\n        return this;\n    }\n    nextRangeIndex(_index) {\n        return 0;\n    }\n    previousRangeIndex(_index) {\n        return 0;\n    }\n    eq(reference) {\n        let r1 = this;\n        let r2 = reference;\n        if (r1 === NULLREF || r2 === NULLREF) {\n            return r1 === r2;\n        }\n        // make positions consistent\n        if ((r2 instanceof CellRef) || (r2 instanceof RangeRef && !(r1 instanceof CellRef))) {\n            r1 = reference;\n            r2 = this;\n        }\n        if (r1 instanceof CellRef) { // cell eq *\n            r2 = r2.simplify();\n            return r2 instanceof CellRef && r1.row == r2.row && r1.col == r2.col && r1.sheet == r2.sheet;\n        } else if (r1 instanceof RangeRef) { // range eq range/union\n            if (r2 instanceof RangeRef) {\n                return r2.topLeft.eq(r1.topLeft) && r2.bottomRight.eq(r1.bottomRight);\n            }\n            if (r2 instanceof UnionRef) {\n                return r2.single() && r1.eq(r2.refs[0]);\n            }\n        } else if (r1 instanceof UnionRef && r2 instanceof UnionRef) { // union eq union\n            const refs1 = r1.refs;\n            const refs2 = r2.refs;\n            if (refs1.length != refs2.length) {\n                return false;\n            }\n            for (let i = 0, len = refs1.length; i < len; i++) {\n                if (!refs1[i].eq(refs2[i])) {\n                    return false;\n                }\n            }\n            return true;\n        }\n        return r1 === r2;   // XXX'll support it.\n    }\n    concat(ref) {\n        return new UnionRef([this, ref]);\n    }\n    replaceAt(_index, ref) {\n        return ref;\n    }\n    forEachColumnIndex(callback) {\n        this.forEachAxisIndex('col', callback);\n    }\n    forEachRowIndex(callback) {\n        this.forEachAxisIndex('row', callback);\n    }\n    forEachRow(_callback) {\n        //\n    }\n    forEachColumn(_callback) {\n        //\n    }\n    forEachAxisIndex(axis, callback) {\n        let sorted = [];\n        let method = axis === 'row' ? 'forEachRow' : 'forEachColumn';\n\n        this[method](function(ref) {\n            let index = ref.first()[axis];\n            if (sorted.indexOf(index) === -1) {\n                sorted.push(index);\n            }\n        });\n\n        sorted.sort(function(a, b) {\n            return a > b ? 1 : (a < b ? -1 : 0);\n        }).forEach(callback);\n    }\n    valid() {\n        return false;\n    }\n    renameSheet(oldSheetName, newSheetName) {\n        if (this.sheet && this.sheet.toLowerCase() == oldSheetName.toLowerCase()) {\n            this.sheet = newSheetName;\n            return true;\n        }\n    }\n}\n\nRef.display = displayRef;\n\n/* -----[ Null reference ]----- */\nclass NULLREFClass extends Ref {\n    print() {\n        return \"#NULL!\";\n    }\n    eq(ref) {\n        return ref === this;\n    }\n    forEach() {}\n}\nconst NULLREF = new NULLREFClass();\n\n/* -----[ Name reference ]----- */\n\nclass NameRef extends Ref {\n    constructor(name) {\n        super();\n        this.name = name;\n        this.ref = \"name\";\n    }\n\n    clone() {\n        return new NameRef(this.name)\n            .setSheet(this.sheet, this.hasSheet());\n    }\n    print() {\n        let ret = displaySheet(this.name);\n        if (this.hasSheet()) {\n            ret = displaySheet(this.sheet) + \"!\" + ret;\n        }\n        return ret;\n    }\n}\n\n/* -----[ Cell reference ]----- */\n\nclass CellRef extends Ref {\n    constructor(row, col, rel) {\n        super();\n        this.row = row;\n        this.col = col;\n        this.rel = rel || 0;\n        this.ref = \"cell\";\n    }\n\n    clone() {\n        return new CellRef(this.row, this.col, this.rel)\n            .setSheet(this.sheet, this.hasSheet());\n    }\n\n    intersect(ref) {\n        if (ref instanceof CellRef) {\n            if (this.eq(ref)) {\n                return this;\n            } else {\n                return NULLREF;\n            }\n        }\n        return ref.intersect(this);\n    }\n\n    print(trow, tcol, mod) {\n        let col = this.col, row = this.row, rel = this.rel, abs;\n        if (trow == null && rel) {\n            let sheet = this.hasSheet() ? displaySheet(this.sheet) + \"!\" : \"\";\n            if (isFinite(col)) {\n                col = rel & 1 ? (\"C[\" + col + \"]\") : (\"C\" + (col + 1));\n            } else {\n                col = \"\";\n            }\n            if (isFinite(row)) {\n                row = rel & 2 ? (\"R[\" + row + \"]\") : (\"R\" + (row + 1));\n            } else {\n                row = \"\";\n            }\n            return sheet + row + col;\n        } else {\n            abs = this.absolute(trow, tcol);\n            if (mod) {\n                // Hacks`absolute()`\n                row = abs.row % 0x100000;\n                col = abs.col % 0x4000;\n                if (row < 0) {\n                    row += 0x100000;\n                }\n                if (col < 0) {\n                    col += 0x4000;\n                }\n                return displayRef(this._hasSheet && this.sheet, row, col, rel);\n            }\n            return abs.valid() ? displayRef(this._hasSheet && this.sheet, abs.row, abs.col, rel) : \"#REF!\";\n        }\n    }\n    absolute(arow, acol) {\n        let ret = this.clone();\n        if ((ret.rel & 3) === 0) {\n            return ret;    // already absolute\n        }\n\n        // Hacks0x4000 (max col) and 0x100000 (max row).  This\n        // fixes importing relative references in definedName-s from Excel.  Example in\n        // Excel3, open the Name Manager (in Formula tab) and define name\n        // TEST with value Sheet1!A1:C3.  The serialization of this name in XLSX is:\n        //\n        //     <definedName name=\"TEST\">Sheet1!XFA1048575:XFC1</definedName>\n        //\n        // This is insane, of course, but oh well.  Excel.  If you type in E3 =SUM(TEST) it\n        // works (it actually sums the cells), but if you type =SUM(Sheet1!XFA1048575:XFC1)\n        // you get back zero.  Let's see why SUM(TEST) works:\n        //\n        //     XFA1048575:XFC1                   E3\n        //     (zero-based indexes below)\n        //\n        //     R[1048574]C[16380]:R[0]C[16382] + R2C4 = R1048576C16384:R2C16386\n        //                                            % (0x100000, 0x4000)\n        //                                            = R0C0:R2C2 (== A1:C3)\n        //\n        // So XFA1048575:XFC1 is relocated to E3 at evaluation time, and because we take\n        // rows modulo 0x100000 and cols modulo 0x4000, we get back the correct range.\n        //\n        // IMO Excel should disallow A1-style relative references in name definitions\n        // (simply because the meaning of the A1:C3 you type in Name Manager depends on the\n        // active cell) and only allow R1C1 notation — that's unambiguous.  But it doesn't.\n        // Moreover, R1C1-style refs in XLSX are explicitly forbidden by the spec, and the\n        // hacks above are not documented — how else could we have fun implementing a XLSX\n        // reader?\n        if (ret.rel & 1) {\n            // relative col, add anchor\n            ret.col = (ret.col + acol) % 0x4000;\n        }\n        if (ret.rel & 2) {\n            // relative row, add anchor\n            ret.row = (ret.row + arow) % 0x100000;\n        }\n\n        ret.rel = 0;\n        return ret;\n    }\n    toRangeRef() {\n        return new RangeRef(this, this);\n    }\n    relative(arow, acol, rel) {\n        if (rel == null) {\n            rel = this.rel;\n        }\n        let row = rel & 2 ? this.row - arow : this.row;\n        let col = rel & 1 ? this.col - acol : this.col;\n        return new CellRef(row, col, rel)\n            .setSheet(this.sheet, this.hasSheet());\n    }\n    height() {\n        return 1;\n    }\n    width() {\n        return 1;\n    }\n    toString() {\n        return displayRef(null, this.row, this.col, 3);\n    }\n    isCell() {\n        return true;\n    }\n    leftColumn() {\n        return this;\n    }\n    rightColumn() {\n        return this;\n    }\n    topRow() {\n        return this;\n    }\n    bottomRow() {\n        return this;\n    }\n    forEachRow(callback) {\n        callback(this.toRangeRef());\n    }\n    forEachColumn(callback) {\n        callback(this.toRangeRef());\n    }\n    adjust(row, col, trow, tcol, forRow, start, delta) {\n        let ref = this.absolute(row, col);\n        if (forRow) {\n            if (ref.row >= start) {\n                if (delta < 0 && ref.row < start - delta) {\n                    return NULLREF;\n                }\n                ref.row += delta;\n            }\n        } else {\n            if (ref.col >= start) {\n                if (delta < 0 && ref.col < start - delta) {\n                    return NULLREF;\n                }\n                ref.col += delta;\n            }\n        }\n        if (trow != null && tcol != null) {\n            ref = ref.relative(trow, tcol, this.rel);\n        }\n        return ref;\n    }\n    valid() {\n        if (this.rel) {\n            throw new Error(\"valid() called on relative reference\");\n        }\n        let col = this.col, row = this.row;\n        return !((isFinite(col) && col < 0) || (isFinite(row) && row < 0));\n    }\n}\n\n/* -----[ Range reference ]----- */\n\nclass RangeRef extends Ref {\n    constructor(tl, br) {\n        super();\n        this.ref = \"range\";\n        if (tl._hasSheet && br._hasSheet && tl.sheet.toLowerCase() != br.sheet.toLowerCase()) {\n            // \"3D\" reference\n            this.endSheet = br.sheet;\n        }\n        // we want to drop any sheet information from the cells here.\n        this.topLeft = new CellRef(tl.row, tl.col, tl.rel);\n        this.bottomRight = new CellRef(br.row, br.col, br.rel);\n        this.normalize();\n    }\n    clone() {\n        return new RangeRef(this.topLeft.clone(), this.bottomRight.clone()).setSheet(this.sheet, this.hasSheet());\n    }\n    _containsRange(range) {\n        return this._containsCell(range.topLeft)\n                && this._containsCell(range.bottomRight);\n    }\n    _containsCell(cell) {\n        return cell.sheet == this.sheet\n                && cell.row >= this.topLeft.row\n                && cell.col >= this.topLeft.col\n                && cell.row <= this.bottomRight.row\n                && cell.col <= this.bottomRight.col;\n    }\n    contains(ref) {\n        if (ref instanceof Array) {\n            let that = this;\n\n            return ref.some(function(_ref) { return Boolean(that.contains(_ref)); });\n        }\n        if (ref instanceof CellRef) {\n            return this._containsCell(ref);\n        }\n        if (ref instanceof RangeRef) {\n            return this._containsRange(ref);\n        }\n        return false;\n    }\n    _intersectRange(ref) {\n        if (this.sheet != ref.sheet) {\n            return NULLREF;\n        }\n        let a_left = this.topLeft.col;\n        let a_top = this.topLeft.row;\n        let a_right = this.bottomRight.col;\n        let a_bottom = this.bottomRight.row;\n        let b_left = ref.topLeft.col;\n        let b_top = ref.topLeft.row;\n        let b_right = ref.bottomRight.col;\n        let b_bottom = ref.bottomRight.row;\n        if (a_left <= b_right &&\n                b_left <= a_right &&\n                a_top <= b_bottom &&\n                b_top <= a_bottom) {\n            return new RangeRef(\n                // topLeft\n                new CellRef(Math.max(a_top, b_top),\n                            Math.max(a_left, b_left)),\n                // bottomRight\n                new CellRef(Math.min(a_bottom, b_bottom),\n                            Math.min(a_right, b_right))\n            ).setSheet(this.sheet, this.hasSheet());\n        } else {\n            return NULLREF;\n        }\n    }\n    intersect(ref) {\n        if (ref instanceof CellRef) {\n            return this._containsCell(ref) ? ref : NULLREF;\n        }\n        if (ref instanceof RangeRef) {\n            return this._intersectRange(ref).simplify();\n        }\n        if (ref instanceof UnionRef) {\n            return ref.intersect(this);\n        }\n        return NULLREF;        // can't handle NameRef-s here.\n    }\n    simplify() {\n        if (this.isCell()) {\n            return new CellRef(\n                this.topLeft.row,\n                this.topLeft.col,\n                this.topLeft.rel\n            ).setSheet(this.sheet, this.hasSheet());\n        }\n        return this;\n    }\n    normalize() {\n        let a = this.topLeft, b = this.bottomRight;\n        let r1 = a.row, c1 = a.col, r2 = b.row, c2 = b.col;\n        let rr1 = a.rel & 2, rc1 = a.rel & 1;\n        let rr2 = b.rel & 2, rc2 = b.rel & 1;\n        let tmp, changes = false;\n        // do not attempt to normalize unless relativeness of rows and cols are the same.\n        // https://github.com/telerik/kendo-ui-core/issues/4278\n        if (rr1 === rr2 && rc1 === rc2) {\n            if (r1 > r2) {\n                changes = true;\n                tmp = r1; r1 = r2; r2 = tmp;\n                tmp = rr1; rr1 = rr2; rr2 = tmp;\n            }\n            if (c1 > c2) {\n                changes = true;\n                tmp = c1; c1 = c2; c2 = tmp;\n                tmp = rc1; rc1 = rc2; rc2 = tmp;\n            }\n            if (changes) {\n                this.topLeft = new CellRef(r1, c1, rc1 | rr1);\n                this.bottomRight = new CellRef(r2, c2, rc2 | rr2);\n            }\n        }\n        return this;\n    }\n    print(trow, tcol, mod) {\n        if (mod || this.absolute(trow, tcol).valid()) {\n            let ret = this.topLeft.print(trow, tcol, mod)\n                    + \":\"\n                    + this.bottomRight.print(trow, tcol, mod);\n            if (this.hasSheet()) {\n                ret = displaySheet(this.sheet)\n                        + (this.endSheet ? \":\" + displaySheet(this.endSheet) : \"\")\n                        + \"!\" + ret;\n            }\n            return ret;\n        }\n        return \"#REF!\";\n    }\n    absolute(arow, acol) {\n        return new RangeRef(\n            this.topLeft.absolute(arow, acol),\n            this.bottomRight.absolute(arow, acol)\n        ).setSheet(this.sheet, this.hasSheet());\n    }\n    relative(arow, acol, relTL, relBR) {\n        if (relBR == null) {\n            relBR = relTL;\n        }\n        return new RangeRef(\n            this.topLeft.relative(arow, acol, relTL),\n            this.bottomRight.relative(arow, acol, relBR)\n        ).setSheet(this.sheet, this.hasSheet());\n    }\n    height() {\n        if (this.topLeft.rel != this.bottomRight.rel) {\n            throw new Error(\"Mixed relative/absolute references\");\n        }\n        return this.bottomRight.row - this.topLeft.row + 1;\n    }\n    width() {\n        if (this.topLeft.rel != this.bottomRight.rel) {\n            throw new Error(\"Mixed relative/absolute references\");\n        }\n        return this.bottomRight.col - this.topLeft.col + 1;\n    }\n    collapse() {\n        return this.topLeft.toRangeRef();\n    }\n    leftColumn() {\n        return new RangeRef(this.topLeft, new CellRef(this.bottomRight.row, this.topLeft.col));\n    }\n    rightColumn() {\n        return new RangeRef(new CellRef(this.topLeft.row, this.bottomRight.col), this.bottomRight);\n    }\n    topRow() {\n        return new RangeRef(this.topLeft, new CellRef(this.topLeft.row, this.bottomRight.col));\n    }\n    bottomRow() {\n        return new RangeRef(new CellRef(this.bottomRight.row, this.topLeft.col), this.bottomRight);\n    }\n    toRangeRef() {\n        return this;\n    }\n    toRow(row) {\n        row += Math.max(0, this.topLeft.row);\n        return new RangeRef(\n            new CellRef(row, this.topLeft.col),\n            new CellRef(row, this.bottomRight.col)\n        ).setSheet(this.sheet, this.hasSheet());\n    }\n    toColumn(col) {\n        col += Math.max(0, this.topLeft.col);\n        return new RangeRef(\n            new CellRef(this.topLeft.row, col),\n            new CellRef(this.bottomRight.row, col)\n        ).setSheet(this.sheet, this.hasSheet());\n    }\n    toCell(row, col) {\n        row += Math.max(0, this.topLeft.row);\n        col += Math.max(0, this.topLeft.col);\n        return new CellRef(row, col, 0)\n            .setSheet(this.sheet, this.hasSheet());\n    }\n    forEachRow(callback) {\n        let startRow = this.topLeft.row;\n        let endRow = this.bottomRight.row;\n        let startCol = this.topLeft.col;\n        let endCol = this.bottomRight.col;\n\n        for (let i = startRow; i <= endRow; i++) {\n            callback(new RangeRef(\n                new CellRef(i, startCol),\n                new CellRef(i, endCol)\n            ));\n        }\n    }\n    forEachColumn(callback) {\n        let startRow = this.topLeft.row;\n        let endRow = this.bottomRight.row;\n        let startCol = this.topLeft.col;\n        let endCol = this.bottomRight.col;\n\n        for (let i = startCol; i <= endCol; i++) {\n            callback(new RangeRef(\n                new CellRef(startRow, i),\n                new CellRef(endRow, i)\n            ));\n        }\n    }\n    intersecting(refs) {\n        return refs.filter((ref) => ref.toRangeRef().intersects(this));\n    }\n\n    union(refs, callback) {\n        let intersecting = this.intersecting(refs);\n\n        let topLeftRow = this.topLeft.row;\n        let topLeftCol = this.topLeft.col;\n        let bottomRightRow = this.bottomRight.row;\n        let bottomRightCol = this.bottomRight.col;\n\n        let modified = false;\n\n        intersecting.forEach(function(ref) {\n            ref = ref.toRangeRef();\n            if (ref.topLeft.row < topLeftRow) {\n                modified = true;\n                topLeftRow = ref.topLeft.row;\n            }\n\n            if (ref.topLeft.col < topLeftCol) {\n                modified = true;\n                topLeftCol = ref.topLeft.col;\n            }\n\n            if (ref.bottomRight.row > bottomRightRow) {\n                modified = true;\n                bottomRightRow = ref.bottomRight.row;\n            }\n\n            if (ref.bottomRight.col > bottomRightCol) {\n                modified = true;\n                bottomRightCol = ref.bottomRight.col;\n            }\n\n            if (callback) {\n                callback(ref);\n            }\n        });\n\n        let result = new RangeRef(\n            new CellRef(topLeftRow, topLeftCol),\n            new CellRef(bottomRightRow, bottomRightCol)\n        );\n\n        if (modified) {\n            return result.union(refs, callback);\n        } else {\n            return result;\n        }\n    }\n    resize(options) {\n        let limit = Math.max.bind(Math, 0);\n        function num(value) { return value || 0; }\n\n        let top = this.topLeft.row + num(options.top);\n        let left = this.topLeft.col + num(options.left);\n        let bottom = this.bottomRight.row + num(options.bottom);\n        let right = this.bottomRight.col + num(options.right);\n\n        if (left < 0 && right < 0 || top < 0 && bottom < 0) {\n            return NULLREF;\n        } else if (top <= bottom && left <= right) {\n            return new RangeRef(new CellRef(limit(top), limit(left)),\n                                new CellRef(limit(bottom), limit(right)));\n        } else {\n            return NULLREF;\n        }\n    }\n    move(rows, cols) {\n        return new RangeRef(\n            new CellRef(this.topLeft.row + rows,\n                        this.topLeft.col + cols),\n            new CellRef(this.bottomRight.row + rows,\n                        this.bottomRight.col + cols)\n        );\n    }\n    first() {\n        return this.topLeft.clone().setSheet(this.sheet, this.hasSheet());\n    }\n    isCell() {\n        return !this.endSheet && this.topLeft.eq(this.bottomRight);\n    }\n    toString() {\n        return this.topLeft + \":\" + this.bottomRight;\n    }\n    adjust(row, col, trow, tcol, forRow, start, delta) {\n        let tl = this.topLeft.adjust(row, col, trow, tcol, forRow, start, delta);\n        let tr = this.bottomRight.adjust(row, col, trow, tcol, forRow, start, delta);\n        if (tl === NULLREF && tr === NULLREF) {\n            return NULLREF;\n        }\n        if (tl === NULLREF) {\n            tl = this.topLeft.absolute(row, col);\n            if (forRow) {\n                tl.row = start;\n            } else {\n                tl.col = start;\n            }\n            if (trow != null && tcol != null) {\n                tl = tl.relative(trow, tcol, this.topLeft.rel);\n            }\n        } else if (tr === NULLREF) {\n            tr = this.bottomRight.absolute(row, col);\n            if (forRow) {\n                tr.row = start - 1;\n            } else {\n                tr.col = start - 1;\n            }\n            if (trow != null && tcol != null) {\n                tr = tr.relative(trow, tcol, this.bottomRight.rel);\n            }\n        }\n        return new RangeRef(tl, tr)\n            .setSheet(this.sheet, this.hasSheet())\n            .simplify();\n    }\n    valid() {\n        return this.topLeft.valid() && this.bottomRight.valid();\n    }\n}\n\n/* -----[ Union reference ]----- */\n\nclass UnionRef extends Ref {\n    constructor(refs) {\n        super();\n        this.refs = refs;\n        this.length = refs.length;\n    }\n    clone() {\n        return new UnionRef(this.refs.slice());\n    }\n    intersect(ref) {\n        let a = [];\n        for (let i = 0; i < this.length; ++i) {\n            let x = ref.intersect(this.refs[i]);\n            if (x !== NULLREF) {\n                a.push(x);\n            }\n        }\n        if (a.length > 0) {\n            return new UnionRef(a).simplify();\n        }\n        return NULLREF;\n    }\n    simplify() {\n        // eslint-disable-next-line max-len\n        let u = new UnionRef(this.refs.reduce(function(a, ref) {\n            ref = ref.simplify();\n            if (ref !== NULLREF) {\n                a.push(ref);\n            }\n            return a;\n        }, []));\n        if (u.empty()) {\n            return NULLREF;\n        }\n        if (u.single()) {\n            return u.refs[0];\n        }\n        return u;\n    }\n    absolute(arow, acol) {\n        return new UnionRef(this.refs.map(function(ref) {\n            return ref.absolute(arow, acol);\n        }));\n    }\n    forEach(callback, obj) {\n        this.refs.forEach(function(ref) {\n            if (ref instanceof UnionRef) {\n                ref.forEach(callback, obj);\n            } else {\n                callback.call(obj, ref);\n            }\n        }, obj);\n    }\n    toRangeRef() {\n        return this.refs[0].toRangeRef();\n    }\n    contains(theRef) {\n        return this.refs.some(function(ref) { return ref.contains(theRef); });\n    }\n    map(callback, obj) {\n        let refs = [];\n        this.forEach(function(ref) {\n            refs.push(callback.call(obj, ref));\n        });\n        return new UnionRef(refs);\n    }\n    first() {\n        return this.refs[0].first();\n    }\n    lastRange() {\n        return this.refs[this.length - 1];\n    }\n    size() {\n        return this.length;\n    }\n    single() {\n        return this.length == 1;\n    }\n    empty() {\n        return this.length === 0;\n    }\n    isCell() {\n        return this.single() && this.refs[0].isCell();\n    }\n    rangeAt(index) {\n        return this.refs[index];\n    }\n    nextRangeIndex(index) {\n        if (index === this.length - 1) {\n            return 0;\n        } else {\n            return index + 1;\n        }\n    }\n    previousRangeIndex(index) {\n        if (index === 0) {\n            return this.length - 1;\n        } else {\n            return index - 1;\n        }\n    }\n    concat(ref) {\n        return new UnionRef(this.refs.concat([ref]));\n    }\n    print(row, col, mod) {\n        return this.refs.map(function(ref) { return ref.print(row, col, mod); }).join(\",\");\n    }\n\n    replaceAt(index, ref) {\n        let newRefs = this.refs.slice();\n        newRefs.splice(index, 1, ref);\n        return new UnionRef(newRefs);\n    }\n\n    leftColumn() {\n        return this.map(function(ref) {\n            return ref.leftColumn();\n        });\n    }\n    rightColumn() {\n        return this.map(function(ref) {\n            return ref.rightColumn();\n        });\n    }\n    topRow() {\n        return this.map(function(ref) {\n            return ref.topRow();\n        });\n    }\n    bottomRow() {\n        return this.map(function(ref) {\n            return ref.bottomRow();\n        });\n    }\n    forEachRow(callback) {\n        this.forEach(function(ref) {\n            ref.forEachRow(callback);\n        });\n    }\n    forEachColumn(callback) {\n        this.forEach(function(ref) {\n            ref.forEachColumn(callback);\n        });\n    }\n    adjust(row, col, trow, tcol, forRow, start, delta) {\n        return this.map(function(ref) {\n            return ref.adjust(row, col, trow, tcol, forRow, start, delta);\n        }).simplify();\n    }\n    toString() {\n        return this.refs.map(function(ref) {\n            return ref.toString();\n        }).join(\", \");\n    }\n    valid() {\n        for (let i = this.refs.length; --i >= 0;) {\n            if (this.refs[i].valid()) {\n                return false;\n            }\n        }\n        return true;\n    }\n    renameSheet(oldSheetName, newSheetName) {\n        this.refs.forEach(function(ref) {\n            ref.renameSheet(oldSheetName, newSheetName);\n        });\n    }\n}\n\nconst FIRSTREF = new CellRef(0, 0);\n\nconst SHEETREF = new RangeRef(new CellRef(0, 0), new CellRef(Infinity, Infinity));\nSHEETREF.print = function() {\n    return \"#SHEET\";\n};\n\n/* eslint-disable key-spacing */\nconst messages = {};\nmessages.view = {\n    nameBox: \"Name Box\",\n    errors: {\n        modifyMerged: \"Cannot change part of a merged cell.\",\n        openUnsupported: \"Unsupported format. Please select an .xlsx file.\",\n        shiftingNonblankCells: \"Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.\",\n        insertColumnWhenRowIsSelected: \"Cannot insert column when all columns are selected.\",\n        insertRowWhenColumnIsSelected: \"Cannot insert row when all rows are selected.\",\n        filterRangeContainingMerges: \"Cannot create a filter within a range containing merges\",\n        sortRangeContainingMerges: \"Cannot sort a range containing merges\",\n        cantSortMultipleSelection: \"Cannot sort multiple selection\",\n        cantSortNullRef: \"Cannot sort empty selection\",\n        cantSortMixedCells: \"Cannot sort range containing cells of mixed shapes\",\n        validationError: \"The value that you entered violates the validation rules set on the cell.\",\n        cannotModifyDisabled: \"Cannot modify disabled cells.\",\n        insertRowBelowLastRow: \"Cannot insert row below the last row.\",\n        insertColAfterLastCol: \"Cannot insert column to the right of the last column.\"\n    },\n    tabs: {\n        home: \"Home\",\n        insert: \"Insert\",\n        data: \"Data\"\n    }\n};\n\nmessages.menus = {\n    \"cut\"          : \"Cut\",\n    \"copy\"         : \"Copy\",\n    \"paste\"        : \"Paste\",\n    \"merge\"        : \"Merge\",\n    \"unmerge\"      : \"Unmerge\",\n    \"delete\"       : \"Delete\",\n    \"hide\"         : \"Hide\",\n    \"unhide\"       : \"Unhide\",\n    \"bringToFront\" : \"Bring to front\",\n    \"sendToBack\"   : \"Send to back\"\n};\n\nmessages.workbook = {\n    defaultSheetName: \"Sheet\"\n};\n\nconst options = {\n    name: \"Spreadsheet\",\n    toolbar: true,\n    sheetsbar: true,\n    rows: 200,\n    columns: 50,\n    rowHeight: 20,\n    columnWidth: 64,\n    headerHeight: 20,\n    headerWidth: 32,\n    excel: {\n        fileName: \"Workbook.xlsx\",\n        forceProxy: false,\n        proxyURL: \"\",\n    },\n    messages: messages,\n    pdf: {\n        // which part of the workbook to be exported\n        area: \"workbook\",\n        fileName: \"Workbook.pdf\",\n        proxyURL: \"\",\n        // paperSize can be an usual name, i.e. \"A4\", or an array of two Number-s specifying the\n        // width/height in points (1pt = 1/72in), or strings including unit, i.e. \"10mm\".  Supported\n        // units are \"mm\", \"cm\", \"in\" and \"pt\".  The default \"auto\" means paper size is determined\n        // by content.\n        paperSize: \"a4\",\n        // True to reverse the paper dimensions if needed such that width is the larger edge.\n        landscape: true,\n        // An object containing { left, top, bottom, right } margins with units.\n        margin: null,\n        // Optional information for the PDF Info dictionary; all strings except for the date.\n        title: null,\n        author: null,\n        subject: null,\n        keywords: null,\n        creator: \"Kendo UI PDF Generator\",\n        // Creation Date; defaults to new Date()\n        date: null\n    },\n    defaultCellStyle: {\n        fontFamily: \"Arial\",\n        fontSize: 12\n    },\n    useCultureDecimals: false,\n    locale: 'en'\n};\n\nconst ALL_REASONS = {\n    recalc: true,\n    selection: true,\n    activeCell: true,\n    layout: true,\n    sheetSelection: true,\n    resize: true,\n    editorChange: false,\n    editorClose: false\n};\n\nconst keys = {\n    INSERT: 45,\n    DELETE: 46,\n    BACKSPACE: 8,\n    TAB: 9,\n    ENTER: 13,\n    ESC: 27,\n    LEFT: 37,\n    UP: 38,\n    RIGHT: 39,\n    DOWN: 40,\n    END: 35,\n    HOME: 36,\n    SPACEBAR: 32,\n    PAGEUP: 33,\n    PAGEDOWN: 34,\n    F2: 113,\n    F10: 121,\n    F11: 122,\n    F12: 123,\n    NUMPAD_PLUS: 107,\n    NUMPAD_MINUS: 109,\n    NUMPAD_DOT: 110,\n    B: 66,\n    I: 73,\n    U: 85,\n    N: 78,\n    H: 72,\n    A: 65,\n    R: 82\n};\n\n/* eslint-disable no-nested-ternary */\n/* eslint-disable no-param-reassign */\n/* eslint-disable no-prototype-builtins */\n\nconst RX_UNICODE_LETTER = new RegExp(\"[\\\\u0041-\\\\u005A\\\\u0061-\\\\u007A\\\\u00AA\\\\u00B5\\\\u00BA\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02C1\\\\u02C6-\\\\u02D1\\\\u02E0-\\\\u02E4\\\\u02EC\\\\u02EE\\\\u0370-\\\\u0374\\\\u0376\\\\u0377\\\\u037A-\\\\u037D\\\\u037F\\\\u0386\\\\u0388-\\\\u038A\\\\u038C\\\\u038E-\\\\u03A1\\\\u03A3-\\\\u03F5\\\\u03F7-\\\\u0481\\\\u048A-\\\\u052F\\\\u0531-\\\\u0556\\\\u0559\\\\u0561-\\\\u0587\\\\u05D0-\\\\u05EA\\\\u05F0-\\\\u05F2\\\\u0620-\\\\u064A\\\\u066E\\\\u066F\\\\u0671-\\\\u06D3\\\\u06D5\\\\u06E5\\\\u06E6\\\\u06EE\\\\u06EF\\\\u06FA-\\\\u06FC\\\\u06FF\\\\u0710\\\\u0712-\\\\u072F\\\\u074D-\\\\u07A5\\\\u07B1\\\\u07CA-\\\\u07EA\\\\u07F4\\\\u07F5\\\\u07FA\\\\u0800-\\\\u0815\\\\u081A\\\\u0824\\\\u0828\\\\u0840-\\\\u0858\\\\u08A0-\\\\u08B2\\\\u0904-\\\\u0939\\\\u093D\\\\u0950\\\\u0958-\\\\u0961\\\\u0971-\\\\u0980\\\\u0985-\\\\u098C\\\\u098F\\\\u0990\\\\u0993-\\\\u09A8\\\\u09AA-\\\\u09B0\\\\u09B2\\\\u09B6-\\\\u09B9\\\\u09BD\\\\u09CE\\\\u09DC\\\\u09DD\\\\u09DF-\\\\u09E1\\\\u09F0\\\\u09F1\\\\u0A05-\\\\u0A0A\\\\u0A0F\\\\u0A10\\\\u0A13-\\\\u0A28\\\\u0A2A-\\\\u0A30\\\\u0A32\\\\u0A33\\\\u0A35\\\\u0A36\\\\u0A38\\\\u0A39\\\\u0A59-\\\\u0A5C\\\\u0A5E\\\\u0A72-\\\\u0A74\\\\u0A85-\\\\u0A8D\\\\u0A8F-\\\\u0A91\\\\u0A93-\\\\u0AA8\\\\u0AAA-\\\\u0AB0\\\\u0AB2\\\\u0AB3\\\\u0AB5-\\\\u0AB9\\\\u0ABD\\\\u0AD0\\\\u0AE0\\\\u0AE1\\\\u0B05-\\\\u0B0C\\\\u0B0F\\\\u0B10\\\\u0B13-\\\\u0B28\\\\u0B2A-\\\\u0B30\\\\u0B32\\\\u0B33\\\\u0B35-\\\\u0B39\\\\u0B3D\\\\u0B5C\\\\u0B5D\\\\u0B5F-\\\\u0B61\\\\u0B71\\\\u0B83\\\\u0B85-\\\\u0B8A\\\\u0B8E-\\\\u0B90\\\\u0B92-\\\\u0B95\\\\u0B99\\\\u0B9A\\\\u0B9C\\\\u0B9E\\\\u0B9F\\\\u0BA3\\\\u0BA4\\\\u0BA8-\\\\u0BAA\\\\u0BAE-\\\\u0BB9\\\\u0BD0\\\\u0C05-\\\\u0C0C\\\\u0C0E-\\\\u0C10\\\\u0C12-\\\\u0C28\\\\u0C2A-\\\\u0C39\\\\u0C3D\\\\u0C58\\\\u0C59\\\\u0C60\\\\u0C61\\\\u0C85-\\\\u0C8C\\\\u0C8E-\\\\u0C90\\\\u0C92-\\\\u0CA8\\\\u0CAA-\\\\u0CB3\\\\u0CB5-\\\\u0CB9\\\\u0CBD\\\\u0CDE\\\\u0CE0\\\\u0CE1\\\\u0CF1\\\\u0CF2\\\\u0D05-\\\\u0D0C\\\\u0D0E-\\\\u0D10\\\\u0D12-\\\\u0D3A\\\\u0D3D\\\\u0D4E\\\\u0D60\\\\u0D61\\\\u0D7A-\\\\u0D7F\\\\u0D85-\\\\u0D96\\\\u0D9A-\\\\u0DB1\\\\u0DB3-\\\\u0DBB\\\\u0DBD\\\\u0DC0-\\\\u0DC6\\\\u0E01-\\\\u0E30\\\\u0E32\\\\u0E33\\\\u0E40-\\\\u0E46\\\\u0E81\\\\u0E82\\\\u0E84\\\\u0E87\\\\u0E88\\\\u0E8A\\\\u0E8D\\\\u0E94-\\\\u0E97\\\\u0E99-\\\\u0E9F\\\\u0EA1-\\\\u0EA3\\\\u0EA5\\\\u0EA7\\\\u0EAA\\\\u0EAB\\\\u0EAD-\\\\u0EB0\\\\u0EB2\\\\u0EB3\\\\u0EBD\\\\u0EC0-\\\\u0EC4\\\\u0EC6\\\\u0EDC-\\\\u0EDF\\\\u0F00\\\\u0F40-\\\\u0F47\\\\u0F49-\\\\u0F6C\\\\u0F88-\\\\u0F8C\\\\u1000-\\\\u102A\\\\u103F\\\\u1050-\\\\u1055\\\\u105A-\\\\u105D\\\\u1061\\\\u1065\\\\u1066\\\\u106E-\\\\u1070\\\\u1075-\\\\u1081\\\\u108E\\\\u10A0-\\\\u10C5\\\\u10C7\\\\u10CD\\\\u10D0-\\\\u10FA\\\\u10FC-\\\\u1248\\\\u124A-\\\\u124D\\\\u1250-\\\\u1256\\\\u1258\\\\u125A-\\\\u125D\\\\u1260-\\\\u1288\\\\u128A-\\\\u128D\\\\u1290-\\\\u12B0\\\\u12B2-\\\\u12B5\\\\u12B8-\\\\u12BE\\\\u12C0\\\\u12C2-\\\\u12C5\\\\u12C8-\\\\u12D6\\\\u12D8-\\\\u1310\\\\u1312-\\\\u1315\\\\u1318-\\\\u135A\\\\u1380-\\\\u138F\\\\u13A0-\\\\u13F4\\\\u1401-\\\\u166C\\\\u166F-\\\\u167F\\\\u1681-\\\\u169A\\\\u16A0-\\\\u16EA\\\\u16EE-\\\\u16F8\\\\u1700-\\\\u170C\\\\u170E-\\\\u1711\\\\u1720-\\\\u1731\\\\u1740-\\\\u1751\\\\u1760-\\\\u176C\\\\u176E-\\\\u1770\\\\u1780-\\\\u17B3\\\\u17D7\\\\u17DC\\\\u1820-\\\\u1877\\\\u1880-\\\\u18A8\\\\u18AA\\\\u18B0-\\\\u18F5\\\\u1900-\\\\u191E\\\\u1950-\\\\u196D\\\\u1970-\\\\u1974\\\\u1980-\\\\u19AB\\\\u19C1-\\\\u19C7\\\\u1A00-\\\\u1A16\\\\u1A20-\\\\u1A54\\\\u1AA7\\\\u1B05-\\\\u1B33\\\\u1B45-\\\\u1B4B\\\\u1B83-\\\\u1BA0\\\\u1BAE\\\\u1BAF\\\\u1BBA-\\\\u1BE5\\\\u1C00-\\\\u1C23\\\\u1C4D-\\\\u1C4F\\\\u1C5A-\\\\u1C7D\\\\u1CE9-\\\\u1CEC\\\\u1CEE-\\\\u1CF1\\\\u1CF5\\\\u1CF6\\\\u1D00-\\\\u1DBF\\\\u1E00-\\\\u1F15\\\\u1F18-\\\\u1F1D\\\\u1F20-\\\\u1F45\\\\u1F48-\\\\u1F4D\\\\u1F50-\\\\u1F57\\\\u1F59\\\\u1F5B\\\\u1F5D\\\\u1F5F-\\\\u1F7D\\\\u1F80-\\\\u1FB4\\\\u1FB6-\\\\u1FBC\\\\u1FBE\\\\u1FC2-\\\\u1FC4\\\\u1FC6-\\\\u1FCC\\\\u1FD0-\\\\u1FD3\\\\u1FD6-\\\\u1FDB\\\\u1FE0-\\\\u1FEC\\\\u1FF2-\\\\u1FF4\\\\u1FF6-\\\\u1FFC\\\\u2071\\\\u207F\\\\u2090-\\\\u209C\\\\u2102\\\\u2107\\\\u210A-\\\\u2113\\\\u2115\\\\u2119-\\\\u211D\\\\u2124\\\\u2126\\\\u2128\\\\u212A-\\\\u212D\\\\u212F-\\\\u2139\\\\u213C-\\\\u213F\\\\u2145-\\\\u2149\\\\u214E\\\\u2160-\\\\u2188\\\\u2C00-\\\\u2C2E\\\\u2C30-\\\\u2C5E\\\\u2C60-\\\\u2CE4\\\\u2CEB-\\\\u2CEE\\\\u2CF2\\\\u2CF3\\\\u2D00-\\\\u2D25\\\\u2D27\\\\u2D2D\\\\u2D30-\\\\u2D67\\\\u2D6F\\\\u2D80-\\\\u2D96\\\\u2DA0-\\\\u2DA6\\\\u2DA8-\\\\u2DAE\\\\u2DB0-\\\\u2DB6\\\\u2DB8-\\\\u2DBE\\\\u2DC0-\\\\u2DC6\\\\u2DC8-\\\\u2DCE\\\\u2DD0-\\\\u2DD6\\\\u2DD8-\\\\u2DDE\\\\u2E2F\\\\u3005-\\\\u3007\\\\u3021-\\\\u3029\\\\u3031-\\\\u3035\\\\u3038-\\\\u303C\\\\u3041-\\\\u3096\\\\u309D-\\\\u309F\\\\u30A1-\\\\u30FA\\\\u30FC-\\\\u30FF\\\\u3105-\\\\u312D\\\\u3131-\\\\u318E\\\\u31A0-\\\\u31BA\\\\u31F0-\\\\u31FF\\\\u3400-\\\\u4DB5\\\\u4E00-\\\\u9FCC\\\\uA000-\\\\uA48C\\\\uA4D0-\\\\uA4FD\\\\uA500-\\\\uA60C\\\\uA610-\\\\uA61F\\\\uA62A\\\\uA62B\\\\uA640-\\\\uA66E\\\\uA67F-\\\\uA69D\\\\uA6A0-\\\\uA6EF\\\\uA717-\\\\uA71F\\\\uA722-\\\\uA788\\\\uA78B-\\\\uA78E\\\\uA790-\\\\uA7AD\\\\uA7B0\\\\uA7B1\\\\uA7F7-\\\\uA801\\\\uA803-\\\\uA805\\\\uA807-\\\\uA80A\\\\uA80C-\\\\uA822\\\\uA840-\\\\uA873\\\\uA882-\\\\uA8B3\\\\uA8F2-\\\\uA8F7\\\\uA8FB\\\\uA90A-\\\\uA925\\\\uA930-\\\\uA946\\\\uA960-\\\\uA97C\\\\uA984-\\\\uA9B2\\\\uA9CF\\\\uA9E0-\\\\uA9E4\\\\uA9E6-\\\\uA9EF\\\\uA9FA-\\\\uA9FE\\\\uAA00-\\\\uAA28\\\\uAA40-\\\\uAA42\\\\uAA44-\\\\uAA4B\\\\uAA60-\\\\uAA76\\\\uAA7A\\\\uAA7E-\\\\uAAAF\\\\uAAB1\\\\uAAB5\\\\uAAB6\\\\uAAB9-\\\\uAABD\\\\uAAC0\\\\uAAC2\\\\uAADB-\\\\uAADD\\\\uAAE0-\\\\uAAEA\\\\uAAF2-\\\\uAAF4\\\\uAB01-\\\\uAB06\\\\uAB09-\\\\uAB0E\\\\uAB11-\\\\uAB16\\\\uAB20-\\\\uAB26\\\\uAB28-\\\\uAB2E\\\\uAB30-\\\\uAB5A\\\\uAB5C-\\\\uAB5F\\\\uAB64\\\\uAB65\\\\uABC0-\\\\uABE2\\\\uAC00-\\\\uD7A3\\\\uD7B0-\\\\uD7C6\\\\uD7CB-\\\\uD7FB\\\\uF900-\\\\uFA6D\\\\uFA70-\\\\uFAD9\\\\uFB00-\\\\uFB06\\\\uFB13-\\\\uFB17\\\\uFB1D\\\\uFB1F-\\\\uFB28\\\\uFB2A-\\\\uFB36\\\\uFB38-\\\\uFB3C\\\\uFB3E\\\\uFB40\\\\uFB41\\\\uFB43\\\\uFB44\\\\uFB46-\\\\uFBB1\\\\uFBD3-\\\\uFD3D\\\\uFD50-\\\\uFD8F\\\\uFD92-\\\\uFDC7\\\\uFDF0-\\\\uFDFB\\\\uFE70-\\\\uFE74\\\\uFE76-\\\\uFEFC\\\\uFF21-\\\\uFF3A\\\\uFF41-\\\\uFF5A\\\\uFF66-\\\\uFFBE\\\\uFFC2-\\\\uFFC7\\\\uFFCA-\\\\uFFCF\\\\uFFD2-\\\\uFFD7\\\\uFFDA-\\\\uFFDC]\");\n\nfunction isUnicodeLetter(ch) {\n    return RX_UNICODE_LETTER.test(ch);\n}\n\nfunction memoize(f) {\n    let cache = Object.create(null);\n    return function() {\n        let id = \"\";\n        for (let i = arguments.length; --i >= 0;) {\n            id += \":\" + arguments[i];\n        }\n        return id in cache ? cache[id] : (cache[id] = f.apply(this, arguments));\n    };\n}\n\nfunction arabicToRoman(n) {\n    let literals = {\n        1: \"i\", 10: \"x\", 100: \"c\",\n        2: \"ii\", 20: \"xx\", 200: \"cc\",\n        3: \"iii\", 30: \"xxx\", 300: \"ccc\",\n        4: \"iv\", 40: \"xl\", 400: \"cd\",\n        5: \"v\", 50: \"l\", 500: \"d\",\n        6: \"vi\", 60: \"lx\", 600: \"dc\",\n        7: \"vii\", 70: \"lxx\", 700: \"dcc\",\n        8: \"viii\", 80: \"lxxx\", 800: \"dccc\",\n        9: \"ix\", 90: \"xc\", 900: \"cm\",\n        1000: \"m\"\n    };\n    let values = [ 1000,\n                   900 , 800, 700, 600, 500, 400, 300, 200, 100,\n                   90 , 80 , 70 , 60 , 50 , 40 , 30 , 20 , 10 ,\n                   9 , 8 , 7 , 6 , 5 , 4 , 3 , 2 , 1 ];\n    let roman = \"\";\n    while (n > 0) {\n        if (n < values[0]) {\n            values.shift();\n        } else {\n            roman += literals[values[0]];\n            n -= values[0];\n        }\n    }\n    return roman;\n}\n\nfunction romanToArabic(r) {\n    r = r.toLowerCase();\n    let digits = {\n        i: 1,\n        v: 5,\n        x: 10,\n        l: 50,\n        c: 100,\n        d: 500,\n        m: 1000\n    };\n    let value = 0, prev = 0;\n    for (let i = 0; i < r.length; ++i) {\n        let v = digits[r.charAt(i)];\n        if (!v) {\n            return null;\n        }\n        value += v;\n        if (v > prev) {\n            value -= 2 * prev;\n        }\n        prev = v;\n    }\n    return value;\n}\n\nfunction withExit(f, obj) {\n    try {\n        return f.call(obj, function(value) {\n            throw new Return(value);\n        });\n    } catch (ex) {\n        if (ex instanceof Return) {\n            return ex.value;\n        }\n        throw ex;\n    }\n    function Return(value) {\n        this.value = value;\n    }\n}\n\nconst getterCache = {};\n\ngetterCache[\"undefined\"] = (obj) => obj;\n\nconst FIELD_REGEX = /\\[(?:(\\d+)|['\"](.*?)['\"])\\]|((?:(?!\\[.*?\\]|\\.).)+)/g;\nfunction getter(field, safe) {\n    const key = field + safe;\n\n    if (getterCache[key]) {\n        return getterCache[key];\n    }\n\n    const fields = [];\n    field.replace(FIELD_REGEX, (_, index, indexAccessor, field) => {\n        fields.push(isPresent(index) ? index : indexAccessor || field);\n        return undefined;\n    });\n\n    getterCache[key] = (obj) => {\n        let result = obj;\n        for (let idx = 0; idx < fields.length; idx++) {\n            result = result[fields[idx]];\n            if (!isPresent(result) && safe) {\n                return result;\n            }\n        }\n\n        return result;\n    };\n\n    return getterCache[key];\n}\n\nfunction deepExtend(destination) {\n    let i = 1,\n        length = arguments.length;\n\n    for (i = 1; i < length; i++) {\n        deepExtendOne(destination, arguments[i]);\n    }\n\n    return destination;\n}\n\nfunction deepExtendOne(destination, source) {\n    let property,\n        propValue,\n        propType,\n        destProp;\n\n    for (property in source) {\n        if (property === '__proto__' || property === 'constructor') {\n            continue;\n        }\n\n        propValue = source[property];\n        propType = typeof propValue;\n\n        if (propValue instanceof Date) {\n            destination[property] = new Date(propValue.getTime());\n        } else if (isFunction(propValue?.clone)) {\n            destination[property] = propValue.clone();\n        } else if (propType === 'object' && propValue !== null && isPlainObject(propValue)) {\n            // Check if the property is a plain object before attempting to merge deeply\n            destProp = destination[property];\n            if (typeof destProp !== 'object' || destProp === null) {\n                destination[property] = {};\n            }\n\n            deepExtendOne(destination[property], propValue);\n        } else if (propType !== 'undefined') {\n            destination[property] = propValue;\n        }\n    }\n\n    return destination;\n}\n\nfunction guid() {\n    let id = \"\", i, random, chars = \"abcdef\";\n\n    id += chars[Math.floor(Math.random() * Math.floor(chars.length))];\n\n    for (i = 1; i < 32; i++) {\n        random = Math.random() * 16 | 0;\n\n        if (i === 8 || i === 12 || i === 16 || i === 20) {\n            id += \"-\";\n        }\n        id += (i === 12 ? 4 : (i === 16 ? (random & 3 | 8) : random)).toString(16);\n    }\n\n    return id;\n}\n\nconst support = {};\n\nconst scrollbar = function(refresh) {\n    if (!isNaN(support._scrollbar) && !refresh) {\n        return support._scrollbar;\n    }\n\n    let div = document.createElement(\"div\"),\n        result;\n\n    div.style.overflow = \"scroll\";\n    div.style.overflowX = \"hidden\";\n    div.style.zoom = \"1\";\n    div.style.clear = \"both\";\n    div.style.display = \"block\";\n\n    div.innerHTML = \"&nbsp;\";\n    document.body.appendChild(div);\n\n    support._scrollbar = result = div.offsetWidth - div.scrollWidth;\n\n    document.body.removeChild(div);\n\n    return result;\n};\n\nfunction toCamelCase(str) {\n    return str.replace(/\\-(\\w)/g, function(strMatch, g1) {\n        return g1.toUpperCase();\n    });\n}\n\nfunction size(obj) {\n    let result = 0, key;\n    for (key in obj) {\n        if (obj.hasOwnProperty(key) && key !== \"toJSON\") { // Ignore fake IE7 toJSON.\n            result++;\n        }\n    }\n\n    return result;\n}\n\nconst kendoGetComputedStyles = function(element, properties) {\n    let styles = {}, computedStyle;\n\n    if (document.defaultView && document.defaultView.getComputedStyle) {\n        computedStyle = document.defaultView.getComputedStyle(element, \"\");\n\n        if (properties) {\n            properties.forEach(function(value) {\n                styles[value] = computedStyle.getPropertyValue(value);\n            });\n        }\n    } else {\n        computedStyle = element.currentStyle;\n\n        if (properties) {\n            properties.forEach(function(value) {\n                styles[value] = computedStyle[toCamelCase(value)];\n            });\n        }\n    }\n\n    if (!size(styles)) {\n        styles = computedStyle;\n    }\n\n    return styles;\n};\n\nconst insertAfter = function(newElement, after) {\n    after.parentNode.insertBefore(newElement, after.nextSibling);\n};\n\nconst _activeElement$1 = function() {\n    try {\n        return document.activeElement;\n    } catch (e) {\n        return document.documentElement.activeElement;\n    }\n};\n\nconst isPresent = (value) => value !== null && value !== undefined;\nconst isBlank = (value) => !isPresent(value);\nconst isDate = (value) => value && value.getTime;\nconst isString = (value) => typeof value === \"string\";\nconst isNumeric = (value) => !isNaN(value - parseFloat(value));\nconst isFunction = (fn) => typeof fn === \"function\";\nconst isPlainObject = function(obj) {\n    if (!obj || toString.call(obj) !== \"[object Object]\") {\n        return false;\n    }\n\n    const proto = Object.getPrototypeOf(obj);\n    return proto === null || proto.constructor === Object;\n};\n\nclass CalcError {\n\n    constructor(code) {\n        if (code instanceof CalcError) {\n            return code;\n        }\n        this.code = code;\n    }\n\n    toString() {\n        return '#' + this.code + (this.code === 'NAME' ? '?' : '!');\n    }\n}\n\nlet intlValue = {};\n\nconst intl = (value) => {\n    if (value) {\n        intlValue = value;\n    } else {\n        return intlValue;\n    }\n};\n\nconst culture = () => {\n    return intl().localeInfo();\n};\n\nfunction createKendoObj(calc, CalcError, Ref, CellRef, RangeRef) {\n    const kendo = {};\n    kendo.spreadsheet = { calc, CalcError, Ref, CellRef, RangeRef };\n    kendo.culture = () => culture();\n\n    return kendo;\n}\n\n/* eslint-disable max-params */\n/* eslint-disable complexity */\n/* eslint-disable no-unused-vars */\n\n\nlet calc = {\n    runtime: {\n        FUNCS: Object.create(null),\n    }\n};\n\nlet FUNCS$1 = calc.runtime.FUNCS;\n\n/* -----[ Context ]----- */\n\nclass Context {\n    constructor(callback, formula, ss, parent) {\n        this.callback = callback;\n        this.formula = formula;\n        this.ss = ss;\n        this.parent = parent;\n    }\n\n    resolve(val) {\n        var self = this;\n        if (val instanceof Ref) {\n            self.resolveCells([ val ], function() {\n                self._resolve(val);\n            });\n        } else {\n            self._resolve(val);\n        }\n    }\n\n    error(val) {\n        return new CalcError(val);\n    }\n\n    _resolve(val) {\n        if (val === undefined) {\n            val = null;\n        } else if (Array.isArray(val)) {\n            val = this.asMatrix(val);\n        } else {\n            val = maybeRoundFloatErrors(val);\n        }\n        var f = this.formula;\n        if (f.arrayFormulaRange) {\n            // when this is an array formula, make sure we return a Matrix.  The value already\n            // *should* be a Matrix, so this won't incur speed penalty in normal cases.\n            val = this.asMatrix(val) || this.asMatrix([[ val ]]);\n        } else if (val instanceof RangeRef) {\n            val = this._arrayArg(val);\n        }\n        f.value = val;\n        if (this.ss.onFormula(f) && this.callback) {\n            this.callback.call(f, val);\n        }\n    }\n\n    resolveCells(a, f) {\n        var context = this, formulas = [];\n\n        (function loop(a) {\n            for (var i = 0; i < a.length; ++i) {\n                var x = a[i];\n                if (x instanceof Ref) {\n                    add(context.getRefCells(x));\n                }\n                if (Array.isArray(x)) {\n                    // make sure we resolve cells in literal matrices\n                    loop(x);\n                }\n            }\n        })(a);\n\n        if (!formulas.length) {\n            return f.call(context);\n        }\n\n        for (var pending = formulas.length, i = 0; i < formulas.length; ++i) {\n            fetch(formulas[i]);\n        }\n        function fetch(formula) {\n            formula.exec(context.ss, function() {\n                if (!--pending) {\n                    f.call(context);\n                }\n            }, context);\n        }\n        function add(a) {\n            for (var i = 0; i < a.length; ++i) {\n                var cell = a[i];\n                if (cell.formula) {\n                    formulas.push(cell.formula);\n                }\n            }\n            return true;\n        }\n    }\n\n    cellValues(a, wantNulls) {\n        var ret = [];\n        for (var i = 0; i < a.length; ++i) {\n            var val = a[i];\n            if (val instanceof Ref) {\n                val = this.getRefData(val, wantNulls);\n                ret = ret.concat(val);\n            } else if (Array.isArray(val)) {\n                ret = ret.concat(this.cellValues(val, wantNulls));\n            } else if (val instanceof Matrix) {\n                ret = ret.concat(this.cellValues(val.data, wantNulls));\n            } else {\n                ret.push(val);\n            }\n        }\n        return ret;\n    }\n\n    fetchName(ref, callback) {\n        var f = this.formula;\n        var val = this.ss.nameValue(ref, f.sheet, f.row, f.col);\n        if (val instanceof Formula$1) {\n            // clone and relocate to calling formula, so that relative references in a named\n            // formula would work as expected.\n            val = val.clone(f.sheet, f.row, f.col, true);\n\n            // XXX: I don't like this dependency here; basically we only need ss.onFormula to\n            // return true and do nothing else.\n            var ss = new calc.ValidationFormulaContext(this.ss.workbook);\n\n            val.exec(ss, callback, this);\n        } else {\n            if (val instanceof Ref) {\n                // relocate for relative refs\n                val = val.absolute(f.row, f.col);\n                if (val instanceof RangeRef && this.ss.isMerged(val)) {\n                    val = val.topLeft;\n                }\n                if (!val.sheet) {\n                    val.sheet = f.sheet;\n                }\n            }\n            callback(val == null ? new CalcError(\"NAME\") : val);\n        }\n    }\n\n    force(val) {\n        if (val instanceof Ref) {\n            return this.getRefData(val);\n        }\n        return val;\n    }\n\n    func(fname, callback, args) {\n        fname = fname.toLowerCase();\n        var f = FUNCS$1[fname];\n        if (f) {\n            return f.call(this, callback, args);\n        }\n        callback(new CalcError(\"NAME\"));\n    }\n\n    bool(val) {\n        if (val instanceof Ref) {\n            val = this.getRefData(val);\n        }\n        if (typeof val == \"string\") {\n            return val.toLowerCase() == \"true\";\n        }\n        if (typeof val == \"number\") {\n            return val !== 0;\n        }\n        if (typeof val == \"boolean\") {\n            return val;\n        }\n        return val != null;\n    }\n\n    _arrayArg(ref) { // not necessarily a reference though\n        var f = this.formula;\n        if (!f.arrayFormulaRange && ref instanceof RangeRef) {\n            // if formula wasn't saved with Ctrl-Shift-Enter but a range is passed, Excel does\n            // something special:\n            //\n            // - if range is Wx1 (horizontal array) and current formula resides within the\n            //   horizontal bounds of the range, the appropriate cell is selected.  Example:\n            //   A1..D1 contain 1, 2, 3, 4 and we have in B2: =A1:D1, then B2 will get 2 (the\n            //   value in A2).  If the same formula is typed outside the horizontal span of the\n            //   range, say in E2: =A1:D1, then #VALUE! is returned.\n            //\n            // - similarly, if the range is 1xH (vertical array), the formula must reside within\n            //   the vertical bounds of the range and it gets the corresponding cell; otherwise,\n            //   #VALUE!.\n            if (ref.height() == 1 && f.col >= ref.topLeft.col && f.col <= ref.bottomRight.col) {\n                return this.getRefData(new CellRef(ref.topLeft.row, f.col).setSheet(ref.sheet));\n            }\n            if (ref.width() == 1 && f.row >= ref.topLeft.row && f.row <= ref.bottomRight.row) {\n                return this.getRefData(new CellRef(f.row, ref.topLeft.col).setSheet(ref.sheet));\n            }\n            return new CalcError(\"VALUE\");\n        } else {\n            return this.asMatrix(ref);\n        }\n    }\n\n    asMatrix(range) {\n        if (range instanceof Matrix) {\n            return range;\n        }\n        let self = this;\n        if (range instanceof RangeRef) {\n            let tl = range.topLeft;\n            let top = tl.row, left = tl.col;\n            let cells = self.getRefCells(range);\n            let m = new Matrix(self);\n            if (isFinite(range.width())) {\n                m.width = range.width();\n            }\n            if (isFinite(range.height())) {\n                m.height = range.height();\n            }\n            if (!isFinite(top)) {\n                top = 0;\n            }\n            if (!isFinite(left)) {\n                left = 0;\n            }\n            cells.forEach(function(cell) {\n                m.set(cell.row - top,\n                      cell.col - left,\n                      cell.value);\n            });\n            return m;\n        }\n        if (Array.isArray(range) && range.length > 0) {\n            let m = new Matrix(self), row = 0;\n            range.forEach(function(line) {\n                let col = 0;\n                let h = 1;\n                line.forEach(function(el) {\n                    let isRange = el instanceof RangeRef;\n                    if (el instanceof Ref && !isRange) {\n                        el = self.getRefData(el);\n                    }\n                    if (isRange || Array.isArray(el)) {\n                        el = self.asMatrix(el);\n                    }\n                    if (el instanceof Matrix) {\n                        el.each(function(el, r, c) {\n                            m.set(row + r, col + c, el);\n                        });\n                        h = Math.max(h, el.height);\n                        col += el.width;\n                    } else {\n                        if (typeof el === \"string\" && el.length && !isNaN(el)) {\n                            el = Number(el);\n                        }\n\n                        m.set(row, col++, el);\n                    }\n                });\n                row += h;\n            });\n            return m;\n        }\n    }\n\n    getRefCells(refs, hiddenInfo, wantNulls) {\n        var f = this.formula;\n        return this.ss.getRefCells(refs, hiddenInfo, f.sheet, f.row, f.col, wantNulls);\n    }\n\n    getRefData(ref, wantNulls) {\n        var f = this.formula;\n        return this.ss.getData(ref, f.sheet, f.row, f.col, wantNulls);\n    }\n\n    workbook() {\n        return this.ss.workbook;\n    }\n}\n\nfunction argmax(i, end, f) {\n    var max = f(i), pos = i;\n    while (++i < end) {\n        var v = f(i);\n        if (v > max) {\n            max = v;\n            pos = i;\n        }\n    }\n    return pos;\n}\n\nclass Matrix {\n    constructor(context) {\n        this.context = context;\n        this.height = 0;\n        this.width = 0;\n        this.data = [];\n    }\n    clone() {\n        var m = new Matrix(this.context);\n        m.height = this.height;\n        m.width = this.width;\n        m.data = this.data.map(function(row) { return row.slice(); });\n        return m;\n    }\n    get(row, col) {\n        var line = this.data[row];\n        var val = line ? line[col] : null;\n        return val instanceof Ref ? this.context.getRefData(val) : val;\n    }\n    getNA(row, col) {\n        if (this.height == 1) {\n            row = 0;\n        }\n        if (this.width == 1) {\n            col = 0;\n        }\n        if (row < this.height && col < this.width) {\n            return this.get(row, col);\n        }\n        return new CalcError(\"N/A\");\n    }\n    set(row, col, data) {\n        var line = this.data[row];\n        if (line == null) {\n            line = this.data[row] = [];\n        }\n        line[col] = data;\n        if (row >= this.height) {\n            this.height = row + 1;\n        }\n        if (col >= this.width) {\n            this.width = col + 1;\n        }\n    }\n    each(f, includeEmpty) {\n        for (var row = 0; row < this.height; ++row) {\n            for (var col = 0; col < this.width; ++col) {\n                var val = this.get(row, col);\n                if (includeEmpty || val != null) {\n                    val = f.call(this.context, val, row, col);\n                    if (val !== undefined) {\n                        return val;\n                    }\n                }\n            }\n        }\n    }\n    map(f, includeEmpty) {\n        var m = new Matrix(this.context);\n        this.each(function(el, row, col) {\n            // here `this` is actually the context\n            m.set(row, col, f.call(this, el, row, col));\n        }, includeEmpty);\n        return m;\n    }\n    eachRow(f) {\n        for (var row = 0; row < this.height; ++row) {\n            var val = f.call(this.context, row);\n            if (val !== undefined) {\n                return val;\n            }\n        }\n    }\n    eachCol(f) {\n        for (var col = 0; col < this.width; ++col) {\n            var val = f.call(this.context, col);\n            if (val !== undefined) {\n                return val;\n            }\n        }\n    }\n    mapRow(f) {\n        var m = new Matrix(this.context);\n        this.eachRow(function(row) {\n            m.set(row, 0, f.call(this.context, row));\n        });\n        return m;\n    }\n    mapCol(f) {\n        var m = new Matrix(this.context);\n        this.eachCol(function(col) {\n            m.set(0, col, f.call(this.context, col));\n        });\n        return m;\n    }\n    toString() {\n        return JSON.stringify(this.data);\n    }\n    transpose() {\n        var m = new Matrix(this.context);\n        this.each(function(el, row, col) {\n            m.set(col, row, el);\n        });\n        return m;\n    }\n    unit(n) {\n        this.width = this.height = n;\n        var a = this.data = new Array(n);\n        for (var i = n; --i >= 0;) {\n            var row = a[i] = new Array(n);\n            for (var j = n; --j >= 0;) {\n                row[j] = i == j ? 1 : 0;\n            }\n        }\n        return this;\n    }\n    multiply(b) {\n        var a = this, m = new Matrix(a.context);\n        for (var row = 0; row < a.height; ++row) {\n            for (var col = 0; col < b.width; ++col) {\n                var s = 0;\n                for (var i = 0; i < a.width; ++i) {\n                    var va = a.get(row, i);\n                    var vb = b.get(i, col);\n                    if (typeof va != \"number\" || typeof vb != \"number\") {\n                        throw new CalcError(\"VALUE\");\n                    }\n                    s += va * vb;\n                }\n                m.set(row, col, s);\n            }\n        }\n        return m;\n    }\n    adds(b, s) {\n        var a = this, m = new Matrix(a.context);\n        var sign = s ? -1 : 1;\n        for (var row = 0; row < a.height; ++row) {\n            for (var col = 0; col < a.width; ++col) {\n                var x = a.get(row, col),\n                    y = b.get(row, col);\n                m.set(row, col, x + sign * y);\n            }\n        }\n        return m;\n    }\n    determinant() {\n        var a = this.clone().data;\n        var n = a.length;\n        var d = 1, C, L, i, k;\n        for (C = 0; C < n; C++) {\n            for (L = C; (L < n) && (!a[L][C]); L++);\n            if (L == n) {\n                return 0;\n            }\n            if (L != C) {\n                d = -d;\n                for (k = C; k < n; k++) {\n                    var t = a[C][k];\n                    a[C][k] = a[L][k];\n                    a[L][k] = t;\n                }\n            }\n            for (i = C + 1; i < n; i++) {\n                for (k = C + 1; k < n; k++) {\n                    a[i][k] -= a[C][k] * a[i][C] / a[C][C];\n                }\n            }\n            d *= a[C][C];\n        }\n        return d;\n    }\n    inverse() {\n        let n = this.width;\n        let m = this.augment(new Matrix(this.context).unit(n));\n        let a = m.data;\n        let tmp;\n\n        // Gaussian elimination\n        // https://en.wikipedia.org/wiki/Gaussian_elimination#Finding_the_inverse_of_a_matrix\n\n        // 1. Get zeros below main diagonal\n        for (let k = 0; k < n; ++k) {\n            let imax = argmax(k, n, function(i) { return a[i][k]; });\n            if (!a[imax][k]) {\n                return null; // singular matrix\n            }\n            if (k != imax) {\n                tmp = a[k];\n                a[k] = a[imax];\n                a[imax] = tmp;\n            }\n            for (let i = k + 1; i < n; ++i) {\n                for (let j = k + 1; j < 2 * n; ++j) {\n                    a[i][j] -= a[k][j] * a[i][k] / a[k][k];\n                }\n                a[i][k] = 0;\n            }\n        }\n\n        // 2. Get 1-s on main diagonal, dividing by pivot\n        for (let i = 0; i < n; ++i) {\n            for (let f = a[i][i], j = 0; j < 2 * n; ++j) {\n                a[i][j] /= f;\n            }\n        }\n\n        // 3. Get zeros above main diagonal.  Actually, we only care to compute the right side\n        // here (that will be the inverse), so in the inner loop below we go while j >= n,\n        // instead of j >= k.\n        for (let k = n; --k >= 0;) {\n            for (let i = k; --i >= 0;) {\n                if (a[i][k]) {\n                    for (let j = 2 * n; --j >= n;) {\n                        a[i][j] -= a[k][j] * a[i][k];\n                    }\n                }\n            }\n        }\n\n        return m.slice(0, n, n, n);\n    }\n    augment(m) {\n        var ret = this.clone(), n = ret.width;\n        m.each(function(val, row, col) {\n            ret.set(row, col + n, val);\n        });\n        return ret;\n    }\n    slice(row, col, height, width) {\n        var m = new Matrix(this.context);\n        for (var i = 0; i < height; ++i) {\n            for (var j = 0; j < width; ++j) {\n                m.set(i, j, this.get(row + i, col + j));\n            }\n        }\n        return m;\n    }\n\n    // XXX: debug\n    // dump() {\n    //     this.data.forEach(function(row){\n    //         window.console.log(row.map(function(val){\n    //             var str = val.toFixed(3).replace(/\\.?0*$/, function(s){\n    //                 return [ \"\", \" \", \"  \", \"   \", \"    \" ][s.length];\n    //             });\n    //             if (val >= 0) { str = \" \" + str; }\n    //             return str;\n    //         }).join(\"  \"));\n    //     });\n    // }\n}\n\n/* -----[ Formula ]----- */\n\nfunction sameRef(r1, r2) {\n    // note: r1.eq(r2) will not do, because it returns true for A1 and A1:A1 (CellRef\n    // vs. RangeRef).  To properly undo we need to assert that the references are exactly the\n    // same (including type).\n    if (r1.constructor !== r2.constructor) {\n        return false;\n    }\n    if (r1 instanceof CellRef) {\n        return r1.sheet == r2.sheet\n            && r1.row == r2.row\n            && r1.col == r2.col\n            && r1.rel == r2.rel;\n    }\n    if (r1 instanceof RangeRef) {\n        return sameRef(r1.topLeft , r2.topLeft)\n            && sameRef(r1.bottomRight , r2.bottomRight)\n            && r1.endSheet == r2.endSheet;\n    }\n    if (r1 instanceof UnionRef) {\n        var i = r1.refs.length;\n        if (i != r2.refs.length) {\n            return false;\n        }\n        while (--i >= 0) {\n            if (!sameRef(r1.refs[i], r2.refs[i])) {\n                return false;\n            }\n        }\n    }\n    return true;\n}\n\nlet Formula$1 = class Formula {\n    constructor(refs, handler, printer, sheet, row, col, arrayFormulaRange) {\n        this.refs = refs;\n        this.handler = handler;\n        this.print = printer;\n        this.absrefs = null;\n        this.sheet = sheet;\n        this.row = row;\n        this.col = col;\n        this.onReady = [];\n        this.pending = false;\n        this.arrayFormulaRange = arrayFormulaRange;\n    }\n    setArrayFormulaRange(ref) {\n        this.arrayFormulaRange = ref.clone().setSheet(this.sheet);\n    }\n    clone(sheet, row, col, forceRefs) {\n        var lcsheet = sheet.toLowerCase();\n        var refs = this.refs;\n        var range = this.arrayFormulaRange;\n        if (forceRefs || lcsheet != this.sheet.toLowerCase()) {\n            refs = refs.map(function(ref) {\n                if (!ref.hasSheet() && (!ref.sheet || ref.sheet.toLowerCase() != lcsheet)) {\n                    ref = ref.clone().setSheet(sheet);\n                }\n                return ref;\n            });\n            if (range) {\n                range = range.clone().setSheet(sheet);\n            }\n        }\n        return new Formula(refs, this.handler, this.print, sheet, row, col, range);\n    }\n    deepClone() {\n        var refs = this.refs.map(function(ref) { return ref.clone(); });\n        return new Formula(refs, this.handler, this.print, this.sheet, this.row, this.col, this.arrayFormulaRange);\n    }\n    resolve(val) {\n        this.pending = false;\n        this.onReady.forEach(function(callback) {\n            callback(val);\n        });\n    }\n    exec(ss, callback, parentContext) {\n        if (\"value\" in this) {\n            if (callback) {\n                callback(this.value);\n            }\n        } else {\n            if (callback) {\n                this.onReady.push(callback);\n            }\n\n            var ctx = new Context(this.resolve, this, ss, parentContext);\n            var level = 0;\n            // if the call chain leads back to this same formula, we have a circular dependency.\n            while (parentContext) {\n                if (parentContext.formula === this) {\n                    this.pending = false;\n                    ctx.resolve(new CalcError(\"CIRCULAR\"));\n                    return;\n                }\n                parentContext = parentContext.parent;\n                ++level;\n            }\n\n            // pending is still useful for ASYNC formulas\n            if (this.pending) {\n                return;\n            }\n            this.pending = true;\n\n            var next = function() {\n                // compute and cache the absolute references\n                if (!this.absrefs) {\n                    this.absrefs = this.refs.map(function(ref) {\n                        return ref.absolute(this.row, this.col);\n                    }, this);\n                }\n\n                // finally invoke the handler given to us by the compiler in calc.js\n                this.handler.call(ctx);\n            }.bind(this);\n\n            if (level < 20) {\n                next();\n            } else {\n                setTimeout(next, 0);\n            }\n        }\n    }\n    reset() {\n        this.onReady = [];\n        this.pending = false;\n        delete this.value;\n    }\n    renameSheet(oldSheetName, newSheetName) {\n        oldSheetName = oldSheetName.toLowerCase();\n        this.absrefs = null;\n        if (this.sheet.toLowerCase() == oldSheetName) {\n            this.sheet = newSheetName;\n        }\n        this.refs.forEach(function(ref) {\n            ref.renameSheet(oldSheetName, newSheetName);\n        });\n    }\n    adjust(affectedSheet, operation, start, delta) {\n        affectedSheet = affectedSheet.toLowerCase();\n        var formulaRow = this.row;\n        var formulaCol = this.col;\n        var formulaSheet = this.sheet.toLowerCase();\n        var formulaMoves = false;\n        if (formulaSheet == affectedSheet) {\n            // move formula if it's after the change point\n            if (operation == \"row\" && formulaRow >= start) {\n                this.row += delta;\n                formulaMoves = true;\n            }\n            if (operation == \"col\" && formulaCol >= start) {\n                this.col += delta;\n                formulaMoves = true;\n            }\n        }\n        var newFormulaRow = this.row;\n        var newFormulaCol = this.col;\n        this.absrefs = null;\n        var prevRefs = this.refs;\n        var modified = formulaMoves;\n        this.refs = prevRefs.map(function(ref) {\n            var newRef = adjust(ref);\n            if (!modified && !sameRef(newRef, ref)) {\n                modified = true;\n            }\n            return newRef;\n        });\n\n        var prevRange = this.arrayFormulaRange;\n        if (prevRange) {\n            this.arrayFormulaRange = adjust(prevRange);\n            if (!modified && !sameRef(prevRange, this.arrayFormulaRange)) {\n                modified = true;\n            }\n        }\n\n        if (modified) {\n            // return a clone of the original formula.  needed to undo operations like\n            // deleteRow, which can transform a reference into NULL.\n            return new Formula(prevRefs, this.handler, this.print, this.sheet, formulaRow, formulaCol, prevRange);\n        }\n\n        function adjust(ref) {\n            if (ref === NULLREF) {\n                return ref;\n            }\n            if (ref.sheet.toLowerCase() != affectedSheet) {\n                if (formulaMoves) {\n                    // a reference to another sheet should still point to the same location\n                    // after adjustment; thus if row/col was removed before formula, relative\n                    // references must be adjusted by delta.\n                    if (operation == \"row\" && formulaRow >= start) {\n                        ref = ref.relative(delta, 0);\n                    }\n                    if (operation == \"col\" && formulaCol >= start) {\n                        ref = ref.relative(0, delta);\n                    }\n                }\n                return ref;\n            }\n            return ref.adjust(\n                formulaRow, formulaCol,\n                newFormulaRow, newFormulaCol,\n                operation == \"row\",\n                start, delta\n            );\n        }\n    }\n    toString() {\n        return this.print(this.row, this.col);\n    }\n};\n\n// spreadsheet functions --------\n\nFUNCS$1[\"if\"] = function(callback, args) {\n    var self = this;\n    var co = args[0], th = args[1], el = args[2];\n    // XXX: I don't like this resolveCells here.  We should try to declare IF with\n    // defineFunction.\n    this.resolveCells([ co ], function() {\n        var comatrix = self.asMatrix(co);\n        if (comatrix) {\n            // XXX: calling both branches in this case, since we'll typically need values from\n            // both.  We could optimize and call them only when first needed, but oh well.\n            th(function(th) {\n                el(function(el) {\n                    var thmatrix = self.asMatrix(th);\n                    var elmatrix = self.asMatrix(el);\n                    callback(comatrix.map(function(val, row, col) {\n                        if (val instanceof CalcError) {\n                            return val;\n                        } else if (self.bool(val)) {\n                            return thmatrix ? thmatrix.get(row, col) : th;\n                        } else {\n                            return elmatrix ? elmatrix.get(row, col) : el;\n                        }\n                    }));\n                });\n            });\n        } else {\n            co = this.force(co);\n            if (co instanceof CalcError) {\n                callback(co);\n            } else if (self.bool(co)) {\n                th(callback);\n            } else {\n                el(callback);\n            }\n        }\n    });\n};\n\nFUNCS$1[\"φ\"] = function(callback) {\n    callback((1 + Math.sqrt(5)) / 2);\n};\n\n// Lasciate ogni speranza, voi ch'entrate.\n//\n// XXX: document this function.\nfunction compileArgumentChecks(functionName, args) {\n    var arrayArgs = \"function arrayArgs(args) { var xargs = [], width = 0, height = 0, arrays = [], i = 0; \";\n    var resolve = \"function resolve(args, callback) { var toResolve = [], i = 0; \";\n    var name, forced, main = \"'use strict'; function check(args) { var stack = [], tmp, xargs = [], i = 0, m, err = 'VALUE'; \", haveForced = false;\n    var canBeArrayArg = false, hasArrayArgs = false;\n    main += args.map(comp).join(\"\");\n    main += \"if (i < args.length) return new CalcError('N/A'); \";\n    main += \"return xargs; } \";\n    arrayArgs += \"return { args: xargs, width: width, height: height, arrays: arrays }; } \";\n\n    var f;\n    if (haveForced) {\n        resolve += \"this.resolveCells(toResolve, callback); } \";\n        f = new Function(\"kendo\", \"CalcError\", \"round\", main + resolve + arrayArgs + \" return { resolve: resolve, check: check, arrayArgs: arrayArgs };\");\n    } else {\n        f = new Function(\"kendo\", \"CalcError\", \"round\", main + \" return { check: check };\");\n    }\n    f = f(calc.kendo, CalcError, limitPrecision$1);\n    if (!hasArrayArgs) {\n        delete f.arrayArgs;\n    }\n    return f;\n\n    function comp(x) {\n        name = x[0];\n        var code = \"{ \";\n        if (Array.isArray(name)) {\n            arrayArgs += \"while (i < args.length) { \";\n            resolve += \"while (i < args.length) { \";\n            code += \"xargs.push(tmp = []); stack.push(xargs); xargs = tmp; \";\n            code += \"while (i < args.length) { \";\n            code += x.map(comp).join(\"\");\n            code += \"} \";\n            code += \"xargs = stack.pop(); \";\n            resolve += \"} \";\n            arrayArgs += \"} \";\n        } else if (name == \"+\") {\n            arrayArgs += \"while (i < args.length) { \";\n            resolve += \"while (i < args.length) { \";\n            code += \"if (i >= args.length) return new CalcError('N/A'); \";\n            code += \"xargs.push(tmp = []); stack.push(xargs); xargs = tmp; \";\n            code += \"do { \";\n            code += x.slice(1).map(comp).join(\"\");\n            code += \"} while (i < args.length); \";\n            code += \"xargs = stack.pop(); \";\n            resolve += \"} \";\n            arrayArgs += \"} \";\n        } else if (name == \"?\") {\n            // standalone assertion without a new argument\n            code += \"if (!(\" + cond(x[1]) + \")) return new CalcError(err); \";\n        } else {\n            var type = x[1];\n            if (Array.isArray(type) && /^#?collect/.test(type[0])) {\n                var wantNulls = /!$/.test(type[0]);\n                var n = type[2];\n                force();\n                code += \"try {\"\n                    + \"var $\" + name + \" = this.cellValues(args.slice(i\";\n                if (n) {\n                    code += \", i + \" + n;\n                }\n                code += \")\" + (wantNulls ? \",true\" : \"\") + \").reduce(function(ret, $\" + name + \"){ \";\n                if (type[0].charAt(0) != \"#\") {\n                    code += \"if ($\" + name + \" instanceof CalcError) throw $\" + name + \"; \";\n                }\n                code += \"if (\" + cond(type[1]) + \") ret.push($\" + name + \"); \";\n                code += \"return ret; \";\n                code += \"}.bind(this), []); \";\n                if (n) {\n                    code += \"i += \" + n + \"; \";\n                } else {\n                    code += \"i = args.length; \";\n                }\n                code += \"xargs.push($\" + name + \")\"\n                    + \"} catch(ex) { if (ex instanceof CalcError) return ex; throw ex; } \";\n                resolve += \"toResolve.push(args.slice(i)); \";\n            } else if (type == \"rest\") {\n                code += \"xargs.push(args.slice(i)); i = args.length; \";\n            } else {\n                if ((canBeArrayArg = /^\\*/.test(name))) {\n                    hasArrayArgs = true;\n                    name = name.substr(1);\n                }\n                code += \"var $\" + name + \" = args[i++]; \";\n                var allowError = false;\n                if (/!$/.test(type)) {\n                    type = type.substr(0, type.length - 1);\n                    allowError = true;\n                } else {\n                    code += \"if ($\" + name + \" instanceof CalcError) return $\" + name + \"; \";\n                }\n                code += typeCheck(type, allowError) + \"xargs.push($\" + name + \"); \";\n            }\n        }\n        code += \"} \";\n        return code;\n    }\n\n    function force() {\n        if (forced) {\n            return \"$\" + name + \"\";\n        }\n        haveForced = true;\n        forced = true;\n        resolve += \"toResolve.push(args[i++]); \";\n        return \"($\" + name + \" = this.force($\" + name + \"))\";\n    }\n\n    function forceNum(round) {\n        return \"(\"\n            + (round\n               ? (\"(typeof \" + force() + \" == 'number' ? ($\" + name + \" = round($\" + name + \"), true) : false) || \")\n               : (\"(typeof \" + force() + \" == 'number') || \"))\n            + \"(typeof $\" + name + \" == 'boolean' ? ($\" + name + \" = +$\" + name + \", true) : false) || \"\n            + \"(typeof $\" + name + \" == 'string' && !/^(?:=|true|false)/i.test($\" + name + \") ? (\"\n            + \"tmp = kendo.spreadsheet.calc.parse(0, 0, 0, $\" + name + \"), \"\n            + \"/^date|number|percent$/.test(tmp.type) ? ($\" + name + \" = +tmp.value, true) : false\"\n            + \") : false)\"\n            + \")\";\n    }\n\n    function typeCheck(type, allowError) {\n        forced = false;\n        var ret = \"if (!(\" + cond(type) + \")) { \";\n        if (forced && !allowError) {\n            ret += \" if ($\" + name + \" instanceof CalcError) return $\" + name + \"; \";\n        }\n        ret += \"return new CalcError(err); } \";\n        if (!forced) {\n            resolve += \"i++; \";\n        }\n        if (canBeArrayArg) {\n            arrayArgs += \"var $\" + name + \" = this._arrayArg(args[i]); \"\n                + \"if ($\" + name + \") { \"\n                + \"xargs.push($\" + name + \"); \"\n                + \"width = Math.max(width, $\" + name + \".width); \"\n                + \"height = Math.max(height, $\" + name + \".height); \"\n                + \"arrays.push(true) } else { \"\n                + \"xargs.push(args[i]); \"\n                + \"arrays.push(false); } i++; \";\n        } else {\n            arrayArgs += \"xargs.push(args[i++]); arrays.push(false); \";\n        }\n        return ret;\n    }\n\n    function cond(type) {\n        if (Array.isArray(type)) {\n            if (type[0] == \"or\") {\n                return \"(\" + type.slice(1).map(cond).join(\") || (\") + \")\";\n            }\n            if (type[0] == \"and\") {\n                return \"(\" + type.slice(1).map(cond).join(\") && (\") + \")\";\n            }\n            if (type[0] == \"values\") {\n                return \"(\" + type.slice(1).map(function(val) {\n                    return force() + \" === \" + val;\n                }).join(\") || (\") + \")\";\n            }\n            if (type[0] == \"null\") {\n                return \"(\" + cond(\"null\") + \" ? (($\" + name + \" = \" + type[1] + \"), true) : false)\";\n            }\n            if (type[0] == \"between\" || type[0] == \"[between]\") {\n                return \"(\" + force() + \" >= \" + type[1] + \" && \" + \"$\" + name + \" <= \" + type[2] + \" ? true : ((err = 'NUM'), false))\";\n            }\n            if (type[0] == \"(between)\") {\n                return \"(\" + force() + \" > \" + type[1] + \" && \" + \"$\" + name + \" < \" + type[2] + \" ? true : ((err = 'NUM'), false))\";\n            }\n            if (type[0] == \"(between]\") {\n                return \"(\" + force() + \" > \" + type[1] + \" && \" + \"$\" + name + \" <= \" + type[2] + \" ? true : ((err = 'NUM'), false))\";\n            }\n            if (type[0] == \"[between)\") {\n                return \"(\" + force() + \" >= \" + type[1] + \" && \" + \"$\" + name + \" < \" + type[2] + \" ? true : ((err = 'NUM'), false))\";\n            }\n            if (type[0] == \"assert\") {\n                var err = type[2] || \"N/A\";\n                return \"((\" + type[1] + \") ? true : (err = \" + JSON.stringify(err) + \", false))\";\n            }\n            if (type[0] == \"not\") {\n                return \"!(\" + cond(type[1]) + \")\";\n            }\n            throw new Error(\"Unknown array type condition: \" + type[0]);\n        }\n        if (type == \"number\" || type == \"datetime\") {\n            return forceNum(true);\n        }\n        if (type == \"number!\") {\n            return \"(typeof \" + force() + \" == 'number' ? ($\" + name + \" = round($\" + name + \"), true) : false)\";\n        }\n        if (type == \"integer\" || type == \"date\") {\n            return \"(\" + forceNum() + \" && (($\" + name + \" |= 0), true))\";\n        }\n        if (type == \"divisor\") {\n            return \"(\" + forceNum(true) + \" && ($\" + name + \" == 0 ? ((err = 'DIV/0'), false) : true))\";\n        }\n        if (type == \"number+\") {\n            return \"(\" + forceNum(true) + \" && ($\" + name + \" >= 0 ? true : ((err = 'NUM'), false)))\";\n        }\n        if (type == \"integer+\") {\n            return \"(\" + forceNum() + \" && (($\" + name + \" |= 0) >= 0 ? true : ((err = 'NUM'), false)))\";\n        }\n        if (type == \"number++\") {\n            return \"(\" + forceNum(true) + \" && ($\" + name + \" > 0 ? true : ((err = 'NUM'), false)))\";\n        }\n        if (type == \"integer++\") {\n            return \"(\" + forceNum() + \" && (($\" + name + \" |= 0) > 0 ? true : ((err = 'NUM'), false)))\";\n        }\n        if (type == \"string\") {\n            return \"((typeof \" + force() + \" == 'string' || typeof $\" + name + \" == 'boolean' || typeof $\" + name + \" == 'number') ? ($\" + name + \" += '', true) : ($\" + name + \" === undefined ? (($\" + name + \" = ''), true) : false))\";\n        }\n        if (type == \"boolean\") {\n            return \"(typeof \" + force() + \" == 'boolean')\";\n        }\n        if (type == \"logical\") {\n            return \"(typeof \" + force() + \" == 'boolean' || (typeof $\" + name + \" == 'number' ? ($\" + name + \" = !!$\" + name + \", true) : false))\";\n        }\n        if (type == \"matrix\") {\n            force();\n            return \"((m = this.asMatrix($\" + name + \")) ? ($\" + name + \" = m) : false)\";\n        }\n        if (type == \"#matrix\") {\n            return \"((m = this.asMatrix($\" + name + \")) ? ($\" + name + \" = m) : false)\";\n        }\n        if (type == \"ref\") {\n            return \"($\" + name + \" instanceof kendo.spreadsheet.Ref)\";\n        }\n        if (type == \"area\") {\n            return \"($\" + name + \" instanceof kendo.spreadsheet.CellRef || $\" + name + \" instanceof kendo.spreadsheet.RangeRef)\";\n        }\n        if (type == \"cell\") {\n            return \"($\" + name + \" instanceof kendo.spreadsheet.CellRef)\";\n        }\n        if (type == \"null\") {\n            return \"(\" + force() + \" == null)\";\n        }\n        if (type == \"anyvalue\") {\n            return \"(\" + force() + \" != null && i <= args.length)\";\n        }\n        if (type == \"forced\") {\n            return \"(\" + force() + \", i <= args.length)\";\n        }\n        if (type == \"anything\") {\n            return \"(i <= args.length)\";\n        }\n        if (type == \"blank\") {\n            return \"(\" + force() + \" == null || $\" + name + \" === '')\";\n        }\n        throw new Error(\"Can't check for type: \" + type);\n    }\n}\n\nfunction limitPrecision$1(num, digits) {\n    return num === parseInt(num, 10) ? num : +num.toPrecision(digits || 16);\n}\n\nfunction maybeRoundFloatErrors(num, digits) {\n    if (typeof num == \"number\") {\n        return limitPrecision$1(num, digits);\n    } else {\n        return num;\n    }\n}\n\nfunction withErrorHandling(obj, f, args) {\n    if (args instanceof CalcError) {\n        return args;\n    }\n    try {\n        return f.apply(obj, args);\n    } catch (ex) {\n        if (ex instanceof CalcError) {\n            return ex;\n        } else {\n            throw ex;\n        }\n    }\n}\n\nfunction makeSyncFunction(handler, resolve, check, arrayArgs) {\n    return function(callback, args) {\n        function doit() {\n            if (arrayArgs) {\n                let x = arrayArgs.call(this, args);\n                args = x.args;\n                if (x.width > 0 && x.height > 0) {\n                    let result = new Matrix(this);\n                    for (let row = 0; row < x.height; ++row) {\n                        for (let col = 0; col < x.width; ++col) {\n                            let xargs = [];\n                            for (let i = 0; i < args.length; ++i) {\n                                if (x.arrays[i]) {\n                                    xargs[i] = args[i].getNA(row, col);\n                                } else {\n                                    xargs[i] = args[i];\n                                }\n                            }\n                            xargs = check.call(this, xargs);\n                            result.set(row, col, withErrorHandling(this, handler, xargs));\n                        }\n                    }\n                    return callback(result);\n                }\n            }\n            let xargs = check.call(this, args);\n            callback(withErrorHandling(this, handler, xargs));\n        }\n        if (resolve) {\n            resolve.call(this, args, doit);\n        } else {\n            doit.call(this);\n        }\n    };\n}\n\nfunction makeAsyncFunction(handler, resolve, check, arrayArgs) {\n    return function(callback, args) {\n        function doit() {\n            if (arrayArgs) {\n                let x = arrayArgs.call(this, args);\n                args = x.args;\n                if (x.width > 0 && x.height > 0) {\n                    let result = new Matrix(this);\n                    let count = x.width * x.height;\n                    let makeCallback = function(row, col) {\n                        return function(value) {\n                            result.set(row, col, value);\n                            --count;\n                            if (count === 0) {\n                                return callback(result);\n                            }\n                        };\n                    };\n                    for (let row = 0; row < x.height && count > 0; ++row) {\n                        for (let col = 0; col < x.width && count > 0; ++col) {\n                            let xargs = [];\n                            for (let i = 0; i < args.length; ++i) {\n                                if (x.arrays[i]) {\n                                    xargs[i] = args[i].getNA(row, col);\n                                } else {\n                                    xargs[i] = args[i];\n                                }\n                            }\n                            xargs = check.call(this, xargs);\n                            if (xargs instanceof CalcError) {\n                                result.set(row, col, xargs);\n                                --count;\n                                if (count === 0) {\n                                    return callback(result);\n                                }\n                            } else {\n                                xargs.unshift(makeCallback(row, col));\n                                handler.apply(this, xargs);\n                            }\n                        }\n                    }\n                    return;\n                }\n            }\n            let x = check.call(this, args);\n            if (x instanceof CalcError) {\n                callback(x);\n            } else {\n                x.unshift(callback);\n                handler.apply(this, x);\n            }\n        }\n        if (resolve) {\n            resolve.call(this, args, doit);\n        } else {\n            doit.call(this);\n        }\n    };\n}\n\nfunction defineFunction(name, func) {\n    name = name.toLowerCase();\n    FUNCS$1[name] = func;\n    return {\n        args: function(args, log) {\n            var code = compileArgumentChecks(name, args);\n            // XXX: DEBUG\n            if (log) {\n                if (code.arrayArgs) {window.console.log(code.arrayArgs.toString());}\n                if (code.resolve) {window.console.log(code.resolve.toString());}\n                if (code.check) {window.console.log(code.check.toString());}\n            }\n            var f = FUNCS$1[name] = makeSyncFunction(func, code.resolve, code.check, code.arrayArgs);\n            f.kendoSpreadsheetArgs = args;\n            return this;\n        },\n        argsAsync: function(args, log) {\n            var code = compileArgumentChecks(name, args);\n            // XXX: DEBUG\n            if (log) {\n                if (code.arrayArgs) {window.console.log(code.arrayArgs.toString());}\n                if (code.resolve) {window.console.log(code.resolve.toString());}\n                if (code.check) {window.console.log(code.check.toString());}\n            }\n            var f = FUNCS$1[name] = makeAsyncFunction(func, code.resolve, code.check, code.arrayArgs);\n            f.kendoSpreadsheetArgs = args;\n            return this;\n        }\n    };\n}\n\nfunction defineBuiltinFunction$1(name, isAsync, x, impl) {\n    FUNCS$1[name] = isAsync\n        ? makeAsyncFunction(impl, x.resolve, x.check, x.arrayArgs)\n        : makeSyncFunction(impl, x.resolve, x.check, x.arrayArgs);\n}\n\n/* -----[ date calculations ]----- */\n\n// Julian days algorithms from http://www.hermetic.ch/cal_stud/jdn.htm#comp\n\nfunction dateToJulianDays(y, m, d) {\n    m++;\n    return ((1461 * (y + 4800 + ((m - 14) / 12 | 0))) / 4 | 0) +\n        ((367 * (m - 2 - 12 * ((m - 14) / 12 | 0))) / 12 | 0) -\n        ((3 * (((y + 4900 + ((m - 14) / 12 | 0)) / 100 | 0))) / 4 | 0) +\n        d - 32075;\n}\n\nfunction julianDaysToDate(jd) {\n    var l, n, j, i, m, d, y;\n    l = jd + 68569;\n    n = (4 * l) / 146097 | 0;\n    l = l - ((146097 * n + 3) / 4 | 0);\n    i = (4000 * (l + 1) / 1461001) | 0;\n    l = l - ((1461 * i) / 4 | 0) + 31;\n    j = (80 * l) / 2447 | 0;\n    d = l - ((2447 * j) / 80 | 0);\n    l = j / 11 | 0;\n    m = j + 2 - (12 * l);\n    y = 100 * (n - 49) + i + l;\n    m--;\n    return {\n        year  : y,\n        month : m,\n        date  : d,\n        day   : (jd + 1) % 7,\n        ord   : ORDINAL_ADD_DAYS[isLeapYear$1(y)][m] + d\n    };\n}\n\n// This uses the Google Spreadsheet approach: treat 1899-12-31 as day 1, allowing to avoid\n// implementing the \"Leap Year Bug\" yet still be Excel compatible for dates starting 1900-03-01.\nvar BASE_DATE = dateToJulianDays(1900, 0, -1);\n\nvar DAYS_IN_MONTH = [ 31, 28, 31,\n                      30, 31, 30,\n                      31, 31, 30,\n                      31, 30, 31 ];\n\nvar ORDINAL_ADD_DAYS = [\n    [ 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334 ], // non-leap year\n    [ 0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335 ]  // leap year\n];\n\nfunction isLeapYear$1(yr) {\n    if (yr % 4) {\n        return 0;\n    }\n    if (yr % 100) {\n        return 1;\n    }\n    if (yr % 400) {\n        return 0;\n    }\n    return 1;\n}\n\nfunction daysInYear$1(yr) {\n    return isLeapYear$1(yr) ? 366 : 365;\n}\n\nfunction daysInMonth$1(yr, mo) {\n    return (isLeapYear$1(yr) && mo == 1) ? 29 : DAYS_IN_MONTH[mo];\n}\n\nfunction validDate(yr, mo, da) {\n    return mo >= 1 && mo <= 12 && da >= 1 && da <= daysInMonth$1(yr, mo - 1);\n}\n\nfunction unpackDate$2(serial) {\n    return julianDaysToDate((serial | 0) + BASE_DATE);\n}\n\nfunction packDate$2(year, month, date) {\n    return dateToJulianDays(year, month, date) - BASE_DATE;\n}\n\nvar MS_IN_MIN = 60 * 1000;\nvar MS_IN_HOUR = 60 * MS_IN_MIN;\nvar MS_IN_DAY = 24 * MS_IN_HOUR;\n\nfunction unpackTime$1(serial) {\n    var frac = serial - (serial | 0);\n    if (frac < 0) {\n        frac++;\n    }\n    var ms = Math.round(MS_IN_DAY * frac);\n    var hours = Math.floor(ms / MS_IN_HOUR);\n    ms -= hours * MS_IN_HOUR;\n    var minutes = Math.floor(ms / MS_IN_MIN);\n    ms -= minutes * MS_IN_MIN;\n    var seconds = Math.floor(ms / 1000);\n    ms -= seconds * 1000;\n    return {\n        hours: hours,\n        minutes: minutes,\n        seconds: seconds,\n        milliseconds: ms\n    };\n}\n\nfunction serialToDate$2(serial) {\n    var d = unpackDate$2(serial), t = unpackTime$1(serial);\n    return new Date(d.year, d.month, d.date,\n                    t.hours, t.minutes, t.seconds, t.milliseconds);\n}\n\nfunction packTime$1(hh, mm, ss, ms) {\n    return (hh + (mm + (ss + ms / 1000) / 60) / 60) / 24;\n}\n\nfunction dateToSerial$2(date) {\n    var time = packTime$1(date.getHours(),\n                        date.getMinutes(),\n                        date.getSeconds(),\n                        date.getMilliseconds());\n    date = packDate$2(date.getFullYear(),\n                    date.getMonth(),\n                    date.getDate());\n    if (date < 0) {\n        return date - 1 + time;\n    } else {\n        return date + time;\n    }\n}\n\nfunction parseDate(str, format) {\n    if (format) {\n        format = calc.formatting.makeDateFormat(format);\n    }\n    const parseExactDate = intl().parseDate;\n    return parseExactDate(str, format)\n        || parseExactDate(str)\n        || parseExactDate(str, [\n            \"MMMM dd yyyy\",\n            \"MMMM dd yy\",\n            \"MMM dd yyyy\",\n            \"MMM dd yy\",\n            \"dd MMMM yyyy\",\n            \"dd MMMM yy\",\n            \"dd MMM yyyy\",\n            \"dd MMM yy\",\n            \"MMMM dd, yyyy\",\n            \"MMMM dd, yy\",\n            \"MMM dd, yyyy\",\n            \"MMM dd, yy\",\n            \"MMMM dd\",\n            \"MMM dd\",\n            \"MMMM yyyy\",\n            \"MMM yyyy\",\n            \"dd MMMM\",\n            \"dd MMM\"\n        ]);\n}\n\nfunction defineAlias$1(alias, name) {\n    var orig = FUNCS$1[name];\n    if (!orig) {\n        throw new Error(\"Function \" + name + \" is not yet defined\");\n    }\n    if (!orig.kendoSpreadsheetAliases) {\n        orig.kendoSpreadsheetAliases = [ name ];\n    }\n    orig.kendoSpreadsheetAliases.push(alias);\n    FUNCS$1[alias] = orig;\n}\n\nclass ParseError {\n    constructor(message, pos) {\n        this.message = message;\n        this.pos = pos;\n    }\n    toString() {\n        return this.message;\n    }\n}\n\nfunction InputStream(input) {\n    let pos = 0;\n    return {\n        next        : next,\n        peek        : peek,\n        eof         : eof,\n        croak       : croak,\n        readWhile   : readWhile,\n        readEscaped : readEscaped,\n        lookingAt   : lookingAt,\n        skip        : skip,\n        forward     : forward,\n        pos         : location\n    };\n    function location() {\n        return pos;\n    }\n    function next() {\n        let ch = input.charAt(pos++);\n        return ch;\n    }\n    function peek() {\n        return input.charAt(pos);\n    }\n    function eof() {\n        return peek() === \"\";\n    }\n    function croak(msg) {\n        throw new ParseError(msg + \" (input: \" + input + \")\", pos);\n    }\n    function skip(ch) {\n        if (typeof ch == \"string\") {\n            if (input.substr(pos, ch.length) !== ch) {\n                croak(\"Expected \" + ch);\n            }\n            forward(ch.length);\n        } else if (ch instanceof RegExp) {\n            let m = ch.exec(input.substr(pos));\n            if (m) {\n                forward(m[0].length);\n                return m;\n            }\n        } else {\n            // assuming RegExp match data\n            forward(ch[0].length);\n        }\n    }\n    function forward(n) {\n        while (n-- > 0) {\n            next();\n        }\n    }\n    function readEscaped(end) {\n        let escaped = false, str = \"\";\n        while (!eof()) {\n            let ch = next();\n            if (escaped) {\n                str += ch;\n                escaped = false;\n            } else if (ch === \"\\\\\") {\n                escaped = true;\n            } else if (ch === end) {\n                break;\n            } else {\n                str += ch;\n            }\n        }\n        return str;\n    }\n    function readWhile(predicate) {\n        let str = \"\";\n        while (!eof() && predicate(peek(), str)) {\n            str += next();\n        }\n        return str;\n    }\n    function lookingAt(rx) {\n        return rx.exec(input.substr(pos));\n    }\n}\n\n/* -----[ exports ]----- */\n\ncalc.runtime.CalcError = CalcError;\ncalc.runtime.Formula = Formula$1;\ncalc.runtime.Matrix = Matrix;\ncalc.runtime.packDate = packDate$2;\ncalc.runtime.unpackDate = unpackDate$2;\ncalc.runtime.packTime = packTime$1;\ncalc.runtime.unpackTime = unpackTime$1;\ncalc.runtime.serialToDate = serialToDate$2;\ncalc.runtime.dateToSerial = dateToSerial$2;\ncalc.runtime.daysInMonth = daysInMonth$1;\ncalc.runtime.validDate = validDate;\ncalc.runtime.isLeapYear = isLeapYear$1;\ncalc.runtime.daysInYear = daysInYear$1;\ncalc.runtime.parseDate = parseDate;\ncalc.runtime.limitPrecision = limitPrecision$1;\ncalc.runtime.defineBuiltinFunction = defineBuiltinFunction$1;\ncalc.runtime.defineAlias = defineAlias$1;\ncalc.runtime.InputStream = InputStream;\ncalc.runtime.ParseError = ParseError;\n\n/* eslint-disable indent */\n\nfunction Node() {\n    this.node = null;\n}\nNode.prototype = {\n    remove: function() {\n        if (this.node.parentNode) {\n            this.node.parentNode.removeChild(this.node);\n        }\n        this.attr = {};\n    },\n    attr: {},\n    text: function() {\n        return \"\";\n    }\n};\nfunction NullNode() {\n}\nNullNode.prototype = {\n    nodeName: \"#null\",\n    attr: { style: {} },\n    children: [],\n    remove: function() {\n    }\n};\nlet NULL_NODE = new NullNode();\nfunction Element(nodeName, attr, children) {\n    this.nodeName = nodeName;\n    this.attr = attr || {};\n    this.children = children || [];\n}\nElement.prototype = new Node();\nElement.prototype.appendTo = function(parent) {\n    let node = typeof(this.nodeName) === \"string\" ? document.createElement(this.nodeName) : this.nodeName;\n    let children = this.children;\n    for (let index = 0; index < children.length; index++) {\n        children[index].render(node, NULL_NODE);\n    }\n    parent.appendChild(node);\n    return node;\n};\nElement.prototype.render = function(parent, cached) {\n    let node;\n    if (cached.nodeName !== this.nodeName) {\n        cached.remove();\n        node = this.appendTo(parent);\n    } else {\n        node = cached.node;\n        let index;\n        let children = this.children;\n        let length = children.length;\n        let cachedChildren = cached.children;\n        let cachedLength = cachedChildren.length;\n        if (Math.abs(cachedLength - length) > 2) {\n            this.render({\n                appendChild: function(node) {\n                    parent.replaceChild(node, cached.node);\n                }\n            }, NULL_NODE);\n            return;\n        }\n        for (index = 0; index < length; index++) {\n            children[index].render(node, cachedChildren[index] || NULL_NODE);\n        }\n        for (index = length; index < cachedLength; index++) {\n            cachedChildren[index].remove();\n        }\n    }\n    this.node = node;\n    this.syncAttributes(cached.attr);\n    this.removeAttributes(cached.attr);\n};\nElement.prototype.syncAttributes = function(cachedAttr) {\n    let attr = this.attr;\n    for (let name in attr) {\n        let value = attr[name];\n        let cachedValue = cachedAttr[name];\n        if (name === \"style\") {\n            this.setStyle(value, cachedValue);\n        } else if (value !== cachedValue) {\n            this.setAttribute(name, value, cachedValue);\n        }\n    }\n};\nElement.prototype.setStyle = function(style, cachedValue) {\n    let node = this.node;\n    let key;\n    if (cachedValue) {\n        for (key in style) {\n            if (style[key] !== cachedValue[key]) {\n                node.style[key] = style[key];\n            }\n        }\n    } else {\n        for (key in style) {\n            node.style[key] = style[key];\n        }\n    }\n};\nElement.prototype.removeStyle = function(cachedStyle) {\n    let style = this.attr.style || {};\n    let node = this.node;\n    for (let key in cachedStyle) {\n        if (style[key] === undefined) {\n            node.style[key] = \"\";\n        }\n    }\n};\nElement.prototype.removeAttributes = function(cachedAttr) {\n    let attr = this.attr;\n    for (let name in cachedAttr) {\n        if (name === \"style\") {\n            this.removeStyle(cachedAttr.style);\n        } else if (attr[name] === undefined) {\n            this.removeAttribute(name);\n        }\n    }\n};\nElement.prototype.removeAttribute = function(name) {\n    let node = this.node;\n    if (name === \"style\") {\n        node.style.cssText = \"\";\n    } else if (name === \"className\") {\n        node.className = \"\";\n    } else {\n        node.removeAttribute(name);\n    }\n};\nElement.prototype.setAttribute = function(name, value) {\n    let node = this.node;\n    if (node[name] !== undefined) {\n        node[name] = value;\n    } else {\n        node.setAttribute(name, value);\n    }\n};\nElement.prototype.text = function() {\n    let str = \"\";\n    for (let i = 0; i < this.children.length; ++i) {\n        str += this.children[i].text();\n    }\n    return str;\n};\nfunction TextNode(nodeValue) {\n    this.nodeValue = String(nodeValue);\n}\nTextNode.prototype = new Node();\nTextNode.prototype.nodeName = \"#text\";\nTextNode.prototype.render = function(parent, cached) {\n    let node;\n    if (cached.nodeName !== this.nodeName) {\n        cached.remove();\n        node = document.createTextNode(this.nodeValue);\n        parent.appendChild(node);\n    } else {\n        node = cached.node;\n        if (this.nodeValue !== cached.nodeValue) {\n            if (node.parentNode) {\n                // sometimes in IE parentNode is null (reason unknown),\n                // and IE throws an error when you try to set a\n                // parentless' nodeValue, because why not.\n                node.nodeValue = this.nodeValue;\n            }\n        }\n    }\n    this.node = node;\n};\nTextNode.prototype.text = function() {\n    return this.nodeValue;\n};\nfunction HtmlNode(html) {\n    this.html = html;\n}\nHtmlNode.prototype = {\n    nodeName: \"#html\",\n    attr: {},\n    remove: function() {\n        for (let index = 0; index < this.nodes.length; index++) {\n           let el = this.nodes[index];\n           if (el.parentNode) {\n               el.parentNode.removeChild(el);\n           }\n       }\n    },\n    render: function(parent, cached) {\n        if (cached.nodeName !== this.nodeName || cached.html !== this.html) {\n           cached.remove();\n           let lastChild = parent.lastChild;\n           insertHtml(parent, this.html);\n           this.nodes = [];\n           for (let child = lastChild ? lastChild.nextSibling : parent.firstChild; child; child = child.nextSibling) {\n               this.nodes.push(child);\n           }\n       } else {\n           this.nodes = cached.nodes.slice(0);\n       }\n    }\n};\n\nfunction insertHtml(node, html) {\n    const HTML_CONTAINER = document.createElement(\"div\");\n    HTML_CONTAINER.innerHTML = html;\n    while (HTML_CONTAINER.firstChild) {\n        node.appendChild(HTML_CONTAINER.firstChild);\n    }\n}\nfunction html(value) {\n    return new HtmlNode(value);\n}\nfunction element(nodeName, attrs, children) {\n    return new Element(nodeName, attrs, children);\n}\nfunction text$1(value) {\n    return new TextNode(value);\n}\nfunction Tree(root) {\n    this.root = root;\n    this.children = [];\n}\nTree.prototype = {\n    html: html,\n    element: element,\n    text: text$1,\n    render: function(children) {\n        let cachedChildren = this.children;\n        let index;\n        let length;\n        for (index = 0, length = children.length; index < length; index++) {\n            let cached = cachedChildren[index];\n            if (!cached) {\n                cached = NULL_NODE;\n            } else if (!cached.node || !cached.node.parentNode) {\n                cached.remove();\n                cached = NULL_NODE;\n            }\n            children[index].render(this.root, cached);\n        }\n        for (index = length; index < cachedChildren.length; index++) {\n            cachedChildren[index].remove();\n        }\n        this.children = children;\n    }\n};\n\nconst dom = {\n    html: html,\n    text: text$1,\n    element: element,\n    Tree: Tree,\n    Node: Node\n};\n\n//--------------------------------------------------- custom number format.\n\n\nlet RX_COLORS = /^\\[(black|green|white|blue|magenta|yellow|cyan|red)\\]/i;\nlet RX_CONDITION = /^\\[(<=|>=|<>|<|>|=)(-?[0-9.]+)\\]/;\n\n/* eslint-disable complexity */\n\n/* The proper amount of suffering for whoever designed the Excel\n   Custom Number Format would be to have him implement the\n   formatter himself. */\n\nfunction parse$2(input) {\n    input = calc.runtime.InputStream(input);\n    let sections = [], haveConditional = false, decimalPart;\n    while (!input.eof()) {\n        let sec = readSection();\n        sections.push(sec);\n        if (sec.cond) {\n            haveConditional = true;\n        }\n    }\n    // From https://support.office.com/en-us/article/Create-or-delete-a-custom-number-format-78f2a361-936b-4c03-8772-09fab54be7f4:\n    //\n    //    A number format can have up to four sections of code, separated by semicolons. These\n    //    code sections define the format for positive numbers, negative numbers, zero values,\n    //    and text, in that order.\n    //\n    //    You do not have to include all code sections in your custom number format. If you\n    //    specify only two code sections for your custom number format, the first section is\n    //    used for positive numbers and zeros, and the second section is used for negative\n    //    numbers. If you specify only one code section, it is used for all numbers. If you want\n    //    to skip a code section and include a code section that follows it, you must include\n    //    the ending semicolon for the section that you skip.\n    //\n    // However, if sections have conditionals, it is not clear if:\n    //\n    //    - still at most four are allowed\n    //    - is the last section still for text\n    //\n    // We will assume that if no sections have conditionals, then there must be at most 4, and\n    // they will be interpreted in the order above.  If the first section contains a\n    // conditional, then there can be any number of them; if the last one is not conditional\n    // then it will be interpreted as text format.\n    if (!haveConditional) {\n        if (sections.length === 1) {\n            sections[0].cond = \"num\";\n        } else if (sections.length === 2) {\n            sections[0].cond = { op: \">=\", value: 0 };\n            sections[1].cond = { op: \"<\", value: 0 };\n        } else if (sections.length >= 3) {\n            sections[0].cond = { op: \">\", value: 0 };\n            sections[1].cond = { op: \"<\", value: 0 };\n            sections[2].cond = { op: \"=\", value: 0 };\n            if (sections.length > 3) {\n                sections[3].cond = \"text\";\n                sections = sections.slice(0, 4);\n            }\n        }\n    }\n    return sections;\n    function maybeColor() {\n        let m = input.skip(RX_COLORS);\n        if (m) {\n            return m[1].toLowerCase();\n        }\n    }\n    function maybeCondition() {\n        let m = input.skip(RX_CONDITION);\n        if (m) {\n            let val = parseFloat(m[2]);\n            if (!isNaN(val)) {\n                return { op: m[1], value: val, custom: true };\n            }\n        }\n    }\n    function readFormat() {\n        let format = [], tok, prev = null;\n        while (!input.eof() && (tok = readNext())) {\n            // disambiguate: m/mm might mean month or minutes depending on surrounding context.\n            if (tok.type === \"date\") {\n                if (prev && /^(el)?time$/.test(prev.type) && prev.part === \"h\"\n                    && tok.part === \"m\" && tok.format < 3) {\n                    // m or mm that follows hours should display minutes\n                    tok.type = \"time\";\n                }\n            } else if (/^(el)?time$/.test(tok.type) && tok.part === \"s\") {\n                if (prev && prev.type === \"date\" && prev.part === \"m\"\n                    && prev.format < 3) {\n                    // m or mm followed by seconds should display minutes\n                    prev.type = \"time\";\n                }\n            }\n            if (!(/^(?:str|space|fill)$/.test(tok.type))) {\n                prev = tok;\n            }\n            format.push(tok);\n        }\n        return format;\n    }\n    function maybeFraction(tok) {\n        if (tok.type !== \"date\" || (tok.part === \"m\" && tok.format < 3)) {\n            let m = input.skip(/^\\.(0+)/);\n            if (m) {\n                tok.fraction = m[1].length;\n                if (tok.type === \"date\") {\n                    tok.type = \"time\";\n                }\n            }\n        }\n        return tok;\n    }\n    function readNext() {\n        let ch, m;\n        // numbers\n        if ((m = input.skip(/^([#0?]+)(?:,([#0?]+))+/))) {\n            // thousands separator.  seems convenient to treat\n            // this as a single token.\n            return { type: \"digit\", sep: true, format: m[1] + m[2], decimal: decimalPart };\n        }\n        if ((m = input.skip(/^[#0?]+/))) {\n            return { type: \"digit\", sep: false, format: m[0], decimal: decimalPart };\n        }\n        // XXX: handle this one!\n        if ((m = input.skip(/^(e)([+-])/i))) {\n            return { type: \"exp\", ch: m[1], sign: m[2] };\n        }\n        // dates\n        if ((m = input.skip(/^(d{1,4}|m{1,5}|yyyy|yy|y)/i))) {\n            m = m[1].toLowerCase();\n            return maybeFraction({ type: \"date\", part: m.charAt(0), format: m.length });\n        }\n        // time (interpret as a date)\n        if ((m = input.skip(/^(hh?|ss?)/i))) { // m and mm are handled above\n            m = m[1].toLowerCase();\n            return maybeFraction({ type: \"time\", part: m.charAt(0), format: m.length });\n        }\n        // elapsed time (interpret as interval of days)\n        if ((m = input.skip(/^\\[(hh?|mm?|ss?)\\]/i))) {\n            m = m[1].toLowerCase();\n            return maybeFraction({ type: \"eltime\", part: m.charAt(0), format: m.length });\n        }\n        if ((m = input.skip(/^(a[.]?m[.]?\\/p[.]?m[.]?|a\\/p)/i))) {\n            m = m[1].split(\"/\");\n            return { type: \"ampm\", am: m[0], pm: m[1] };\n        }\n        switch ((ch = input.next())) { // JSHint sadness\n          case \";\":\n            return null;\n          case \"\\\\\":\n            // quotes next character\n            return { type: \"str\", value: input.next() };\n          case '\"':\n            return { type: \"str\", value: input.readEscaped(ch) };\n          case \"@\":\n            return { type: \"text\" };\n          case \"_\":\n            // whitespace of the width of following character\n            return { type: \"space\", value: input.next() };\n          case \"*\":\n            // fills cell width with the following character\n            return { type: \"fill\", value: input.next() };\n          case \".\":\n            if (input.lookingAt(/^\\s*[#0?]/)) {\n                decimalPart = true;\n                return { type: \"dec\" };\n            }\n            return { type: \"str\", value: \".\" };\n          case \"%\":\n            return { type: \"percent\" };\n          case \",\":\n            return { type: \"comma\" };\n        }\n        // whatever we can't make sense of, output literally.\n        return { type: \"str\", value: ch };\n    }\n    function readSection() {\n        decimalPart = false;\n        let color = maybeColor(), cond = maybeCondition();\n        if (!color && cond) {\n            color = maybeColor();\n        }\n        return {\n            color: color,\n            cond: cond,\n            body: readFormat()\n        };\n    }\n}\n\nfunction print$1(sections) {\n    return sections.map(printSection).join(\";\");\n    function printSection(sec) {\n        let out = \"\";\n        if (sec.color) {\n            out += \"[\" + sec.color + \"]\";\n        }\n        if (sec.cond) {\n            if (!(sec.cond === \"text\" || sec.cond === \"num\")) {\n                out += \"[\" + sec.cond.op + sec.cond.value + \"]\";\n            }\n        }\n        out += sec.body.map(printToken).join(\"\");\n        return out;\n    }\n    function maybeFraction(fmt, tok) {\n        if (tok.fraction) {\n            fmt += \".\" + padLeft(\"\", tok.fraction, \"0\");\n        }\n        return fmt;\n    }\n    function printToken(tok) {\n        if (tok.type === \"digit\") {\n            if (tok.sep) {\n                return tok.format.charAt(0) + \",\" + tok.format.substr(1);\n            } else {\n                return tok.format;\n            }\n        } else if (tok.type === \"exp\") {\n            return tok.ch + tok.sign;\n        } else if (tok.type === \"date\" || tok.type === \"time\") {\n            return maybeFraction(padLeft(\"\", tok.format, tok.part), tok);\n        } else if (tok.type === \"eltime\") {\n            return maybeFraction(\"[\" + padLeft(\"\", tok.format, tok.part) + \"]\", tok);\n        } else if (tok.type === \"ampm\") {\n            return tok.am + \"/\" + tok.pm;\n        } else if (tok.type === \"str\") {\n            return JSON.stringify(tok.value);\n        } else if (tok.type === \"text\") {\n            return \"@\";\n        } else if (tok.type === \"space\") {\n            return \"_\" + tok.value;\n        } else if (tok.type === \"fill\") {\n            return \"*\" + tok.value;\n        } else if (tok.type === \"dec\") {\n            return \".\";\n        } else if (tok.type === \"percent\") {\n            return \"%\";\n        } else if (tok.type === \"comma\") {\n            return \",\";\n        }\n    }\n}\n\nfunction adjustDecimals(sections, x) {\n    sections.forEach(function(sec) {\n        let diff = x;\n        if (sec.cond === \"text\") {\n            return;\n        }\n        let body = sec.body, adjusted = false, i = body.length;\n        while (diff !== 0 && --i >= 0) {\n            let tok = body[i];\n            if (tok.type === \"digit\") {\n                if (tok.decimal) {\n                    adjusted = true;\n                    if (diff > 0) {\n                        tok.format += padLeft(\"\", diff, \"0\");\n                    } else if (diff < 0) {\n                        let tmp = tok.format.length;\n                        tok.format = tok.format.substr(0, tmp + diff);\n                        diff += tmp - tok.format.length;\n                    }\n                    if (tok.format.length === 0) {\n                        body.splice(i, 1);\n                        while (--i >= 0) {\n                            tok = body[i];\n                            if (tok.type === \"digit\" && tok.decimal) {\n                                ++i;\n                                break;\n                            }\n                            if (tok.type === \"dec\") {\n                                body.splice(i, 1);\n                                break;\n                            }\n                        }\n                    }\n                }\n                if (diff > 0) {\n                    break;\n                }\n            }\n        }\n        if (!adjusted && diff > 0) {\n            // no decimal part was found, insert one after the last digit token.\n            body.splice(\n                i + 1, 0, {\n                    type    : \"dec\"\n                }, {\n                    type    : \"digit\",\n                    sep     : false,\n                    decimal : true,\n                    format  : padLeft(\"\", diff, \"0\")\n                }\n            );\n        }\n    });\n}\n\nfunction TokenStream2(parts) {\n    let index = 0;\n    return {\n        next: function() {\n            return parts[index++];\n        },\n        eof: function() {\n            return index >= parts.length;\n        },\n        ahead: function(n, f) {\n            if (index + n <= parts.length) {\n                let val = f.apply(null, parts.slice(index, index + n));\n                if (val) {\n                    index += n;\n                }\n                return val;\n            }\n        },\n        restart: function() {\n            index = 0;\n        }\n    };\n}\n\nlet runtime$1 = {\n    unpackDate: calc.runtime.unpackDate,\n    unpackTime: calc.runtime.unpackTime,\n\n    date: function(culture, d, part, length) {\n        switch (part) {\n          case \"d\":\n            switch (length) {\n            case 1: return d.date;\n            case 2: return padLeft(d.date, 2, \"0\");\n            case 3: return culture.calendar.days.format.abbreviated[d.day];\n            case 4: return culture.calendar.days.format.wide[d.day];\n            }\n            break;\n          case \"m\":\n            switch (length) {\n            case 1: return d.month + 1;\n            case 2: return padLeft(d.month + 1, 2, \"0\");\n            case 3: return culture.calendar.months.format.abbreviated[d.month];\n            case 4: return culture.calendar.months.format.wide[d.month];\n            case 5: return culture.calendar.months.format.narrow[d.month];\n            }\n            break;\n          case \"y\":\n            switch (length) {\n            case 1: return d.year;\n            case 2: return d.year % 100;\n            case 4: return d.year;\n            }\n            break;\n        }\n        return \"##\";\n    },\n\n    time: function(t, part, length, ampm, fraclen) {\n        let ret, fraction;\n        switch (part) {\n          case \"h\":\n            ret = padLeft(ampm ? t.hours % 12 || 12 : t.hours, length, \"0\");\n            if (fraclen) {\n                fraction = (t.minutes + (t.seconds + t.milliseconds / 1000) / 60) / 60;\n            }\n            break;\n          case \"m\":\n            ret = padLeft(t.minutes, length, \"0\");\n            if (fraclen) {\n                fraction = (t.seconds + t.milliseconds / 1000) / 60;\n            }\n            break;\n          case \"s\":\n            ret = padLeft(t.seconds, length, \"0\");\n            if (fraclen) {\n                fraction = t.milliseconds / 1000;\n            }\n            break;\n        }\n        if (fraction) {\n            ret += runtime$1.toFixed(fraction, fraclen).replace(/^0+/, \"\");\n        }\n        return ret;\n    },\n\n    eltime: function(value, part, length, fraclen) {\n        let ret, fraction;\n        switch (part) {\n          case \"h\":\n            ret = value * 24;\n            break;\n          case \"m\":\n            ret = value * 24 * 60;\n            break;\n          case \"s\":\n            ret = value * 24 * 60 * 60;\n            break;\n        }\n        if (fraclen) {\n            fraction = ret - (ret | 0);\n        }\n        ret = padLeft(ret | 0, length, \"0\");\n        if (fraction) {\n            ret += runtime$1.toFixed(fraction, fraclen).replace(/^0+/, \"\");\n        }\n        return ret;\n    },\n\n    fill: function(ch) {\n        // XXX: how to implement this?\n        return ch;\n    },\n\n    // formatting integer part is slightly different than decimal\n    // part, so they're implemented in two functions.  For the\n    // integer part we need to walk the value and the format\n    // backwards (right-to-left).\n\n    formatInt: function(culture, value, parts, declen, sep) {\n        // toFixed is perfect for rounding our value; if there is\n        // no format for decimals, for example, we want the number\n        // rounded up.\n        value = runtime$1.toFixed(value, declen).replace(/\\..*$/, \"\");\n        let lastPart = parts[parts.length - 1];\n\n        if (declen > 0 && lastPart[parts.length - 1] != \"0\") {\n            // if the rounded number is zero and we have decimal\n            // format, consider it a non-significant digit (Excel\n            // won't display the leading zero for 0.2 in format #.#).\n            // the zero won't e omitted if using 0.0 format\n            if (value === \"0\") { value = \"\"; }\n            else if (value === \"-0\") { value = \"-\"; }\n        }\n\n        let shouldInsertMinus = false;\n        let iv = value.length - 1;\n        let result = [];\n        let len = 0, str;\n\n        function add(ch, skipMinus) {\n            if (sep && len && len % 3 === 0 && /^[0-9]$/.test(ch)) {\n                str = culture.numbers.symbols.group + str;\n            }\n            if (skipMinus && ch === \"-\") {\n                shouldInsertMinus = true;\n                ch = \"0\";\n            }\n            str = ch + str;\n            len++;\n        }\n\n        for (let j = parts.length; --j >= 0;) {\n            let format = parts[j];\n            str = \"\";\n            for (let k = format.length; --k >= 0;) {\n                let chf = format.charAt(k);\n                if (iv < 0) {\n                    if (chf == \"0\") {\n                        add(\"0\");\n                    } else if (chf == \"?\") {\n                        add(\" \");\n                    }\n                } else {\n                    if (value == \"0\" && chf == \"?\") {\n                        add(\" \");\n                    } else if (chf == \"0\") {\n                        add(value.charAt(iv), true);\n                    } else {\n                        add(value.charAt(iv));\n                    }\n                    iv--;\n                }\n            }\n            if (j === 0) {\n                while (iv >= 0) {\n                    add(value.charAt(iv--));\n                }\n            }\n            result.unshift(str);\n        }\n\n        if (shouldInsertMinus) {\n            result[0] = \"-\" + result[0];\n        }\n\n        return result;\n    },\n\n    // for decimal part we walk in normal direction and pad on the\n    // right if required (for '0' or '?' chars).\n\n    formatDec: function(value, parts, declen) {\n        value = runtime$1.toFixed(value, declen);\n        let pos = value.indexOf(\".\");\n        if (pos >= 0) {\n            value = value.substr(pos + 1).replace(/0+$/, \"\");\n        } else {\n            value = \"\";\n        }\n\n        let iv = 0;\n        let result = [];\n\n        for (let j = 0; j < parts.length; ++j) {\n            let format = parts[j];\n            let str = \"\";\n            for (let k = 0; k < format.length; ++k) {\n                let chf = format.charAt(k);\n                if (iv < value.length) {\n                    str += value.charAt(iv++);\n                } else if (chf == \"0\") {\n                    str += \"0\";\n                } else if (chf == \"?\") {\n                    str += \" \";\n                }\n            }\n            result.push(str);\n        }\n\n        return result;\n    },\n\n    // JS's toFixed is broken, it's only OK to use it on integers.\n    toFixed: function(value, decimals) {\n        return (function toFixed(value, last) {\n            if (!isFinite(value)) {\n                return \"#NUM!\";\n            }\n\n            // deal early with the trivial cases\n            if (value < 0) {    // JS's Math.round is broken with negative numbers\n                return \"-\" + toFixed(-value);\n            }\n\n            if (decimals === 0) { // no decimals\n                return String(Math.round(value));\n            }\n\n            if (value === Math.round(value) && !/e/i.test(String(value))) { // value is integer and not too big\n                return value.toFixed(decimals);\n            }\n\n            // this handles cases like 0.3.toFixed(20) == \"0.29999999999999998890\", or\n            // 2.1825.toFixed(20) = \"2.18250000000000010658\".\n            // https://github.com/telerik/kendo-ui-core/issues/3520#issuecomment-333768221\n            // https://twitter.com/mcbazon/status/1035828655652593665\n            let num = digNumber(value);\n            let intpart = num.intpart;\n            let decpart = num.decpart;\n            if (decpart.length <= decimals) {\n                while (decpart.length < decimals) {\n                    decpart += \"0\";\n                }\n                return intpart + \".\" + decpart;\n            }\n\n            if (last) {\n                // \"we should definitely not get here\" (famous last words).  Let's MAKE SURE\n                // there's no more recursion.\n                return intpart + \".\" + decpart.substr(0, decimals);\n            }\n\n            // if there are more decimals than wanted, round and try again.\n            // it should not recurse more than once.\n            let f = Math.pow(10, decimals);\n            return toFixed(Math.round(value * f) / f, true);\n\n        })(Number(value.toFixed(14))); /* restrict to 14 decimals, because 0.1 + 0.2 ===\n                                        * 0.30000000000000004 */\n    }\n\n};\n\nfunction checkCondition(condition, a, b) {\n    switch (condition.op) {\n      case \"=\":\n        return a == b;\n      case \"<\":\n        return a < b;\n      case \">\":\n        return a > b;\n      case \"<=\":\n        return a <= b;\n      case \">=\":\n        return a >= b;\n    }\n    throw new Error(`Unknown condition operator: ${JSON.stringify(condition)}`);\n}\n\nfunction compileFormatPart(format) {\n    let input = TokenStream2(format.body);\n    let hasDate = false;\n    let hasTime = false;\n    let hasAmpm = false;\n    let percentCount = 0;\n    let currency = /[\\$\\xA2-\\xA5\\u058F\\u060B\\u09F2\\u09F3\\u09FB\\u0AF1\\u0BF9\\u0E3F\\u17DB\\u20A0-\\u20BD\\uA838\\uFDFC\\uFE69\\uFF04\\uFFE0\\uFFE1\\uFFE5\\uFFE6]/;\n    let scaleCount = 0;\n    let separeThousands = false;\n    let declen = 0;\n    let intFormat = [], decFormat = [];\n    let condition = format.cond;\n\n    function checkComma(a, b) {\n        if ((a.type === \"digit\" && b.type === \"comma\") || (a.type === \"comma\" && a.hidden && b.type === \"comma\")) {\n            b.hidden = true;\n            scaleCount++;\n        }\n    }\n    while (!input.eof()) {\n        input.ahead(2, checkComma);\n        let tok = input.next();\n        if (tok.type === \"percent\") {\n            percentCount++;\n        }\n        else if (tok.type === \"digit\") {\n            if (tok.decimal) {\n                declen += tok.format.length;\n                decFormat.push(tok.format);\n            } else {\n                intFormat.push(tok.format);\n                if (tok.sep) {\n                    separeThousands = true;\n                }\n            }\n        }\n        else if (tok.type === \"time\") {\n            hasTime = true;\n        }\n        else if (tok.type === \"date\") {\n            hasDate = true;\n        }\n        else if (tok.type === \"ampm\") {\n            hasAmpm = hasTime = true;\n        }\n    }\n\n    return function interpret(result, value, culture) {\n        let intPart, decPart, isNegative, date, time;\n        if (condition === \"text\") {\n            if (!(typeof value == \"string\" || value instanceof CalcError)) {\n                return false;\n            }\n        }\n        else if (condition === \"num\") {\n            if (typeof value != \"number\") {\n                return false;\n            }\n        }\n        else if (condition) {\n            if (typeof value != \"number\") {\n                return false;\n            }\n            if (!checkCondition(condition, value, condition.value)) {\n                return false;\n            }\n            if (!condition.custom) {\n                value = Math.abs(value);\n            }\n        }\n        if (percentCount > 0 || scaleCount > 0 || intFormat.length || decFormat.length || hasDate || hasTime) {\n            if (typeof value != \"number\") {\n                return false;\n            }\n        }\n        if (format.color) {\n            result.color = format.color;\n        }\n        if (percentCount > 0) {\n            value *= Math.pow(100, percentCount);\n        }\n        if (scaleCount > 0) {\n            value /= Math.pow(1000, scaleCount);\n        }\n        if (intFormat.length) {\n            intPart = runtime$1.formatInt(culture, value, intFormat, declen, separeThousands);\n            isNegative = parseInt(intPart[0]) < 0;\n        }\n        if (decFormat.length) {\n            decPart = runtime$1.formatDec(value, decFormat, declen);\n        }\n        if (intFormat.length || decFormat.length) {\n            result.type = \"number\";\n        }\n        if (hasDate) {\n            date = runtime$1.unpackDate(value);\n        }\n        if (hasTime) {\n            time = runtime$1.unpackTime(value);\n        }\n        if (hasDate || hasTime) {\n            result.type = \"date\";\n        }\n        let matchedCurrency = false, output = \"\";\n        input.restart();\n        while (!input.eof()) {\n            let tok = input.next();\n            if (tok.type === \"dec\") {\n                output += culture.numbers.symbols.decimal;\n            }\n            else if (tok.type === \"comma\" && !tok.hidden) {\n                output += ',';\n            }\n            else if (tok.type === \"percent\") {\n                result.type = \"percent\";\n                output += culture.numbers.symbols.percentSign;\n            }\n            else if (tok.type === \"str\") {\n                if (currency.test(tok.value)) {\n                    result.type = \"currency\";\n                    if (isNegative) {\n                        output += \"-\";\n                        matchedCurrency = true;\n                    }\n                }\n                output += tok.value;\n            }\n            else if (tok.type === \"text\") {\n                result.type = \"text\";\n                output += value; // XXX: sure not `tok.value`?\n            }\n            else if (tok.type === \"space\") {\n                if (output) {\n                    result.body.push(output);\n                }\n                output = \"\";\n                result.body.push(tok);\n            }\n            else if (tok.type === \"fill\") {\n                output += runtime$1.fill(tok.value);\n            }\n            else if (tok.type === \"digit\") {\n                if (isNegative && intPart[0] && matchedCurrency) {\n                    intPart[0] = intPart[0].replace(\"-\", \"\");\n                }\n                output += tok.decimal ? decPart.shift() : intPart.shift();\n            }\n            else if (tok.type === \"date\") {\n                output += runtime$1.date(culture, date, tok.part, tok.format);\n            }\n            else if (tok.type === \"time\") {\n                output += runtime$1.time(time, tok.part, tok.format, hasAmpm, tok.fraction);\n            }\n            else if (tok.type === \"eltime\") {\n                output += runtime$1.eltime(value, tok.part, tok.format, tok.fraction);\n            }\n            else if (tok.type === \"ampm\") {\n                // XXX: should use culture?  As per the \"spec\", Excel\n                // displays whatever the token was (AM/PM, a/p etc.)\n                output += time.hours < 12 ? tok.am : tok.pm;\n            }\n        }\n        if (output) {\n            result.body.push(output);\n        }\n        return true;\n    };\n}\n\nlet TEXT = compileFormatPart({ cond: \"text\", body: [ { type: \"text\" } ] });\n\nlet compile = memoize(function(format) {\n    let tree = parse$2(format);\n    let parts = tree.map(compileFormatPart);\n    parts.push(TEXT);\n    return function(value, localCulture = culture()) {\n        let result = { body: [] };\n        for (let i = 0; i < parts.length; ++i) {\n            if (parts[i](result, value, localCulture)) {\n                break;\n            }\n        }\n        return result;\n    };\n});\n\n// Attempts to produce a format compatible with kendo.parseDate from our Excel format.  Needed\n// in runtime.parseDate (passing Excel format to kendo.parseDate will mess up the month or\n// minutes).  https://github.com/telerik/kendo-ui-core/issues/3797\nlet makeDateFormat = memoize(function(format) {\n    let tree = parse$2(format);\n    let section, found = false, hasAmpm = false;\n    // locate a section that contains date/time formatting.  only the first will be converted.\n    for (let i = 0; i < tree.length; ++i) {\n        section = tree[i];\n        for (let j = 0; j < section.body.length; ++j) {\n            if (/^(?:date|time|ampm)$/.test(section.body[j].type)) {\n                found = true;\n                if (section.body[j].type === \"ampm\") {\n                    hasAmpm = true;\n                }\n            }\n        }\n        if (found) {\n            break;\n        }\n    }\n    if (!found) {\n        return null;\n    }\n    return section.body.map(printToken).join(\"\");\n    // a little copy/paste goes a long way\n    function maybeFraction(fmt, tok) {\n        if (tok.fraction) {\n            fmt += padLeft(\"\", Math.max(tok.fraction, 3), \"f\");\n        }\n        return fmt;\n    }\n    function printToken(tok) {\n        if (tok.type === \"digit\") {\n            if (tok.sep) {\n                return tok.format.charAt(0) + \",\" + tok.format.substr(1);\n            } else {\n                return tok.format;\n            }\n        }\n        else if (tok.type === \"exp\") {\n            return tok.ch + tok.sign;\n        }\n        else if (tok.type === \"date\" || tok.type === \"time\") {\n            let part = tok.part;\n            if (tok.type === \"date\" && /^m/.test(part)) {\n                part = \"M\"; // month, not minutes\n            }\n            else if (tok.type === \"time\" && /^h/.test(part)) {\n                if (!hasAmpm) {\n                    // 24-hours clock is H or HH\n                    part = part.toUpperCase();\n                }\n            }\n            return maybeFraction(padLeft(\"\", tok.format, part), tok);\n        }\n        else if (tok.type === \"ampm\") {\n            return \"tt\";\n        }\n        else if (tok.type === \"str\") {\n            // XXX: this is a bit wrong.  it doesn't look like kendo.toString / kendo.parseDate\n            // support arbitrary text (in Excel formats that's quoted), for example:\n            //    kendo.toString(new Date(), \"here's the day dude: dd\")\n            //  → \"3ere'8 t3e 19ay 19u19e: 19\"   (it's 19th June, 3 o'clock, probably 8 seconds)\n            return tok.value;\n        }\n        else if (tok.type === \"space\") {\n            return \" \";\n        }\n        else if (tok.type === \"dec\") {\n            return \".\";\n        }\n        else if (tok.type === \"percent\") {\n            return \"%\";\n        }\n        else if (tok.type === \"comma\") {\n            return \",\";\n        }\n        else {\n            return \"\";\n        }\n    }\n});\n\nfunction padLeft(val, width, ch) {\n    val += \"\";\n    while (val.length < width) {\n        val = ch + val;\n    }\n    return val;\n}\n\nfunction padRight(val, width, ch) {\n    val += \"\";\n    while (val.length < width) {\n        val += ch;\n    }\n    return val;\n}\n\n// given a number, return { intpart, decpart } as strings.  the main difficulty here is that JS\n// will stringify really large values in scientific notation (e.g. 1.23e+30, which is actually\n// the integer 1230000000000000000000000000000).\nfunction digNumber(num) {\n    let str = String(num).toLowerCase();\n    let intpart, decpart, m;\n    let pos = str.indexOf(\".\");\n    if (pos < 0) {\n        pos = str.indexOf(\"e\");\n        if (pos < 0) {\n            intpart = str;\n            decpart = \"\";\n        } else {\n            intpart = str.substr(0, pos);\n            decpart = str.substr(pos);\n        }\n    } else {\n        intpart = str.substr(0, pos);\n        decpart = str.substr(pos + 1);\n    }\n    if ((m = /(\\d*)e([-+]?\\d+)/.exec(decpart))) {\n        let exp = parseInt(m[2], 10);\n        if (exp >= 0) {\n            decpart = padRight(m[1], exp, \"0\");\n            intpart += decpart.substr(0, exp);\n            decpart = decpart.substr(exp);\n        } else {\n            intpart = padLeft(intpart, -exp, \"0\");\n            decpart = intpart.substr(exp) + m[1];\n            intpart = intpart.substr(0, intpart.length + exp);\n        }\n    }\n    return { intpart: intpart || \"0\", decpart: decpart };\n}\n\n/* -----[ exports ]----- */\nfunction text(f) {\n    let a = f.body;\n    let text = \"\";\n    for (let i = 0; i < a.length; ++i) {\n        let el = a[i];\n        if (typeof el == \"string\") {\n            text += el;\n        } else if (el.type === \"space\") {\n            text += \" \";\n        }\n    }\n    return text;\n}\n\nconst formatting = {\n    compile : compile,\n    parse: parse$2,\n    format: function(value, format, culture) {\n        let f = compile(format)(value, culture);\n        let span = dom.element(\"span\");\n        span.__dataType = f.type;\n        let a = f.body;\n        if (f.color) {\n            span.attr.style = { color: f.color };\n        }\n        for (let i = 0; i < a.length; ++i) {\n            let el = a[i];\n            if (typeof el == \"string\") {\n                span.children.push(dom.text(el));\n            } else if (el.type === \"space\") {\n                span.children.push(dom.element(\"span\", {\n                    style: { visibility: \"hidden\" }\n                }, [ dom.text(el.value) ]));\n            }\n        }\n        return span;\n    },\n    text: function(value, format, culture) {\n        let f = compile(format)(value, culture);\n        return text(f);\n    },\n    textAndColor: function(value, format, culture) {\n        let f = compile(format)(value, culture);\n        return { text: text(f), color: f.color, type: f.type };\n    },\n    type: function(value, format, culture) {\n        return compile(format)(value, culture).type;\n    },\n    adjustDecimals: function(format, diff) {\n        let ast = parse$2(format);\n        adjustDecimals(ast, diff);\n        return print$1(ast);\n    },\n    makeDateFormat: makeDateFormat\n};\n\n/* eslint-disable no-nested-ternary */\n/* eslint-disable space-infix-ops */\n/* eslint-disable indent */\n/* eslint-disable no-empty */\n/* eslint-disable no-loop-func */\n/* eslint-disable consistent-return */\n/* eslint-disable block-scoped-var */\n/* eslint-disable no-redeclare */\n/* eslint-disable no-var */\n/* eslint-disable eqeqeq */\n/* eslint-disable complexity */\n/* eslint-disable max-params */\n/* eslint-disable no-implicit-coercion */\n/* eslint-disable key-spacing */\n/* eslint-disable default-case */\n/* eslint-disable camelcase */\n/* eslint-disable brace-style */\n/* eslint-disable no-else-return */\n/* eslint-disable no-constant-condition */\n/* eslint-disable no-param-reassign */\n/* eslint-disable space-before-blocks */\n/* eslint-disable no-unused-labels */\n\n\nconst kendo = createKendoObj(calc, CalcError, Ref, CellRef, RangeRef);\ncalc.kendo = kendo; // XXX\ncalc.formatting = formatting;\n\n// --------------------------------------------calc.js\n\n// Excel formula parser and compiler to JS.\n// some code adapted from http://lisperator.net/pltut/\n\n// these two will hold the same operators, except that when the comma is used as decimal\n// separator, the union operator must be the semicolon (;) instead of comma.\nlet OPERATORS_STANDARD = Object.create(null);\nlet OPERATORS_COMMA = Object.create(null);\n\n(function(ops){\n    ops.forEach(function(cls, i){\n        cls.forEach(function(op){\n            OPERATORS_STANDARD[op] = ops.length - i;\n            OPERATORS_COMMA[op === \",\" ? \";\" : op] = ops.length - i;\n        });\n    });\n})([\n    [ \":\" ],\n    [ \" \" ],\n    [ \",\" ],\n    [ \"%\" ],\n    [ \"^\" ],\n    [ \"*\", \"/\" ],\n    [ \"+\", \"-\" ],\n    [ \"&\" ],\n    [ \"=\", \"<\", \">\", \"<=\", \">=\", \"<>\" ]\n]);\n\nlet OPERATORS = OPERATORS_STANDARD;\n\nlet SEPARATORS = {\n    DEC: \".\",\n    ARG: \",\",\n    COL: \",\"\n};\n\nfunction setDecimalSeparator(sep) {\n    SEPARATORS.DEC = sep;\n    SEPARATORS.ARG = sep === \",\" ? \";\" : \",\";\n    SEPARATORS.COL = sep === \",\" ? \"\\\\\" : \",\";\n    OPERATORS = sep === \",\" ? OPERATORS_COMMA : OPERATORS_STANDARD;\n}\n\ncalc.withDecimalSeparator = function(sep, f) {\n    if (SEPARATORS.DEC === sep) {\n        return f();\n    }\n    let save = SEPARATORS.DEC;\n    setDecimalSeparator(sep);\n    try {\n        return f();\n    } finally {\n        setDecimalSeparator(save);\n    }\n};\n\ncalc._separators = SEPARATORS;\n\nlet TRUE = { type: \"bool\", value: true };\nlet FALSE = { type: \"bool\", value: false };\n\nfunction getcol(str) {\n    str = str.toUpperCase();\n    let col = 0;\n    for (let i = 0; i < str.length; ++i) {\n        col = col * 26 + str.charCodeAt(i) - 64;\n    }\n    return col - 1;\n}\n\nfunction getrow(str) {\n    return parseInt(str, 10) - 1;\n}\n\nfunction parseReference(name, noThrow) {\n    if (name.toLowerCase() === \"#sheet\") {\n        return SHEETREF;\n    }\n    OUT: {\n        // this is redundant, but let's keep it fast for the most\n        // common case — A1.  If this fails, we'll try to employ the\n        // whole tokenizer.\n        let m;\n        if ((m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name))) {\n            let row = getrow(m[4]), col = getcol(m[2]);\n            if (row < 0x100000 && col < 0x4000) {\n                return new CellRef(getrow(m[4]), getcol(m[2]));\n            }\n            // no NameRef-s from this function\n            break OUT;\n        }\n        let stream = TokenStream(name, {});\n        let a = [];\n        while (true) {\n            let ref = stream.next();\n            if (ref instanceof CellRef) {\n                // this function always makes absolute references\n                ref.rel = 0;\n            } else if (ref instanceof RangeRef) {\n                ref.topLeft.rel = 0;\n                ref.bottomRight.rel = 0;\n            } else {\n                break OUT;\n            }\n            a.push(ref);\n            if (stream.eof()) {\n                break;\n            }\n            if (!stream.is(\"op\", SEPARATORS.ARG)) {\n                break OUT;\n            }\n            stream.next();\n        }\n        return a.length === 1 ? a[0] : new UnionRef(a);\n    }\n    if (!noThrow) {\n        throw new Error(\"Cannot parse reference: \" + name);\n    }\n}\n\nfunction parseFormula(sheet, row, col, input) {\n    let refs = [];\n    input = TokenStream(input, { row: row, col: col });\n    let is = input.is;\n\n    return {\n        type: \"exp\",\n        ast: parseExpression(true),\n        refs: refs,\n        sheet: sheet,\n        row: row,\n        col: col\n    };\n\n    function addReference(ref) {\n        ref.index = refs.length;\n        refs.push(ref);\n        return ref;\n    }\n\n    function skip(type, value, allowEOF) {\n        if (is(type, value)) {\n            return input.next();\n        } else {\n            let tok = input.peek();\n            if (tok) {\n                input.croak(\"Expected \" + type + \" «\" + value + \"» but found \" + tok.type + \" «\" + tok.value + \"»\");\n            } else if (!allowEOF) {\n                input.croak(\"Expected \" + type + \" «\" + value + \"»\");\n            }\n        }\n    }\n\n    function parseExpression(commas) {\n        return maybeBinary(maybeIntersect(parseAtom()), 0, commas);\n    }\n\n    function parseSymbol(tok) {\n        if (tok.upper === \"TRUE\" || tok.upper === \"FALSE\") {\n            return tok.upper === \"TRUE\" ? TRUE : FALSE;\n        }\n        return addReference(new NameRef(tok.value));\n    }\n\n    function parseFuncall() {\n        let fname = input.next();\n        fname = fname.value;\n        skip(\"punc\", \"(\");\n        let args = [];\n        while (1) {\n            if (is(\"punc\", \")\")) {\n                break;\n            }\n            if (is(\"op\", SEPARATORS.ARG)) {\n                args.push({ type: \"null\" });\n                input.next();\n                continue;\n            }\n            args.push(parseExpression(false));\n            if (input.eof() || is(\"punc\", \")\")) {\n                break;\n            }\n            skip(\"op\", SEPARATORS.ARG);\n        }\n        skip(\"punc\", \")\", true);\n        return {\n            type: \"func\",\n            func: fname,\n            args: args\n        };\n    }\n\n    function fixReference(ref) {\n        if (!ref.hasSheet()) {\n            ref.setSheet(sheet);\n        }\n        return addReference(ref);\n    }\n\n    function parseAtom() {\n        let exp;\n        if (is(\"ref\")) {\n            exp = fixReference(input.next());\n        }\n        else if (is(\"func\")) {\n            exp = parseFuncall();\n        }\n        else if (is(\"punc\", \"(\")) {\n            input.next();\n            exp = parseExpression(true);\n            skip(\"punc\", \")\", true);\n        }\n        else if (is(\"punc\", \"{\")) {\n            input.next();\n            exp = parseArray();\n            skip(\"punc\", \"}\", true);\n        }\n        else if (is(\"num\") || is(\"str\") || is(\"error\")) {\n            exp = input.next();\n        }\n        else if (is(\"sym\")) {\n            exp = parseSymbol(input.next());\n        }\n        else if (is(\"op\", \"+\") || is(\"op\", \"-\")) {\n            exp = {\n                type: \"prefix\",\n                op: input.next().value,\n                exp: parseAtom()\n            };\n        }\n        else if (!input.peek()) {\n            input.croak(\"Incomplete expression\");\n        }\n        else if (is(\"punc\", \"[\")) {\n            input.croak(\"External reference not supported\");\n        }\n        else {\n            input.croak(\"Parse error\");\n        }\n        return maybePercent(exp);\n    }\n\n    function parseArray() {\n        let row = [], value = [ row ], first = true;\n        while (!input.eof() && !is(\"punc\", \"}\")) {\n            if (first) {\n                first = false;\n            } else if (is(null, \";\")) {\n                value.push(row = []);\n                input.next();\n            } else {\n                skip(null, SEPARATORS.COL);\n            }\n            row.push(parseExpression(false));\n        }\n        return {\n            type: \"matrix\",\n            value: value\n        };\n    }\n\n    function maybeIntersect(exp) {\n        if (is(\"punc\", \"(\") || is(\"ref\") || is(\"num\") || is(\"func\")) {\n            return {\n                type: \"binary\",\n                op: \" \",\n                left: exp,\n                right: parseExpression(false)\n            };\n        } else {\n            return exp;\n        }\n    }\n\n    function maybePercent(exp) {\n        if (is(\"op\", \"%\")) {\n            input.next();\n            return maybePercent({\n                type: \"postfix\",\n                op: \"%\",\n                exp: exp\n            });\n        } else {\n            return exp;\n        }\n    }\n\n    function maybeBinary(left, my_prec, commas) {\n        let tok = is(\"op\");\n        if (tok && (commas || tok.value !== SEPARATORS.ARG)) {\n            let his_prec = OPERATORS[tok.value];\n            if (his_prec > my_prec) {\n                input.next();\n                let right = maybeBinary(parseAtom(), his_prec, commas);\n                return maybeBinary({\n                    type: \"binary\",\n                    op: tok.value === \";\" ? \",\" : tok.value, // translate union back to comma\n                    left: left,\n                    right: right\n                }, my_prec, commas);\n            }\n        }\n        return left;\n    }\n}\n\nfunction parseNameDefinition(name, def) {\n    let nameRef = parseFormula(null, 0, 0, name);\n    if (!(nameRef.ast instanceof NameRef)) {\n        throw new calc.runtime.ParseError(\"Invalid name: \" + name);\n    }\n    nameRef = nameRef.ast;\n\n    if (!(def instanceof Ref)) {\n        let defAST = parseFormula(nameRef.sheet, 0, 0, def);\n        if (defAST.ast instanceof Ref) {\n            def = defAST.ast;   // single reference\n        } else if (/^(?:str|num|bool|error)$/.test(defAST.ast.type)) {\n            def = defAST.ast.value; // constant\n        } else {\n            def = makeFormula(defAST); // formula\n        }\n    }\n\n    return {\n        name: nameRef,\n        value: def\n    };\n}\n\nfunction print(exp, refs, row, col, mod) {\n    return print(exp.ast, exp, 0);\n\n    function print(node, parent, prec) {\n        switch (node.type) {\n          case \"num\":\n            return calc._separators.DEC == \".\" ? JSON.stringify(node.value)\n                : JSON.stringify(node.value).replace(\".\", calc._separators.DEC);\n\n          case \"bool\":\n            return node.value;\n\n          case \"error\":\n            return \"#\" + node.value;\n\n          case \"str\":\n            return JSON.stringify(node.value);\n\n          case \"ref\":\n            return withParens(() =>\n                refs[node.index].print(row, col, mod));\n\n          case \"prefix\":\n            return withParens(() =>\n                node.op + print(node.exp, node, OPERATORS[node.op]));\n\n          case \"postfix\":\n            return withParens(() =>\n                print(node.exp, node, OPERATORS[node.op]) + node.op);\n\n          case \"binary\":\n            return withParens(() => {\n                let left = parenthesize(\n                    print(node.left, node, OPERATORS[node.op]),\n                    node.left instanceof NameRef && node.op === \":\"\n                );\n                let right = parenthesize(\n                    print(node.right, node, OPERATORS[node.op]),\n                    node.right instanceof NameRef && node.op === \":\"\n                );\n                if (/^[,;]/.test(node.op)) {\n                    return left + calc._separators.ARG + right;\n                } else {\n                    return left + node.op + right;\n                }\n            });\n\n          case \"func\":\n            return node.func + \"(\"\n                + node.args.map(arg => print(arg, node, 0)).join(calc._separators.ARG + \" \") + \")\";\n\n          case \"matrix\":\n            return \"{ \" + node.value.map(tr => tr.map(td => print(td, node, 0)).join(calc._separators.COL)).join(\"; \") + \" }\";\n\n          case \"null\":\n            return \"\";\n        }\n\n        throw new Error(\"Cannot print node \" + node.type);\n\n        function withParens(f) {\n            let op = node.op;\n            let needParens = (OPERATORS[op] < prec\n                              || (!prec && op === \",\")\n                              || (parent.type === \"prefix\" && prec === OPERATORS[op] && parent.op === \"-\")\n                              || (parent.type === \"binary\" && prec === OPERATORS[op] && node === parent.right));\n            return parenthesize(f(), needParens);\n        }\n    }\n\n    function parenthesize(code, cond) {\n        return cond ? \"(\" + code + \")\" : code;\n    }\n}\n\nfunction makePrinter(exp) {\n    return function(row, col, mod) {\n        return print(exp, this.refs, row, col, mod);\n    };\n}\n\n/// BEGIN interpreter\n\nfunction evRef(ctx, node, k) {\n    return node.ref === \"name\"\n        ? ctx.fetchName(node, k)\n        : k(ctx.formula.absrefs[node.index]);\n}\n\nfunction evFuncIf(ctx, co, th, el, k) {\n    return evaluate(ctx, co, co => ctx.func(\"if\", k, [\n        co,\n        k => evaluate(ctx, th, k),\n        k => evaluate(ctx, el, k)\n    ]));\n}\n\nfunction evFuncAnd(ctx, args, k) {\n    return args.length === 0 ? k(true)\n        : args.length === 1 ? evaluate(ctx, args[0], co => k(ctx.bool(co)))\n        : evaluate(ctx, args[0], co =>\n            ctx.bool(co)\n                ? evFuncAnd(ctx, args.slice(1), k)\n                : k(false));\n}\n\nfunction evFuncOr(ctx, args, k) {\n    return args.length === 0 ? k(false)\n        : args.length === 1 ? evaluate(ctx, args[0], co => k(ctx.bool(co)))\n        : evaluate(ctx, args[0], co =>\n            ctx.bool(co)\n                ? k(true)\n                : evFuncOr(ctx, args.slice(1), k));\n}\n\nfunction evFunc(ctx, node, k) {\n    switch (node.func.toLowerCase()) {\n      case \"if\":\n        return evFuncIf(ctx, node.args[0], node.args[1] || TRUE, node.args[2] || FALSE, k);\n      case \"and\":\n        return evFuncAnd(ctx, node.args, k);\n      case \"or\":\n        return evFuncOr(ctx, node.args, k);\n      case \"true\":\n        return k(true);\n      case \"false\":\n        return k(false);\n    }\n    return evArguments(ctx, node.args, 0, args => ctx.func(node.func, k, args));\n}\n\nfunction evArguments(ctx, args, i, k, ret = []) {\n    return i === args.length\n        ? k(ret)\n        : evaluate(ctx, args[i], val => (\n            ret[i] = val,\n            evArguments(ctx, args, i + 1, k, ret)\n        ));\n}\n\nfunction evBinary(ctx, node, k) {\n    return evaluate(ctx, node.left, left =>\n        evaluate(ctx, node.right, right =>\n            ctx.func(\"binary\" + node.op, k, [ left, right ])));\n}\n\nfunction evUnary(ctx, node, k) {\n    return evaluate(ctx, node.exp, exp =>\n        ctx.func(\"unary\" + node.op, k, [ exp ]));\n}\n\nfunction evMatrix(ctx, { value }, k) {\n    let a = [];\n    return (function loop(i){\n        return i === value.length ? k(a)\n            : evArguments(ctx, value[i], 0, row =>\n                (a[i] = row, loop(i + 1)));\n    })(0);\n}\n\nfunction evaluate(ctx, node, k) {\n    switch (node.type) {\n      case \"ref\":\n        return evRef(ctx, node, k);\n      case \"num\":\n      case \"str\":\n      case \"null\":\n      case \"bool\":\n        return k(node.value);\n      case \"error\":\n        return k(ctx.error(node.value));\n      case \"prefix\":\n      case \"postfix\":\n        return evUnary(ctx, node, k);\n      case \"binary\":\n        return evBinary(ctx, node, k);\n      case \"func\":\n        return evFunc(ctx, node, k);\n      case \"matrix\":\n        return evMatrix(ctx, node, k);\n    }\n    throw new Error(\"Cannot evaluate \" + node.type);\n}\n\nfunction makeInterpreter({ ast }) {\n    return function() {\n        // `this` is the Context object (runtime.js), so don't attempt\n        // to make this an arrow function.\n        return evaluate(this, ast, val => this.resolve(val));\n    };\n}\n\n/// END interpreter\n\nlet FORMULA_CACHE = Object.create(null);\n\nfunction makeFormula(exp) {\n    let printer = makePrinter(exp);\n    let hash = printer.call(exp); // needs .refs\n    let formula = FORMULA_CACHE[hash];\n    if (formula) {\n        // we need to clone because formulas cache the result; even if the formula is the same,\n        // its value will depend on its location, hence we need different objects.  Still, using\n        // this cache is a good idea because we'll reuse the same refs array, handler and\n        // printer, instead of allocating new ones (and we skip compiling it).\n        return formula.clone(exp.sheet, exp.row, exp.col);\n    }\n\n    formula = new calc.runtime.Formula(exp.refs, makeInterpreter(exp), printer, exp.sheet, exp.row, exp.col);\n    FORMULA_CACHE[hash] = formula.clone(exp.sheet, exp.row, exp.col);\n    return formula;\n}\n\nfunction identity$1(x) {\n    return x;\n}\n\nfunction TokenStream(input, options) {\n    input = RawTokenStream(calc.runtime.InputStream(input), options);\n    let ahead = input.ahead;\n    let skip = input.skip;\n    let token = null;\n    let fixCell = options.row != null && options.col != null\n        ? function(cell) {\n            if (cell.rel & 1) {\n                cell.col -= options.col;\n            }\n            if (cell.rel & 2) {\n                cell.row -= options.row;\n            }\n            return cell;\n        }\n        : identity$1;\n\n    let addPos = options.forEditor\n        ? function(thing, startToken, endToken) {\n            thing.begin = startToken.begin;\n            thing.end = endToken.end;\n            return thing;\n        }\n        : identity$1;\n\n    return {\n        peek  : peek,\n        next  : next,\n        croak : input.croak,\n        eof   : input.eof,\n        is    : is\n    };\n\n    function is(type, value) {\n        let tok = peek();\n        return tok != null\n            && (type == null || tok.type === type)\n            && (value == null || tok.value === value)\n            ? tok : null;\n    }\n\n    function peek() {\n        if (token == null) {\n            token = readNext();\n        }\n        return token;\n    }\n\n    function next() {\n        if (token != null) {\n            let tmp = token;\n            token = null;\n            return tmp;\n        }\n        return readNext();\n    }\n\n    function readNext() {\n        let ret;\n        let t = input.peek();\n        if (t) {\n            if (t.type === \"sym\" || t.type === \"rc\" || t.type === \"num\") {\n                ret = ahead(8, refRange3D)\n                    || ahead(6, refCell3D)\n                    || ahead(6, refSheetRange)\n                    || ahead(4, refSheetCell)\n                    || ahead(4, refRange)\n                    || ahead(2, refCell)\n                    || ahead(2, funcall);\n            }\n            if (!ret) {\n                ret = input.next();\n            }\n        }\n        return ret;\n    }\n\n    function toCell(tok, isFirst) {\n        if (tok.type === \"rc\") {\n            // RC notation is read properly without knowing where\n            // we are, so no need to fixCell on this one.\n            // However, if only absolute refs were asked for (from\n            // i.e. parseReference) I feel it's alright to yell\n            // about it here.\n            if (tok.rel && !options.forEditor && (options.row == null || options.col == null)) {\n                input.croak(\"Cannot read relative cell in RC notation\");\n            }\n            return new CellRef(tok.row, tok.col, tok.rel);\n        }\n        if (tok.type === \"num\") {\n            if (tok.value <= 1048577) {\n                // whole row\n                return fixCell(new CellRef(\n                    getrow(tok.value),\n                    isFirst ? -Infinity : +Infinity,\n                    2\n                ));\n            } else {\n                return null;\n            }\n        }\n        // otherwise it's \"sym\".  The OOXML spec (SpreadsheetML\n        // 18.2.5) defines the maximum value to be interpreted as\n        // a cell reference to be XFD1048576.\n        let name = tok.value;\n        let m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name);\n        if (m) {\n            let row = getrow(m[4]), col = getcol(m[2]);\n            if (row <= 1048576 && col <= 16383) {\n                return fixCell(new CellRef(\n                    getrow(m[4]),\n                    getcol(m[2]),\n                    (m[1] ? 0 : 1) | (m[3] ? 0 : 2)\n                ));\n            } else {\n                return null;\n            }\n        }\n        let abs = name.charAt(0) === \"$\";\n        if (abs) {\n            name = name.substr(1);\n        }\n        if (/^\\d+$/.test(name)) {\n            let row = getrow(name);\n            if (row <= 1048576) {\n                return fixCell(new CellRef(\n                    getrow(name),\n                    isFirst ? -Infinity : +Infinity,\n                    (abs ? 0 : 2)\n                ));\n            }\n        } else {\n            let col = getcol(name);\n            if (col <= 16383) {\n                return fixCell(new CellRef(\n                    isFirst ? -Infinity : +Infinity,\n                    getcol(name),\n                    (abs ? 0 : 1)\n                ));\n            }\n        }\n    }\n\n    // Sheet1(a) :(b) Sheet2(c) !(d) A1(e) :(f) C3(g) not followed by paren (h)\n    function refRange3D(a, b, c, d, e, f, g, h) {\n        if (a.type === \"sym\" &&\n            b.type === \"op\" && b.value === \":\" &&\n            c.type === \"sym\" &&\n            d.type === \"punc\" && d.value === \"!\" &&\n            (e.type === \"sym\" || e.type === \"rc\" || (e.type === \"num\" && e.value === e.value | 0)) &&\n            f.type === \"op\" && f.value === \":\" &&\n            (g.type === \"sym\" || g.type === \"rc\" || (g.type === \"num\" && g.value === g.value | 0)) &&\n            g.type === e.type &&\n            !(h.type === \"punc\" && h.value === \"(\" && !g.space))\n        {\n            let tl = toCell(e, true), br = toCell(g, false);\n            if (tl && br) {\n                // skip them except the last one, we only wanted to\n                // ensure it's not paren.\n                skip(7);\n                return addPos(new RangeRef(\n                    tl.setSheet(a.value, true),\n                    br.setSheet(c.value, true)\n                ).setSheet(a.value, true), a, g);\n            }\n        }\n    }\n\n    // Sheet1(a) :(b) Sheet2(c) !(d) A1(e) not followed by paren (f)\n    function refCell3D(a, b, c, d, e, f) {\n        if (a.type === \"sym\" &&\n            b.type === \"op\" && b.value === \":\" &&\n            c.type === \"sym\" &&\n            d.type === \"punc\" && d.value === \"!\" &&\n            (e.type === \"sym\" || e.type === \"rc\" || (e.type === \"num\" && e.value === e.value | 0)) &&\n            !(f.type === \"punc\" && f.value === \"(\" && !e.space))\n        {\n            let tl = toCell(e);\n            if (tl) {\n                skip(5);\n                let br = tl.clone();\n                return addPos(new RangeRef(\n                    tl.setSheet(a.value, true),\n                    br.setSheet(c.value, true)\n                ).setSheet(a.value, true), a, e);\n            }\n        }\n    }\n\n    // Sheet1(a) !(b) A1(c) :(d) C3(e) not followed by paren (f)\n    function refSheetRange(a, b, c, d, e, f) {\n        if (a.type === \"sym\" &&\n            b.type === \"punc\" && b.value === \"!\" &&\n            (c.type === \"sym\" || c.type === \"rc\" || (c.type === \"num\" && c.value === c.value | 0)) &&\n            d.type === \"op\" && d.value === \":\" &&\n            (e.type === \"sym\" || e.type === \"rc\" || (e.type === \"num\" && e.value === e.value | 0)) &&\n            !(f.type === \"punc\" && f.value === \"(\" && !e.space))\n        {\n            let tl = toCell(c, true), br = toCell(e, false);\n            if (tl && br) {\n                skip(5);\n                return addPos(new RangeRef(tl, br).setSheet(a.value, true), a, e);\n            }\n        }\n    }\n\n    // Sheet1(a) !(b) A1(c) not followed by paren (d)\n    function refSheetCell(a, b, c, d) {\n        if (a.type === \"sym\" &&\n            b.type === \"punc\" && b.value === \"!\" &&\n            (c.type === \"sym\" || c.type === \"rc\" || (c.type === \"num\" && c.value === c.value | 0)) &&\n            !(d.type === \"punc\" && d.value === \"(\" && !c.space))\n        {\n            skip(3);\n            let x = toCell(c);\n            if (!x || !isFinite(x.row)) {\n                x = new NameRef(c.value);\n            }\n            return addPos(x.setSheet(a.value, true), a, c);\n        }\n    }\n\n    // A1(a) :(b) C3(c) not followed by paren (d)\n    function refRange(a, b, c, d) {\n        if ((a.type === \"sym\" || a.type === \"rc\" || (a.type === \"num\" && a.value === a.value | 0)) &&\n            (b.type === \"op\" && b.value === \":\") &&\n            (c.type === \"sym\" || c.type === \"rc\" || (c.type === \"num\" && c.value === c.value | 0)) &&\n            !(d.type === \"punc\" && d.value === \"(\" && !c.space))\n        {\n            let tl = toCell(a, true), br = toCell(c, false);\n            if (tl && br) {\n                skip(3);\n                return addPos(new RangeRef(tl, br), a, c);\n            }\n        }\n    }\n\n    // A1(a) not followed by paren (b)\n    function refCell(a, b) {\n        if ((a.type === \"sym\" || a.type === \"rc\") && !(b.type === \"punc\" && b.value === \"(\" && !a.space)) {\n            let x = toCell(a);\n            if (x && isFinite(x.row) && isFinite(x.col)) {\n                skip(1);\n                return addPos(x, a, a);\n            }\n        }\n    }\n\n    function funcall(a, b) {\n        if (a.type === \"sym\" && b.type === \"punc\" && b.value === \"(\" && !a.space) {\n            a.type = \"func\";\n            skip(1);\n            return a;       // already has position\n        }\n    }\n}\n\nfunction isWhitespace(ch) {\n    return \" \\t\\r\\n\\xa0\\u200b\".indexOf(ch) >= 0;\n}\n\nlet EOF = { type: \"eof\" };\n\nfunction RawTokenStream(input, options) {\n    let tokens = [], index = 0;\n    let readWhile = input.readWhile;\n\n    return {\n        next  : next,\n        peek  : peek,\n        eof   : eof,\n        croak : input.croak,\n        ahead : ahead,\n        skip  : skip\n    };\n\n    function isDigit(ch) {\n        return (/[0-9]/i.test(ch));\n    }\n\n    function isIdStart(ch) {\n        return (/[a-z$_]/i.test(ch) || isUnicodeLetter(ch));\n    }\n\n    function isId(ch) {\n        return isIdStart(ch) || isDigit(ch) || ch === \".\";\n    }\n\n    function isOpChar(ch) {\n        return ch in OPERATORS;\n    }\n\n    function isPunc(ch) {\n        return \"\\\\!;(){}[]\".indexOf(ch) >= 0;\n    }\n\n    function readNumber() {\n        // XXX: TODO: exponential notation\n        let has_dot = false;\n        let number = readWhile(function(ch){\n            if (ch === SEPARATORS.DEC) {\n                if (has_dot) {\n                    return false;\n                }\n                has_dot = true;\n                return true;\n            }\n            return isDigit(ch);\n        });\n        if (number === SEPARATORS.DEC) {\n            return { type: \"punc\", value: SEPARATORS.DEC };\n        } else {\n            return { type: \"num\", value: parseFloat(number.replace(SEPARATORS.DEC, \".\")) };\n        }\n    }\n\n    function symbol(id, quote) {\n        return {\n            type  : \"sym\",\n            value : id,\n            upper : id.toUpperCase(),\n            space : isWhitespace(input.peek()),\n            quote : quote\n        };\n    }\n\n    function getRC(a, b, c) {\n        if (!a && !b && !c) {\n            return null;\n        }\n        if ((!a && !c) || (a && c)) {\n            let num = b ? parseInt(b, 10) : 0;\n            return a ? num : num - 1;\n        }\n    }\n\n    function readSymbol() {\n        let m = input.lookingAt(/^R(\\[)?(-?[0-9]+)?(\\])?C(\\[)?(-?[0-9]+)?(\\])?/i);\n        if (m) {\n            let row = getRC(m[1], m[2], m[3]);\n            let col = getRC(m[4], m[5], m[6]);\n            if (row != null && col != null) {\n                input.skip(m);\n                return {\n                    type: \"rc\",\n                    row: row,\n                    col: col,\n                    rel: ((m[4] || !(m[4] || m[5] || m[6]) ? 1 : 0) // col\n                          |\n                          (m[1] || !(m[1] || m[2] || m[3]) ? 2 : 0) // row\n                         )\n                };\n            }\n        }\n        return symbol(readWhile(isId));\n    }\n\n    function readString() {\n        input.next();\n        return { type: \"str\", value: input.readEscaped('\"') };\n    }\n\n    function readSheetName() {\n        input.next();\n        return symbol(input.readEscaped(\"'\"), true);\n    }\n\n    function readOperator() {\n        return {\n            type  : \"op\",\n            value : readWhile(function(ch, op){\n                return (op + ch) in OPERATORS;\n            })\n        };\n    }\n\n    function readPunc() {\n        return {\n            type  : \"punc\",\n            value : input.next()\n        };\n    }\n\n    function readNext() {\n        if (input.eof()) {\n            return null;\n        }\n        let ch = input.peek(), m;\n        if (ch === '\"') {\n            return readString();\n        }\n        if (ch === \"'\") {\n            return readSheetName();\n        }\n        if (isDigit(ch) || ch === SEPARATORS.DEC) {\n            return readNumber();\n        }\n        if (isIdStart(ch)) {\n            return readSymbol();\n        }\n        if (isOpChar(ch)) {\n            return readOperator();\n        }\n        if (isPunc(ch)) {\n            return readPunc();\n        }\n        if ((m = input.lookingAt(/^#([a-z\\/]+)[?!]?/i))) {\n            input.skip(m);\n            return { type: \"error\", value: m[1] };\n        }\n        if (!options.forEditor) {\n            input.croak(\"Can't handle character with code: \" + ch.charCodeAt(0));\n        }\n        return { type: \"error\", value: input.next() };\n    }\n\n    function peek() {\n        while (tokens.length <= index) {\n            readWhile(isWhitespace);\n            let begin = input.pos();\n            let tok = readNext();\n            if (options.forEditor && tok) {\n                tok.begin = begin;\n                tok.end = input.pos();\n            }\n            tokens.push(tok);\n        }\n        return tokens[index];\n    }\n\n    function next() {\n        let tok = peek();\n        if (tok) {\n            index++;\n        }\n        return tok;\n    }\n\n    function ahead(n, f) {\n        let pos = index, a = [];\n        while (n-- > 0) {\n            a.push(next() || EOF);\n        }\n        index = pos;\n        return f.apply(a, a);\n    }\n\n    function skip(n) {\n        index += n;\n    }\n\n    function eof() {\n        return peek() == null;\n    }\n}\n\n//// exports\n\nlet FORMAT_PARSERS = [];\n\nlet registerFormatParser = calc.registerFormatParser = function(p) {\n    FORMAT_PARSERS.push(p);\n};\n\ncalc.parse = function(sheet, row, col, input, format) {\n    if (input instanceof Date) {\n        return { type: \"date\", value: calc.runtime.dateToSerial(input) };\n    }\n    if (typeof input == \"number\") {\n        return { type: \"number\", value: input };\n    }\n    if (typeof input == \"boolean\") {\n        return { type: \"boolean\", value: input };\n    }\n    input += \"\";\n    if (/^'/.test(input)) {\n        return {\n            type: \"string\",\n            value: input.substr(1)\n        };\n    }\n    // trivial (integer) percent values; more complex formats are handled below via\n    // registerFormatParser; this case could be dropped completely.\n    if (/^-?[0-9]+%$/.test(input)) {\n        let str = input.substr(0, input.length - 1);\n        let num = parseFloat(str);\n        if (!isNaN(num) && num === str) {\n            return {\n                type: \"percent\",\n                value: num / 100\n            };\n        }\n    }\n    if (/^=/.test(input)) {\n        input = input.substr(1);\n        if (/\\S/.test(input)) {\n            return parseFormula(sheet, row, col, input);\n        } else {\n            return {\n                type: \"string\",\n                value: \"=\" + input\n            };\n        }\n    }\n    for (let i = 0; i < FORMAT_PARSERS.length; ++i) {\n        let result = FORMAT_PARSERS[i](input, format);\n        if (result) {\n            return result;\n        }\n    }\n    if (input.toLowerCase() === \"true\") {\n        return { type: \"boolean\", value: true };\n    }\n    if (input.toLowerCase() === \"false\") {\n        return { type: \"boolean\", value: false };\n    }\n    let date = calc.runtime.parseDate(input, format);\n    if (date) {\n        return { type: \"date\", value: calc.runtime.dateToSerial(date) };\n    }\n    let num = parseFloat(input);\n    if (!isNaN(num) && input.length > 0 && num === input) {\n        format = null;\n        if (num !== Math.floor(num)) {\n            format = \"0.\" + String(num).split(\".\")[1].replace(/\\d/g, \"0\");\n        }\n        return {\n            type: \"number\",\n            value: num,\n            format: format\n        };\n    }\n    return {\n        type: \"string\",\n        value: input\n    };\n};\n\nfunction tokenize(input, row, col) {\n    let tokens = [];\n    input = TokenStream(input, { forEditor: true, row: row, col: col });\n    while (!input.eof()) {\n        tokens.push(next());\n    }\n    let tok = tokens[0];\n    if (tok.type === \"op\" && tok.value === \"=\") {\n        tok.type = \"startexp\";\n    }\n    return tokens;\n\n    function next() {\n        let tok = input.next();\n        if (tok.type === \"sym\") {\n            if (tok.upper === \"TRUE\") {\n                tok.type = \"bool\";\n                tok.value = true;\n            } else if (tok.upper === \"FALSE\") {\n                tok.type = \"bool\";\n                tok.value = false;\n            }\n        } else if (tok.type === \"ref\") {\n            tok = {\n                type  : \"ref\",\n                ref   : (row != null && col != null ? tok.absolute(row, col) : tok),\n                begin : tok.begin,\n                end   : tok.end\n            };\n        }\n        return tok;\n    }\n}\n\n// The `sqref` attribute in dataValidation (XLSX) will contain a space-separated list of\n// references.  This helper is called from excel-reader.js to parse them.\nfunction parseSqref(input, row, col) {\n    row = row || 0;\n    col = col || 0;\n    input = TokenStream(input, { row: row, col: col });\n    let refs = [];\n    while (!input.eof()) {\n        let ref = input.next();\n        if (ref.type !== \"ref\") {\n            throw new calc.runtime.ParseError(\"Expecting a reference but got: \" + JSON.stringify(ref));\n        }\n        refs.push(ref.absolute(row, col));\n    }\n    return refs;\n}\n\ncalc.parseNameDefinition = parseNameDefinition;\ncalc.parseFormula = parseFormula;\ncalc.parseReference = parseReference;\ncalc.compile = makeFormula;\ncalc.parseSqref = parseSqref;\n\ncalc.tokenize = tokenize;\n\n/* -----[ a few special formats ]----- */\n\n// various time formats\nregisterFormatParser(function(input, existingFormat){\n    let m, date = 0, format = \"\";\n    // have date part?\n    if (!existingFormat) {\n        existingFormat = culture().calendar.patterns.d;\n    }\n    if ((m = /^(\\d+)([-/.])(\\d+)\\2(\\d{2}(?:\\d{2})?)(\\s*)/.exec(input))) {\n        let mo = parseInt(m[1], 10);\n        let sep = m[2];\n        let da = parseInt(m[3], 10);\n        let yr = parseInt(m[4], 10);\n        if (yr < 30) {\n            yr += 2000;\n        } else if (yr < 100) {\n            yr += 1900;\n        }\n        let monthFirst = existingFormat ? existingFormat.indexOf(\"M\") < existingFormat.indexOf(\"d\") : true;\n        if (mo > 12 || !monthFirst) {\n            let tmp = mo;\n            mo = da;\n            da = tmp;\n            monthFirst = false;\n        }\n        if (!calc.runtime.validDate(yr, mo, da)) {\n            return null;\n        }\n        date = calc.runtime.packDate(yr, mo - 1, da);\n        if (date < 0) { date--; }\n        if (monthFirst) {\n            format = [\"mm\", \"dd\", \"yyyy\"].join(sep);\n        } else {\n            format = [\"dd\", \"mm\", \"yyyy\"].join(sep);\n        }\n        format += m[5];\n        input = input.substr(m[0].length); // skip the date\n    }\n    // hh:mm\n    if ((m = /^(\\d+):(\\d+)$/.exec(input))) {\n        let hh = parseInt(m[1], 10);\n        let mm = parseInt(m[2], 10);\n        return {\n            type   : \"date\",\n            format : format + \"hh:mm\",\n            value  : date + calc.runtime.packTime(hh, mm, 0, 0)\n        };\n    }\n    // mm:ss.ms\n    if ((m = /^(\\d+):(\\d+)(\\.\\d+)$/.exec(input))) {\n        let mm = parseInt(m[1], 10);\n        let ss = parseInt(m[2], 10);\n        let ms = parseFloat(m[3]) * 1000;\n        return {\n            type   : \"date\",\n            format : format + \"mm:ss.00\",\n            value  : date + calc.runtime.packTime(0, mm, ss, ms)\n        };\n    }\n    // hh:mm:ss\n    if ((m = /^(\\d+):(\\d+):(\\d+)$/.exec(input))) {\n        let hh = parseInt(m[1], 10);\n        let mm = parseInt(m[2], 10);\n        let ss = parseInt(m[3], 10);\n        return {\n            type   : \"date\",\n            format : format + \"hh:mm:ss\",\n            value  : date + calc.runtime.packTime(hh, mm, ss, 0)\n        };\n    }\n    // hh:mm:ss.ms\n    if ((m = /^(\\d+):(\\d+):(\\d+)(\\.\\d+)$/.exec(input))) {\n        let hh = parseInt(m[1], 10);\n        let mm = parseInt(m[2], 10);\n        let ss = parseInt(m[3], 10);\n        let ms = parseFloat(m[4]) * 1000;\n        return {\n            type   : \"date\",\n            format : format + \"hh:mm:ss.00\",\n            value  : date + calc.runtime.packTime(hh, mm, ss, ms)\n        };\n    }\n});\n\n// Support numeric formats with thousands separator and/or currency symbol, like `1,234,567.00`,\n// `$1234`, `123,456.78 $` etc.  I apologize for this code.\nregisterFormatParser(function(input){\n    let m, n;\n    const intlService = intl();\n    var numbers = intlService.localeInfo().numbers;\n    let comma = numbers.symbols.group;\n    let dot = numbers.symbols.decimal;\n    let localeCurrency = numbers.localeCurrency;\n    if (!localeCurrency && intlService.localeCurrency) {\n        localeCurrency = intlService.localeCurrency();\n    }\n    let currency = numbers.currencies[localeCurrency].symbol;\n    let rxnum = getNumberRegexp(comma, dot);\n    let rxcur = new RegExp(\"^\\\\s*\\\\\" + currency + \"\\\\s*\");\n    let sign = 1;\n    let format = \"\";\n    let suffix = \"\";\n    let has_currency = false;\n    let has_percent = false;\n\n    input = calc.runtime.InputStream(input.replace(/^\\s+|\\s+$/g, \"\"));\n\n    // has minus before currency?\n    if (input.skip(/^-\\s*/)) {\n        sign = -1;\n    }\n\n    // has currency before number?\n    if ((m = input.skip(rxcur))) {\n        has_currency = true;\n        format += '\"' + m[0] + '\"';\n    }\n\n    // has minus after currency?\n    if (input.skip(/^-\\s*/)) {\n        if (sign < 0) {\n            return null;    // not a number\n        }\n        sign = -1;\n    }\n\n    // read the number itself\n    if (!(n = input.skip(rxnum))) {\n        return null;        // not a number\n    }\n    format += \"0\";\n\n    // has currency after number?\n    if ((m = input.skip(rxcur))) {\n        if (has_currency) {\n            return null;    // either before or after, not both.\n        }\n        has_currency = true;\n        suffix = '\"' + m[0] + '\"';\n    }\n\n    // has percent after number?\n    if (!has_currency && (m = input.skip(/^\\s*%\\s*/))) {\n        has_percent = true;\n        suffix = m[0];      // no quotes this time, % is special in format\n    }\n\n    if (!input.eof()) {\n        return null;        // should anything else follow, not a number\n    }\n\n    if (n[2] || has_currency) {\n        format = format.replace(\"0\", \"#\");\n        format += \",0\";\n    }\n    if (n[3]) {\n        format += \".\" + repeat(\"0\", n[3].length - 1);\n    }\n    let value = n[0]\n        .replace(new RegExp(\"\\\\\" + comma, \"g\"), \"\")\n        .replace(new RegExp(\"\\\\\" + dot, \"g\"), \".\");\n\n    value = parseFloat(value);\n    if (has_percent) {\n        value /= 100;\n    }\n\n    format += suffix;\n    if (has_currency) {\n        format += ';-' + format;\n    }\n\n    return {\n        type: \"number\",\n        currency: has_currency,\n        format: format,\n        value: sign * value\n    };\n});\n\nregisterFormatParser(function(input){\n    let m;\n    if ((m = /^([0-9]*)\\.([0-9]+)(\\s*%)$/.exec(input))) {\n        return {\n            type: \"number\",\n            value: parseFloat(input) / 100,\n            format: \"0.\" + repeat(\"0\", m[2].length) + m[3]\n        };\n    }\n});\n\nlet NUMBER_FORMAT_RX = {};\nfunction getNumberRegexp(comma, dot) {\n    let id = comma + dot;\n    let rx = NUMBER_FORMAT_RX[id];\n    if (!rx) {\n        rx = \"^(\\\\d+(COM\\\\d{3})*(DOT\\\\d+)?)\";\n        rx = rx.replace(/DOT/g, \"\\\\\" + dot).replace(/COM/g, \"\\\\\" + comma);\n        rx = new RegExp(rx);\n        NUMBER_FORMAT_RX[id] = rx;\n    }\n    return rx;\n}\n\nfunction repeat(str, len) {\n    let out = \"\";\n    while (len-- > 0) {\n        out += str;\n    }\n    return out;\n}\n\n/*************************************************************************************/\n\nclass FormulaContext {\n    constructor(workbook) {\n        this.workbook = workbook;\n    }\n\n    getRefCells(ref, hiddenInfo, fsheet, frow, fcol, wantNulls) {\n        let sheet, formula, value, i;\n        if (ref instanceof CellRef) {\n            sheet = this.workbook.sheetByName(ref.sheet);\n            if (!sheet || !ref.valid()) {\n                return [{\n                    value: new CalcError(\"REF\")\n                }];\n            }\n            formula = sheet.formula(ref);\n            value = sheet.range(ref.row, ref.col).value();\n\n            if (wantNulls || formula != null || value != null) {\n                return [{\n                    formula: formula,\n                    value: value,\n                    row: ref.row,\n                    col: ref.col,\n                    sheet: ref.sheet,\n                    hidden: hiddenInfo ? (sheet.columnWidth(ref.col) === 0 || sheet.rowHeight(ref.row) === 0) : false\n                }];\n            } else {\n                return [];\n            }\n        }\n        if (ref instanceof RangeRef) {\n            i = this.workbook.sheetIndex(ref.sheet);\n            let states = [], n = i;\n            if (ref.endSheet) {\n                // \"3D\" reference.\n                n = this.workbook.sheetIndex(ref.endSheet);\n                if (i > n) {\n                    let tmp = i;\n                    i = n;\n                    n = tmp;\n                }\n            }\n\n            if (i < 0 || n < 0 || !ref.valid()) {\n                return [{\n                    value: new CalcError(\"REF\")\n                }];\n            }\n\n            // XXX: This is nicer, but significantly slower.\n            // Should investigate why, or add some options to make\n            // it faster (i.e. probably because it adds all cell\n            // properties, while we only need value and formula).\n            //\n            //     let add = function(row, col, data){\n            //         data.row = row;\n            //         data.col = col;\n            //         data.sheet = sheet.name();\n            //         states.push(data);\n            //     };\n            //     while (i <= n) {\n            //         sheet = this.workbook.sheetByIndex(i++);\n            //         sheet.forEach(ref, add);\n            //     }\n            //\n            // For now keep doing it \"manually\".\n\n            while (i <= n) {\n                sheet = this.workbook.sheetByIndex(i++);\n                let tl = sheet._grid.normalize(ref.topLeft);\n                let br = sheet._grid.normalize(ref.bottomRight);\n\n                let startCellIndex = sheet._grid.cellRefIndex(tl);\n                let endCellIndex = sheet._grid.cellRefIndex(br);\n\n                let values = sheet._properties.iterator(\"value\", startCellIndex, endCellIndex);\n\n                for (let col = tl.col; col <= br.col; ++col) {\n                    for (let row = tl.row; row <= br.row; ++row) {\n                        let index = sheet._grid.index(row, col);\n                        formula = sheet._properties.get(\"formula\", index);\n                        value = values.at(index);\n                        if (wantNulls || formula != null || value != null) {\n                            states.push({\n                                formula : formula,\n                                value   : value,\n                                row     : row,\n                                col     : col,\n                                sheet   : sheet.name(),\n                                hidden  : hiddenInfo ? (sheet.columnWidth(col) === 0 || sheet.rowHeight(row) === 0) : false\n                            });\n                        }\n                    }\n                }\n            }\n\n            return states;\n        }\n        if (ref instanceof UnionRef) {\n            let a = [];\n            for (i = 0; i < ref.refs.length; ++i) {\n                a = a.concat(this.getRefCells(ref.refs[i], hiddenInfo, fsheet, frow, fcol));\n            }\n            return a;\n        }\n        if (ref instanceof NameRef) {\n            let val = this.nameValue(ref, fsheet, frow, fcol);\n            // XXX: revise this\n            if (val instanceof Ref) {\n                return this.getRefCells(val, hiddenInfo, fsheet, frow, fcol);\n            }\n            return [{\n                value: val == null ? new CalcError(\"NAME\") : val\n            }];\n        }\n        return [];\n    }\n\n    isMerged(ref) {\n        let sheet = this.workbook.sheetByName(ref.sheet);\n        return sheet.isMerged(ref);\n    }\n\n    nameValue(ref, fsheet, frow, fcol) {\n        let val;\n        if (ref.hasSheet()) {\n            // qualified name\n            val = this.workbook.nameValue(this._displayString(ref.print()));\n        } else {\n            // try local name\n            ref = ref.clone().setSheet(fsheet, true);\n            val = this.workbook.nameValue(this._displayString(ref.print()));\n            if (val == null) {\n                // try global name\n                val = this.workbook.nameValue(this._displayString(ref.name));\n            }\n            if (val == null) {\n                // try without _displayString\n                val = this.workbook.nameValue(ref.print()) || this.workbook.nameValue(ref.name);\n            }\n        }\n        if (val instanceof Ref) {\n            val = val.absolute(frow, fcol);\n        }\n        return val;\n    }\n\n    getData(ref, fsheet, frow, fcol, wantNulls) {\n        let single = ref instanceof CellRef;\n        if (ref instanceof NameRef) {\n            single = this.workbook.nameValue(ref.name) instanceof CellRef;\n        }\n        let data = this.getRefCells(ref, false, fsheet, frow, fcol, wantNulls).map(function(cell) {\n            let val = cell.value;\n            if (val instanceof calc.runtime.Formula) {\n                val = val.value;\n            }\n            return val;\n        });\n        return single ? data[0] : data;\n    }\n\n    onFormula(f) {\n        let sheet = this.workbook.sheetByName(f.sheet);\n        let row = f.row, col = f.col, value = f.value;\n        let currentFormula = sheet.formula({ row: row, col: col });\n        if (currentFormula !== f) {\n            // could have been deleted or modified in the mean time,\n            // if the formula was asynchronous.  ignore this result.\n            return false;\n        }\n\n        let arrayRange = f.arrayFormulaRange;\n        if (arrayRange) {\n            // `value` will always be a Matrix in this case;\n            // enforced in runtime.js (Context::_resolve).  We\n            // must fill only cells in arrayRange.\n            let tlRow, tlCol;\n            let width = value.width;\n            let height = value.height;\n            sheet.forEach(arrayRange, function(row, col) {\n                if (tlRow === undefined) {\n                    tlRow = row;\n                    tlCol = col;\n                }\n                let vrow = row - tlRow;\n                let vcol = col - tlCol;\n                let val;\n                if (vrow < height && vcol < width) {\n                    val = value.get(vrow, vcol);\n                } else {\n                    val = new CalcError(\"N/A\");\n                }\n                sheet._value(row, col, val);\n            });\n        }\n        else {\n            // formulas may return references.  if a range or union,\n            // we'll just save the first cell.\n            if (value instanceof Ref) {\n                value = this.getData(value, f.sheet, row, col);\n                if (Array.isArray(value)) {\n                    value = value[0];\n                }\n                if (value === undefined) {\n                    value = null; // clear contents\n                }\n            }\n\n            // when not saved as an array formula, a formula\n            // returning a Matrix will just save the first value.\n            if (value instanceof calc.runtime.Matrix) {\n                value = value.get(0, 0);\n            }\n\n            sheet._value(row, col, value);\n        }\n\n        clearTimeout(sheet._formulaContextRefresh);\n        sheet._formulaContextRefresh = setTimeout(function() {\n            sheet.batch(function() {}, { layout: true });\n        }, 50);\n\n        return true;\n    }\n    _displayString(val) {\n        if (/^[a-z_][a-z0-9_]*$/i.test(val)) {\n            return val;\n        }\n        return \"'\" + val.replace(/\\x27/g, \"\\\\'\") + \"'\";\n    }\n}\n\nclass ValidationFormulaContext extends FormulaContext {\n    onFormula() {\n        return true;\n    }\n}\n\ncalc.ValidationFormulaContext = ValidationFormulaContext;\n\n/* eslint-disable no-param-reassign */\n\nlet KEY_NAMES$1 = {\n    8: 'backspace',\n    9: 'tab',\n    13: 'enter',\n    27: 'esc',\n    37: 'left',\n    38: 'up',\n    39: 'right',\n    40: 'down',\n    35: 'end',\n    36: 'home',\n    32: 'spacebar',\n    33: 'pageup',\n    34: 'pagedown',\n    46: 'delete',\n    113: ':edit'\n};\n\nconst Mac = () => navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n\nlet isAlphaNum = function(keyCode) {\n    if ((keyCode > 47 && keyCode < 58) || // number keys\n        (keyCode > 64 && keyCode < 91) || // letter keys\n        (keyCode > 95 && keyCode < 112) || // numpad keys\n        (keyCode > 185 && keyCode < 193) || // ;=,-./` (in order)\n        (keyCode > 218 && keyCode < 223) || // [\\]' (in order)\n        (keyCode === 229)                   // combined key event?\n        ) {\n        return true;\n    }\n\n    return false;\n};\n\nlet keyName = function(event) {\n    let keyCode = event.keyCode;\n    let name = KEY_NAMES$1[keyCode];\n\n    if (!name && isAlphaNum(keyCode)) {\n        name = \":alphanum\";\n    }\n\n    // https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key\n    //\n    // Fix for https://github.com/telerik/kendo-ui-core/issues/2284\n    // (starting editor with `=` on Firefox)\n    if (!name && event.key && event.key.length === 1) {\n        name = \":alphanum\";\n    }\n\n    return name;\n};\n\nclass EventListener {\n    constructor(target, observer, handlers) {\n        this._handlers = {};\n        this.target = target;\n        this._observer = observer || window;\n\n        this.keyDownProxy = this.keyDown.bind(this);\n        this.mouseProxy = this.mouse.bind(this);\n        this.touchProxy = this.touch.bind(this);\n        this.threshold = 5;\n        this._pressLocation = null;\n\n        this._attachEvent(target, \"keydown\", this.keyDownProxy);\n        this._attachEvent(target, \"contextmenu mousedown cut copy paste scroll wheel click dblclick focus\", this.mouseProxy);\n        this._attachEvent(target, \"touchmove touchend\", this.touchProxy);\n\n        this._attachEvent(document.documentElement, \"mousemove mouseup\", this.mouseProxy);\n        this._attachEvent(document.documentElement, \"touchmove touchend\", this.touchProxy);\n\n        if (handlers) {\n            for (let key in handlers) {\n                this.on(key, handlers[key]);\n            }\n        }\n    }\n\n    _attachEvent(element, events, handler) {\n        events.split(' ').forEach(eventType => { element.addEventListener(eventType, handler); });\n    }\n\n    _removeEvent(element, events, handler) {\n        events.split(' ').forEach(eventType => { element.removeEventListener(eventType, handler); });\n    }\n\n    keyDown(e) {\n        // Do not handle keys for Toolbar Tab switch shortcuts\n        if (e.altKey && (e.key === \"n\" || e.key === \"h\" || e.key === \"a\")) {\n            return;\n        }\n\n        this.handleEvent(e, keyName(e));\n    }\n\n    touch(e) {\n        this.handleEvent(e, e.type);\n    }\n\n    mouse(e) {\n        let rightClick;\n\n        if (e.which) {\n            rightClick = (e.which === 3);\n        } else if (e.button) {\n            rightClick = (e.button === 2);\n        }\n\n        let type = e.type;\n\n        if (type === \"mousedown\") {\n            if (rightClick) {\n                type = \"rightmousedown\";\n            } else {\n                this._pressLocation = { x: e.pageX, y: e.pageY };\n            }\n        }\n\n        if (type === \"mouseup\") {\n            if (!rightClick) {\n                this._pressLocation = null;\n            }\n        }\n\n        if (type === \"mousemove\" && this._pressLocation) {\n            let dx = this._pressLocation.x - e.pageX;\n            let dy = this._pressLocation.y - e.pageY;\n            let distance = Math.sqrt(dx * dx + dy * dy);\n\n            if (distance > this.threshold) {\n                type = \"mousedrag\";\n            }\n        }\n\n        this.handleEvent(e, type);\n    }\n\n    handleEvent(e, name) {\n        let eventKey = \"\";\n\n        e.mod = Mac() ? e.metaKey : (e.ctrlKey && !e.altKey);\n\n        if (e.altKey) {\n            eventKey += \"alt+\";\n        }\n\n        if (e.shiftKey) {\n            eventKey += \"shift+\";\n        }\n\n        if (e.ctrlKey) {\n            eventKey += \"ctrl+\";\n        }\n\n        eventKey += name;\n\n        let catchAllHandler = this._handlers['*+' + name];\n\n        if (catchAllHandler) {\n            catchAllHandler.call(this._observer, e, eventKey);\n        }\n\n        let handler = this._handlers[eventKey];\n\n        if (handler) {\n            handler.call(this._observer, e, eventKey);\n        }\n    }\n\n    on(event, callback) {\n        let handlers = this._handlers;\n\n        if (typeof callback === \"string\") {\n            callback = this._observer[callback];\n        }\n\n        if (typeof event === \"string\") {\n            event = event.split(\",\");\n        }\n\n        event.forEach(function(e) {\n            handlers[e] = callback;\n        });\n    }\n\n    destroy() {\n        this._removeEvent(this.target, \"keydown\", this.keyDownProxy);\n        this._removeEvent(this.target, \"contextmenu mousedown cut copy paste scroll wheel click dblclick focus\", this.mouseProxy);\n        this._removeEvent(this.target, \"touchmove touchend\", this.touchProxy);\n\n        this._removeEvent(document.documentElement, \"mousemove mouseup\", this.mouseProxy);\n        this._removeEvent(document.documentElement, \"touchmove touchend\", this.touchProxy);\n    }\n}\n\n/* eslint-disable default-case */\n/* eslint-disable no-else-return */\n/* eslint-disable key-spacing */\n/* eslint-disable eqeqeq */\n/* eslint-disable brace-style */\n/* eslint-disable consistent-return */\n\n\nlet alphaNumRegExp = /:alphanum$/;\n\nlet ACTIONS = {\n    \"up\": \"up\",\n    \"down\": \"down\",\n    \"left\": \"left\",\n    \"right\": \"right\",\n    \"home\": \"first-col\",\n    \"end\": \"last-col\",\n    \"ctrl+left\": \"word-left\",\n    \"ctrl+right\": \"word-right\",\n    \"ctrl+up\": \"word-up\",\n    \"ctrl+down\": \"word-down\",\n    \"ctrl+home\": \"first\",\n    \"ctrl+end\": \"last\",\n    \"pageup\": \"prev-page\",\n    \"pagedown\": \"next-page\"\n};\n\nlet ENTRY_ACTIONS = {\n    \"tab\": \"next\",\n    \"shift+tab\": \"previous\",\n    \"enter\": \"lower\",\n    \"shift+enter\": \"upper\",\n    \"delete\": \"clearContents\",\n    \"backspace\": \"clearContents\",\n    \"shift+:alphanum\": \"edit\",\n    \"alt+:alphanum\": \"edit\",\n    \":alphanum\": \"edit\",\n    \"ctrl+:alphanum\": \"ctrl\",\n    \"alt+ctrl+:alphanum\": \"edit\",\n    \":edit\": \"edit\"\n};\n\nlet CONTAINER_EVENTS = {\n    \"wheel\": \"onWheel\",\n    \"*+mousedown\": \"onMouseDown\",\n    \"contextmenu\": \"onContextMenu\",\n    \"*+mousedrag\": \"onMouseDrag\",\n    \"*+mouseup\": \"onMouseUp\",\n    \"*+dblclick\": \"onDblClick\",\n    \"mousemove\": \"onMouseMove\"\n};\n\nlet CLIPBOARD_EVENTS = {\n    \"pageup\": \"onPageUp\",\n    \"pagedown\": \"onPageDown\",\n    \"mouseup\": \"onMouseUp\",\n    \"*+cut\": \"onCut\",\n    \"*+paste\": \"onPaste\",\n    \"*+copy\": \"onCopy\"\n};\n\nlet EDITOR_EVENTS = {\n    \"esc\": \"onEditorEsc\",\n    \"enter\": \"onEditorBlur\",\n    \"alt+enter\": \"insertNewline\",\n    \"shift+enter\": \"onEditorBlur\",\n    \"tab\": \"onEditorBlur\",\n    \"shift+tab\": \"onEditorBlur\",\n    \"shift+ctrl+enter\": \"onEditorArrayFormula\"\n};\n\nlet FORMULABAR_EVENTS = Object.assign({ focus: \"onEditorBarFocus\" }, EDITOR_EVENTS);\nlet FORMULAINPUT_EVENTS = Object.assign({ focus: \"onEditorCellFocus\" }, EDITOR_EVENTS);\n\nlet SELECTION_MODES = {\n    cell: \"range\",\n    rowheader: \"row\",\n    columnheader: \"column\",\n    topcorner: \"sheet\",\n    autofill: \"autofill\"\n};\n\n// function toActionSelector(selectors) {\n//     return selectors.map(function(action) {\n//         return '[data-action=\"' + action + '\"]';\n//     }).join(\",\");\n// }\n\n// let COMPOSITE_UNAVAILABLE_ACTION_SELECTORS = toActionSelector([ 'cut', 'copy', 'paste', 'insert-left', 'insert-right', 'insert-above', 'insert-below' ]);\n// let UNHIDE_ACTION_SELECTORS = toActionSelector([ 'unhide-row', 'unhide-column' ]);\n\nlet ACTION_KEYS = [];\nlet SHIFT_ACTION_KEYS = [];\nlet ENTRY_ACTION_KEYS = [];\n\nfor (let key in ACTIONS) {\n    ACTION_KEYS.push(key);\n    SHIFT_ACTION_KEYS.push(\"shift+\" + key);\n}\n\nfor (let key in ENTRY_ACTIONS) {\n    ENTRY_ACTION_KEYS.push(key);\n}\n\nCLIPBOARD_EVENTS[ACTION_KEYS] = \"onAction\";\nCLIPBOARD_EVENTS[SHIFT_ACTION_KEYS] = \"onShiftAction\";\nCLIPBOARD_EVENTS[ENTRY_ACTION_KEYS] = \"onEntryAction\";\n\nFORMULAINPUT_EVENTS[ACTION_KEYS] = \"onEditorAction\";\nFORMULAINPUT_EVENTS[SHIFT_ACTION_KEYS] = \"onEditorShiftAction\";\n\nclass Controller {\n    constructor(view, workbook) {\n        this.view = view;\n        this.workbook(workbook);\n        this.container = view.container;\n        this.clipboardElement = view.clipboard;\n        // this.cellContextMenu = view.cellContextMenu;\n        // this.rowHeaderContextMenu = view.rowHeaderContextMenu;\n        // this.colHeaderContextMenu = view.colHeaderContextMenu;\n        // this.drawingContextMenu = view.drawingContextMenu;\n        this.scroller = view.scroller;\n        this.tabstrip = view.tabstrip;\n        this.sheetsbar = view.sheetsbar;\n\n        view.nameEditor.bind(\"enter\", this.onNameEditorEnter.bind(this));\n        view.nameEditor.bind(\"cancel\", this.onNameEditorCancel.bind(this));\n        view.nameEditor.bind(\"select\", this.onNameEditorSelect.bind(this));\n        view.nameEditor.bind(\"delete\", this.onNameEditorDelete.bind(this));\n\n        this.editor = view.editor;\n        this.editor.bind(\"change\", this.onEditorChange.bind(this));\n        this.editor.bind(\"activate\", this.onEditorActivate.bind(this));\n        this.editor.bind(\"deactivate\", this.onEditorDeactivate.bind(this));\n        this.editor.bind(\"update\", this.onEditorUpdate.bind(this));\n\n        this.listener = new EventListener(this.container, this, CONTAINER_EVENTS);\n\n        this.scrollHandler = this.onScroll.bind(this);\n        this.mouseDownHandler = this.onMouseDown.bind(this);\n\n        view.scroller.addEventListener(\"scroll\", this.scrollHandler);\n        view.scroller.addEventListener(\"mousedown\", this.mouseDownHandler);\n\n        this._enableEditorEvents();\n\n        if (this.sheetsbar) {\n            this.sheetsbar.bind(\"select\", this.onSheetBarSelect.bind(this));\n            this.sheetsbar.bind(\"reorder\", this.onSheetBarReorder.bind(this));\n            this.sheetsbar.bind(\"rename\", this.onSheetBarRename.bind(this));\n            this.sheetsbar.bind(\"remove\", this.onSheetBarRemove.bind(this));\n        }\n\n        // this.cellContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n        // this.rowHeaderContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n        // this.colHeaderContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n        // this.drawingContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n\n        // this is necessary for Windows to catch prevent context menu correctly\n        // this.cellContextMenu.element\n        //     .add(this.rowHeaderContextMenu.element)\n        //     .add(this.colHeaderContextMenu.element)\n        //     .add(this.drawingContextMenu.element)\n        //     .on(\"contextmenu\", false);\n\n        // if (this.tabstrip) {\n        //     this.tabstrip.bind(\"action\", this.onCommandRequest.bind(this));\n        //     this.tabstrip.bind(\"dialog\", this.onDialogRequest.bind(this));\n        // }\n    }\n\n    executeCommand(options) {\n        return this._execute(options);\n    }\n\n    _enableEditorEvents(enable) {\n        if (enable === undefined || enable) {\n            this.keyListener = new EventListener(this.clipboardElement, this, CLIPBOARD_EVENTS);\n            this.barKeyListener = new EventListener(this.editor.barElement(), this, FORMULABAR_EVENTS);\n            this.inputKeyListener = new EventListener(this.editor.cellElement(), this, FORMULAINPUT_EVENTS);\n        } else {\n            this.keyListener.destroy();\n            this.barKeyListener.destroy();\n            this.inputKeyListener.destroy();\n        }\n    }\n\n    _execute(options) {\n        let result = this._workbook.execute(options);\n\n        if (options.command === \"EditCommand\" && !result) {\n            this._workbook.trigger(\"change\", { editorClose: true });\n        }\n\n        if (result) {\n            this._preventNavigation = true;\n            if (result.reason === \"error\") {\n                this.editor.deactivate(true); // make sure we don't call any change hooks\n                this.view.showError(result, function() {\n                    // we only get here in case of a validation error when the user decided to retry.\n                    // this.activateEditor(false);\n                    // reset to last input from user\n                    // this.editor.value(this._lastEditorValue);\n                    // however, set _value manually such that it'll detect change properly.  ugly :-\\\n                    // this.editor._value = this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell());\n                    // seems like a nice UX to have the whole input selected\n                    // this.editor.select();\n                }.bind(this));\n            } else {\n                this.view.openDialog(result.reason);\n            }\n        }\n\n        return result;\n    }\n\n    _activeTooltip() {\n        return this._workbook.activeSheet().activeCell().simplify().toString();\n    }\n\n    onContextMenuSelect(e) {\n        let action = e.item.getAttribute('data-action'); // $(e.item).data(\"action\");\n        let command;\n        switch (action) {\n        case \"cut\":\n            command = { command: \"ToolbarCutCommand\", options: { workbook: this._workbook } };\n            break;\n        case \"copy\":\n            command = { command: \"ToolbarCopyCommand\", options: { workbook: this._workbook } };\n            break;\n        case \"paste\":\n            command = { command: \"ToolbarPasteCommand\", options: { workbook: this._workbook } };\n            break;\n        case \"delete-drawing\":\n            command = { command: \"DeleteDrawingCommand\", options: { drawing: this.navigator._sheet._activeDrawing } };\n            break;\n        case \"bring-to-front\":\n            command = { command: \"BringToFrontCommand\", options: { drawing: this.navigator._sheet._activeDrawing } };\n            break;\n        case \"send-to-back\":\n            command = { command: \"SendToBackCommand\", options: { drawing: this.navigator._sheet._activeDrawing } };\n            break;\n        case \"unmerge\":\n            command = { command: \"MergeCellCommand\", options: { value: \"unmerge\" } };\n            break;\n        case \"merge\":\n            this.view.openDialog(\"merge\");\n            break;\n        case \"hide-row\":\n            command = { command: \"HideLineCommand\", options: { axis: \"row\" } };\n            break;\n        case \"hide-column\":\n            command = { command: \"HideLineCommand\", options: { axis: \"column\" } };\n            break;\n        case \"unhide-row\":\n            command = { command: \"UnHideLineCommand\", options: { axis: \"row\" } };\n            break;\n        case \"unhide-column\":\n            command = { command: \"UnHideLineCommand\", options: { axis: \"column\" } };\n            break;\n        case \"delete-row\":\n            command = { command: \"DeleteRowCommand\" };\n            break;\n        case \"delete-column\":\n            command = { command: \"DeleteColumnCommand\" };\n            break;\n        }\n\n        if (command) {\n            this._execute(command);\n        }\n    }\n\n    onSheetBarRemove(e) {\n        let sheet = this._workbook.sheetByName(e.name);\n\n        //TODO: move to model!\n        if (!sheet) {\n            return;\n        }\n\n        this._workbook.removeSheet(sheet);\n    }\n\n    destroy() {\n        this.view.scroller.removeEventListener(\"scroll\", this.scrollHandler);\n        this.view.scroller.removeEventListener(\"mousedown\", this.mouseDownHandler);\n\n        this.listener.destroy();\n        this._enableEditorEvents(false);\n        this.keyListener.destroy();\n        this.inputKeyListener.destroy();\n    }\n\n    onSheetBarSelect(e) {\n        let sheet;\n        let workbook = this._workbook;\n\n        if (e.isAddButton) {\n            if (this._workbook.trigger(\"insertSheet\")) {\n                return;\n            }\n\n            sheet = workbook.insertSheet();\n        } else {\n            sheet = workbook.sheetByName(e.name);\n        }\n\n        //TODO: move to model\n        if (workbook.activeSheet().name() !== sheet.name()) {\n            if (this._workbook.trigger(\"selectSheet\", { sheet: sheet })) {\n                return;\n            }\n\n            if (!this.editor.canInsertRef(false)) {\n                this.editor.deactivate();\n            }\n\n            workbook.activeSheet(sheet);\n        }\n    }\n\n    onSheetBarReorder(e) {\n        let workbook = this._workbook;\n        let sheet = workbook.sheetByIndex(e.oldIndex);\n        let activeSheet = workbook.activeSheet();\n        let activeSheetName = activeSheet.name();\n\n        workbook.moveSheetToIndex(sheet, e.newIndex);\n\n        if (activeSheetName !== sheet.name()) {\n            if (workbook.trigger(\"selectSheet\", { sheet: sheet })) {\n                workbook.activeSheet(activeSheet);\n                return;\n            }\n\n            if (!this.editor.canInsertRef(false)) {\n                this.editor.deactivate();\n            }\n\n            workbook.activeSheet(sheet);\n        }\n    }\n\n    onSheetBarRename(e) {\n        let sheet = this._workbook.sheetByIndex(e.sheetIndex);\n\n        if (this._workbook.sheetByName(e.name)) {\n            this.view.showError({ reason: \"error\", type: \"duplicateSheetName\" });\n            return;\n        }\n\n        this._workbook.renameSheet(sheet, e.name);\n\n        this.clipboardElement.focus();\n    }\n\n    sheet(sheet) {\n        this.navigator = sheet.navigator();\n        this.axisManager = sheet.axisManager();\n    }\n\n    workbook(workbook) {\n        this._workbook = workbook;\n        this.clipboard = workbook.clipboard();\n        workbook.bind(\"commandRequest\", this.onCommandRequest.bind(this));\n    }\n\n    refresh() {\n        let editor = this.editor;\n        let workbook = this._workbook;\n        let sheet = workbook.activeSheet();\n\n        this._viewPortHeight = this.view.scroller.clientHeight;\n        this.navigator.height(this._viewPortHeight);\n\n        if (!editor.isActive() && !this.isEditorDisabled) {\n            editor.enable(sheet.selection().enable() !== false);\n            this.resetEditorValue();\n        }\n\n        let ref = sheet.selection()._ref.simplify();\n        let def = this._workbook.nameForRef(ref, sheet.name());\n        this.view.nameEditor.value(def.name);\n    }\n\n    onScroll() {\n        this.view.render({ scroll: true });\n    }\n\n    onWheel(event) {\n        let deltaX = event.deltaX;\n        let deltaY = event.deltaY;\n\n        if (event.deltaMode === 1) {\n            deltaX *= 10;\n            deltaY *= 10;\n        }\n\n        this.scrollWith(deltaX, deltaY);\n\n        event.preventDefault();\n    }\n\n    onAction(event, action) {\n        let sheet = this._workbook.activeSheet();\n        sheet._activeDrawing = null;\n        this.navigator.moveActiveCell(ACTIONS[action]);\n        event.preventDefault();\n    }\n\n    onPageUp() {\n        this.scrollDown(-this._viewPortHeight);\n    }\n\n    onPageDown() {\n        this.scrollDown(this._viewPortHeight);\n    }\n\n    onEntryAction(event, action) {\n        let sheet = this._workbook.activeSheet();\n\n        if (event.mod) {\n            let key = String.fromCharCode(event.keyCode);\n            let shouldPrevent = true;\n\n            switch (key) {\n            case \"A\":\n                sheet._activeDrawing = null;\n                this.navigator.selectAll();\n                break;\n            case \"Y\":\n                this._workbook.undoRedoStack.redo();\n                break;\n            case \"Z\":\n                this._workbook.undoRedoStack.undo();\n                break;\n            default:\n                shouldPrevent = false;\n                break;\n            }\n            if (shouldPrevent) {\n                event.preventDefault();\n            }\n        } else {\n            let disabled = sheet.selection().enable() === false;\n            let casual = action !== \":edit\";\n\n            if (action == \"delete\" || action == \"backspace\") {\n                if (sheet._activeDrawing) {\n                    this._execute({\n                        command: \"DeleteDrawingCommand\",\n                        options: { drawing: sheet._activeDrawing }\n                    });\n                } else if (!disabled) {\n                    this._execute({ command: \"ClearContentCommand\" });\n                }\n                event.preventDefault();\n            } else if (alphaNumRegExp.test(action) || !casual) {\n                sheet._activeDrawing = null;\n                if (disabled) {\n                    event.preventDefault();\n                    return;\n                }\n                if (casual) {\n                    this.editor.value(\"\");\n                }\n                this.activateEditor(casual);\n            } else {\n                this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                event.preventDefault();\n            }\n        }\n    }\n\n    onShiftAction(event, action) {\n        this.navigator.modifySelection(ACTIONS[action.replace(\"shift+\", \"\")], this.appendSelection);\n        event.preventDefault();\n    }\n\n    onMouseMove(event) {\n        let sheet = this._workbook.activeSheet();\n\n        if (sheet.resizingInProgress() || sheet.selectionInProgress()) {\n            return;\n        }\n\n        let object = this.objectAt(event);\n        if (object.type === \"columnresizehandle\" || object.type === \"rowresizehandle\") {\n            sheet.positionResizeHandle(object.ref);\n        } else {\n            sheet.removeResizeHandle();\n        }\n\n        sheet._renderComment(object.type == \"cell\" ? object.ref : null);\n    }\n\n    onMouseDown(event) {\n        let object = this.objectAt(event);\n        if (object.pane) {\n            this.originFrame = object.pane;\n        }\n\n        if (this._startResizingDrawing(event, object)) {\n            event.stopPropagation();\n            return;\n        }\n\n        let sheet = this._workbook.activeSheet();\n        // let win = this.container.closest('[' + kendo.attr(\"role\") + '=\"window\"]');\n        // if (win.length) {\n        //     win = kendo.widgetInstance(win);\n        //     if (win && win.options.modal) {\n        //         event.stopPropagation();\n        //     }\n        // }\n\n        sheet._activeDrawing = null;\n        if (object.type === \"drawing\") {\n            sheet._activeDrawing = object.drawing;\n            object.copy = object.drawing.clone();\n            object.startBox = sheet.drawingBoundingBox(object.copy);\n            sheet.startDragging(object);\n            sheet.triggerChange({ dragging: true });\n            event.preventDefault();\n            return;\n        }\n\n        if (object.type === \"outside\") {\n            event.preventDefault();\n            event.stopPropagation();\n            return;\n        }\n\n        if (object.type === \"editor\") {\n            // XXX: canceling the edits, because they might not\n            // validate.  Not sure it's the Right Thing.\n            this.onEditorEsc();\n            this.openCustomEditor();\n            event.preventDefault();\n            return;\n        }\n\n        if (this.editor.canInsertRef(false) && object.ref) {\n            this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n            this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey, this.view);\n            event.preventDefault();\n            return;\n        } else {\n            this._preventNavigation = false;\n            this.editor.deactivate();\n            if (this._preventNavigation) {\n                return;     // validation error\n            }\n        }\n\n        if (object.type === \"columnresizehandle\" || object.type === \"rowresizehandle\") {\n            sheet.startResizing({ x: object.x, y: object.y });\n            event.preventDefault();\n            return;\n        }\n\n        if (object.type === \"filtericon\") {\n            this.openFilterMenu(event);\n            event.preventDefault();\n            return;\n        }\n\n        this._selectionMode = SELECTION_MODES[object.type];\n        this.appendSelection = event.mod;\n        this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey, this.view);\n    }\n\n    _startResizingDrawing(event) {\n        let handle = event.target.closest(\".k-spreadsheet-drawing-handle\");\n        if (handle) {\n            let location = this.translateCoords(event);\n            let direction = handle.getAttribute(\"data-direction\");\n            let sheet = this._workbook.activeSheet();\n            let drawing = sheet._activeDrawing;\n            sheet.startDragging({\n                pane     : this.originFrame,\n                drawing  : drawing,\n                copy     : drawing.clone(),\n                startBox : sheet.drawingBoundingBox(drawing),\n                resize   : direction,\n                //aspect   : drawing.width / drawing.height,\n                startX   : location.x,\n                startY   : location.y\n            });\n            return true;\n        }\n    }\n\n    onContextMenu(event) {\n        let sheet = this._workbook.activeSheet();\n\n        event.preventDefault();\n\n        if (sheet.resizingInProgress() || sheet.draggingInProgress()) {\n            return;\n        }\n\n        // emit close here if necessary\n\n        let object = this.objectAt(event);\n\n        if (object.type === \"columnresizehandle\" || object.type === \"rowresizehandle\") {\n            return;\n        }\n\n        if (object.ref) {\n            this.navigator.selectForContextMenu(object.ref, SELECTION_MODES[object.type]);\n        } else if (object.type == \"drawing\") {\n            this.navigator.selectDrawingForContextMenu(object.drawing);\n        }\n\n        let isComposite = this.navigator._sheet.select() instanceof UnionRef;\n        let showUnhide = false;\n        let showUnmerge = false;\n\n        if (object.type == \"columnheader\") {\n            showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenColumns();\n        } else if (object.type == \"rowheader\") {\n            showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenRows();\n        } else if (object.type == \"drawing\") ; else {\n            showUnmerge = this.navigator.selectionIncludesMergedCells();\n        }\n\n        this._workbook.trigger(\"contextmenu\", {\n            objectRef: object.ref,\n            targetType: object.type,\n            isComposite,\n            showUnhide,\n            showUnmerge,\n            originalEvent: event\n        });\n    }\n\n    prevent(event) {\n        event.preventDefault();\n    }\n\n    constrainResize(type, ref) {\n        let sheet = this._workbook.activeSheet();\n        let resizeHandle = sheet.resizeHandlePosition();\n\n        return !resizeHandle || type === \"outside\" || type === \"topcorner\" || ref.col < resizeHandle.col || ref.row < resizeHandle.row;\n    }\n\n    _dragDrawing(event) {\n        let sheet = this._workbook.activeSheet();\n        let drag = sheet.draggingInProgress();\n        if (!drag) {\n            return false;\n        }\n\n        let location = this.translateCoords(event);\n        let drawing = drag.drawing;\n        let deltaX = location.x - drag.startX;\n        let deltaY = location.y - drag.startY;\n\n        if (drag.resize == \"SE\") {\n            if (drag.aspect) {\n                if (Math.abs(deltaX) > Math.abs(deltaY)) {\n                    drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                    drawing.height = drawing.width / drag.aspect;\n                } else {\n                    drawing.height = Math.max(drag.copy.height + deltaY, 20);\n                    drawing.width = drawing.height * drag.aspect;\n                }\n            } else {\n                drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                drawing.height = Math.max(drag.copy.height + deltaY, 20);\n            }\n        }\n        else if (drag.resize == \"E\") {\n            drawing.width = Math.max(drag.copy.width + deltaX, 20);\n        }\n        else if (drag.resize == \"S\") {\n            drawing.height = Math.max(drag.copy.height + deltaY, 20);\n        }\n        else if (drag.resize == \"N\") {\n            if (drag.copy.height - deltaY > 20) {\n                drawing.height = drag.copy.height - deltaY;\n                drawing.offsetY = drag.copy.offsetY + deltaY;\n            }\n        }\n        else if (drag.resize == \"W\") {\n            if (drag.copy.width - deltaX > 20) {\n                drawing.width = drag.copy.width - deltaX;\n                drawing.offsetX = drag.copy.offsetX + deltaX;\n            }\n        }\n        else if (drag.resize == \"NE\") {\n            drawing.width = Math.max(drag.copy.width + deltaX, 20);\n            if (drag.copy.height - deltaY > 20) {\n                drawing.height = drag.copy.height - deltaY;\n                drawing.offsetY = drag.copy.offsetY + deltaY;\n            }\n        }\n        else if (drag.resize == \"SW\") {\n            drawing.height = Math.max(drag.copy.height + deltaY, 20);\n            if (drag.copy.width - deltaX > 20) {\n                drawing.width = drag.copy.width - deltaX;\n                drawing.offsetX = drag.copy.offsetX + deltaX;\n            }\n        }\n        else if (drag.resize == \"NW\") {\n            if (drag.copy.height - deltaY > 20) {\n                drawing.height = drag.copy.height - deltaY;\n                drawing.offsetY = drag.copy.offsetY + deltaY;\n            }\n            if (drag.copy.width - deltaX > 20) {\n                drawing.width = drag.copy.width - deltaX;\n                drawing.offsetX = drag.copy.offsetX + deltaX;\n            }\n        }\n        // just moving (no resize)\n        else {\n            drawing.offsetX = drag.copy.offsetX + deltaX;\n            drawing.offsetY = drag.copy.offsetY + deltaY;\n        }\n\n        sheet.triggerChange({ dragging: true });\n\n        return true;\n    }\n\n    onMouseDrag(event) {\n        if (this._selectionMode === \"sheet\") {\n            return;\n        }\n\n        let location = { clientX: event.clientX, clientY: event.clientY };\n        let sheet = this._workbook.activeSheet();\n\n        if (this._dragDrawing(event)) {\n            return;\n        }\n\n        let object = this.objectAt(location);\n\n        if (sheet.resizingInProgress()) {\n\n            if (!this.constrainResize(object.type, object.ref)) {\n                sheet.resizeHintPosition({ x: object.x, y: object.y });\n            }\n\n            return;\n        }\n\n        if (object.type === \"outside\") {\n            this.startAutoScroll(object);\n            return;\n        }\n\n        if (this.originFrame === object.pane) {\n            this.selectToLocation(location);\n        } else { // cross frame selection\n            let frame = this.originFrame._grid;\n\n            if (object.x > frame.right) ;\n\n            if (object.y > frame.bottom) {\n                this.scrollTop();\n            }\n\n            if (object.y < frame.top || object.x < frame.left) {\n                this.startAutoScroll(object, location);\n            } else {\n                this.selectToLocation(location);\n            }\n        }\n\n        event.preventDefault();\n    }\n\n    onMouseUp(event) {\n        let sheet = this._workbook.activeSheet();\n        sheet.completeResizing();\n        sheet.completeDragging();\n\n        this.navigator.completeSelection();\n        this.stopAutoScroll();\n\n        let editor = this.editor.activeEditor();\n        if (!editor) {\n            return;\n        }\n        let el = event.target;\n        while (el) {\n            if (el === editor.element) {\n                return;\n            }\n            el = el.parentNode;\n        }\n\n        let object = this.objectAt(event);\n        if (object && object.ref && editor.canInsertRef(false)) {\n            editor.refAtPoint(sheet);\n            sheet._setFormulaSelections(editor.highlightedRefs());\n        }\n    }\n\n    onDblClick(event) {\n        let object = this.objectAt(event);\n        let disabled = this._workbook.activeSheet().selection().enable() === false;\n\n        if (object.type !== \"cell\" || disabled) {\n            return;\n        }\n\n        let sel = this._workbook.activeSheet().selection();\n        this.activateEditor(!sel.value() && !sel.formula());\n        this.onEditorUpdate();\n    }\n\n    onCut(e) {\n        let self = this;\n        setTimeout(function() {\n            self.clipboard.menuInvoked = (e === undefined);\n            self._execute({\n                command: \"CutCommand\",\n                options: { workbook: self.view._workbook, event: e }\n            });\n        });\n    }\n\n    clipBoardValue() {\n        return this.clipboardElement.html();\n    }\n\n    _pasteImage(blob) {\n        let self = this;\n        let img = new window.Image();\n        img.src = window.URL.createObjectURL(blob);\n        img.onload = function() {\n            self._execute({\n                command: \"InsertImageCommand\",\n                options: {\n                    blob: blob,\n                    width: img.width,\n                    height: img.height\n                }\n            });\n        };\n        setTimeout(function() {\n            window.URL.revokeObjectURL(img.src);\n        }, 10);\n    }\n\n    onPaste(e) {\n        let self = this;\n        let html = \"\";\n        let plain = \"\";\n        self.clipboard.menuInvoked = (e === undefined);\n        if (e) {\n            let clipboardData = e.clipboardData;\n            if (clipboardData && clipboardData.getData) {\n                e.preventDefault();\n                let hasHTML = false;\n                let hasPlainText = false;\n                // Firefox uses DOMStringList, needs special handling\n                if (window.DOMStringList && clipboardData.types instanceof window.DOMStringList) {\n                    hasHTML = clipboardData.types.contains(\"text/html\");\n                    hasPlainText = clipboardData.types.contains(\"text/plain\");\n                } else if (Array.isArray(clipboardData.types)) {\n                    hasHTML = clipboardData.types.indexOf(\"text/html\") >= 0;\n                    hasPlainText = clipboardData.types.indexOf(\"text/plain\") >= 0;\n                } else {\n                    hasHTML = /text\\/html/.test(clipboardData.types);\n                    hasPlainText = /text\\/plain/.test(clipboardData.types);\n                }\n                if (hasHTML) {\n                    html = clipboardData.getData('text/html').trim();\n                }\n                if (hasPlainText) {\n                    plain = clipboardData.getData('text/plain').trim();\n                }\n                if (!html && !plain && clipboardData.items && clipboardData.items.length) {\n                    for (let i = 0; i < clipboardData.items.length; ++i) {\n                        let item = clipboardData.items[i];\n                        if (item.kind === \"file\" && /^image\\/(?:png|jpe?g|gif)$/i.test(item.type)) {\n                            return self._pasteImage(item.getAsFile());\n                        }\n                    }\n                }\n            } else {\n                if (window.clipboardData.files && window.clipboardData.files.length) {\n                    let file = window.clipboardData.files[0];\n                    if (/^image\\/(?:png|jpe?g|gif)$/i.test(file.type)) {\n                        return self._pasteImage(file);\n                    }\n                }\n\n                plain = window.clipboardData.getData(\"Text\");\n                if (plain) {\n                    plain = plain.trim();\n                }\n\n                // There's no way to get the HTML clipboard contents in IE other than letting\n                // the browser handle the event (it pastes into our clipboardElement), and then\n                // we can read the HTML from there.  Need to allow a small timeout for this.\n                self.clipboardElement.empty();\n                setTimeout(function() {\n                    html = self.clipboardElement.html();\n                    if (html || plain) {\n                        self.clipboard.external({ html: html, plain: plain });\n                        self._execute({\n                            command: \"PasteCommand\",\n                            options: { workbook: self.view._workbook, event: e }\n                        });\n                    }\n                });\n\n                return;\n            }\n        } else {\n            self.clipboard.menuInvoked = true;\n        }\n\n        if (!html && !plain) {\n            return;\n        }\n        self.clipboard.external({ html: html, plain: plain });\n        self._execute({\n            command: \"PasteCommand\",\n            options: { workbook: self.view._workbook, event: e }\n        });\n    }\n\n    onCopy(e) {\n        this.clipboard.menuInvoked = (e === undefined);\n        this._execute({\n            command: \"CopyCommand\",\n            options: { workbook: this.view._workbook, event: e }\n        });\n    }\n\n////////////////////////////////////////////////////////////////////\n\n    scrollTop() {\n        this.scroller.scrollTop = 0;\n    }\n\n    scrollLeft() {\n        this.scroller.scrollLeft = 0;\n    }\n\n    scrollDown(value) {\n        this.scroller.scrollTop += value;\n    }\n\n    scrollRight(value) {\n        this.scroller.scrollLeft += value;\n    }\n\n    scrollWith(right, down) {\n        this.scroller.scrollTop += down;\n        this.scroller.scrollLeft += right;\n    }\n\n    translateCoords(location) {\n        let box = this.container.getBoundingClientRect();\n        return {\n            x: location.clientX - box.left,\n            y: location.clientY - box.top\n        };\n    }\n\n    objectAt(location, noDrawing) {\n        if (!location) {\n            return;\n        }\n        const loc = this.translateCoords(location);\n        return this.view.objectAt(loc.x, loc.y, noDrawing);\n    }\n\n    selectToLocation(cellLocation) {\n        let object = this.objectAt(cellLocation, true);\n\n        if (object.pane && object.ref) { // cell, rowheader or columnheader\n            this.extendSelection(object);\n            this.lastKnownCellLocation = cellLocation;\n            this.originFrame = object.pane;\n        }\n\n        this.stopAutoScroll();\n    }\n\n    extendSelection(object) {\n        this.navigator.extendSelection(object.ref, this._selectionMode);\n    }\n\n    autoScroll() {\n        let x = this._autoScrollTarget.x;\n        let y = this._autoScrollTarget.y;\n        let boundaries = this.originFrame._grid;\n        let scroller = this.view.scroller;\n        let scrollStep = 8;\n\n        let scrollLeft = scroller.scrollLeft;\n        let scrollTop = scroller.scrollTop;\n\n        if (x < boundaries.left) {\n            this.scrollRight(-scrollStep);\n        }\n        if (x > boundaries.right) {\n            this.scrollRight(scrollStep);\n        }\n        if (y < boundaries.top) {\n            this.scrollDown(-scrollStep);\n        }\n        if (y > boundaries.bottom) {\n            this.scrollDown(scrollStep);\n        }\n\n        if (scrollTop === scroller.scrollTop && scrollLeft === scroller.scrollLeft) {\n            this.selectToLocation(this.finalLocation);\n        } else {\n            this.extendSelection(this.objectAt(this.lastKnownCellLocation));\n        }\n    }\n\n    startAutoScroll(viewObject, location) {\n        if (!this._scrollInterval) {\n            this._scrollInterval = setInterval(this.autoScroll.bind(this), 50);\n        }\n\n        this.finalLocation = location || this.lastKnownCellLocation;\n\n        this._autoScrollTarget = viewObject;\n    }\n\n    stopAutoScroll() {\n        clearInterval(this._scrollInterval);\n        this._scrollInterval = null;\n    }\n\n    openCustomEditor() {\n        this.view.openCustomEditor();\n    }\n\n    openFilterMenu(event) {\n        let object = this.objectAt(event);\n        let sheet = this._workbook.activeSheet();\n        let column = sheet.filterColumn(object.ref);\n        let filterMenu = this.view.createFilterMenu(column);\n\n        filterMenu.bind(\"action\", this.onCommandRequest.bind(this));\n        filterMenu.bind(\"action\", filterMenu.close.bind(filterMenu));\n\n        filterMenu.openFor(event.target, event);\n    }\n\n////////////////////////////////////////////////////////////////////\n\n    _saveEditorValue(arrayFormula) {\n        let sheet = this.editor._range.sheet();\n        let value = this.editor.value();\n        if (this._workbook.activeSheet() !== sheet) {\n            // remove highlighted refs (XXX: which are mostly wrong, BTW)\n            this._workbook.activeSheet()._setFormulaSelections();\n            // go back to the original sheet\n            this._workbook.activeSheet(sheet);\n        }\n        sheet.isInEditMode(false);\n        this._lastEditorValue = value;\n        this._execute({\n            command: \"EditCommand\",\n            options: {\n                value: value,\n                arrayFormula: arrayFormula\n            }\n        });\n    }\n\n    onEditorChange() {\n        this._saveEditorValue(false);\n    }\n\n    onEditorArrayFormula() {\n        this._saveEditorValue(true);\n        this.editor.deactivate(true);\n    }\n\n    onEditorActivate() {\n        let workbook = this._workbook;\n        let sheet = workbook.activeSheet();\n\n        sheet._setFormulaSelections(this.editor.highlightedRefs());\n        sheet.isInEditMode(true);\n    }\n\n    onEditorDeactivate() {\n        let sheet = this._workbook.activeSheet();\n\n        sheet.isInEditMode(false);\n        sheet._setFormulaSelections([]);\n    }\n\n    onEditorUpdate() {\n        this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n    }\n\n    onEditorBarFocus() {\n        let disabled = this._workbook.activeSheet().selection().enable() === false;\n        if (disabled) {\n            return;\n        }\n        this.editor\n            .activate({\n                range: this._workbook.activeSheet().selection(),\n                rect: this.view.activeCellRectangle(),\n                tooltip: this._activeTooltip()\n            });\n    }\n\n    onEditorCellFocus() {\n        this.editor.scale();\n    }\n\n    onEditorEsc() {\n        this.resetEditorValue();\n        this.editor.deactivate();\n\n        this.clipboardElement.focus();\n    }\n\n    insertNewline(e) {\n        e.preventDefault();\n        this.editor.insertNewline();\n    }\n\n    onEditorBlur(e, action) {\n        if (e.defaultPrevented || this.editor.isFiltered()) {\n            return;\n        }\n\n        this._preventNavigation = false;\n        this.editor.deactivate();\n\n        if (!this._preventNavigation) {\n            this.clipboardElement.focus();\n            this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n        }\n\n        if (action === 'tab') {\n            e.preventDefault();\n        }\n    }\n\n    onEditorAction(event, action) {\n        if (event.defaultPrevented) {\n            return;\n        }\n\n        let editor = this.editor;\n        let sheet = this._workbook.activeSheet();\n\n        if (this._casualEditing && /^(?:up|right|down|left)$/.test(action)) {\n            this.deactivateEditor();\n            this.navigator.moveActiveCell(ACTIONS[action]);\n            event.preventDefault();\n        } else if (editor.canInsertRef(true)) {\n            this.navigator.moveActiveCell(ACTIONS[action]);\n            editor.activeEditor().refAtPoint(sheet);\n            sheet._setFormulaSelections(editor.highlightedRefs());\n            event.preventDefault();\n        }\n    }\n\n    onEditorShiftAction(event, action) {\n        let editor = this.editor;\n        let sheet = this._workbook.activeSheet();\n\n        if (editor.canInsertRef(true)) {\n            this.navigator.modifySelection(ACTIONS[action.replace(\"shift+\", \"\")], this.appendSelection);\n\n            editor.activeEditor().refAtPoint(sheet);\n            sheet._setFormulaSelections(editor.highlightedRefs());\n\n            event.preventDefault();\n        }\n    }\n\n////////////////////////////////////////////////////////////////////\n    resetEditorValue() {\n        let sheet = this._workbook.activeSheet();\n        let ref = sheet.activeCell();\n        let input = this._workbook._inputForRef(ref);\n        let x = sheet.range(ref).intersectingArrayFormula();\n        if (x) {\n            input = \"=\" + x.formula;\n        }\n        this.editor.value(input, Boolean(x));\n    }\n\n    activateEditor(casual) {\n        // This flag will be false when F2 has been pressed, and\n        // true when editing is \"casual\", i.e., user just started\n        // typing.  In this case we want arrow keys to do cell\n        // navigation rather than move the cursor.\n        // https://github.com/telerik/kendo-ui-core/issues/3644\n        this._casualEditing = casual;\n\n        this.editor.activate({\n            range: this._workbook.activeSheet().selection(),\n            rect: this.view.activeCellRectangle(),\n            tooltip: this._activeTooltip()\n        }).focus();\n    }\n\n    deactivateEditor() {\n        this.view.editor.deactivate();\n    }\n\n    onCommandRequest(e) {\n        if (e.command) {\n            this._execute(e);\n        } else {\n            this._workbook.undoRedoStack[e.action]();\n        }\n    }\n\n    onDialogRequest(e) {\n        let additionalOptions = {\n            pdfExport: this._workbook.options.pdf,\n            excelExport: this._workbook.options.excel\n        };\n\n        if (e.options) {\n            deepExtend(e.options, additionalOptions);\n        } else {\n            e.options = additionalOptions;\n        }\n\n        this.view.openDialog(e.name, e.options);\n    }\n\n    onNameEditorEnter({ value }) {\n        let ref;\n        let workbook = this._workbook;\n        let sheet = workbook.activeSheet();\n        let name = value !== undefined ? value : this.view.nameEditor.value();\n\n        // 1. does it look like a reference, or already defined\n        // name?  If so, just select it (don't define/modify any\n        // names)\n        ref = calc.parseReference(name, true) || workbook.nameValue(name);\n        if (ref instanceof Ref) {\n            if (ref.sheet && ref.sheet.toLowerCase() !== sheet.name().toLowerCase()) {\n                // reference points to another sheet, select it if found\n                let tmp = workbook.sheetByName(ref.sheet);\n                if (tmp) {\n                    workbook.activeSheet(tmp);\n                    sheet = tmp;\n                }\n            }\n            sheet.range(ref).select();\n            return;\n        }\n\n        ref = sheet.selection()._ref.clone().simplify().setSheet(sheet.name(), true);\n\n        // XXX: should we check if a name is already defined for this range, and update it instead?\n        // Excel just adds a new one, and provides a more complete Name Manager dialog.\n        //let def = workbook.nameForRef(ref, sheet.name());\n\n        // just define new name\n        this._execute({\n            command: \"DefineNameCommand\",\n            options: { name: name, value: ref }\n        });\n\n        this.clipboardElement.focus();\n    }\n    onNameEditorCancel() {\n        this.clipboardElement.focus();\n    }\n    onNameEditorSelect(ev) {\n        let name = ev.name;\n        let workbook = this._workbook;\n        let sheet = workbook.activeSheet();\n        let ref = workbook.nameValue(name);\n        if (ref instanceof Ref) {\n            if (ref.sheet && ref.sheet.toLowerCase() !== sheet.name().toLowerCase()) {\n                // reference points to another sheet, select it if found\n                let tmp = workbook.sheetByName(ref.sheet);\n                if (tmp) {\n                    workbook.activeSheet(tmp);\n                    sheet = tmp;\n                }\n            }\n            sheet.range(ref).select();\n            return;\n        }\n        this.clipboardElement.focus();\n    }\n    onNameEditorDelete(ev) {\n        this._execute({\n            command: \"DeleteNameCommand\",\n            options: { name: ev.name }\n        });\n        this.clipboardElement.focus();\n    }\n}\n\nclass RangeTreeNode {\n    constructor(level, value, left, right) {\n        this.level = level;\n        this.value = value;\n        this.left = left;\n        this.right = right;\n    }\n}\n\nconst NilNode = {\n    left: undefined,\n    right: undefined,\n    level: 0\n};\nNilNode.left = NilNode;\nNilNode.right = NilNode;\n\nfunction skew(n) {\n    let node = n;\n    if (node.left.level === node.level) {\n        let temp = node;\n        node = node.left;\n        temp.left = node.right;\n        node.right = temp;\n    }\n\n    return node;\n}\n\nfunction split(n) {\n    let node = n;\n    if (node.right.right.level === node.level) {\n        let temp = node;\n        node = node.right;\n        temp.right = node.left;\n        node.left = temp;\n        node.level += 1;\n    }\n\n    return node;\n}\n\nfunction insert(node, value) {\n    if (node === NilNode) {\n        return new RangeTreeNode(1, value, NilNode, NilNode);\n    } else if (node.value.start > value.start) {\n        node.left = insert(node.left, value);\n    } else {\n        node.right = insert(node.right, value);\n    }\n\n    return split(skew(node));\n}\n\nfunction remove(n, value) {\n    let node = n;\n    if (node === NilNode) {\n        return node;\n    }\n\n    let diff = node.value.start - value.start;\n    if (diff === 0) {\n        if (node.left !== NilNode && node.right !== NilNode) {\n            let heir = node.left;\n\n            while (heir.right !== NilNode) {\n                heir = heir.right;\n            }\n\n            node.value = heir.value;\n            node.left = remove(node.left, node.value);\n        } else if (node.left === NilNode) {\n            node = node.right;\n        } else {\n            node = node.left;\n        }\n    } else if (diff > 0) {\n        node.left = remove(node.left, value);\n    } else {\n        node.right = remove(node.right, value);\n    }\n\n    if (node.left.level < (node.level - 1) || node.right.level < (node.level - 1)) {\n        node.level -= 1;\n        if (node.right.level > node.level) {\n            node.right.level = node.level;\n        }\n\n        node = skew(node);\n        node.right = skew(node.right);\n        node.right.right = skew(node.right.right);\n        node = split(node);\n        node.right = split(node.right);\n    }\n\n    return node;\n}\n\nclass ValueRange {\n    // start;\n    // end;\n    // value;\n\n    constructor(start, end, value) {\n        this.start = start;\n        this.end = end;\n        this.value = value;\n    }\n\n    intersects(range) {\n        return range.start <= this.end && range.end >= this.start;\n    }\n\n    clone() {\n        return new ValueRange(this.start, this.end, this.value);\n    }\n}\n\nclass RangeTree {\n    // root;\n    constructor() {\n        this.root = NilNode;\n    }\n\n    insert(value) {\n        this.root = insert(this.root, value);\n    }\n\n    remove(value) {\n        this.root = remove(this.root, value);\n    }\n\n    findrange(value) {\n        let node = this.root;\n\n        while (node !== NilNode) {\n            if (value < node.value.start) {\n                node = node.left;\n            } else if (value > node.value.end) {\n                node = node.right;\n            } else {\n                return node.value;\n            }\n        }\n\n        return null;\n    }\n\n    values() {\n        let result = [];\n        values(this.root, result);\n        return result;\n    }\n\n    intersecting(start, end) {\n        let ranges = [];\n        intersecting(this.root, new ValueRange(start, end), ranges);\n        return ranges;\n    }\n\n    map(callback) {\n        let tree = new RangeTree();\n        map(tree, this.root, callback);\n        return tree;\n    }\n\n    forEach(callback) {\n        forEach(this.root, callback);\n    }\n\n    clone() {\n        return this.map(function(value) {\n            return value.clone();\n        });\n    }\n\n    first() {\n        let first = this.root;\n        while (first.left !== NilNode) {\n            first = first.left;\n        }\n\n        return first;\n    }\n\n    last() {\n        let last = this.root;\n        while (last.right !== NilNode) {\n            last = last.right;\n        }\n\n        return last;\n    }\n}\n\nfunction values(node, result) {\n    if (node === NilNode) {\n        return;\n    }\n\n    values(node.left, result);\n    result.push(node.value);\n    values(node.right, result);\n}\n\nfunction intersecting(node, range, ranges) {\n    if (node === NilNode) {\n        return;\n    }\n\n    let value = node.value;\n\n    if (range.start < value.start) {\n        intersecting(node.left, range, ranges);\n    }\n\n    if (value.intersects(range)) {\n        ranges.push(value);\n    }\n\n    if (range.end > value.end) {\n        intersecting(node.right, range, ranges);\n    }\n}\n\nfunction map(tree, root, callback) {\n    if (root === NilNode) {\n        return;\n    }\n    map(tree, root.left, callback);\n    tree.insert(callback(root.value));\n    map(tree, root.right, callback);\n}\n\nfunction forEach(root, callback) {\n    if (root === NilNode) {\n        return;\n    }\n    forEach(root.left, callback);\n    callback(root.value);\n    forEach(root.right, callback);\n}\n\nclass RangeList {\n    // tree;\n    constructor(start, end, value) {\n        if (end === undefined) {\n            this.tree = start;\n        } else {\n            this.tree = new RangeTree();\n            this.tree.insert(new ValueRange(start, end, value));\n        }\n    }\n\n    values() {\n        return this.tree.values();\n    }\n\n    map(callback) {\n        return new RangeList(this.tree.map(callback));\n    }\n\n    forEach(callback) {\n        this.tree.forEach(callback);\n    }\n\n    intersecting(start, end) {\n        return this.tree.intersecting(start, end);\n    }\n\n    first() {\n        return this.tree.first().value;\n    }\n\n    last() {\n        return this.tree.last().value;\n    }\n\n    insert(start, end, value) {\n        return this.tree.insert(new ValueRange(start, end, value));\n    }\n\n    value(s, e, value) {\n        let start = s, end = e;\n        if (value === undefined) {\n            if (end === undefined) {\n                end = start;\n            }\n            return this.intersecting(start, end)[0].value;\n        }\n\n        let ranges = this.tree.intersecting(start - 1, end + 1);\n\n        if (ranges.length) {\n            let firstRange = ranges[0], lastRange = ranges[ranges.length - 1];\n\n            if (firstRange.end < start) {\n                if (firstRange.value === value) {\n                    start = firstRange.start;\n                } else {\n                    ranges.shift();\n                }\n            }\n\n            if (lastRange.start > end) {\n                if (lastRange.value === value) {\n                    end = lastRange.end;\n                } else {\n                    ranges.pop();\n                }\n            }\n\n            for (let i = 0, length = ranges.length; i < length; i++) {\n                let range = ranges[i];\n                let rangeValue = range.value;\n                let rangeStart = range.start;\n                let rangeEnd = range.end;\n\n                this.tree.remove(range);\n\n                if (rangeStart < start) {\n                    if (rangeValue !== value) {\n                        this.insert(rangeStart, start - 1, rangeValue);\n                    } else {\n                        start = rangeStart;\n                    }\n                }\n\n                if (rangeEnd > end) {\n                    if (rangeValue !== value) {\n                        this.insert(end + 1, rangeEnd, rangeValue);\n                    } else {\n                        end = rangeEnd;\n                    }\n                }\n            }\n        }\n\n        this.insert(start, end, value);\n    }\n\n    expandedValues(start, end) {\n        let ranges = this.intersecting(start, end);\n        let result = [];\n\n        let rangeIndex = 0;\n\n        for (let i = start; i <= end; i++) {\n            if (ranges[rangeIndex].end < i) {\n                rangeIndex ++;\n            }\n\n            result.push({ index: i - start, value: ranges[rangeIndex].value });\n        }\n\n        return result;\n    }\n\n    sortedIndices(start, end, valueComparer, indices) {\n        let result = this.expandedValues(start, end);\n\n        let comparer = function(a, b) {\n            if (a.value === b.value) {\n                return a.index - b.index;\n            }\n\n            return valueComparer(a.value, b.value);\n        };\n\n        if (indices) {\n            comparer = function(a, b) {\n                let x = indices[a.index];\n                let y = indices[b.index];\n\n                if (x.value === y.value) {\n                    return valueComparer(a.value, b.value);\n                }\n\n                return a.index - b.index;\n            };\n        }\n\n        result.sort(comparer);\n\n        return result;\n    }\n\n    sort(start, end, indices) {\n        if (this.intersecting(start, end).length === 1) {\n            return;\n        }\n\n        let expValues = this.expandedValues(start, end);\n\n        for (let i = 0, len = indices.length; i < len; i++) {\n            this.value(i + start, i + start, expValues[indices[i].index].value);\n        }\n    }\n\n    copy(sourceStart, sourceEnd, targetStart) {\n        let intValues = this.intersecting(sourceStart, sourceEnd);\n\n        let start = targetStart;\n        let end;\n\n        for (let i = 0, len = intValues.length; i < len; i++) {\n            let rangeStart = intValues[i].start;\n\n            if (rangeStart < sourceStart) {\n                rangeStart = sourceStart;\n            }\n\n            let rangeEnd = intValues[i].end;\n\n            if (rangeEnd > sourceEnd) {\n                rangeEnd = sourceEnd;\n            }\n\n            end = start + (rangeEnd - rangeStart);\n\n            this.value(start, end, intValues[i].value);\n\n            start = ++end;\n        }\n    }\n\n    iterator(start, end) {\n        return new Iterator(start, end, this.intersecting(start, end));\n    }\n\n    getState() {\n        return this.tree.clone();\n    }\n\n    setState(state) {\n        this.tree = state.clone();\n    }\n\n    toJSON() {\n        return this.values();\n    }\n\n    fromJSON(vals) {\n        vals.forEach((v) => {\n            this.value(v.start, v.end, v.value);\n        });\n    }\n}\n\nclass Iterator {\n    constructor(start, end, ranges) {\n        this.start = start;\n        this.end = end;\n        this.index = 0;\n        this.ranges = ranges;\n    }\n\n    unique() {\n        return this.ranges.map(function(range) {\n            return range.value;\n        });\n    }\n\n    at(index) {\n        while (this.ranges[this.index] && this.ranges[this.index].end < index) {\n            this.index ++;\n        }\n\n        return this.ranges[this.index] && this.ranges[this.index].value;\n    }\n\n    forEach(callback) {\n        for (let i = this.start; i <= this.end; i++) {\n            callback(this.at(i), i);\n        }\n\n        this.index = 0;\n    }\n}\n\nclass SparseRangeList extends RangeList {\n    constructor(start, end, value) {\n        super(start, end, value);\n        this._defaultValue = value;\n        this.tree = new RangeTree();\n        this.range = new ValueRange(start, end, value);\n    }\n\n    intersecting(s, end) {\n        let start = s;\n        let ranges = this.tree.intersecting(start, end);\n        let result = [];\n        let range;\n\n        if (!ranges.length) {\n            return [this.range];\n        }\n\n        for (let i = 0, len = ranges.length; i < len; i++) {\n            range = ranges[i];\n            if (range.start > start) {\n                result.push(new ValueRange(start, range.start - 1, this.range.value));\n            }\n\n            result.push(range);\n            start = range.end + 1;\n        }\n\n        if (range.end < end) {\n            result.push(new ValueRange(range.end + 1, end, this.range.value));\n        }\n\n        return result;\n    }\n\n    insert(start, end, v) {\n        let value = v;\n        if (value == null) {\n            value = this._defaultValue;\n        }\n        if (value !== this.range.value) {\n            this.tree.insert(new ValueRange(start, end, value));\n        }\n    }\n\n    lastRangeStart() {\n        let node = this.tree.root;\n\n        if (node === NilNode) {\n            return this.range.start;\n        }\n\n        while (node.right !== NilNode) {\n            node = node.right;\n        }\n\n        return node.value.end + 1;\n    }\n}\n\n/* eslint-disable default-case */\n/* eslint-disable camelcase */\n/* eslint-disable no-param-reassign */\n\n\nclass Property {\n    constructor(list) {\n        this.list = list;\n    }\n\n    get(index) {\n        return this.parse(this.list.value(index, index));\n    }\n\n    set(start, end, value) {\n        if (value === undefined) {\n            value = end;\n            end = start;\n        }\n\n        this.list.value(start, end, value);\n    }\n\n    parse(value) {\n        return value;\n    }\n\n    copy(start, end, dst) {\n        this.list.copy(start, end, dst);\n    }\n\n    iterator(start, end) {\n        return this.list.iterator(start, end);\n    }\n}\nclass JsonProperty extends Property {\n    set(start, end, value) {\n        this.list.value(start, end, JSON.stringify(value));\n    }\n\n    parse(value) {\n        return JSON.parse(value);\n    }\n}\nclass ValueProperty extends Property {\n    constructor(values, formats) {\n        super(values);\n        this.formats = formats;\n    }\n\n    set(start, end, value) {\n        if (value instanceof Date) {\n            value = calc.runtime.dateToSerial(value);\n            if (!this.formats.value(start,end)) {\n                this.formats.value(start, end, toExcelFormat$1(culture().calendar.patterns.d));\n            }\n        } else if (typeof value == \"number\") {\n            value = calc.runtime.limitPrecision(value);\n        }\n\n        this.list.value(start, end, value);\n    }\n}\nfunction toExcelFormat$1(format) {\n    return format.replace(/M/g, \"m\").replace(/'/g, '\"').replace(/tt/, \"am/pm\");\n}\n\nconst propertyBagSpec = [\n    { property: Property, name: \"format\", value: null, sortable: true, serializable: true },\n    { property: ValueProperty, name: \"value\", value: null, sortable: true, serializable: true, depends: \"format\" },\n    { property: Property, name: \"formula\", value: null, sortable: true, serializable: true },\n    { property: Property, name: \"background\", value: null, sortable: true, serializable: true },\n    { property: JsonProperty, name: \"vBorders\", value: null, sortable: false, serializable: false },\n    { property: JsonProperty, name: \"hBorders\", value: null, sortable: false, serializable: false },\n    { property: JsonProperty, name: \"dBorders\", value: null, sortable: false, serializable: true },\n    { property: Property, name: \"color\", value: null, sortable: true, serializable: true },\n    { property: Property, name: \"fontFamily\", value: null, sortable: true, serializable: true },\n    { property: Property, name: \"underline\", value: null, sortable: true, serializable: true },\n    { property: Property, name: \"fontSize\", value: null, sortable: true, serializable: true },\n    { property: Property, name: \"italic\", value: null, sortable: true, serializable: true },\n    { property: Property, name: \"bold\", value: null, sortable: true, serializable: true },\n    { property: Property, name: \"textAlign\", value: null, sortable: true, serializable: true },\n    { property: Property, name: \"indent\", value: null, sortable: true, serializable: true },\n    { property: Property, name: \"verticalAlign\", value: null, sortable: true, serializable: true },\n    { property: Property, name: \"wrap\", value: null, sortable: true, serializable: true },\n    { property: Property, name: \"validation\", value: null, sortable: false, serializable: true },\n    { property: Property, name: \"enable\", value: null, sortable: false, serializable: true },\n    { property: Property, name: \"link\", value: null, sortable: true, serializable: true },\n    { property: Property, name: \"editor\", value: null, sortable: true, serializable: true },\n    { property: Property, name: \"comment\", value: null, sortable: true, serializable: true },\n    { property: Property, name: \"html\", value: null, sortable: true, serializable: true }\n];\n\nclass PropertyBag {\n    constructor(rowCount, columnCount, defaultValues) {\n        defaultValues = defaultValues || {};\n        let cellCount = rowCount * columnCount - 1;\n\n        this.specs = propertyBagSpec;\n        this.rowCount = rowCount;\n        this.columnCount = columnCount;\n        this.cellCount = cellCount;\n        this.properties = {};\n        this.lists = {};\n\n        this.specs.forEach(function(spec) {\n            let name = spec.name;\n            let value = defaultValues[name];\n            if (value === undefined) {\n                value = spec.value;\n            }\n            this.lists[name] = new SparseRangeList(0, cellCount, value);\n            let prop = this.properties[name] = new spec.property(this.lists[name], this.lists[spec.depends]);\n            prop.spec = spec;\n        }, this);\n\n        // XXX: this is a hack but I have no better ideas at this\n        // point.  The getState() method in a SparseRangeList\n        // clones the tree (which just copies values over), but\n        // formulas are objects maintaining complex state.\n        // https://github.com/telerik/kendo-ui-core/issues/2816\n        this.lists.formula.tree.clone = cloneFormulaTree;\n        this.lists.validation.tree.clone = cloneFormulaTree;\n    }\n\n    _resize(new_rows, new_cols) {\n        let self = this;\n        let old_rows = self.rowCount;\n        let cell_count = new_rows * new_cols - 1;\n        function scaleIndex(index) {\n            let col = index / old_rows | 0;\n            let row = index % old_rows;\n            return col * new_rows + row;\n        }\n        function scaleNode(node) {\n            // node is a ValueRange from rangelist.js\n            // start/end are rowCount * col + row\n            node.start = scaleIndex(node.start);\n            node.end = scaleIndex(node.end);\n        }\n        Object.keys(self.lists).forEach(function(name) {\n            let list = self.lists[name];\n            if (new_rows !== old_rows) {\n                list.forEach(scaleNode);\n            }\n            list.range.end = cell_count;\n        });\n        self.rowCount = new_rows;\n        self.columnCount = new_cols;\n        self.cellCount = cell_count;\n    }\n\n    getState() {\n        let state = {};\n\n        this.specs.forEach(function(spec) {\n            state[spec.name] = this.lists[spec.name].getState();\n        }, this);\n\n        return state;\n    }\n\n    setState(state) {\n        this.specs.forEach(function(spec) {\n            this.lists[spec.name].setState(state[spec.name]);\n        }, this);\n    }\n\n    get(name, index) {\n        if (index === undefined) {\n            return this.lists[name];\n        }\n\n        switch (name) {\n        case \"borderRight\":\n            index += this.rowCount;\n            /* falls through */\n        case \"borderLeft\":\n            name = \"vBorders\";\n            break;\n\n        case \"borderBottom\":\n            index++;\n            /* falls through */\n        case \"borderTop\":\n            name = \"hBorders\";\n            break;\n        }\n        return index > this.cellCount ? null : this.properties[name].get(index);\n    }\n\n    set(name, start, end, value) {\n        switch (name) {\n        case \"borderRight\":\n            start += this.rowCount;\n            end += this.rowCount;\n            /* falls through */\n        case \"borderLeft\":\n            name = \"vBorders\";\n            break;\n\n        case \"borderBottom\":\n            start++;\n            end++;\n            /* falls through */\n        case \"borderTop\":\n            name = \"hBorders\";\n            break;\n        }\n        if (start <= end && end <= this.cellCount) {\n            this.properties[name].set(start, end, value);\n        }\n    }\n\n    fromJSON(index, value) {\n        for (let si = 0; si < this.specs.length; si++) {\n            let spec = this.specs[si];\n\n            if (spec.serializable) {\n                if (value[spec.name] !== undefined) {\n                    this.set(spec.name, index, index, value[spec.name], false);\n                }\n            }\n        }\n\n        [ \"borderLeft\", \"borderRight\", \"borderTop\", \"borderBottom\" ].forEach(function(b) {\n            if (value[b] !== undefined) {\n                this.set(b, index, index, value[b]);\n            }\n        }, this);\n    }\n\n    copy(sourceStart, sourceEnd, targetStart) {\n        this.specs.forEach(function(spec) {\n            this.properties[spec.name].copy(sourceStart, sourceEnd, targetStart);\n        }, this);\n    }\n\n    iterator(name, start, end) {\n        let prop = this.properties[name];\n        let iter = prop.iterator(start, end), at = iter.at;\n        let cellCount = this.cellCount;\n        iter.at = function(index) {\n            return index > cellCount ? null : prop.parse(at.call(iter, index));\n        };\n        iter.name = name;\n        iter.value = prop.spec.value;\n        return iter;\n    }\n\n    sortable() {\n        return this.specs.filter(function(spec) { return spec.sortable; })\n            .map(function(spec) {\n                return this.lists[spec.name];\n            }, this);\n    }\n\n    iterators(start, end) {\n        return this.specs.reduce(function(ret, spec) {\n            if (spec.serializable) {\n                ret.push(this.iterator(spec.name, start, end));\n            }\n            return ret;\n        }.bind(this), []);\n    }\n\n    forEach(start, end, callback) {\n        let iterators = this.iterators(start, end);\n        let hBorders = this.iterator(\"hBorders\", start, end + 1);\n        let leftBorders = this.iterator(\"vBorders\", start, end);\n        let rightBorders = this.iterator(\"vBorders\", start + this.rowCount, end + this.rowCount);\n        let values, index;\n\n        function addBorder(name, iterator, index) {\n            let val = iterator.at(index);\n            if (val !== iterator.value) {\n                values[name] = val;\n            }\n        }\n\n        for (index = start; index <= end; index++) {\n            values = {};\n\n            for (let i = 0; i < iterators.length; i++) {\n                let iterator = iterators[i];\n                let value = iterator.at(index);\n\n                if (value !== iterator.value) {\n                    values[iterator.name] = value;\n                }\n            }\n\n            addBorder(\"borderLeft\", leftBorders, index);\n            addBorder(\"borderRight\", rightBorders, index + this.rowCount);\n            addBorder(\"borderTop\", hBorders, index);\n            if ((index + 1) % this.rowCount) {\n                addBorder(\"borderBottom\", hBorders, index + 1);\n            }\n\n            callback(values);\n        }\n    }\n\n    forEachProperty(callback) {\n        for (let name in this.properties) {\n            callback(this.properties[name]);\n        }\n    }\n}\nfunction cloneFormulaValue(x) {\n    x = x.clone();\n    x.value = x.value.deepClone(); // x.value is Formula or Validation\n    return x;\n}\nfunction cloneFormulaTree() {\n    let tree = this.map(cloneFormulaValue);\n    tree.clone = cloneFormulaTree; // because it's a new RangeTree now\n    return tree;\n}\nconst ALL_PROPERTIES = propertyBagSpec.reduce(function(a, spec) {\n    if (spec.serializable) {\n        a.push(spec.name);\n    }\n    return a;\n}, [ \"borderTop\", \"borderRight\", \"borderBottom\", \"borderLeft\" ]);\n\n/* eslint-disable no-param-reassign */\n/* eslint-disable no-useless-call */\n/* eslint-disable camelcase */\n/* eslint-disable default-case */\n\n\nlet TRANSPOSE_FORMAT = \"_matrix({0})\";\nlet DATE_FORMAT = 'DATEVALUE(\"{0}\")';\n\nfunction compileValidation(sheet, row, col, validation) {\n    let validationHandler;\n    let comparer;\n    let parsedFromDate;\n    let parsedToDate;\n    if (typeof validation === \"string\") {\n        validation = JSON.parse(validation);\n    }\n    if (validation.from) {\n        if (validation.dataType === \"list\" && !validation.fromIsListValue) {\n            // We need to convert the {...} validation.from value to a string, so that it would work when exported to XLSX\n            if (validation.from.indexOf(\"{\") > -1) {\n                validation.from = validation.from.replace(/\\\"/g,\"\").replace(\"{\",\"\\\"\").replace(\"}\", \"\\\"\");\n            }\n            validation.from = intl().format(TRANSPOSE_FORMAT, validation.from);\n            validation.fromIsListValue = true;\n        }\n        if (validation.dataType === \"date\") {\n            parsedFromDate = calc.runtime.parseDate(validation.from);\n            if (parsedFromDate) {\n                validation.from = intl().format(DATE_FORMAT, validation.from);\n                validation.fromIsDateValue = true;\n            }\n        }\n        validation.from = calc.compile(calc.parseFormula(sheet, row, col, validation.from));\n    }\n    if (validation.to) {\n        if (validation.dataType === \"date\") {\n            parsedToDate = calc.runtime.parseDate(validation.to);\n            if (parsedToDate) {\n                validation.to = intl().format(DATE_FORMAT, validation.to);\n                validation.toIsDateValue = true;\n            }\n        }\n        validation.to = calc.compile(calc.parseFormula(sheet, row, col, validation.to));\n    }\n    if (validation.dataType === \"custom\") {\n        comparer = validationExport.validationComparers.custom;\n    } else if (validation.dataType === \"list\") {\n        comparer = validationExport.validationComparers.list;\n    } else {\n        comparer = validationExport.validationComparers[validation.comparerType];\n    }\n    if (!comparer) {\n        throw intl().format(\"'{0}' comparer is not implemented.\", validation.comparerType);\n    }\n    validationHandler = function(valueToCompare) { //add 'valueFormat' arg when add isDate comparer\n        let toValue = this.to && (this.to_value || this.to_value === 0) ? this.to_value : undefined;\n        if (valueToCompare === null || valueToCompare === \"\") {\n            if (this.allowNulls) {\n                this.value = true;\n            } else {\n                this.value = false;\n            }\n        } else if (this.dataType === \"custom\") {\n            this.value = comparer(valueToCompare, this.from_value, toValue);\n        } else if (this.dataType === \"list\") {\n            let data = this._getListData();\n            this.value = comparer(valueToCompare, data, toValue);\n        } else {\n            //TODO: TYPE CHECK IS REQUIRED ONLY FOR DATE TYPE WHEN SPECIAL COMPARER (ISDATE) IS USED\n            this.value = comparer(valueToCompare, this.from_value, toValue);\n        }\n        return this.value;\n    };\n    const resultOptions = Object.assign({}, validation);\n    resultOptions.handler = validationHandler;\n    resultOptions.sheet = sheet;\n    resultOptions.row = row;\n    resultOptions.col = col;\n    return new Validation(resultOptions);\n}\nclass Validation {\n    constructor(options) {\n        this.handler = options.handler;\n        this.from = options.from;\n        this.to = options.to;\n        this.dataType = options.dataType; //date, time etc\n        this.comparerType = options.comparerType; //greaterThan, EqaulTo etc\n        this.type = options.type ? options.type : \"warning\"; //info, warning, reject\n        this.allowNulls = options.allowNulls ? true : false;\n        this.fromIsDateValue = options.fromIsDateValue ? true : false;\n        this.toIsDateValue = options.toIsDateValue ? true : false;\n        this.showButton = options.showButton;\n        this.fromIsListValue = options.fromIsListValue ? true : false;\n        //TODO: address to be range / cell ref, and adjust it based on it\n        this.sheet = options.sheet;\n        this.row = options.row;\n        this.col = options.col;\n        if (options.tooltipMessageTemplate) {\n            this.tooltipMessageTemplate = options.tooltipMessageTemplate;\n        }\n        if (options.tooltipTitleTemplate) {\n            this.tooltipTitleTemplate = options.tooltipTitleTemplate;\n        }\n        if (options.messageTemplate) {\n            this.messageTemplate = options.messageTemplate;\n        }\n        if (options.titleTemplate) {\n            this.titleTemplate = options.titleTemplate;\n        }\n    }\n    _formatMessages(format) {\n        let from = this.from ? this.from_value : \"\";\n        let to = this.to ? this.to_value : \"\";\n        let fromFormula = this.from ? this.from.toString() : \"\";\n        let toFormula = this.to ? this.to.toString() : \"\";\n        let dataType = this.dataType;\n        let type = this.type;\n        let comparerType = this.comparerType;\n        return intl().format(format, from, to, fromFormula, toFormula, dataType, type, comparerType);\n    }\n    _setMessages() {\n        this.title = \"\";\n        this.message = \"\";\n        if (this.tooltipTitleTemplate) {\n            this.tooltipTitle = this._formatMessages(this.tooltipTitleTemplate);\n        }\n        if (this.tooltipMessageTemplate) {\n            this.tooltipMessage = this._formatMessages(this.tooltipMessageTemplate);\n        }\n        if (this.titleTemplate) {\n            this.title = this._formatMessages(this.titleTemplate);\n        }\n        if (this.messageTemplate) {\n            this.message = this._formatMessages(this.messageTemplate);\n        }\n    }\n    _getListData() {\n        if (!this.from_value || !this.from_value.data) {\n            return [];\n        }\n        let cube = this.from_value.data;\n        let i;\n        let y;\n        let data = [];\n        for (i = 0; i < cube.length; i++ ) {\n            let array = cube[i];\n            if (array) {\n                for (y = 0; y < array.length; y++ ) {\n                    data.push(array[y]);\n                }\n            }\n        }\n        return data;\n    }\n    clone(sheet, row, col) {\n        let options = this._getOptions();\n        if (options.from) {\n            options.from = options.from.clone(sheet, row, col);\n        }\n        if (options.to) {\n            options.to = options.to.clone(sheet, row, col);\n        }\n        const optionsResult = Object.assign({}, options);\n        optionsResult.handler = this.handler;\n        optionsResult.sheet = sheet;\n        optionsResult.row = row;\n        optionsResult.col = col;\n        return new Validation(optionsResult);\n    }\n    deepClone() {\n        let v = new Validation(this);\n        v.from = v.from.deepClone();\n        if (v.to) {\n            v.to = v.to.deepClone();\n        }\n        return v;\n    }\n    exec(ss, compareValue, compareFormat, callback) {\n        let self = this;\n        function getValue(val) {\n            if (val instanceof Ref) {\n                val = ss.getData(val);\n                if (Array.isArray(val)) {\n                    val = val[0];\n                }\n            }\n            return val;\n        }\n        let calculateFromCallBack = function(val) {\n            self.from_value = getValue(val);\n            self.value = self.handler.call(self, compareValue, compareFormat);\n            self._setMessages();\n            if (callback) {\n                callback(self.value);\n            }\n        };\n        if (self.to) {\n            self.to.exec(ss, function(val) {\n                self.to_value = getValue(val);\n                self.from.exec(ss, calculateFromCallBack);\n            });\n        } else {\n            self.from.exec(ss, calculateFromCallBack);\n        }\n    }\n    reset() {\n        if (this.from) {\n            this.from.reset();\n        }\n        if (this.to) {\n            this.to.reset();\n        }\n        delete this.value;\n    }\n    adjust(affectedSheet, operation, start, delta) {\n        let prevFrom, prevTo, modified;\n        let formulaRow = this.row;\n        let formulaCol = this.col;\n        if (this.from) {\n            prevFrom = this.from.adjust(affectedSheet, operation, start, delta);\n        }\n        if (this.to) {\n            prevTo = this.to.adjust(affectedSheet, operation, start, delta);\n        }\n        if (this.sheet.toLowerCase() === affectedSheet.toLowerCase()) {\n            switch (operation) {\n            case \"row\":\n                if (formulaRow >= start) {\n                    modified = true;\n                    this.row += delta;\n                }\n                break;\n            case \"col\":\n                if (formulaCol >= start) {\n                    modified = true;\n                    this.col += delta;\n                }\n                break;\n            }\n        }\n        if (modified || prevFrom || prevTo) {\n            let v = new Validation(this);\n            v.from = prevFrom;\n            v.to = prevTo;\n            v.row = formulaRow;\n            v.col = formulaCol;\n            return v;\n        }\n    }\n    toJSON() {\n        let options = this._getOptions();\n        if (options.from) {\n            options.from = options.from.toString();\n            if (options.dataType === \"list\") {\n                options.from = options.from.replace(/^_matrix\\((.*)\\)$/i, \"$1\");\n                delete options.fromIsListValue;\n            }\n            if (options.dataType === \"date\") {\n                if (this.fromIsDateValue) {\n                    options.from = options.from.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, \"$1\");\n                    delete options.fromIsDateValue;\n                }\n            }\n        }\n        if (options.to) {\n            options.to = options.to.toString();\n            if (options.dataType === \"date\") {\n                if (this.toIsDateValue) {\n                    options.to = options.to.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, \"$1\");\n                    delete options.toIsDateValue;\n                }\n            }\n        }\n        return options;\n    }\n    _getOptions() {\n        return {\n            from: this.from,\n            to: this.to,\n            dataType: this.dataType,\n            type: this.type,\n            comparerType: this.comparerType,\n            row: this.row,\n            col: this.col,\n            sheet: this.sheet,\n            allowNulls: this.allowNulls,\n            fromIsListValue: this.fromIsListValue,\n            fromIsDateValue: this.fromIsDateValue,\n            toIsDateValue: this.toIsDateValue,\n            tooltipMessageTemplate: this.tooltipMessageTemplate,\n            tooltipTitleTemplate: this.tooltipTitleTemplate,\n            //TODO: export generated messages instead?\n            messageTemplate: this.messageTemplate,\n            titleTemplate: this.titleTemplate,\n            showButton: this.showButton\n        };\n    }\n}\nconst validationExport = {};\nvalidationExport.compile = compileValidation;\nvalidationExport.validationComparers = {\n    greaterThan: function(valueToCompare, from) {\n        return valueToCompare > from;\n    },\n    lessThan: function(valueToCompare, from) {\n        return valueToCompare < from;\n    },\n    between: function(valueToCompare, from, to) {\n        return valueToCompare >= from && valueToCompare <= to;\n    },\n    equalTo: function(valueToCompare, from) {\n        return valueToCompare === from;\n    },\n    notEqualTo: function(valueToCompare, from) {\n        return valueToCompare !== from;\n    },\n    greaterThanOrEqualTo: function(valueToCompare, from) {\n        return valueToCompare >= from;\n    },\n    lessThanOrEqualTo: function(valueToCompare, from) {\n        return valueToCompare <= from;\n    },\n    notBetween: function(valueToCompare, from, to) {\n        return valueToCompare < from || valueToCompare > to;\n    },\n    custom: function(valueToCompare, from) {\n        return from;\n    },\n    list: function(valueToCompare, data) {\n        return data.indexOf(valueToCompare) > -1;\n    }\n};\nvalidationExport.Validation = Validation;\n\n/* eslint-disable no-nested-ternary */\n/* eslint-disable curly */\n/* eslint-disable space-infix-ops */\n/* eslint-disable indent */\n/* eslint-disable no-empty */\n/* eslint-disable no-loop-func */\n/* eslint-disable consistent-return */\n/* eslint-disable block-scoped-var */\n/* eslint-disable no-redeclare */\n/* eslint-disable no-var */\n/* eslint-disable eqeqeq */\n/* eslint-disable complexity */\n/* eslint-disable max-params */\n/* eslint-disable no-implicit-coercion */\n/* eslint-disable key-spacing */\n/* eslint-disable default-case */\n/* eslint-disable camelcase */\n/* eslint-disable brace-style */\n/* eslint-disable no-else-return */\n/* eslint-disable no-constant-condition */\n/* eslint-disable no-param-reassign */\n/* eslint-disable space-before-blocks */\n\nconst { measureText } = util;\n\nlet PROPERTIES = [\n    \"color\", \"fontFamily\", \"underline\",\n    \"italic\", \"bold\", \"textAlign\", \"indent\",\n    \"verticalAlign\", \"background\", \"format\", \"link\", \"editor\",\n    \"borderTop\", \"borderRight\", \"borderBottom\", \"borderLeft\",\n    \"comment\", \"html\"\n];\nlet Range$1 = class Range {\n    constructor(ref, sheet) {\n        this._sheet = sheet;\n        this._ref = ref;\n    }\n\n    clone() {\n        return new Range(this._ref.clone(), this._sheet);\n    }\n\n    skipHiddenCells() {\n        let refs = [];\n        let self = this, sheet = self._sheet;\n        let skipHiddenRows = sheet.isHiddenRow.bind(sheet);\n        let skipHiddenCols = sheet.isHiddenColumn.bind(sheet);\n        self._ref.forEach(function(ref) {\n            ref = self._normalize(ref.toRangeRef());\n            let tl = ref.topLeft, br = ref.bottomRight;\n            let rows = partition(tl.row, br.row, skipHiddenRows);\n            let cols = partition(tl.col, br.col, skipHiddenCols);\n            for (let i = 0; i < rows.length; ++i) {\n                for (let j = 0; j < cols.length; ++j) {\n                    refs.push(new RangeRef(\n                        new CellRef(rows[i].begin, cols[j].begin),\n                        new CellRef(rows[i].end, cols[j].end)\n                    ));\n                }\n            }\n        });\n        return sheet.range(refs.length > 1 ? new UnionRef(refs) : refs[0]);\n    }\n\n    _normalize(ref) {\n        return this._sheet._grid.normalize(ref);\n    }\n\n    _set(name, value, noTrigger) {\n        let self = this;\n        let sheet = self._sheet;\n        self._ref.forEach(function(ref) {\n            let result = ref;\n            let valueProp = name === \"value\" || name === \"formula\" || name === \"link\";\n\n            // Set values/formulas/links only to the topLeft cell when merged\n            if (valueProp && ref.topLeft) {\n                let topLeftRef = new CellRef(ref.topLeft.row, ref.topLeft.col);\n\n                sheet.forEachMergedCell(function(f) {\n                    if (f.intersects(topLeftRef)) {\n                        result = topLeftRef;\n                    }\n                });\n            }\n\n            sheet._set(result.toRangeRef(), name, value);\n        });\n        if (!noTrigger) {\n            sheet.triggerChange({\n                recalc  : name === \"formula\" || name === \"value\" || name === \"validation\",\n                value   : value,\n                range   : self,\n                ref     : self._ref,\n                isValue : name === \"value\"\n            });\n        }\n        return self;\n    }\n\n    _get(name) {\n        return this._sheet._get(this._ref.toRangeRef(), name);\n    }\n\n    _property(name, value) {\n        if (value === undefined) {\n            return this._get(name);\n        } else {\n            return this._set(name, value);\n        }\n    }\n\n    value(value) {\n        if (value !== undefined) {\n            // When value is set through the public API we must clear the\n            // formula.  Don't trigger change (third parameter), it'll be\n            // done when setting the value below\n            this._set(\"formula\", null, true);\n        }\n        return this._property(\"value\", value);\n    }\n\n    html(value) {\n        return this._property(\"html\", value);\n    }\n\n    resize(direction) {\n        let ref = this._resizedRef(direction);\n        return new Range(ref, this._sheet);\n    }\n\n    _resizedRef(direction) {\n        return this._ref.map(function(ref) {\n            return ref.toRangeRef().resize(direction);\n        });\n    }\n\n    input(value, options) {\n        options = Object.assign({ arrayFormula: false }, options);\n        let existingFormat = this._get(\"format\"), x;\n        if (value !== undefined) {\n            let tl = this._ref.toRangeRef().topLeft;\n            x = calc.parse(this._sheet.name(), tl.row, tl.col, value, existingFormat);\n            this._sheet.batch(function() {\n                let formula = null;\n                if (x.type === \"exp\") {\n                    formula = calc.compile(x);\n                } else if (existingFormat !== \"@\") {\n                    let existingFormatType = existingFormat &&\n                        formatting.type(x.value, existingFormat);\n                    if (x.type === \"date\" && existingFormatType !== \"date\") {\n                        this.format(x.format || toExcelFormat(culture().calendar.patterns.d));\n                    } else if (x.type === \"percent\" && existingFormatType !== \"percent\") {\n                        this.format(x.value * 100 === (x.value * 100 | 0) ? \"0%\" : \"0.00%\");\n                    } else if (x.format) {\n                        if (!existingFormat || x.currency ||\n                            (existingFormatType === \"number\" && x.type === \"number\" &&\n                                x.format.length > existingFormat.length)) {\n                            this.format(x.format);\n                        }\n                    }\n                } else if (x.type !== \"string\") {\n                    x.value = value;\n                }\n                this.formula(formula, options.arrayFormula);\n                if (!formula) {\n                    // value() will clear the formula.  Lucky for us,\n                    // x.value is undefined so it actually won't, but let's\n                    // be explicit and only set value if formula is not\n                    // present.\n                    this.value(x.value);\n                }\n            }.bind(this), {\n                recalc       : true,\n                value        : value,\n                ref          : this._ref,\n                editorChange : this._sheet.isInEditMode(),\n                isValue      : true\n            });\n\n            return this;\n        } else {\n            value = this._get(\"value\");\n            let formula = this._get(\"formula\");\n            let type = existingFormat && !formula && formatting.type(value, existingFormat);\n\n            if (formula) {\n                // it's a Formula object which stringifies to the\n                // formula as text (without the starting `=`).\n                value = \"=\" + formula;\n            } else OUT: {\n                if (existingFormat && type === \"date\") {\n                    // check if we could parse back the displayed value.\n                    // https://github.com/telerik/kendo/issues/5335\n                    let t1 = formatting.text(value, existingFormat);\n                    x = calc.parse(null, null, null, t1, existingFormat); // it's not a formula so we don't need sheet/row/col\n                    let t2 = formatting.text(x.value, existingFormat);\n                    if (t1 === t2) {\n                        value = t1;\n                        break OUT;\n                    }\n                }\n                if (type === \"date\") {\n                    const intlVal = intl();\n                    value = intlVal.toString(calc.runtime.serialToDate(value), culture().calendar.patterns.d, intlVal.locale);\n                } else if (type === \"percent\") {\n                    value = calc.runtime.limitPrecision(value * 100) + \"%\";\n                } else if (typeof value == \"string\" &&\n                            (/^[=']/.test(value) ||\n                            (/^(?:true|false)$/i).test(value) ||\n                            looksLikeANumber(value))) {\n                    value = \"'\" + value;\n                } else if (this._sheet._useCultureDecimals() &&\n                            typeof value == \"number\" &&\n                            value !== Math.floor(value)) {\n                    value = String(value).replace(\".\", culture().numbers.symbols.decimal);\n                }\n            }\n\n            return value;\n        }\n    }\n\n    enable(value) {\n        if (value === undefined) {\n            return !withExit(function(exit) {\n                this._sheet.forEach(this._ref, function(_, __, data) {\n                    if (data.enable === false) {\n                        exit(true);\n                    }\n                });\n            }, this);\n        }\n\n        return this._property(\"enable\", value);\n    }\n\n    formula(value, arrayFormula) {\n        let self = this;\n        if (value === undefined) {\n            let f = self._get(\"formula\");\n            return f ? \"\" + f : null; // stringify if present\n        }\n        if (arrayFormula) {\n            // when setting an array formula, we want to set it on\n            // the first cell only, as it will fill the whole\n            // range.\n            let ref = this._ref.toRangeRef();\n            value = self._sheet.range(ref.topLeft)\n                ._set(\"formula\", value)\n                ._get(\"formula\"); // make sure we get the compiled Formula, not a string\n\n            if (value) {    // could be null.\n                // this will be used in FormulaContext -- it's the\n                // range that the formula must populate.\n                value.setArrayFormulaRange(ref);\n            }\n        } else {\n            self._set(\"formula\", value);\n        }\n        return self;\n    }\n\n    intersectingArrayFormula() {\n        let ref = this._ref.clone().simplify().setSheet(this._sheet.name());\n        return withExit(function(exit) {\n            this._sheet._forFormulas(function(f) {\n                let r = f.arrayFormulaRange;\n                if (r && (r = ref.intersect(r)) !== NULLREF) {\n                    exit({ formula: f, intersection: r });\n                }\n            });\n        }, this);\n    }\n\n    canEditArrayFormula() {\n        let x = this.intersectingArrayFormula();\n        if (x) {\n            // we want to allow editing only when the new range is\n            // at least as big as the original range (i.e. no\n            // cells removed)\n            return x.formula.arrayFormulaRange.eq(x.intersection);\n        }\n        return true;\n    }\n\n    validation(value) {\n        //TODO: Accept objects only?\n\n        if (value === undefined) {\n            let f = this._get(\"validation\");\n\n            return f ? f.toJSON() : null; // stringify if present\n        }\n        return this._property(\"validation\", value);\n    }\n\n    _getValidationState() {\n        let ref = this._ref.toRangeRef();\n        let topLeftRow = ref.topLeft.row;\n        let topLeftCol = ref.topLeft.col;\n        let bottomRightRow = ref.bottomRight.row;\n        let bottomRightCol = ref.bottomRight.col;\n        let ci, ri;\n\n        for (ci = topLeftCol; ci <= bottomRightCol; ci ++) {\n            for (ri = topLeftRow; ri <= bottomRightRow; ri ++) {\n                let validation = this._sheet._validation(ri, ci);\n\n                if (validation && validation.type === \"reject\" && validation.value === false) {\n                    return validation;\n                }\n            }\n        }\n\n        return false;\n    }\n\n    merge() {\n        this._ref = this._sheet._merge(this._ref);\n        return this;\n    }\n\n    unmerge() {\n        let mergedCells = this._sheet._mergedCells;\n\n        this._ref.forEach(function(ref) {\n            ref.toRangeRef().intersecting(mergedCells).forEach(function(mergedRef) {\n                mergedCells.splice(mergedCells.indexOf(mergedRef), 1);\n            });\n        });\n\n        this._sheet.triggerChange({});\n\n        return this;\n    }\n\n    select() {\n        this._sheet.select(this._ref);\n\n        return this;\n    }\n\n    values(values) {\n        if (this._ref instanceof UnionRef) {\n            throw new Error(\"Unsupported for multiple ranges.\");\n        }\n\n        if (this._ref === NULLREF) {\n            if (values !== undefined) {\n                throw new Error(\"Unsupported for NULLREF.\");\n            } else {\n                return [];\n            }\n        }\n\n        let ref = this._ref.toRangeRef();\n        let topLeftRow = ref.topLeft.row;\n        let topLeftCol = ref.topLeft.col;\n        let bottomRightRow = ref.bottomRight.row;\n        let bottomRightCol = ref.bottomRight.col;\n        let ci, ri;\n\n        if (values === undefined) {\n            values = new Array(ref.height());\n\n            for (let vi = 0; vi < values.length; vi++) {\n                values[vi] = new Array(ref.width());\n            }\n\n            for (ci = topLeftCol; ci <= bottomRightCol; ci ++) {\n                for (ri = topLeftRow; ri <= bottomRightRow; ri ++) {\n                    values[ri - topLeftRow][ci - topLeftCol] = this._sheet._value(ri, ci);\n                }\n            }\n\n            return values;\n        } else {\n            this._sheet._set(ref, \"formula\", null);\n\n            for (ci = topLeftCol; ci <= bottomRightCol; ci ++) {\n                for (ri = topLeftRow; ri <= bottomRightRow; ri ++) {\n                    let row = values[ri - topLeftRow];\n\n                    if (row) {\n                        let value = row[ci - topLeftCol];\n\n                        if (value !== undefined) {\n                            this._sheet._value(ri, ci, value);\n                        }\n                    }\n                }\n            }\n\n            this._sheet.triggerChange({ recalc: true, ref: ref });\n\n            return this;\n        }\n    }\n\n    _properties(props, isAutofill) {\n        if (this._ref instanceof UnionRef) {\n            throw new Error(\"Unsupported for multiple ranges.\");\n        }\n\n        if (this._ref === NULLREF) {\n            if (props !== undefined) {\n                throw new Error(\"Unsupported for NULLREF.\");\n            } else {\n                return [];\n            }\n        }\n\n        let ref = this._ref.toRangeRef();\n        let topLeftRow = ref.topLeft.row;\n        let topLeftCol = ref.topLeft.col;\n        let bottomRightRow = ref.bottomRight.row;\n        let bottomRightCol = ref.bottomRight.col;\n        let ci, ri;\n        let sheet = this._sheet;\n\n        if (props === undefined) {\n            props = new Array(ref.height());\n            sheet.forEach(ref, function(row, col, data) {\n                row -= topLeftRow;\n                col -= topLeftCol;\n                let line = props[row] || (props[row] = []);\n                line[col] = data;\n            });\n            return props;\n        } else {\n            let data;\n            ref = ref.clone();\n            let setProp = function(propName) {\n                let propValue = data[propName];\n                ref.topLeft.row = ref.bottomRight.row = ri;\n                ref.topLeft.col = ref.bottomRight.col = ci;\n\n                if (propName === \"value\") {\n                    sheet._set(ref, \"formula\", null);\n                }\n\n                sheet._set(ref, propName, propValue);\n            };\n\n            let isValue = false;\n            for (ci = topLeftCol; ci <= bottomRightCol; ci ++) {\n                if (!isAutofill && sheet.isHiddenColumn(ci)) {\n                    continue;\n                }\n                for (ri = topLeftRow; ri <= bottomRightRow; ri ++) {\n                    if (!isAutofill && sheet.isHiddenRow(ri)) {\n                        continue;\n                    }\n                    if (isAutofill && sheet.isFilteredRow(ri)) {\n                        continue;\n                    }\n                    let row = props[ri - topLeftRow];\n                    if (row) {\n                        data = row[ci - topLeftCol];\n                        if (data) {\n                            const keys = Object.keys(data);\n                            keys.forEach(setProp);\n                            isValue = isValue || keys.includes(\"value\");\n                        }\n                    }\n                }\n            }\n            sheet.triggerChange({ recalc: true, ref: this._ref, isValue: isValue });\n            return this;\n        }\n    }\n\n    clear(options) {\n        options = options || {};\n        let clearAll = options.clearAll || !Object.keys(options).length;\n\n        let sheet = this._sheet;\n\n        let reason = {\n            recalc: clearAll || options.contentsOnly,\n            ref: this._ref,\n            isValue: true\n        };\n\n        sheet.batch(function() {\n\n            if (reason.recalc) {\n                this.formula(null);\n            }\n\n            if (clearAll) {\n                this.validation(null);\n            }\n\n            if (clearAll || options.formatOnly) {\n                PROPERTIES.forEach(function(x) {\n                    if (!(options.keepBorders && /^border/i.test(x))) {\n                        this[x](null);\n                    }\n                }.bind(this));\n                this.fontSize(null);\n                this.wrap(null);\n                this.unmerge();\n            }\n\n        }.bind(this), reason);\n\n        return this;\n    }\n\n    clearContent() {\n        return this.clear({ contentsOnly: true });\n    }\n\n    clearFormat() {\n        return this.clear({ formatOnly: true });\n    }\n\n    isSortable() {\n        return !this.cantSort();\n    }\n\n    cantSort() {\n        if (this._ref instanceof UnionRef) {\n            return { code: \"cantSortMultipleSelection\",\n                        message: \"Unsupported for multiple ranges.\" };\n        }\n        if (this._ref === NULLREF) {\n            return { code: \"cantSortNullRef\",\n                        message: \"Unsupported for NULLREF.\" };\n        }\n        let mc = this._sheet._getMergedCells(this._ref.toRangeRef());\n        let primary = mc.primary;\n        let secondary = mc.secondary;\n        let width = null, height = null;\n        let cant = {};\n        try {\n            this._sheet.forEach(this, function(row, col) {\n                let id = new CellRef(row, col).print();\n                let merged = primary[id];\n                if (merged) {\n                    if (width === null) {\n                        width = merged.width();\n                        height = merged.height();\n                    } else if (!(width === merged.width() && height === merged.height())) {\n                        throw cant;\n                    }\n                } else if (!secondary[id] && mc.hasMerged) {\n                    throw cant;\n                }\n            });\n        } catch (ex) {\n            if (ex !== cant) {\n                throw ex;\n            }\n            return {\n                code: \"cantSortMixedCells\",\n                message: \"Unsupported for range containing cells of different shapes.\"\n            };\n        }\n        return false;\n    }\n\n    sort(spec) {\n        let reason = this.cantSort();\n        if (reason) {\n            throw new Error(reason.message);\n        }\n\n        if (spec === undefined) {\n            spec = { column: 0 };\n        }\n\n        spec = spec instanceof Array ? spec : [spec];\n\n        this._sheet._sortBy(this._ref.toRangeRef(), spec.map(function(spec, index) {\n            if (typeof spec === \"number\") {\n                spec = { column: spec };\n            }\n\n            return {\n                index: spec.column === undefined ? index : spec.column,\n                ascending: spec.ascending === undefined ? true : spec.ascending\n            };\n        }));\n\n        return this;\n    }\n\n    isFilterable() {\n        return !(this._ref instanceof UnionRef);\n    }\n\n    filter(spec) {\n        if (this._ref instanceof UnionRef) {\n            throw new Error(\"Unsupported for multiple ranges.\");\n        }\n\n        if (spec === false) {\n            this.clearFilters();\n        } else {\n            spec = spec === true ? [] : spec instanceof Array ? spec : [spec];\n\n            this._sheet._filterBy(this._ref.toRangeRef(), spec.map(function(spec, index) {\n                return {\n                    index: spec.column === undefined ? spec.index === undefined ? index : spec.index : spec.column,\n                    filter: spec.filter\n                };\n            }));\n        }\n\n        return this;\n    }\n\n    clearFilter(spec) {\n        this._sheet.clearFilter(spec);\n    }\n\n    clearFilters() {\n        let filter = this._sheet.filter();\n        let spec = [];\n\n        if (filter) {\n            for (let i = 0; i < filter.columns.length; i++) {\n                spec.push(filter.columns[i].index);\n            }\n\n            this._sheet.batch(function() {\n                this.clearFilter(spec);\n                this._filter = null;\n            }, { layout: true, filter: true });\n        }\n    }\n\n    hasFilter() {\n        let filter = this._sheet.filter();\n        return Boolean(filter);\n    }\n\n    leftColumn() {\n        return new Range(this._ref.leftColumn(), this._sheet);\n    }\n\n    rightColumn() {\n        return new Range(this._ref.rightColumn(), this._sheet);\n    }\n\n    topRow() {\n        return new Range(this._ref.topRow(), this._sheet);\n    }\n\n    bottomRow() {\n        return new Range(this._ref.bottomRow(), this._sheet);\n    }\n\n    column(column) {\n        return new Range(this._ref.toColumn(column), this._sheet);\n    }\n\n    row(row) {\n        return new Range(this._ref.toRow(row), this._sheet);\n    }\n\n    forEachRow(callback) {\n        this._ref.forEachRow(function(ref) {\n            callback(new Range(ref, this._sheet));\n        }.bind(this));\n    }\n\n    forEachColumn(callback) {\n        this._ref.forEachColumn(function(ref) {\n            callback(new Range(ref, this._sheet));\n        }.bind(this));\n    }\n\n    sheet() {\n        return this._sheet;\n    }\n\n    topLeft() {\n        return this._ref.toRangeRef().topLeft;\n    }\n\n    intersectingMerged() {\n        let sheet = this._sheet;\n        let mergedCells = [];\n\n        sheet._mergedCells.forEach(function(ref) {\n            if (ref.intersects(this._ref)) {\n                mergedCells.push(ref.toString());\n            }\n        }.bind(this));\n\n        return mergedCells;\n    }\n\n    getState(propertyName) {\n        let topLeft = this._ref.first();\n        let state = {\n            ref     : topLeft,\n            data    : [],\n            origRef : this._ref,\n\n            // save row heights\n            rows    : this._sheet._rows.getState()\n        };\n        let properties;\n        if (!propertyName) {\n            properties = ALL_PROPERTIES;\n            state.mergedCells = this.intersectingMerged();\n        } else if (propertyName === \"input\") {\n            properties = [\"value\", \"formula\"];\n        } else if (propertyName === \"border\") {\n            properties = [\"borderLeft\", \"borderTop\", \"borderRight\", \"borderBottom\"];\n        } else {\n            properties = [propertyName];\n        }\n\n        let data = state.data;\n        this.forEachCell(function(row, col, cell) {\n            let cellState = {};\n            let dr = row - topLeft.row;\n            let dc = col - topLeft.col;\n            if (!data[dr]) {\n                data[dr] = [];\n            }\n            data[dr][dc] = cellState;\n\n            properties.forEach(function(property) {\n                let value = typeof cell[property] == \"undefined\" ? null : cell[property];\n                if (value instanceof calc.runtime.Formula ||\n                    value instanceof validationExport.Validation) {\n                    value = value.deepClone();\n                }\n                cellState[property] = value;\n            });\n        });\n\n        return state;\n    }\n\n    setState(state, clipboard) {\n        let sheet = this._sheet;\n        let origin = this._ref.first();\n        let rowDelta = state.ref.row - origin.row;\n        let colDelta = state.ref.col - origin.col;\n        let internalClipboard = clipboard && !clipboard.isExternal();\n        let externalClipboard = clipboard && !internalClipboard;\n\n        sheet.batch(function() {\n            if (state.mergedCells) {\n                this.unmerge();\n            }\n\n            if (!clipboard) {\n                // restore row heights.  they won't be available\n                // when this function is called from the clipboard\n                // code.\n                this._sheet._rows.setState(state.rows);\n            }\n\n            let row = origin.row;\n            let hasFilter = this.hasFilter();\n            state.data.forEach(function(data, dr) {\n                if (hasFilter && internalClipboard && sheet.isHiddenRow(state.ref.row + dr)) {\n                    return;\n                }\n                let col = origin.col;\n                data.forEach(function(cellState, dc) {\n                    if (hasFilter && internalClipboard && sheet.isHiddenColumn(state.ref.col + dc)) {\n                        return;\n                    }\n                    let range = clipboard ? sheet.range(row, col)\n                        : sheet.range(origin.row + dr, origin.col + dc);\n                    if (range.enable()) {\n                        for (let property in cellState) {\n                            if (property !== \"value\") {\n                                // make sure value comes last (after the loop),\n                                // because if we set value here and get get to\n                                // formula later and cellState.formula is null,\n                                // it'll clear the value.\n\n                                // when pasting, do not copy \"disabled\" state\n                                if (!(clipboard && property === \"enable\")) {\n                                    range._set(property, cellState[property]);\n                                }\n                            }\n                        }\n                        if (!cellState.formula) {\n                            // only need to set the value if we don't have a\n                            // formula.  Go through the lower level setter rather\n                            // than range.value(...), because range.value will clear\n                            // the formula!  chicken and egg issues.\n                            if (externalClipboard) {\n                                // https://github.com/telerik/kendo-ui-core/issues/1688\n                                // if we have a paste from external source, we should parse the\n                                // value as if it were inputted.  This allows to treat numbers\n                                // as numbers, or `=sum(a1:b2)` as formula (Google Sheets does\n                                // the same).  A difference though is that we can't store an\n                                // invalid Formula and display #ERROR, like G.S. does, so in\n                                // case of a parse error we'll just set the value as string.\n                                try {\n                                    if (cellState.value == null) {\n                                        range._set(\"value\", null);\n                                    } else {\n                                        range.input(cellState.value);\n                                    }\n                                } catch (ex) {\n                                    range._set(\"value\", cellState.value);\n                                }\n                            } else {\n                                range._set(\"value\", cellState.value);\n                            }\n                        }\n                    }\n                    col++;\n                });\n                row++;\n            });\n\n            if (state.mergedCells) {\n                state.mergedCells.forEach(function(merged) {\n                    merged = sheet._ref(merged).relative(rowDelta, colDelta, 3);\n                    sheet.range(merged).merge();\n                }, this);\n            }\n        }.bind(this), { recalc: true, ref: this._ref });\n    }\n\n    _adjustRowHeight() {\n        let that = this;\n        let sheet = that._sheet;\n        let mc = sheet._getMergedCells(that._ref.toRangeRef());\n        let primary = mc.primary;\n        let secondary = mc.secondary;\n\n        sheet.batch(function() {\n            that.forEachRow(function(rowRange) {\n                let row = rowRange._ref.topLeft.row;\n                let height = sheet.rowHeight(row);\n                if (!height) {\n                    // do not adjust if hidden.\n                    // https://github.com/telerik/kendo-ui-core/issues/6272\n                    // (case 2)\n                    return;\n                }\n                rowRange.forEachCell(function(row, col, cell) {\n                    let id = new CellRef(row, col).print();\n                    if (secondary[id]) {\n                        return;\n                    }\n                    let merged = primary[id];\n                    let width;\n                    if (merged) {\n                        width = sheet._columns.sum(merged.topLeft.col,\n                                                    merged.bottomRight.col);\n                    } else {\n                        width = sheet.columnWidth(col);\n                    }\n                    let data = cell.value;\n                    if (cell.format && data != null) {\n                        data = formatting.format(data, cell.format);\n                    }\n                    let textHeight = getTextHeight(\n                        data, width, cell.fontFamily, cell.fontSize, cell.wrap);\n                    height = Math.max(height, textHeight);\n                });\n                sheet.rowHeight(row, height);\n            });\n        }, { layout: true });\n    }\n\n    forEachCell(callback) {\n        this._ref.forEach(function(ref) {\n            this._sheet.forEach(ref.toRangeRef(), callback.bind(this));\n        }.bind(this));\n    }\n\n    hasValue() {\n        let defStyle = this._sheet._defaultCellStyle;\n        return withExit(function(exit) {\n            this.forEachCell(function(row, col, cell) {\n                // we must not consider cells that only have same values\n                // as defaultCellStyle, or otherwise we will forbid\n                // inserting rows/cols in an empty sheet.\n                for (let key in cell) {\n                    let val = cell[key];\n                    if (val !== undefined && val !== null && val !== defStyle[key]) {\n                        exit(true);\n                    }\n                }\n            });\n        }, this);\n    }\n\n    wrap(flag) {\n        if (flag === undefined) {\n            return Boolean(this._property(\"wrap\"));\n        }\n        this._property(\"wrap\", flag);\n        if (flag !== null) {\n            this._adjustRowHeight();\n        }\n        return this;\n    }\n\n    fontSize(size) {\n        if (size === undefined) {\n            return this._property(\"fontSize\");\n        }\n        this._property(\"fontSize\", size);\n        if (size !== null) {\n            this._adjustRowHeight();\n        }\n        return this;\n    }\n\n    draw(options, callback) {\n        this._sheet.draw(this, options, callback);\n    }\n\n    insideBorders(value) {\n        return this.insideVerticalBorders(value).insideHorizontalBorders(value);\n    }\n\n    insideVerticalBorders(value) {\n        this._ref.forEach(function(ref) {\n            if (ref instanceof RangeRef && ref.width() > 1) {\n                ref = ref.clone();\n                ref.topLeft.col++;\n                this._sheet.range(ref)._set(\"vBorders\", value);\n            }\n        }, this);\n        return this;\n    }\n\n    insideHorizontalBorders(value) {\n        this._ref.forEach(function(ref) {\n            if (ref instanceof RangeRef && ref.height() > 1) {\n                ref = ref.clone();\n                ref.topLeft.row++;\n                this._sheet.range(ref)._set(\"hBorders\", value);\n            }\n        }, this);\n        return this;\n    }\n};\nfunction partition(begin, end, predicate) {\n    while (begin <= end && predicate(begin)) {\n        begin++;\n    }\n    if (begin > end) {\n        return [];\n    }\n    for (let i = begin + 1; i <= end; ++i) {\n        if (predicate(i)) {\n            return [\n                    { begin: begin, end: i - 1 }\n            ].concat(partition(i + 1, end, predicate));\n        }\n    }\n    return [{ begin: begin, end: end }];\n}\nPROPERTIES.forEach(function(property) {\n    Range$1.prototype[property] = function(value) {\n        return this._property(property, value);\n    };\n});\nfunction toExcelFormat(format) {\n    return format.replace(/M/g, \"m\").replace(/'/g, '\"').replace(/tt/, \"am/pm\");\n}\nfunction looksLikeANumber(str) {\n    // XXX: could do with just a regexp instead of calling parse.\n    return !(/^=/.test(str)) && (/number|percent/).test(calc.parse(null, 0, 0, str).type);\n}\n\nfunction getTextHeight(text, width, fontFamily, fontSize, wrap) {\n    const measureBox = document.createElement(\"div\");\n\n    measureBox.style.setProperty('position', 'absolute', 'important');\n    measureBox.style.setProperty('top', '-4000px', 'important');\n    measureBox.style.setProperty('height', 'auto', 'important');\n    measureBox.style.setProperty('padding', '1px 3px', 'important');\n    measureBox.style.setProperty('box-sizing', 'border-box', 'important');\n    measureBox.style.setProperty('margin', '0', 'important');\n    measureBox.style.setProperty('border', '1px solid black', 'important');\n    measureBox.style.setProperty('line-height', 'normal', 'important');\n    measureBox.style.setProperty('visibility', 'hidden', 'important');\n    measureBox.style.setProperty('white-space', 'pre-wrap');\n\n    let styles = {\n        \"baselineMarkerSize\" : 0,\n        \"width\" : (wrap === true) ? width + \"px\" : \"auto\",\n        \"font-size\" : (fontSize || 12) + \"px\",\n        \"font-family\" : fontFamily || \"Arial\",\n        \"white-space\" : (wrap === true) ? \"pre-wrap\" : \"pre\",\n        \"overflow-wrap\" : (wrap === true) ? \"break-word\" : \"normal\",\n        \"word-wrap\" : (wrap === true) ? \"break-word\" : \"normal\"\n    };\n\n    return measureText(text, styles, { box: measureBox, normalizeText: false }).height;\n}\n\n// --------------------------------------------------------------- autofill.js\n\nvar runtime = calc.runtime;\nvar Formula = runtime.Formula;\n\nvar ERR_INCOMPATIBLE = \"incompatibleRanges\";\nvar ERR_NO_DIRECTION = \"noFillDirection\";\n\nvar FillError = Range$1.FillError = function(msg) {\n    this.code = msg;\n};\n\n// `srcRange`: the range containing data that we wish to fill.  `direction`: 0↓, 1→, 2↑, 3←.  So\n// when bit 0 is set we're doing horizontal filling, and when bit 1 is set we're doing it in\n// reverse order.\nRange$1.prototype._previewFillFrom = function(srcRange, direction) {\n    var destRange = this, sheet = destRange._sheet;\n    if (typeof srcRange == \"string\") {\n        srcRange = sheet.range(srcRange);\n    }\n    var src = srcRange._ref.toRangeRef().clone().setSheet(sheet.name());\n    var dest = destRange._ref.toRangeRef().clone().setSheet(sheet.name());\n\n    if (src.intersects(dest)) {\n        // the UI will send e.g. C2:C8.fillFrom(C7:D8) (intersecting ranges).  this figures out\n        // the actual destination range.\n        if (src.eq(dest)) {\n            return null; // nothing to do\n        }\n        dest = dest.clone();\n        if (src.topLeft.eq(dest.topLeft)) {\n            if (src.width() == dest.width()) {\n                dest.topLeft.row += src.height();\n                direction = 0;\n            } else if (src.height() == dest.height()) {\n                dest.topLeft.col += src.width();\n                direction = 1;\n            } else {\n                throw new FillError(ERR_INCOMPATIBLE);\n            }\n        } else if (src.bottomRight.eq(dest.bottomRight)) {\n            if (src.width() == dest.width()) {\n                dest.bottomRight.row -= src.height();\n                direction = 2;\n            } else if (src.height() == dest.height()) {\n                dest.bottomRight.col -= src.width();\n                direction = 3;\n            } else {\n                throw new FillError(ERR_INCOMPATIBLE);\n            }\n        } else {\n            throw new FillError(ERR_INCOMPATIBLE);\n        }\n        return sheet.range(dest)._previewFillFrom(srcRange, direction);\n    }\n\n    if (direction == null) {\n        // try to determine based on ranges location/geometry\n        if (src.topLeft.col == dest.topLeft.col) {\n            // assume vertical filling\n            direction = src.topLeft.row < dest.topLeft.row ? 0 : 2;\n        } else if (src.topLeft.row == dest.topLeft.row) {\n            direction = src.topLeft.col < dest.topLeft.col ? 1 : 3;\n        } else {\n            throw new FillError(ERR_NO_DIRECTION);\n        }\n    }\n    var horizontal = direction & 1;\n    var descending = direction & 2;\n    if ((horizontal && src.height() != dest.height()) ||\n        (!horizontal && src.width() != dest.width())) {\n        throw new FillError(ERR_INCOMPATIBLE);\n    }\n    var data = srcRange._properties(), n;\n    if (!horizontal) {\n        data = transpose(data);\n        n = dest.height();\n    } else {\n        n = dest.width();\n    }\n    var fill = new Array(data.length);\n    var hint = null;\n    for (var i = 0; i < data.length; ++i) {\n        var s = data[i];\n        var f = findSeries(s);\n        var a = fill[i] = new Array(n);\n        for (var j = 0; j < n; ++j) {\n            var idx = descending ? -j - 1 : s.length + j;\n            var srcIdx = descending ? s.length - (j % s.length) - 1 : (j % s.length);\n            var cell = a[descending ? n - j - 1 : j] = f(idx, srcIdx);\n            if (cell.value != null) {\n                hint = cell.value;\n            }\n        }\n    }\n    if (!horizontal) {\n        fill = transpose(fill);\n    }\n    return { props: fill, direction: direction, dest: destRange, hint: hint };\n};\n\nRange$1.prototype.fillFrom = function(srcRange, direction) {\n    var x = this._previewFillFrom(srcRange, direction);\n    x.dest._properties(x.props, true);\n    return x.dest;\n};\n\n// This is essentially the FORECAST function, see ./runtime.functions.2.js.\n// It receives an array of values, and returns a function that \"predicts\"\n// the value in cell N.\nfunction linearRegression(data) {\n    var N = data.length;\n    var mx = (N + 1) / 2, my = data.reduce(function(a, b){\n        return a + b;\n    }, 0) / N;\n    var s1 = 0, s2 = 0;\n    for (var i = 0; i < N; i++) {\n        var t1 = (i + 1) - mx, t2 = data[i] - my;\n        s1 += t1 * t2;\n        s2 += t1 * t1;\n    }\n    if (!s2) {\n        return function(N){\n            return data[N % data.length];\n        };\n    }\n    var b = s1 / s2, a = my - b * mx;\n    return function(N) {\n        return a + b * (N + 1);\n    };\n}\n\nfunction findSeries(properties) {\n    function findStep(a) {\n        var diff = a[1] - a[0];\n        for (var i = 2; i < a.length; ++i) {\n            if (a[i] - a[i-1] != diff) {\n                return null;\n            }\n        }\n        return diff;\n    }\n    function getData(a) {\n        return a.map(function(v){\n            return v.number;\n        });\n    }\n    var series = [];\n    var data = properties.map(function(x){\n        return x.formula || x.value;\n    });\n    forEachSeries(data, function(begin, end, type, a){\n        var f, values;\n        if (type == \"number\") {\n            values = getData(a);\n\n            // This code would increase a date even if a single cell was selected.  Seems it's\n            // not desirable so I commented it out.\n            // https://github.com/telerik/kendo-ui-core/issues/3565\n            //\n            // if (values.length == 1 && (begin > 0 || end < data.length ||\n            //                            formatType(values[0], properties[begin].format) == \"date\")) {\n            //     values.push(values[0] + 1);\n            // }\n\n            f = linearRegression(values);\n        } else if (type == \"string\" || type == \"formula\" || type == \"boolean\") {\n            // formulas are simply copied over; the sheet will internally clone the objects\n            f = function(N, i) {\n                return data[i];\n            };\n        } else if (Array.isArray(type)) {\n            if (a.length == 1) {\n                f = function(N) {\n                    return type[(a[0].number + N) % type.length];\n                };\n            } else {\n                // figure out the step\n                var diff = findStep(getData(a));\n                if (diff == null) {\n                    // seemingly no pattern, just repeat those strings\n                    f = function(N) {\n                        return a[(N) % a.length].value;\n                    };\n                } else {\n                    f = function(N) {\n                        var idx = a[0].number + diff * N;\n                        return type[idx % type.length];\n                    };\n                }\n            }\n        } else if (type != \"null\") {\n            values = getData(a);\n            if (values.length == 1) {\n                values.push(values[0] + 1);\n            }\n            values = linearRegression(values);\n            f = function(N, i) {\n                return data[i].replace(/^(.*[\\D0]+)\\d+/, \"$1\" + values(N, i));\n            };\n        } else {\n            f = function() { return null; };\n        }\n        var s = { f: f, begin: begin, end: end, len: end - begin };\n        for (var i = begin; i < end; ++i) {\n            series[i] = s;\n        }\n    });\n    return function(N, i) {\n        var s = series[i];\n        var q = N / data.length | 0;\n        var r = N % data.length;\n        var n = q * s.len + r - s.begin;\n        var value = s.f(n, i);\n        var props = clone$1(properties[i]);\n        delete props.enable;\n        if (value instanceof Formula) {\n            props.formula = value;\n        } else {\n            props.value = value;\n        }\n        return props;\n    };\n}\n\nfunction clone$1(obj) {\n    var copy = {};\n    Object.keys(obj || {}).forEach(function(key){\n        copy[key] = obj[key];\n    });\n    return copy;\n}\n\nfunction forEachSeries(data, f) {\n    var prev = null, start = 0, a = [], type;\n    for (var i = 0; i < data.length; ++i) {\n        type = getType(data[i]);\n        a.push(type);\n        if (prev != null && type.type !== prev.type) {\n            f(start, i, prev.type, a.slice(start, i));\n            start = i;\n        }\n        prev = type;\n    }\n    f(start, i, prev.type, a.slice(start, i));\n}\n\nfunction getType(el) {\n    if (typeof el == \"number\") {\n        return { type: \"number\", number: el };\n    }\n    if (typeof el == \"string\") {\n        var lst = findStringList(el);\n        if (lst) {\n            return lst;\n        }\n        var m = /^(.*\\D)(\\d+)/.exec(el);\n        if (m) {\n            el = el.replace(/^(.*\\D)\\d+/, \"$1-######\");\n            return { type: el, match: m, number: parseFloat(m[2]) };\n        }\n        return { type: \"string\" };\n    }\n    if (typeof el == \"boolean\") {\n        return { type: \"boolean\" };\n    }\n    if (el == null) {\n        return { type: \"null\" };\n    }\n    if (el instanceof Formula) {\n        return { type: \"formula\" };\n    }\n    window.console.error(el);\n    throw new Error(\"Cannot fill data\");\n}\n\nfunction stringLists() {\n    const calendar = culture().calendar;\n    return [\n        calendar.days.format.abbreviated,\n        calendar.days.format.wide,\n        calendar.months.format.abbreviated,\n        calendar.months.format.wide\n    ];\n}\n\nfunction findStringList(str) {\n    var strl = str.toLowerCase();\n    var lists = stringLists();\n    for (var i = 0; i < lists.length; ++i) {\n        var a = lists[i];\n        for (var j = a.length; --j >= 0;) {\n            var el = a[j].toLowerCase();\n            if (el == strl) {\n                return { type: a, number: j, value: str };\n            }\n        }\n    }\n}\n\nfunction transpose(a) {\n    var height = a.length, width = a[0].length;\n    var t = [];\n    for (var i = 0; i < width; ++i) {\n        t[i] = [];\n        for (var j = 0; j < height; ++j) {\n            t[i][j] = a[j][i];\n        }\n    }\n    return t;\n}\n\n/* eslint-disable no-loop-func */\n/* eslint-disable no-param-reassign */\nconst STRING$1 = 'string';\nconst FUNCTION = 'function';\n\nlet preventDefault = function() {\n    this._defaultPrevented = true;\n};\n\nlet isDefaultPrevented = function() {\n    return this._defaultPrevented === true;\n};\n\nclass Observable {\n    constructor() {\n        this._events = {};\n    }\n\n    bind(eventName, handlers, one) {\n        let that = this,\n            idx,\n            eventNames = typeof eventName === STRING$1 ? [eventName] : eventName,\n            length,\n            original,\n            handler,\n            handlersIsFunction = typeof handlers === FUNCTION,\n            events;\n\n        if (handlers === undefined) {\n            for (idx in eventName) {\n                that.bind(idx, eventName[idx]);\n            }\n            return that;\n        }\n\n        for (idx = 0, length = eventNames.length; idx < length; idx++) {\n            eventName = eventNames[idx];\n\n            handler = handlersIsFunction ? handlers : handlers[eventName];\n\n            if (handler) {\n                if (one) {\n                    original = handler;\n                    handler = function() {\n                        that.unbind(eventName, handler);\n                        original.apply(that, arguments);\n                    };\n                    handler.original = original;\n                }\n                events = that._events[eventName] = that._events[eventName] || [];\n                events.push(handler);\n            }\n        }\n\n        return that;\n    }\n\n    one(eventNames, handlers) {\n        return this.bind(eventNames, handlers, true);\n    }\n\n    first(eventName, handlers) {\n        let that = this,\n            idx,\n            eventNames = typeof eventName === STRING$1 ? [eventName] : eventName,\n            length,\n            handler,\n            handlersIsFunction = typeof handlers === FUNCTION,\n            events;\n\n        for (idx = 0, length = eventNames.length; idx < length; idx++) {\n            eventName = eventNames[idx];\n\n            handler = handlersIsFunction ? handlers : handlers[eventName];\n\n            if (handler) {\n                events = that._events[eventName] = that._events[eventName] || [];\n                events.unshift(handler);\n            }\n        }\n\n        return that;\n    }\n\n    trigger(eventName, e) {\n        let that = this,\n            events = that._events[eventName],\n            idx,\n            length;\n\n        if (events) {\n            e = e || {};\n\n            e.sender = that;\n\n            e._defaultPrevented = false;\n\n            e.preventDefault = preventDefault;\n\n            e.isDefaultPrevented = isDefaultPrevented;\n\n            events = events.slice();\n\n            for (idx = 0, length = events.length; idx < length; idx++) {\n                events[idx].call(that, e);\n            }\n\n            return e._defaultPrevented === true;\n        }\n\n        return false;\n    }\n\n    unbind(eventName, handler) {\n        let that = this,\n            events = that._events[eventName],\n            idx;\n\n        if (eventName === undefined) {\n            that._events = {};\n        } else if (events) {\n            if (handler) {\n                for (idx = events.length - 1; idx >= 0; idx--) {\n                    if (events[idx] === handler || events[idx].original === handler) {\n                        events.splice(idx, 1);\n                    }\n                }\n            } else {\n                that._events[eventName] = [];\n            }\n        }\n\n        return that;\n    }\n}\n\nclass Widget extends Observable {\n    constructor(element, options) {\n        super();\n\n        this.element = element;\n        this.events = [];\n        this.options = options;\n\n        // this.bind(this.events, options);\n    }\n\n    setOptions(options) {\n        this._setEvents(options);\n        deepExtend({}, this.options, options);\n    }\n\n    _setEvents(options) {\n        let that = this,\n            idx = 0,\n            length = that.events.length,\n            e;\n\n        for (; idx < length; idx ++) {\n            e = that.events[idx];\n            if (that.options[e] && options[e]) {\n                that.unbind(e, that.options[e]);\n                if (that._events && that._events[e]) {\n                    delete that._events[e];\n                }\n            }\n        }\n\n        that.bind(that.events, options);\n    }\n\n    resize(force) {\n        const size = this.getSize(),\n            currentSize = this._size;\n\n        if (force || (size.width > 0 || size.height > 0) && (!currentSize || size.width !== currentSize.width || size.height !== currentSize.height)) {\n            this._size = size;\n            this._resize(size, force);\n            this.trigger(\"resize\", size);\n        }\n    }\n\n    getSize() {\n        return { width: this.element.offsetWidth, height: this.element.offsetHeight };\n    }\n\n    destroy() {\n        this.unbind();\n    }\n}\n\n/* eslint-disable no-param-reassign */\n\nconst _activeElement = function() {\n    try {\n        return document.activeElement;\n    } catch (e) {\n        return document.documentElement.activeElement;\n    }\n};\n\nclass SheetEditor extends Observable {\n    constructor(view) {\n        super();\n\n        this.events = [\n            \"activate\",\n            \"deactivate\",\n            \"change\",\n            \"update\"\n        ];\n\n        this.view = view;\n        this.formulaBar = view.formulaBar;\n        this._active = false;\n\n        this.barInput = view.formulaBar.formulaInput;\n        this.cellInput = view.formulaInput;\n\n        this.barInput.syncWith(this.cellInput);\n        this.cellInput.syncWith(this.barInput);\n\n        this.barInput.bind(\"keyup\", this._triggerUpdate.bind(this));\n        this.cellInput.bind(\"keyup\", this._triggerUpdate.bind(this));\n\n        this.barInput.bind(\"blur\", this._blur.bind(this));\n        this.cellInput.bind(\"blur\", this._blur.bind(this));\n    }\n\n    _blur() {\n        this.deactivate();\n    }\n\n    _triggerUpdate() {\n        this.trigger(\"update\", { value: this.value() });\n    }\n\n    activeEditor() {\n        let editor = null;\n        let activeElement = _activeElement();\n\n        if (this.barElement() === activeElement) {\n            editor = this.barInput;\n        } else if (this.cellElement() === activeElement) {\n            editor = this.cellInput;\n        }\n\n        return editor;\n    }\n\n    activate(options) {\n        let viewElement = this.view.element,\n            viewWidth, scrollerElement, scrollbarWidth;\n\n        this._active = true;\n        this._rect = options.rect;\n        this._range = options.range;\n\n        this.cellInput.position(options.rect);\n        this.cellInput.resize(options.rect);\n        this.cellInput.tooltip(options.tooltip);\n        this.cellInput.activeCell = this.barInput.activeCell = this._range.topLeft();\n        this.cellInput.activeSheet = this.barInput.activeSheet = this._range._sheet;\n\n        if (viewElement) {\n            viewWidth = viewElement.offsetWidth;\n            scrollerElement = viewElement.querySelector(\".k-spreadsheet-scroller\");\n            scrollbarWidth = scrollerElement.offsetWidth - scrollerElement.clientWidth;\n\n            this.cellInput.element.style.maxWidth = (viewWidth - scrollbarWidth - parseFloat(this.cellInput.element.style.left)) + \"px\";\n        }\n\n        this.trigger(\"activate\");\n\n        return this;\n    }\n\n    deactivate(noChange) {\n        let cellInput = this.cellInput;\n\n        if (!this._active) {\n            return;\n        }\n\n        this._active = false;\n\n        if (!noChange && cellInput.value() !== this._value) {\n            this.trigger(\"change\", {\n                value: cellInput.value(),\n                range: this._range\n            });\n        }\n\n        this._rect = null;\n        cellInput.hide();\n        this.trigger(\"deactivate\");\n    }\n\n    enable(enable) {\n        this.barInput.enable(enable);\n        this.cellInput.enable(enable);\n    }\n\n    barElement() {\n        return this.barInput.element;\n    }\n\n    cellElement() {\n        return this.cellInput.element;\n    }\n\n    focus(inputType) {\n        inputType = inputType || \"cell\";\n\n        if (inputType === \"cell\") {\n            this.cellInput.element.focus();\n            this.cellInput.end();\n        } else {\n            this.barInput.focus();\n        }\n    }\n\n    isActive() {\n        return this._active;\n    }\n\n    isFiltered() {\n        return this.barInput.popup.visible() || this.cellInput.popup.visible();\n    }\n\n    canInsertRef(isKeyboardAction) {\n        let editor = this.activeEditor();\n        return editor && editor.canInsertRef(isKeyboardAction);\n    }\n\n    highlightedRefs() {\n        let editor = this.activeEditor();\n        let refs = [];\n\n        if (editor) {\n            refs = editor.highlightedRefs();\n        }\n\n        return refs;\n    }\n\n    scale() {\n        this.cellInput.scale();\n    }\n\n    toggleTooltip(rect) {\n        this.cellInput.toggleTooltip(notEqual(this._rect, rect));\n    }\n\n    value(value, isArrayFormula) {\n        if (value === undefined) {\n            return this.barInput.value();\n        }\n\n        if (value === null) {\n            value = \"\";\n        }\n\n        this._value = value;\n\n        this.barInput.value(value);\n        this.cellInput.value(value);\n\n        this.barInput.element.classList.toggle(\"k-spreadsheet-array-formula\", Boolean(isArrayFormula));\n    }\n\n    insertNewline() {\n        this.activeEditor().insertNewline();\n        this.scale();\n    }\n\n    select() {\n        this.activeEditor().select();\n    }\n}\n\nfunction notEqual(oldRect, newRect) {\n    return oldRect && (oldRect.top !== newRect.top || oldRect.left !== newRect.left);\n}\n\nconst ampRegExp = /&/g,\n    ltRegExp = /</g,\n    quoteRegExp = /\"/g,\n    aposRegExp = /'/g,\n    gtRegExp = />/g;\n\nconst htmlEncode = function(value) {\n    return String(value).replace(ampRegExp, \"&amp;\").replace(ltRegExp, \"&lt;\").replace(gtRegExp, \"&gt;\").replace(quoteRegExp, \"&quot;\").replace(aposRegExp, \"&#39;\");\n};\n\nclass Axis {\n    constructor(count, value) {\n        this._value = value;\n        this._count = count;\n        this.values = new RangeList(0, count - 1, value);\n        this._hidden = new RangeList(0, count - 1, 0);\n        this.scrollBarSize = scrollbar();\n        this._refresh();\n    }\n    _resize(count) {\n        if (count > this._count) {\n            this.values.value(this._count, count - 1, this._value);\n            this._hidden.value(this._count, count - 1, 0);\n        } else if (count < this._count) {\n            this.values.value(count, this._count - 1, 0);\n            this._hidden.value(count, this._count - 1, 0);\n        }\n        this._count = count;\n        this._refresh();\n    }\n    adjust(start, delta) {\n        // adjust this axis for insert/remove rows/cols operation\n        if (delta < 0) {\n            // removing -- copy from start+|delta| to start\n            this.values.copy(start - delta, this._count - 1, start);\n            this._hidden.copy(start - delta, this._count - 1, start);\n        } else {\n            // adding -- copy from start to start+delta, and set\n            // values for inserted things to default.\n            this.values.copy(start, this._count, start + delta);\n            this._hidden.copy(start, this._count, start + delta);\n            this.values.value(start, start + delta - 1, this._value);\n            this._hidden.value(start, start + delta - 1, 0);\n        }\n        this._refresh();\n    }\n    toJSON(field, positions) {\n        let values = [];\n\n        let iterator = this.values.iterator(0, this._count - 1);\n\n        for (let idx = 0; idx < this._count; idx++) {\n            let value = iterator.at(idx);\n            let hidden = this._hidden.value(idx, idx);\n\n            if (value === this._value && !hidden) {\n                continue;\n            }\n\n            let position = positions[idx];\n\n            if (position === undefined) {\n                position = values.length;\n\n                let item = { index: idx };\n\n                item[field] = value;\n                if (hidden) {\n                    item.hidden = hidden;\n                }\n\n                values.push(item);\n\n                positions[idx] = position;\n            }\n        }\n\n        return values;\n    }\n    fromJSON(field, values) {\n        for (let idx = 0; idx < values.length; idx++) {\n            let el = values[idx];\n\n            let index = el.index;\n            if (index === undefined) {\n                index = idx;\n            }\n\n            // when this particular axis is hidden, the value for\n            // the field (\"height\" or \"width\") will be zero, and\n            // in the \"hidden\" field we'll have the actual value\n            // before it was hidden.\n            // https://github.com/telerik/kendo-ui-core/issues/3523\n            let value = el[field];\n\n            if (value === 0) {\n                this._hidden.value(index, index, el.hidden || this._value);\n                this.value(index, index, 0);\n            } else {\n                this.value(index, index, value);\n            }\n        }\n    }\n    hide(index) {\n        if (!this.hidden(index)) {\n            let value = this.value(index, index);\n            this._hidden.value(index, index, value);\n            this.value(index, index, 0);\n        }\n    }\n    hidden(index) {\n        return this._hidden.value(index, index) !== 0;\n    }\n    includesHidden(start, end) {\n        return this._hidden.intersecting(start, end).length > 1;\n    }\n    nextVisible(index) {\n        let end = this._count - 1, i = index;\n        while (++i <= end) {\n            if (!this.hidden(i)) {\n                return i;\n            }\n        }\n        return index;\n    }\n    nextUntil(index, pred) {\n        let end = this._count - 1, i = index, advanced = false;\n        while (++i <= end) {\n            let val = pred(i, advanced, this.hidden(i));\n            if (typeof val == 'number') {\n                return val;\n            } else if (val) {\n                break;\n            }\n            advanced = true;\n        }\n        return i - 1;\n    }\n    nextPage(index, pageSize) {\n        return this.index(this.sum(0, index - 1) + pageSize);\n    }\n    prevPage(index, pageSize) {\n        return this.index(this.sum(0, index) - pageSize);\n    }\n    firstVisible() {\n        let firstHidden = this._hidden.first();\n        if (firstHidden.value === 0) {\n            return 0;\n        }\n        return firstHidden.end + 1;\n    }\n    lastVisible() {\n        let lastHidden = this._hidden.last();\n        if (lastHidden.value === 0) {\n            return this._count - 1;\n        }\n        return lastHidden.start - 1;\n    }\n    prevVisible(index) {\n        let i = index;\n        while (--i >= 0) {\n            if (!this.hidden(i)) {\n                return i;\n            }\n        }\n        return index;\n    }\n    prevUntil(index, pred) {\n        let i = index, advanced = false;\n        while (--i >= 0) {\n            let val = pred(i, advanced, this.hidden(i));\n            if (typeof val == 'number') {\n                return val;\n            } else if (val) {\n                break;\n            }\n            advanced = true;\n        }\n        return i + 1;\n    }\n    unhide(index) {\n        if (this.hidden(index)) {\n            let value = this._hidden.value(index, index);\n            this._hidden.value(index, index, 0);\n            this.value(index, index, value);\n        }\n    }\n    value(start, end, value) {\n        if (value !== undefined) {\n            this.values.value(start, end, value);\n            this._refresh();\n        } else {\n            return this.values.iterator(start, end).at(0);\n        }\n    }\n    sum(start, end) {\n        let values = this.values.iterator(start, end);\n        let sum = 0;\n        for (let idx = start; idx <= end; idx ++) {\n            sum += values.at(idx);\n        }\n        return sum;\n    }\n    locate(start, end, predicate) {\n        let values = this.values.iterator(start, end);\n        let sum = 0;\n        for (let idx = start; idx <= end; idx++) {\n            sum += values.at(idx);\n            let val = predicate(sum);\n            if (val) {\n                return idx;\n            }\n        }\n        return null;\n    }\n    visible(start, end) {\n        let startSegment = null;\n        let endSegment = null;\n        let lastPage = false;\n        if (end >= this.total + this.scrollBarSize) {\n            lastPage = true;\n        }\n        let ranges = this._pixelValues.intersecting(start, end);\n        startSegment = ranges[0];\n        endSegment = ranges[ranges.length - 1];\n        if (!startSegment) {\n            return { values: this.values.iterator(0, 0), offset: 0 };\n        }\n        let startOffset = start - startSegment.start;\n        // eslint-disable-next-line no-bitwise\n        let startIndex = ((startOffset / startSegment.value.value) >> 0) + startSegment.value.start;\n        let offset = startOffset - (startIndex - startSegment.value.start) * startSegment.value.value;\n        let endOffset = end - endSegment.start;\n        // eslint-disable-next-line no-bitwise\n        let endIndex = ((endOffset / endSegment.value.value) >> 0) + endSegment.value.start;\n        if (endIndex > endSegment.value.end) {\n            endIndex = endSegment.value.end;\n        }\n        if (lastPage) {\n            offset += endSegment.value.value - (endOffset - (endIndex - endSegment.value.start) * endSegment.value.value);\n        }\n        offset = Math.min(-offset, 0);\n        return {\n            values: this.values.iterator(startIndex, endIndex),\n            offset: offset\n        };\n    }\n    index(value) {\n        let index = 0;\n        let iterator = this.values.iterator(0, this._count - 1);\n        let current = iterator.at(0);\n        while (current < value && index < this._count - 1) {\n            current += iterator.at(++index);\n        }\n        return index;\n    }\n    indexVisible(value) {\n        let index = this.index(value);\n        if (this.hidden(index)) {\n            index = this.prevVisible(index);\n        }\n        return index;\n    }\n    _refresh() {\n        let current = 0;\n        this._pixelValues = this.values.map(function(range) {\n            let start = current;\n            current += (range.end - range.start + 1) * range.value;\n            let end = current - 1;\n            return new ValueRange(start, end, range);\n        });\n        this.total = current;\n    }\n    getState() {\n        return {\n            values: this.values.getState(),\n            hidden: this._hidden.getState(),\n            count: this._count\n        };\n    }\n    setState(state) {\n        this.values.setState(state.values);\n        this._hidden.setState(state.hidden);\n        let nowCount = this._count;\n        if (nowCount > state.count) {\n            this._count = state.count;\n            this._resize(nowCount); // calls _refresh too\n        } else {\n            this._refresh();\n        }\n    }\n}\n\nclass PaneAxis {\n    constructor(axis, start, count, headerSize) {\n        this._axis = axis;\n        this._start = start;\n        this._count = count;\n        this.hasHeader = start === 0;\n        this.headerSize = headerSize;\n        this.defaultValue = axis._value;\n        this.frozen = count > 0;\n    }\n    viewSize(viewSize) {\n        this._viewSize = viewSize;\n    }\n    sum(start, end) {\n        return this._axis.sum(start, end - 1);\n    }\n    start() {\n        return this.sum(0, this._start);\n    }\n    size() {\n        return this.sum(this._start, this._start + this._count);\n    }\n    index(value, offset) {\n        return this._axis.index(value + (this.frozen ? 0 : offset) - this.headerSize);\n    }\n    indexVisible(value, offset) {\n        return this._axis.indexVisible(value + (this.frozen ? 0 : offset) - this.headerSize);\n    }\n    // XXX: rename this method\n    paneSegment() {\n        let offset = this.start();\n        let length;\n        if (!this.hasHeader) {\n            offset += this.headerSize;\n        }\n        if (this.frozen) {\n            length = this.size();\n            if (this.hasHeader) {\n                length += this.headerSize;\n            } else {\n                length -= this.headerSize;\n            }\n        } else {\n            length = this._viewSize - offset;\n        }\n        return {\n            offset: offset,\n            length: length\n        };\n    }\n    visible(offset) {\n        let start = this.start();\n        let size;\n        if (this.frozen) {\n            size = this.size();\n            if (!this.hasHeader) {\n                size -= this.headerSize;\n            }\n        } else {\n            size = this._viewSize - start - this.headerSize;\n            start += offset;\n        }\n        let result = this._axis.visible(start, start + size - 1);\n        if (this.frozen) {\n            result.offset = 0;\n        }\n        result.start = start;\n        if (this.hasHeader) {\n            result.offset += this.headerSize;\n            result.start -= this.headerSize;\n        }\n        return result;\n    }\n    contains(start, end) {\n        if (this.frozen) {\n            if (start > this._start + this._count) {\n                return false;\n            }\n            if (end < this._start) {\n                return false;\n            }\n            return true;\n        }\n        return end >= this._start;\n    }\n}\n\n/* eslint-disable no-param-reassign */\n/* eslint-disable camelcase */\n\nclass Rectangle {\n    constructor(left, top, width, height) {\n        this.left = left;\n        this.top = top;\n        this.width = width;\n        this.height = height;\n        this.right = this.left + this.width;\n        this.bottom = this.top + this.height;\n    }\n\n    offset(left, top) {\n        return new Rectangle(this.left + left, this.top + top, this.width, this.height);\n    }\n\n    resize(width, height) {\n        return new Rectangle(this.left, this.top, this.width + width, this.height + height);\n    }\n\n    intersects(x, y) {\n        if (x instanceof Rectangle) {\n            return this.intersectsRect(x);\n        }\n        return this.left < x && x < this.left + this.width &&\n               this.top < y && y < this.top + this.height;\n    }\n\n    intersectsRect(b) {\n        let a = this;\n        return a.left <= b.right\n            && b.left <= a.right\n            && a.top <= b.bottom\n            && b.top <= a.bottom;\n    }\n\n    toDiv(className) {\n        return dom.element(\"div\", {\n            className: className,\n            style: {\n                width: this.width + \"px\",\n                height: this.height + \"px\",\n                top: this.top + \"px\",\n                left: this.left + \"px\"\n            }\n        });\n    }\n}\n\nclass Grid {\n    constructor(rows, columns, rowCount, columnCount, headerHeight, headerWidth) {\n        this.rowCount = rowCount;\n        this.columnCount = columnCount;\n        this._columns = columns;\n        this._rows = rows;\n        this._headerHeight = headerHeight;\n        this._headerWidth = headerWidth;\n    }\n\n    _resize(new_rows, new_cols) {\n        this.rowCount = new_rows;\n        this.columnCount = new_cols;\n    }\n\n    isAxis(ref) {\n        ref = ref.toRangeRef();\n        let topLeft = ref.topLeft;\n        let bottomRight = ref.bottomRight;\n        return (topLeft.row === 0 && bottomRight.row === this.rowCount - 1) || (topLeft.col === 0 && bottomRight.col === this.columnCount - 1);\n    }\n\n    width(start, end) {\n        return this._columns.sum(start, end);\n    }\n\n    height(start, end) {\n        return this._rows.sum(start, end);\n    }\n\n    totalHeight() {\n        return this._rows.total + this._headerHeight;\n    }\n\n    totalWidth() {\n        return this._columns.total + this._headerWidth;\n    }\n\n    index(row, column) {\n        return column * this.rowCount + row;\n    }\n\n    cellRef(index) {\n        return new CellRef(index % this.rowCount, (index / this.rowCount) >> 0);\n    }\n\n    rowRef(row) {\n        return new RangeRef(new CellRef(row, 0), new CellRef(row, this.columnCount - 1));\n    }\n\n    colRef(col) {\n        return new RangeRef(new CellRef(0, col), new CellRef(this.rowCount - 1, col));\n    }\n\n    cellRefIndex(ref) {\n        return this.index(ref.row, ref.col);\n    }\n\n    normalize(ref) {\n        if (ref instanceof RangeRef) {\n            return new RangeRef(\n                this.normalize(ref.topLeft),\n                this.normalize(ref.bottomRight)\n            ).setSheet(ref.sheet, ref.hasSheet());\n        }\n\n        if (ref instanceof UnionRef) {\n            return ref.map(function(ref) {\n                return this.normalize(ref);\n            }, this);\n        }\n\n        if (ref instanceof CellRef) {\n            ref = ref.clone();\n            ref.col = Math.max(0, Math.min(this.columnCount - 1, ref.col));\n            ref.row = Math.max(0, Math.min(this.rowCount - 1, ref.row));\n        }\n\n        return ref;\n    }\n\n    rectangle(ref) {\n        let topLeft = this.normalize(ref.topLeft);\n        let bottomRight = this.normalize(ref.bottomRight);\n        return new Rectangle(\n            this.width(0, topLeft.col - 1),\n            this.height(0, topLeft.row - 1),\n            this.width(topLeft.col, bottomRight.col),\n            this.height(topLeft.row, bottomRight.row)\n        );\n    }\n\n    pane(options) {\n        return new PaneGrid(\n            new PaneAxis(this._rows, options.row, options.rowCount, this._headerHeight),\n            new PaneAxis(this._columns, options.column, options.columnCount, this._headerWidth),\n            this\n        );\n    }\n\n    rangeDimensions(rangeRef) {\n        return {\n            rows: this._rows.values.iterator(rangeRef.topLeft.row, rangeRef.bottomRight.row),\n            columns: this._columns.values.iterator(rangeRef.topLeft.col, rangeRef.bottomRight.col)\n        };\n    }\n\n    forEach(ref, callback) {\n        let topLeft = this.normalize(ref.topLeft);\n        let bottomRight = this.normalize(ref.bottomRight);\n\n        for (let ci = topLeft.col; ci <= bottomRight.col; ci ++) {\n            for (let ri = topLeft.row; ri <= bottomRight.row; ri ++) {\n                callback(new CellRef(ri, ci));\n            }\n        }\n    }\n\n    trim(ref, property) {\n        let topLeft = this.normalize(ref.topLeft);\n        let bottomRight = this.normalize(ref.bottomRight);\n        let bottomRightRow = topLeft.row;\n        let bottomRightCol = topLeft.col;\n\n        for (let ci = topLeft.col; ci <= bottomRight.col; ci ++) {\n            let start = this.index(topLeft.row, ci);\n            let end = this.index(bottomRight.row, ci);\n            let values = property.tree.intersecting(start, end);\n            if (values.length) {\n                let cell = this.cellRef(values[values.length - 1].end);\n                bottomRightRow = Math.max(bottomRightRow, cell.row);\n                bottomRightCol = ci;\n            }\n        }\n        return new RangeRef(ref.topLeft, new CellRef(Math.min(bottomRightRow, ref.bottomRight.row), bottomRightCol));\n    }\n}\n\nclass PaneGrid {\n    constructor(rows, columns, grid) {\n        this.rows = rows;\n        this.columns = columns;\n        this._grid = grid;\n\n        this.headerHeight = rows.headerSize;\n        this.headerWidth = columns.headerSize;\n        this.hasRowHeader = columns.hasHeader;\n        this.hasColumnHeader = rows.hasHeader;\n    }\n\n    refresh(width, height) {\n        this.columns.viewSize(width);\n        this.rows.viewSize(height);\n\n        let x = this.columns.paneSegment();\n        let y = this.rows.paneSegment();\n\n        this.left = x.offset;\n        this.top = y.offset;\n        this.right = x.offset + x.length;\n        this.bottom = y.offset + y.length;\n\n        this.style = {\n            top: y.offset + \"px\",\n            left: x.offset + \"px\",\n            height: y.length + \"px\",\n            width: x.length + \"px\"\n        };\n    }\n\n    view(left, top) {\n        let rows = this.rows.visible(top);\n        let columns = this.columns.visible(left);\n\n        return {\n            rows: rows,\n            columns: columns,\n\n            rowOffset: rows.offset,\n            columnOffset: columns.offset,\n\n            mergedCellLeft: columns.start,\n            mergedCellTop: rows.start,\n\n            ref: new RangeRef(\n                new CellRef(rows.values.start, columns.values.start),\n                new CellRef(rows.values.end, columns.values.end)\n            )\n        };\n    }\n\n    contains(ref) {\n        return this.rows.contains(ref.topLeft.row, ref.bottomRight.row) &&\n            this.columns.contains(ref.topLeft.col, ref.bottomRight.col);\n    }\n\n    index(row, column) {\n        return this._grid.index(row, column);\n    }\n\n    boundingRectangle(ref) {\n        return this._grid.rectangle(ref);\n    }\n\n    cellRefIndex(ref) {\n        return this._grid.cellRefIndex(ref);\n    }\n\n    scrollBoundaries(cell) {\n        let position = this.boundingRectangle(cell);\n\n        let boundaries = {\n            top: Math.max(0, position.top - this.top + (this.hasColumnHeader ? 0 : this.headerHeight)),\n            left: Math.max(0, position.left - this.left + (this.hasRowHeader ? 0 : this.headerWidth)),\n            right: position.right - this.columns._viewSize + this.headerWidth,\n            bottom: position.bottom - this.rows._viewSize + this.headerHeight\n        };\n\n        let widthCompensation = this.columns.defaultValue / 2;\n        let heightCompensation = this.rows.defaultValue / 2;\n\n        boundaries.scrollTop = boundaries.top - heightCompensation;\n        boundaries.scrollBottom = boundaries.bottom + heightCompensation;\n\n        boundaries.scrollLeft = boundaries.left - widthCompensation;\n        boundaries.scrollRight = boundaries.right + widthCompensation;\n        return boundaries;\n    }\n}\n\nclass Sorter {\n    constructor(grid, lists) {\n        this._grid = grid;\n        this._lists = lists;\n    }\n\n    indices(rangeRef, list, ascending, indices) {\n        let comparer = Sorter.ascendingComparer;\n\n        if (ascending === false) {\n            comparer = Sorter.descendingComparer;\n        }\n\n        return list.sortedIndices(this._grid.cellRefIndex(rangeRef.topLeft),\n                                  this._grid.cellRefIndex(rangeRef.bottomRight), comparer, indices);\n    }\n\n    sortBy(ref, column, list, ascending, indices) {\n        let sortedIndices = this.indices(ref.toColumn(column), list, ascending, indices);\n\n        for (let ci = ref.topLeft.col; ci <= ref.bottomRight.col; ci++) {\n            let start = this._grid.index(ref.topLeft.row, ci);\n            let end = this._grid.index(ref.bottomRight.row, ci);\n\n            for (let li = 0; li < this._lists.length; li++) {\n                if (start < this._lists[li].lastRangeStart()) {\n                    this._lists[li].sort(start, end, sortedIndices);\n                }\n            }\n        }\n\n        return sortedIndices;\n    }\n}\n\nSorter.ascendingComparer = function(a, b) {\n    if (a === null && b === null) {\n        return 0;\n    }\n\n    if (a === null) {\n        return 1;\n    }\n\n    if (b === null) {\n        return -1;\n    }\n\n    let typeA = typeof a;\n    let typeB = typeof b;\n\n    if (typeA === 'number') {\n        if (typeB === 'number') {\n            return a - b;\n        }\n        return -1;\n    }\n\n    if (typeA === 'string') {\n        switch (typeB) {\n        case 'number':\n            return 1;\n        case 'string':\n            return a.localeCompare(b);\n        default:\n            return -1;\n        }\n    }\n\n    if (typeA === 'boolean') {\n        switch (typeB) {\n        case 'number':\n            return 1;\n        case 'string':\n            return 1;\n        case 'boolean':\n            return a - b;\n        default:\n            return -1;\n        }\n    }\n\n    if (a instanceof CalcError) {\n        if (b instanceof CalcError) {\n            return 0;\n        }\n        return 1;\n    }\n\n    throw new Error('Cannot compare ' + a + ' and ' + b);\n};\n\nSorter.descendingComparer = function(a, b) {\n    if (a === null && b === null) {\n        return 0;\n    }\n\n    if (a === null) {\n        return 1;\n    }\n\n    if (b === null) {\n        return -1;\n    }\n\n    return Sorter.ascendingComparer(b, a);\n};\n\n/* eslint-disable no-constant-condition */\n/* eslint-disable key-spacing */\n/* eslint-disable no-param-reassign */\n\n\nclass AxisManager {\n    constructor(sheet) {\n        this._sheet = sheet;\n    }\n\n    forEachSelectedColumn(callback) {\n        let sheet = this._sheet;\n\n        sheet.batch(function() {\n            sheet.select().forEachColumnIndex(function(index, i) {\n                callback(sheet, index, i);\n            });\n        }, { layout: true, recalc: true });\n    }\n\n    forEachSelectedRow(callback) {\n        let sheet = this._sheet;\n\n        sheet.batch(function() {\n            sheet.select().forEachRowIndex(function(index, i) {\n                callback(sheet, index, i);\n            });\n        }, { layout: true, recalc: true });\n    }\n\n    includesHiddenColumns(ref) {\n        return this._sheet._grid._columns.includesHidden(ref.topLeft.col, ref.bottomRight.col);\n    }\n\n    includesHiddenRows(ref) {\n        return this._sheet._grid._rows.includesHidden(ref.topLeft.row, ref.bottomRight.row);\n    }\n\n    selectionIncludesHiddenColumns() {\n        return this.includesHiddenColumns(this._sheet.select());\n    }\n\n    selectionIncludesHiddenRows() {\n        return this.includesHiddenRows(this._sheet.select());\n    }\n\n    deleteSelectedColumns() {\n        let indexes = [], delta = 0;\n        this.forEachSelectedColumn(function(sheet, index) {\n            index -= delta;\n            if (sheet.isHiddenColumn(index)) {\n                return;\n            }\n            delta++;\n            let formulas = [];\n            indexes.unshift({\n                index    : index,\n                formulas : formulas,\n                width    : sheet.columnWidth(index)\n            });\n            sheet._saveModifiedFormulas(formulas, function() {\n                sheet.deleteColumn(index);\n            });\n        });\n        return indexes;\n    }\n\n    deleteSelectedRows() {\n        let indexes = [], delta = 0;\n        this.forEachSelectedRow(function(sheet, index) {\n            index -= delta;\n            if (sheet.isHiddenRow(index)) {\n                return;\n            }\n            delta++;\n            let formulas = [];\n            indexes.unshift({\n                index    : index,\n                formulas : formulas,\n                height   : sheet.rowHeight(index)\n            });\n            sheet._saveModifiedFormulas(formulas, function() {\n                sheet.deleteRow(index);\n            });\n        });\n        return indexes;\n    }\n\n    hideSelectedColumns() {\n        this.forEachSelectedColumn(function(sheet, index) {\n            sheet.hideColumn(index);\n        });\n        let sheet = this._sheet;\n        let ref = sheet.select().toRangeRef();\n        let left = ref.topLeft.col;\n        let right = ref.bottomRight.col;\n        let sel = null;\n        while (true) {\n            let hasRight = right < sheet._columns._count;\n            let hasLeft = left >= 0;\n            if (!hasLeft && !hasRight) {\n                break;\n            }\n            if (hasRight && !sheet.isHiddenColumn(right)) {\n                sel = right;\n                break;\n            }\n            if (hasLeft && !sheet.isHiddenColumn(left)) {\n                sel = left;\n                break;\n            }\n            left--;\n            right++;\n        }\n        if (sel !== null) {\n            ref = new RangeRef(\n                new CellRef(0, sel),\n                new CellRef(sheet._rows._count - 1, sel)\n            );\n            sheet.range(ref).select();\n        }\n    }\n\n    hideSelectedRows() {\n        this.forEachSelectedRow(function(sheet, index) {\n            sheet.hideRow(index);\n        });\n        let sheet = this._sheet;\n        let ref = sheet.select().toRangeRef();\n        let top = ref.topLeft.row;\n        let bottom = ref.bottomRight.row;\n        let sel = null;\n        while (true) {\n            let hasBottom = bottom < sheet._rows._count;\n            let hasTop = top >= 0;\n            if (!hasTop && !hasBottom) {\n                break;\n            }\n            if (hasBottom && !sheet.isHiddenRow(bottom)) {\n                sel = bottom;\n                break;\n            }\n            if (hasTop && !sheet.isHiddenRow(top)) {\n                sel = top;\n                break;\n            }\n            top--;\n            bottom++;\n        }\n        if (sel !== null) {\n            ref = new RangeRef(\n                new CellRef(sel, 0),\n                new CellRef(sel, sheet._columns._count - 1)\n            );\n            sheet.range(ref).select();\n        }\n    }\n\n    unhideSelectedColumns() {\n        this.forEachSelectedColumn(function(sheet, index) {\n            sheet.unhideColumn(index);\n        });\n    }\n\n    unhideSelectedRows() {\n        this.forEachSelectedRow(function(sheet, index) {\n            sheet.unhideRow(index);\n        });\n    }\n\n    addColumnLeft() {\n        let sheet = this._sheet;\n        let base, count = 0;\n        sheet.batch(function() {\n            sheet.select().forEachColumnIndex(function(index) {\n                if (!base) {\n                    base = index;\n                }\n                sheet.insertColumn(base);\n                ++count;\n            });\n        }, { recalc: true, layout: true });\n        return { base: base, count: count };\n    }\n\n    addColumnRight() {\n        let sheet = this._sheet;\n        let base, count = 0;\n        sheet.batch(function() {\n            sheet.select().forEachColumnIndex(function(index) {\n                base = index + 1;\n                ++count;\n            });\n            for (let i = 0; i < count; ++i) {\n                sheet.insertColumn(base);\n            }\n        }, { recalc: true, layout: true });\n        return { base: base, count: count };\n    }\n\n    addRowAbove() {\n        let sheet = this._sheet;\n        let base, count = 0;\n        let selectedRows = sheet.select();\n\n        sheet.batch(function() {\n            selectedRows.forEachRowIndex(function(index) {\n                if (!base) {\n                    base = index;\n                }\n                sheet.insertRow(base);\n                ++count;\n            });\n        }, { recalc: true, layout: true });\n\n        return { base: base, count: count };\n    }\n\n    addRowBelow() {\n        let sheet = this._sheet;\n        let base, count = 0;\n\n        sheet.batch(function() {\n            sheet.select().forEachRowIndex(function(index) {\n                base = index + 1;\n                ++count;\n            });\n            for (let i = 0; i < count; ++i) {\n                sheet.insertRow(base);\n            }\n        }, { recalc: true, layout: true });\n\n        return { base: base, count: count };\n    }\n}\n\n/* eslint-disable no-param-reassign */\n\nclass AutoFillCalculator {\n    constructor(grid) {\n        this._grid = grid;\n    }\n\n    rectIsVertical(start, end, x, y) {\n        let startRect = this._grid.rectangle(start.toRangeRef());\n        let endRect = this._grid.rectangle(end.toRangeRef());\n        return Math.abs(endRect[y] - startRect[y]) > Math.abs(startRect[x] - endRect[x]);\n    }\n\n    autoFillDest(selection, cursor) {\n        let topLeft = selection.topLeft;\n        let bottomRight = selection.bottomRight;\n\n        let quadrant;\n        let lower = cursor.row >= topLeft.row;\n        let further = cursor.col >= topLeft.col;\n\n        if (lower) {\n            quadrant = further ? 4 : 3;\n        } else {\n            quadrant = further ? 2 : 1;\n        }\n\n        let pivot, opposite, cornerResult, expanding;\n\n        if (quadrant === 4) {\n            pivot = topLeft;\n            opposite = bottomRight;\n\n            expanding = cursor.row > opposite.row || cursor.col > opposite.col;\n\n            if (expanding) {\n                cursor = new CellRef(Math.max(cursor.row, opposite.row), Math.max(cursor.col, opposite.col));\n            }\n\n            if (this.rectIsVertical(opposite, cursor, 'right', 'bottom')) { // vertical\n                cornerResult = new CellRef(cursor.row, opposite.col);\n            } else {\n                cornerResult = new CellRef(opposite.row, cursor.col);\n            }\n        } else if (quadrant === 3) {\n            let bottomLeft = new CellRef(topLeft.col, bottomRight.row);\n\n            if (cursor.row > bottomRight.row && this.rectIsVertical(bottomLeft, cursor, 'left', 'bottom')) { // vertical\n                pivot = topLeft;\n                cornerResult = new CellRef(cursor.row, bottomRight.col);\n            } else {\n                pivot = bottomRight;\n                cornerResult = new CellRef(topLeft.row, cursor.col);\n            }\n        } else if (quadrant === 2) {\n            let topRight = new CellRef(topLeft.row, bottomRight.col);\n\n            if (cursor.col > bottomRight.col && !this.rectIsVertical(topRight, cursor, 'right', 'top')) { // horizontal\n                pivot = topLeft;\n                cornerResult = new CellRef(bottomRight.row, cursor.col);\n            } else {\n                pivot = bottomRight;\n                cornerResult = new CellRef(cursor.row, topLeft.col);\n            }\n        } else {\n            pivot = bottomRight;\n            if (this.rectIsVertical(topLeft, cursor, 'left', 'top')) { // horizontal\n                cornerResult = new CellRef(cursor.row, topLeft.col);\n            } else {\n                cornerResult = new CellRef(topLeft.row, cursor.col);\n            }\n        }\n\n        return this._grid.normalize(new RangeRef(pivot, cornerResult));\n    }\n}\n\n/* eslint-disable max-params */\n/* eslint-disable no-empty */\n/* eslint-disable no-loop-func */\n/* eslint-disable consistent-return */\n/* eslint-disable block-scoped-var */\n/* eslint-disable no-redeclare */\n/* eslint-disable no-var */\n/* eslint-disable eqeqeq */\n/* eslint-disable complexity */\n/* eslint-disable no-implicit-coercion */\n/* eslint-disable brace-style */\n/* eslint-disable key-spacing */\n/* eslint-disable no-else-return */\n/* eslint-disable default-case */\n/* eslint-disable no-param-reassign */\n\n\nclass EdgeNavigator {\n    constructor(field, axis, rangeGetter, union) {\n        this.rangeGetter = rangeGetter;\n\n        this.prevLeft = function(index) {\n            var current = union(this.range(index));\n            var range = this.range(axis.prevVisible(current.topLeft[field]));\n            return union(range).topLeft[field];\n        };\n\n        this.nextRight = function(index) {\n            var current = union(this.range(index));\n            var range = this.range(axis.nextVisible(current.bottomRight[field]));\n            return union(range).bottomRight[field];\n        };\n\n        // these two don't look like the other ones, as they \"shrink\"\n        this.nextLeft = function(index) {\n            var range = union(this.range(index));\n            return axis.nextVisible(range.bottomRight[field]);\n        };\n\n        this.prevRight = function(index) {\n            var range = union(this.range(index));\n            return axis.prevVisible(range.topLeft[field]);\n        };\n    }\n\n    boundary(top, bottom) {\n        this.top = top;\n        this.bottom = bottom;\n    }\n\n    range(index) {\n        return this.rangeGetter(index, this.top, this.bottom);\n    }\n}\n\nclass SheetNavigator {\n    constructor(sheet) {\n        this._sheet = sheet;\n        this.autoFillCalculator = new AutoFillCalculator(sheet._grid);\n\n        this.colEdge = new EdgeNavigator(\"col\", this._sheet._grid._columns, this.columnRange.bind(this), this.union.bind(this));\n        this.rowEdge = new EdgeNavigator(\"row\", this._sheet._grid._rows, this.rowRange.bind(this), this.union.bind(this));\n    }\n\n    height(height) {\n        this._viewPortHeight = height;\n    }\n\n    union(ref) {\n        return this._sheet.unionWithMerged(ref);\n    }\n\n    columnRange(col, topRow, bottomRow) {\n        return this._sheet._ref(topRow, col, bottomRow - topRow, 1);\n    }\n\n    rowRange(row, leftCol, rightCol) {\n        return this._sheet._ref(row, leftCol, 1, rightCol - leftCol);\n    }\n\n    selectionIncludesMergedCells() {\n        return this._sheet.select().contains(this._sheet._mergedCells);\n    }\n\n    setSelectionValue(value) {\n        var selection = this._sheet.selection();\n\n        setTimeout(function() {\n            selection.value(value());\n        });\n    }\n\n    selectAll() {\n        this._sheet.select(this._sheet._sheetRef);\n    }\n\n    select(ref, mode, addToExisting) {\n        ref = this.refForMode(ref, mode);\n\n        if (addToExisting) {\n            ref = this._sheet.select().concat(ref);\n        }\n\n        this._sheet.select(ref);\n    }\n\n    refForMode(ref, mode) {\n        var grid = this._sheet._grid;\n\n        switch (mode) {\n        case \"range\":\n            ref = grid.normalize(ref);\n            break;\n        case \"row\":\n            ref = grid.rowRef(ref.row);\n            break;\n        case \"column\":\n            ref = grid.colRef(ref.col);\n            break;\n        case \"sheet\":\n            ref = this._sheet._sheetRef;\n            break;\n        }\n\n        return ref;\n    }\n\n    startSelection(ref, mode, addToExisting, shiftKey, view) {\n        if (mode === \"autofill\") {\n            this._sheet.startAutoFill();\n        } else if (shiftKey && mode === \"range\") {\n            var range = new RangeRef(this._sheet.activeCell().first(), ref);\n            this._sheet.select(range, false, false);\n            this._sheet.startSelection(view);\n        } else {\n            this._sheet.startSelection(view);\n            this.select(ref, mode, addToExisting);\n        }\n    }\n\n    completeSelection() {\n        this._sheet.completeSelection();\n    }\n\n    selectForContextMenu(ref, mode) {\n        var sheet = this._sheet;\n        sheet._activeDrawing = null;\n        if (!sheet.select().contains(this.refForMode(ref, mode))) {\n            this.select(ref, mode);\n        }\n    }\n\n    selectDrawingForContextMenu(drawing) {\n        var sheet = this._sheet;\n        sheet._activeDrawing = drawing;\n        sheet.triggerChange({ selection: true });\n    }\n\n    modifySelection(action) {\n        var direction = this.determineDirection(action);\n\n        var sheet = this._sheet;\n        var viewPortHeight = this._viewPortHeight;\n        var rows = sheet._grid._rows;\n        var columns = sheet._grid._columns;\n\n        var originalSelection = sheet.currentOriginalSelectionRange();\n        var selection = sheet.select().toRangeRef();\n        var activeCell = sheet.activeCell();\n\n        var topLeft = originalSelection.topLeft.clone();\n        var bottomRight = originalSelection.bottomRight.clone();\n        var bottomLeft = new CellRef(bottomRight.row, topLeft.col);\n\n        var scrollInto;\n\n        this.colEdge.boundary(selection.topLeft.row, selection.bottomRight.row);\n        this.rowEdge.boundary(selection.topLeft.col, selection.bottomRight.col);\n\n        switch (direction) {\n        case \"expand-left\": // <| |\n            topLeft.col = this.colEdge.prevLeft(topLeft.col);\n            scrollInto = topLeft;\n            break;\n        case \"shrink-right\": // |>|\n            topLeft.col = this.colEdge.nextLeft(topLeft.col);\n            scrollInto = topLeft;\n            break;\n        case \"expand-right\": // | |>\n            bottomRight.col = this.colEdge.nextRight(bottomRight.col);\n            scrollInto = bottomRight;\n            break;\n        case \"shrink-left\": // |<|\n            bottomRight.col = this.colEdge.prevRight(bottomRight.col);\n            scrollInto = bottomRight;\n            break;\n\n            // four actions below mirror the upper ones, on the vertical axis\n        case \"expand-up\":\n            topLeft.row = this.rowEdge.prevLeft(topLeft.row);\n            scrollInto = topLeft;\n            break;\n        case \"shrink-down\":\n            topLeft.row = this.rowEdge.nextLeft(topLeft.row);\n            scrollInto = topLeft;\n            break;\n        case \"expand-down\":\n            bottomRight.row = this.rowEdge.nextRight(bottomRight.row);\n            scrollInto = bottomRight;\n            break;\n        case \"shrink-up\":\n            bottomRight.row = this.rowEdge.prevRight(bottomRight.row);\n            scrollInto = bottomRight;\n            break;\n\n            // pageup/down - may need improvement\n        case \"expand-page-up\":\n            topLeft.row = rows.prevPage(topLeft.row, viewPortHeight);\n            break;\n        case \"shrink-page-up\":\n            bottomRight.row = rows.prevPage(bottomRight.row, viewPortHeight);\n            break;\n        case \"expand-page-down\":\n            bottomRight.row = rows.nextPage(bottomRight.row, viewPortHeight);\n            break;\n        case \"shrink-page-down\":\n            topLeft.row = rows.nextPage(topLeft.row, viewPortHeight);\n            break;\n\n        case \"first-col\":\n            topLeft.col = columns.firstVisible();\n            bottomRight.col = activeCell.bottomRight.col;\n            scrollInto = topLeft;\n            break;\n        case \"last-col\":\n            bottomRight.col = columns.lastVisible();\n            topLeft.col = activeCell.topLeft.col;\n            scrollInto = bottomRight;\n            break;\n        case \"first-row\":\n            topLeft.row = rows.firstVisible();\n            bottomRight.row = activeCell.bottomRight.row;\n            scrollInto = topLeft;\n            break;\n        case \"last-row\":\n            bottomRight.row = rows.lastVisible();\n            topLeft.row = activeCell.topLeft.row;\n            scrollInto = bottomRight;\n            break;\n        case \"last\":\n            bottomRight.row = rows.lastVisible();\n            bottomRight.col = columns.lastVisible();\n            topLeft = activeCell.topLeft;\n            scrollInto = bottomRight;\n            break;\n        case \"first\":\n            topLeft.row = rows.firstVisible();\n            topLeft.col = columns.firstVisible();\n            bottomRight = activeCell.bottomRight;\n            scrollInto = topLeft;\n            break;\n\n        case \"expand-word-right\":\n            bottomRight.col = columns.nextUntil(bottomRight.col, makeWordMovement(sheet, bottomRight, true));\n            scrollInto = bottomRight;\n            break;\n        case \"shrink-word-right\":\n            topLeft.col = columns.nextUntil(bottomLeft.col, makeWordMovement(sheet, bottomLeft, true));\n            scrollInto = topLeft;\n            break;\n        case \"expand-word-left\":\n            topLeft.col = columns.prevUntil(bottomLeft.col, makeWordMovement(sheet, bottomLeft, true));\n            scrollInto = topLeft;\n            break;\n        case \"shrink-word-left\":\n            bottomRight.col = columns.prevUntil(bottomRight.col, makeWordMovement(sheet, bottomRight, true));\n            scrollInto = bottomRight;\n            break;\n        case \"expand-word-up\":\n            topLeft.row = rows.prevUntil(topLeft.row, makeWordMovement(sheet, topLeft, false));\n            scrollInto = topLeft;\n            break;\n        case \"shrink-word-up\":\n            bottomRight.row = rows.prevUntil(bottomRight.row, makeWordMovement(sheet, bottomRight, false));\n            scrollInto = bottomRight;\n            break;\n        case \"expand-word-down\":\n            bottomRight.row = rows.nextUntil(bottomRight.row, makeWordMovement(sheet, bottomRight, false));\n            scrollInto = bottomRight;\n            break;\n        case \"shrink-word-down\":\n            topLeft.row = rows.nextUntil(topLeft.row, makeWordMovement(sheet, topLeft, false));\n            scrollInto = topLeft;\n            break;\n        }\n\n        var newSelection = new RangeRef(topLeft, bottomRight);\n\n        if (!this.union(newSelection).intersects(activeCell)) {\n            // throw new Error(newSelection.print() + \" does not contain \" + activeCell.print());\n            this.modifySelection(direction.replace(\"shrink\", \"expand\"));\n            return;\n        }\n\n        if (scrollInto) {\n            sheet.focus(scrollInto);\n        }\n\n        this.updateCurrentSelectionRange(newSelection);\n    }\n\n    moveActiveCell(direction) {\n        var sheet = this._sheet;\n        var activeCell = sheet.activeCell();\n        var topLeft = activeCell.topLeft;\n        var bottomRight = activeCell.bottomRight;\n\n        var cell = sheet.originalActiveCell();\n        var rows = sheet._grid._rows;\n        var columns = sheet._grid._columns;\n\n        var row = cell.row;\n        var column = cell.col;\n\n        switch (direction) {\n        case \"left\":\n            column = columns.prevVisible(topLeft.col);\n            break;\n        case \"up\":\n            row = rows.prevVisible(topLeft.row);\n            break;\n        case \"right\":\n            column = columns.nextVisible(bottomRight.col);\n            break;\n        case \"down\":\n            row = rows.nextVisible(bottomRight.row);\n            break;\n        case \"first-col\":\n            column = columns.firstVisible();\n            break;\n        case \"last-col\":\n            column = columns.lastVisible();\n            break;\n        case \"first-row\":\n            row = rows.firstVisible();\n            break;\n        case \"last-row\":\n            row = rows.lastVisible();\n            break;\n        case \"last\":\n            row = rows.lastVisible();\n            column = columns.lastVisible();\n            break;\n        case \"first\":\n            row = rows.firstVisible();\n            column = columns.firstVisible();\n            break;\n        case \"next-page\":\n            row = rows.nextPage(bottomRight.row, this._viewPortHeight);\n            break;\n        case \"prev-page\":\n            row = rows.prevPage(bottomRight.row, this._viewPortHeight);\n            break;\n\n        case \"word-right\":\n            column = columns.nextUntil(column, makeWordMovement(sheet, bottomRight, true));\n            break;\n        case \"word-left\":\n            column = columns.prevUntil(column, makeWordMovement(sheet, bottomRight, true));\n            break;\n        case \"word-up\":\n            row = rows.prevUntil(row, makeWordMovement(sheet, bottomRight, false));\n            break;\n        case \"word-down\":\n            row = rows.nextUntil(row, makeWordMovement(sheet, bottomRight, false));\n            break;\n        }\n\n        sheet.select(new CellRef(row, column));\n    }\n\n    navigateInSelection(direction) {\n        var sheet = this._sheet;\n        var activeCell = sheet.activeCell();\n        var topLeft = activeCell.topLeft;\n\n        var cell = sheet.originalActiveCell();\n        var rows = sheet._grid._rows;\n        var columns = sheet._grid._columns;\n\n        var row = cell.row;\n        var column = cell.col;\n\n        var isFirstCell = false;\n        var isLastCell = false;\n\n        var selTopLeft, selBottomRight;\n\n        var topLeftCol = topLeft.col;\n        var topLeftRow = topLeft.row;\n        var tmp;\n\n        function setSelection(sel) {\n            selTopLeft = sel.topLeft;\n            selBottomRight = sel.bottomRight;\n        }\n\n        setSelection(sheet.currentNavigationRange());\n\n        var done = false;\n        var navigatedAway = false;\n\n        while (!done && !navigatedAway) {\n            var current = new CellRef(row, column);\n            var isSingleCellSelected = sheet.singleCellSelection();\n\n            if (isSingleCellSelected) {\n                isFirstCell = selTopLeft.eq(current) && sheet._sheetRef.topLeft.eq(current);\n                isLastCell = selBottomRight.eq(current) && sheet._sheetRef.bottomRight.eq(current);\n\n                if (!isFirstCell) {\n                    isFirstCell = columns.firstVisible() === column && rows.firstVisible() === row;\n                }\n\n                if (!isLastCell) {\n                    isLastCell = columns.lastVisible() === column && rows.lastVisible() === row;\n                }\n            }\n\n            switch (direction) {\n            case \"next\":\n                if (isLastCell) {\n                    navigatedAway = true;\n                } else if (selBottomRight.eq(current)) {\n                    setSelection(sheet.nextNavigationRange());\n                    row = selTopLeft.row;\n                    column = selTopLeft.col;\n                } else {\n                    column = columns.nextVisible(topLeftCol);\n                    if (column === topLeftCol || column > selBottomRight.col) {\n                        column = selTopLeft.col;\n                        tmp = rows.nextVisible(row);\n                        if (tmp === row || tmp > selBottomRight.row) {\n                            row = selTopLeft.row;\n                        } else {\n                            row = tmp;\n                        }\n                    }\n                }\n                break;\n            case \"previous\":\n                if (isFirstCell) {\n                    navigatedAway = true;\n                    this._sheet._workbook._view.element.querySelector('.k-spreadsheet-name-editor .k-input-inner').focus();\n                } else if (selTopLeft.eq(current)) {\n                    setSelection(sheet.previousNavigationRange());\n                    row = selBottomRight.row;\n                    column = selBottomRight.col;\n                } else {\n                    column = columns.prevVisible(topLeftCol);\n                    if (column === topLeftCol || column < selTopLeft.col) {\n                        column = selBottomRight.col;\n                        tmp = rows.prevVisible(row);\n                        if (tmp === row || tmp < selTopLeft.row) {\n                            row = selBottomRight.row;\n                        } else {\n                            row = tmp;\n                        }\n                    }\n                }\n                break;\n            case \"lower\":\n                if (selBottomRight.eq(current)) {\n                    setSelection(sheet.nextNavigationRange());\n                    row = selTopLeft.row;\n                    column = selTopLeft.col;\n                } else {\n                    row = rows.nextVisible(topLeftRow);\n                    if (row === topLeftRow || row > selBottomRight.row) {\n                        row = selTopLeft.row;\n                        tmp = columns.nextVisible(column);\n                        if (tmp === column || tmp > selBottomRight.col) {\n                            column = selTopLeft.col;\n                        } else {\n                            column = tmp;\n                        }\n                    }\n                }\n                break;\n            case \"upper\":\n                if (selTopLeft.eq(current)) {\n                    setSelection(sheet.previousNavigationRange());\n                    row = selBottomRight.row;\n                    column = selBottomRight.col;\n                } else {\n                    row = rows.prevVisible(topLeftRow);\n                    if (row === topLeftRow || row < selTopLeft.row) {\n                        row = selBottomRight.row;\n                        tmp = columns.prevVisible(column);\n                        if (tmp === column || tmp < selTopLeft.col) {\n                            column = selBottomRight.col;\n                        } else {\n                            column = tmp;\n                        }\n                    }\n                }\n                break;\n            default:\n                throw new Error(\"Unknown entry navigation: \" + direction);\n            }\n\n            done = !this.shouldSkip(row, column);\n            // if (!done) { console.log(\"skipping\", row, column); }\n            topLeftCol = column;\n            topLeftRow = row;\n        }\n\n        if (done) {\n            if (sheet.singleCellSelection()) {\n                sheet.select(new CellRef(row, column));\n            } else {\n                sheet.activeCell(new CellRef(row, column));\n            }\n        }\n    }\n\n    extendSelection(ref, mode) {\n        var sheet = this._sheet;\n        var grid = sheet._grid;\n\n        if (mode === \"autofill\") {\n            this.resizeAutoFill(ref);\n            return;\n        }\n        if (mode === \"range\") {\n            ref = grid.normalize(ref);\n        }\n        else if (mode === \"row\") {\n            ref = grid.rowRef(ref.row).bottomRight;\n        } else if (mode === \"column\") {\n            ref = grid.colRef(ref.col).bottomRight;\n        }\n\n        var activeCell = sheet.originalActiveCell().toRangeRef();\n\n        this.updateCurrentSelectionRange(new RangeRef(activeCell.topLeft, ref));\n    }\n\n    shouldSkip(row, col) {\n        if (this._sheet.isHiddenRow(row) || this._sheet.isHiddenColumn(col)) {\n            return true;\n        }\n        var ref = new CellRef(row, col);\n        var isMerged = false;\n        this._sheet.forEachMergedCell(function(merged) {\n            if (merged.intersects(ref) && !merged.collapse().eq(ref)) {\n                isMerged = true;\n            }\n        });\n\n        return isMerged;\n    }\n\n    resizeAutoFill(ref) {\n        var sheet = this._sheet;\n        var selection = sheet.select();\n        var origin = sheet._autoFillOrigin;\n        var dest = this.autoFillCalculator.autoFillDest(selection, ref);\n\n        var punch = this.punch(selection, dest);\n        var hint, direction;\n\n        if (!punch) {\n            var preview = sheet.range(dest)._previewFillFrom(sheet.range(origin));\n            if (preview) {\n                direction = preview.direction;\n                hint = preview.hint;\n            }\n        }\n\n        sheet.updateAutoFill(dest, punch, hint, direction);\n    }\n\n    determineDirection(action) {\n        var selection = this._sheet.currentSelectionRange();\n        var activeCell = this._sheet.activeCell();\n\n        // There may be a third, indeterminate state, caused by a merged cell.\n        // In this state, all key movements are treated as shrinks.\n        // The navigator will reverse them if it detects this it will cause the selection to exclude the active cell.\n        var leftMode = activeCell.topLeft.col === selection.topLeft.col;\n        var rightMode = activeCell.bottomRight.col === selection.bottomRight.col;\n        var topMode = activeCell.topLeft.row === selection.topLeft.row;\n        var bottomMode = activeCell.bottomRight.row === selection.bottomRight.row;\n\n        switch (action) {\n        case \"left\":\n            action = rightMode ? \"expand-left\" : \"shrink-left\";\n            break;\n        case \"right\":\n            action = leftMode ? \"expand-right\" : \"shrink-right\";\n            break;\n        case \"up\":\n            action = bottomMode ? \"expand-up\" : \"shrink-up\";\n            break;\n        case \"down\":\n            action = topMode ? \"expand-down\" : \"shrink-down\";\n            break;\n        case \"prev-page\":\n            action = bottomMode ? \"expand-page-up\" : \"shrink-page-up\";\n            break;\n        case \"next-page\":\n            action = topMode ? \"expand-page-down\" : \"shrink-page-down\";\n            break;\n        case \"word-left\":\n            action = rightMode ? \"expand-word-left\" : \"shrink-word-left\";\n            break;\n        case \"word-right\":\n            action = leftMode ? \"expand-word-right\" : \"shrink-word-right\";\n            break;\n        case \"word-up\":\n            action = bottomMode ? \"expand-word-up\" : \"shrink-word-up\";\n            break;\n        case \"word-down\":\n            action = topMode ? \"expand-word-down\" : \"shrink-word-down\";\n            break;\n        }\n\n        return action;\n    }\n\n    updateCurrentSelectionRange(ref) {\n        var sheet = this._sheet;\n        sheet.select(sheet.originalSelect().replaceAt(sheet.selectionRangeIndex(), ref), false);\n    }\n\n    punch(selection, subset) {\n        var punch;\n        if (subset.topLeft.eq(selection.topLeft)) {\n            if (subset.bottomRight.row < selection.bottomRight.row) {\n                var bottomRow = this.rowEdge.nextRight(subset.bottomRight.row);\n\n                punch = new RangeRef(\n                    new CellRef(bottomRow, selection.topLeft.col),\n                    selection.bottomRight\n                );\n            } else if (subset.bottomRight.col < selection.bottomRight.col) {\n                var bottomCol = this.colEdge.nextRight(subset.bottomRight.col);\n\n                punch = new RangeRef(\n                    new CellRef(selection.topLeft.row, bottomCol),\n                    selection.bottomRight\n                );\n            }\n        }\n\n        return punch;\n    }\n}\n\nfunction makeWordMovement(sheet, pivot, isCol) {\n    // the general idea is:\n    //\n    // - if we start on a non-empty cell, we should select the\n    //   range of non-empty cells that follow it.  If, however,\n    //   the second cell is empty, then we don't stop there; we\n    //   should skip all the empty cells and stop at the first\n    //   non-empty cell (and select it).\n    //\n    // - if we start on an empty cell, then skip all empty cells\n    //   and select the first non-empty one.\n\n    var firstVal = sheet.range(pivot).value();\n    return function(pos, advanced, hidden) {\n        if (hidden) { return true; }   // skip hidden cells\n        var val = ( isCol ?\n                    sheet.range(pivot.row, pos) :\n                    sheet.range(pos, pivot.col) ).value();\n        if (firstVal === null) {\n            return val === null ? false : pos;\n        } else if (!advanced && val === null) {\n            firstVal = null; // switch to the other mode\n            return false;\n        } else {\n            return val === null;\n        }\n    };\n}\n\n/* eslint-disable max-params */\n/* eslint-disable no-empty */\n/* eslint-disable no-loop-func */\n/* eslint-disable consistent-return */\n/* eslint-disable block-scoped-var */\n/* eslint-disable no-redeclare */\n/* eslint-disable no-var */\n/* eslint-disable eqeqeq */\n/* eslint-disable complexity */\n/* eslint-disable no-implicit-coercion */\n/* eslint-disable brace-style */\n/* eslint-disable key-spacing */\n/* eslint-disable no-else-return */\n/* eslint-disable default-case */\n/* eslint-disable no-param-reassign */\n\n\nfunction numberToDate(val) {\n    return val == null ? null : calc.runtime.serialToDate(val);\n}\n\nfunction dateToNumber(val) {\n    return val == null ? null : calc.runtime.dateToSerial(val);\n}\n\nvar identity = function (o) { return o; };\n\nclass SheetDataSourceBinder {\n    constructor(options) {\n        this.options = Object.assign({ columns: [] }, this.options,\n            // skip undefined properties in options\n            Object.keys(options).reduce((acc, key) => {\n                if (options[key] !== undefined) acc[key] = options[key];\n                return acc;\n            }, {})\n        );\n\n        this.columns = this._normalizeColumns(this.options.columns);\n\n        this._sheet();\n        this._dataSource();\n\n        this._header();\n\n        this._boundRowsCount = 0;\n\n        this.dataSource.fetch();\n    }\n\n    _sheet() {\n        this.sheet = this.options.sheet;\n\n        this._sheetChangeHandler = this._sheetChange.bind(this);\n        this._sheetDeleteRowHandler = this._sheetDeleteRow.bind(this);\n        this._sheetInsertRowHandler = this._sheetInsertRow.bind(this);\n\n        this.sheet.bind(\"change\", this._sheetChangeHandler)\n            .bind(\"afterDeleteRow\", this._sheetDeleteRowHandler)\n            .bind(\"afterInsertRow\", this._sheetInsertRowHandler);\n    }\n\n    _sheetInsertRow(e) {\n        if (e.index !== undefined) {\n            this.dataSource.insert(Math.max(e.index - 1, 0), {});\n        }\n    }\n\n    _sheetDeleteRow(e) {\n        if (e.index !== undefined) {\n            var dataSource = this.dataSource;\n            var model = dataSource.view()[e.index - 1];\n\n            if (model) {\n                dataSource.remove(model);\n            }\n        }\n    }\n\n    _header() {\n        this.sheet.batch(function () {\n            this.columns.forEach(function (column, index) {\n                this.sheet.range(0, index).value(column.title);\n            }.bind(this));\n        }.bind(this));\n    }\n\n    _sheetChange(e) {\n        if (e.insertRow || e.deleteRow) {\n            // these actions are handled via custom events\n            return;\n        }\n\n        if (e.recalc && e.ref && e.isValue) {\n            var dataSource = this.dataSource;\n            var data = dataSource.view();\n            var columns = this.columns;\n            var values = [];\n            var sheet = this.sheet;\n            var fields, getters, normalizedRef, i, rangeRef, normalizedRefs;\n            var setValues = function (ref) {\n                ref = ref.toRangeRef();\n                var record;\n                var valueIndex = 0;\n                for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                    record = data[ri - 1]; // skip header row\n\n                    if (!record) {\n                        record = dataSource.insert(ri - 1, {});\n                        data = dataSource.view();\n                    }\n\n                    var colValueIndex = 0;\n                    for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col && ci < columns.length; ci++) {\n                        var currentValue = values[i][valueIndex][colValueIndex++];\n                        record.set(columns[ci].field, getters[ci](currentValue));\n                    }\n                    valueIndex++;\n                }\n            };\n\n            if (dataSource.reader.model) {\n                fields = dataSource.reader.model.fields;\n            }\n\n            if (!columns.length && data.length) {\n                columns = Object.keys(data[0].toJSON());\n            }\n\n            getters = columns.map(function (column) {\n                var field = column.field;\n                if (field && fields && fields[field] && fields[field].type === \"date\") {\n                    return numberToDate;\n                }\n                return identity;\n            });\n\n            this._skipRebind = true;\n            normalizedRef = sheet._grid.normalize(e.ref);\n\n            if (!(normalizedRef instanceof UnionRef)) {\n                normalizedRef = new UnionRef([normalizedRef]);\n            }\n\n            normalizedRefs = normalizedRef.refs;\n\n            normalizedRefs.forEach(function (ref) {\n                values.push(sheet.range(ref).values());\n            });\n\n            for (i = 0; i < normalizedRefs.length; i++) {\n                rangeRef = normalizedRefs[i];\n                rangeRef.forEach(setValues);\n            }\n\n            this._boundRowsCount = dataSource.view().length;\n\n            this._skipRebind = false;\n        }\n    }\n\n    _normalizeColumns(columns) {\n        return columns.map(function (column) {\n            var field = column.field || column;\n            return {\n                field: field,\n                title: column.title || field\n            };\n        });\n    }\n\n    _dataSource() {\n        var options = this.options;\n        var dataSource = options.dataSource;\n\n        dataSource = Array.isArray(dataSource) ? { data: dataSource } : dataSource;\n\n        if (this.dataSource && this._changeHandler) {\n            this.dataSource.unbind(\"change\", this._changeHandler)\n                .unbind(\"progress\", this._progressHandler)\n                .unbind(\"error\", this._errorHandler);\n        } else {\n            this._changeHandler = this._change.bind(this);\n            this._progressHandler = this._requestStart.bind(this);\n            this._errorHandler = this._error.bind(this);\n        }\n\n        this.dataSource = this.options.sheet.createSheetDataSource?.(dataSource)\n            .bind(\"change\", this._changeHandler)\n            .bind(\"progress\", this._progressHandler)\n            .bind(\"error\", this._errorHandler);\n    }\n\n    _error() {\n        this._progress(false);\n    }\n\n    _requestStart() {\n        this._progress(true);\n    }\n\n    _progress(toggle) {\n        this.sheet.trigger(\"progress\", {\n            toggle: toggle\n        });\n    }\n\n    _change() {\n        if (this._skipRebind) {\n            return;\n        }\n\n        if (this.sheet.trigger(\"dataBinding\")) {\n            return;\n        }\n\n        var data = this.dataSource.view();\n        var columns = this.columns;\n\n        if (!columns.length && data.length) {\n            this.columns = columns = this._normalizeColumns(Object.keys(data[0].toJSON()));\n            this._header();\n        }\n\n        var getters = columns.map(function (column) {\n            return getter(column.field);\n        });\n\n        this.sheet.batch(function () {\n            var length = Math.max(data.length, this._boundRowsCount, this.sheet._grid.rowCount - 1);\n\n            for (var idx = 0; idx < length; idx++) {\n                for (var getterIdx = 0; getterIdx < getters.length; getterIdx++) {\n                    var value = data[idx] ? getters[getterIdx](data[idx]) : null;\n\n                    //skip header row\n                    this.sheet.range(idx + 1, getterIdx).value(value);\n                }\n            }\n        }.bind(this));\n\n        this._boundRowsCount = data.length;\n\n        this._progress(false);\n        this.sheet.trigger(\"dataBound\");\n    }\n\n    destroy() {\n        this.dataSource.unbind(\"change\", this._changeHandler)\n            .unbind(\"progress\", this._progressHandler)\n            .unbind(\"error\", this._errorHandler);\n\n        this.sheet.unbind(\"change\", this._sheetChangeHandler)\n            .unbind(\"deleteRow\", this._sheetDeleteRowHandler)\n            .unbind(\"insertRow\", this._sheetInsertRowHandler);\n    }\n}\n\nconst kendoDate = (function() {\n    function today() {\n        return getDate(new Date());\n    }\n\n    function isToday(date) {\n        return getDate(date).getTime() === today().getTime();\n    }\n\n    return {\n        dayOfWeek: dayOfWeek,\n        getDate: getDate,\n        isToday: isToday,\n        addDays: addDays,\n        today: today,\n        firstDayOfMonth: firstDayOfMonth\n    };\n})();\n\n/* eslint-disable no-var */\n/* eslint-disable no-implicit-coercion */\n/* eslint-disable no-param-reassign */\n/* eslint-disable no-loop-func */\n\n\nconst logic = {\n    or: {\n        concat: (acc, fn) => (a) => acc(a) || fn(a),\n        identity: () => false,\n    },\n    and: {\n        concat: (acc, fn) => (a) => acc(a) && fn(a),\n        identity: () => true,\n    },\n};\n\nconst operatorsMap = {\n    contains: (a, b) => (a || \"\").indexOf(b) >= 0,\n    doesnotcontain: (a, b) => (a || \"\").indexOf(b) === -1,\n    doesnotendwith: (a, b) =>\n        (a || \"\").indexOf(b, (a || \"\").length - (b || \"\").length) < 0,\n    doesnotstartwith: (a, b) => (a || \"\").lastIndexOf(b, 0) === -1,\n    endswith: (a, b) =>\n        (a || \"\").indexOf(b, (a || \"\").length - (b || \"\").length) >= 0,\n    eq: (a, b) => a === b,\n    gt: (a, b) => a > b,\n    gte: (a, b) => a >= b,\n    isempty: (a) => a === \"\",\n    isnotempty: (a) => a !== \"\",\n    isnotnull: (a) => isPresent(a),\n    isnull: (a) => isBlank(a),\n    lt: (a, b) => a < b,\n    lte: (a, b) => a <= b,\n    neq: (a, b) => a != b, // tslint:disable-line:triple-equals\n    startswith: (a, b) => (a || \"\").lastIndexOf(b, 0) === 0,\n};\n\nconst dateRegExp = /^\\/Date\\((.*?)\\)\\/$/;\n\nconst convertValue = (value, ignoreCase, accentFoldingFiltering) => {\n    if (value != null && isString(value)) {\n        const date = dateRegExp.exec(value);\n        if (date) {\n            return new Date(+date[1]).getTime();\n        } else if (ignoreCase) {\n            return accentFoldingFiltering\n                ? value.toLocaleLowerCase(accentFoldingFiltering)\n                : value.toLowerCase();\n        }\n    } else if (value != null && isDate(value)) {\n        return value.getTime();\n    }\n    return value;\n};\n\nconst transformFilter = ({\n    field,\n    ignoreCase,\n    value,\n    operator,\n    accentFoldingFiltering,\n}) => {\n    field = !isPresent(field) ? (a) => a : field;\n\n    ignoreCase = isPresent(ignoreCase) ? ignoreCase : true;\n\n    const itemProp = typedGetter(\n        isFunction(field) ? field : getter(field, true),\n        value,\n        ignoreCase,\n        accentFoldingFiltering\n    );\n\n    value = convertValue(value, ignoreCase, accentFoldingFiltering);\n\n    const op = isFunction(operator) ? operator : operatorsMap[operator];\n\n    return (a) => op(itemProp(a), value, ignoreCase);\n};\n\nconst typedGetter = (prop, value, ignoreCase, accentFoldingFiltering) => {\n    if (!isPresent(value)) {\n        return prop;\n    }\n\n    let acc = prop;\n\n    if (isString(value)) {\n        const date = dateRegExp.exec(value);\n        if (date) {\n            value = new Date(+date[1]);\n        } else {\n            acc = (a) => {\n                const x = prop(a);\n                if (typeof x === \"string\" && ignoreCase) {\n                    return accentFoldingFiltering\n                        ? x.toLocaleLowerCase(accentFoldingFiltering)\n                        : x.toLowerCase();\n                } else {\n                    return isNumeric(x) ? x + \"\" : x;\n                }\n            };\n        }\n    }\n\n    if (isDate(value)) {\n        return (a) => {\n            const x = acc(a);\n            return isDate(x) ? x.getTime() : x;\n        };\n    }\n    return acc;\n};\n\nconst transformCompositeFilter = function (filter) {\n    const accentFoldingFiltering = filter.accentFoldingFiltering;\n    const combiner = logic[filter.logic || \"and\"];\n\n    return filter.filters\n        .filter(isPresent)\n        .map((x) => {\n            const extendedFilter = isPresent(accentFoldingFiltering)\n                ? deepExtend({}, x, { accentFoldingFiltering })\n                : x;\n\n            return isPresent(x.filters)\n                ? transformCompositeFilter(extendedFilter)\n                : transformFilter(extendedFilter);\n        })\n        .reduce(combiner.concat, combiner.identity);\n};\n\n/* eslint-disable max-params */\n/* eslint-disable no-empty */\n/* eslint-disable no-loop-func */\n/* eslint-disable consistent-return */\n/* eslint-disable block-scoped-var */\n/* eslint-disable no-redeclare */\n/* eslint-disable no-var */\n/* eslint-disable eqeqeq */\n/* eslint-disable complexity */\n/* eslint-disable no-implicit-coercion */\n/* eslint-disable brace-style */\n/* eslint-disable key-spacing */\n/* eslint-disable no-else-return */\n/* eslint-disable default-case */\n/* eslint-disable no-param-reassign */\n\n\nlet filtersObj = {};\nconst dateToSerial$1 = calc.runtime.dateToSerial;\nconst serialToDate$1 = calc.runtime.serialToDate;\n\nclass Filter {\n    prepare() {\n    }\n    value(cell) {\n        return cell.value;\n    }\n    matches() {\n        throw new Error(\"The 'matches' method is not implemented.\");\n    }\n    toJSON() {\n        throw new Error(\"The 'toJSON' method is not implemented.\");\n    }\n}\n\nFilter.create = function(options) {\n    var filter = options.filter;\n\n    if (!filter) {\n        throw new Error(\"Filter type not specified.\");\n    }\n\n    var constructor = filtersObj[filter.charAt(0).toUpperCase() + filter.substring(1) + \"Filter\"];\n\n    if (!constructor) {\n        throw new Error(\"Filter type not recognized.\");\n    }\n\n    return new constructor(options);\n};\n\nclass ValueFilter extends Filter {\n    constructor(options) {\n        super(options);\n\n        this._values = [];\n        this._dates = [];\n        this._blanks = false;\n\n        if (options.values !== undefined) {\n            this._values = options.values;\n        }\n\n        if (options.blanks !== undefined) {\n            this._blanks = options.blanks;\n        }\n\n        if (options.dates !== undefined) {\n            this._dates = options.dates;\n        }\n    }\n\n    value(cell) {\n        var value = cell.value;\n\n        if (this._dates.length > 0 && cell.format && typeof value === \"number\") {\n            var type = formatting.type(value, cell.format);\n\n            if (type === \"date\") {\n                value = serialToDate$1(value);\n            }\n        }\n\n        return value;\n    }\n\n    matches(value) {\n        if (value === null || value === undefined) {\n            return this._blanks;\n        }\n\n        if (value instanceof Date) {\n            return this._dates.some(function(date) {\n                return date.year === value.getFullYear() &&\n                    (date.month === undefined || date.month === value.getMonth()) &&\n                    (date.day === undefined || date.day === value.getDate()) &&\n                    (date.hours === undefined || date.hours === value.getHours()) &&\n                    (date.minutes === undefined || date.minutes === value.getMinutes()) &&\n                    (date.seconds === undefined || date.seconds === value.getSeconds());\n            });\n        }\n\n        return this._values.indexOf(value) >= 0;\n    }\n    toJSON() {\n        return {\n            filter: \"value\",\n            blanks: this._blanks,\n            values: this._values.slice(0)\n        };\n    }\n}\n\nclass CustomFilter extends Filter {\n    constructor(options) {\n        super(options);\n        this._logic = \"and\";\n        if (options.logic !== undefined) {\n            this._logic = options.logic;\n        }\n\n        if (options.criteria === undefined) {\n            throw new Error(\"Must specify criteria.\");\n        }\n\n        this._criteria = options.criteria;\n\n        this._matches = transformCompositeFilter({\n            logic: this._logic,\n            filters: this._criteria,\n            accentFoldingFiltering: culture().name,\n        });\n    }\n    matches(value) {\n        if (value === null) {\n            return false;\n        }\n\n        return this._matches(value);\n    }\n    value(cell) {\n        var value = cell.value;\n        var criterionValue = this._criteria[0].value;\n        var criterionType = criterionValue instanceof Date ? \"date\" : typeof criterionValue;\n        var valueType = typeof value;\n\n        if (cell.format) {\n            valueType = formatting.type(value, cell.format);\n        }\n\n        if (valueType != criterionType) {\n            if (criterionType == \"string\") {\n                if (cell.format) {\n                    value = formatting.text(value, cell.format);\n                }\n                value = value + \"\";\n            }\n        } else if (valueType == \"date\") {\n            value = serialToDate$1(value);\n        }\n\n        return value;\n    }\n    toJSON() {\n        return {\n            filter: \"custom\",\n            logic: this._logic,\n            criteria: this._criteria\n        };\n    }\n}\n\nclass TopFilter extends Filter {\n    constructor(options) {\n        super(options);\n        this._type = options.type;\n        this._value = options.value;\n        this._values = [];\n    }\n\n    prepare(cells) {\n        var values = cells.map(this.value)\n        .sort()\n        .filter(function(value, index, array) {\n            return index === 0 || value !== array[index - 1];\n        });\n\n        if (this._type === \"topNumber\" || this._type == \"topPercent\") {\n            values.sort(function(x, y) {\n                return y - x;\n            });\n        } else {\n            values.sort(function(x, y) {\n                return x - y;\n            });\n        }\n\n        var count = this._value;\n\n        if (this._type === \"topPercent\" || this._type === \"bottomPercent\") {\n            count = (values.length * count / 100) >> 0;\n        }\n\n        this._values = values.slice(0, count);\n    }\n    matches(value) {\n        return this._values.indexOf(value) >= 0;\n    }\n    toJSON() {\n        return {\n            filter: \"top\",\n            type: this._type,\n            value: this._value\n        };\n    }\n}\n\nclass DynamicFilter extends Filter {\n    constructor(options) {\n        super(options);\n        this._type = options.type;\n\n        this._predicate = this[options.type];\n\n        if (typeof this._predicate !== \"function\") {\n            throw new Error(\"DynamicFilter type '\" + options.type + \"' not recognized.\");\n        }\n    }\n    value(cell) {\n        var value = cell.value;\n\n        if (cell.format) {\n            var type = formatting.type(value, cell.format);\n\n            if (type === \"date\") {\n                value = serialToDate$1(value);\n            }\n        }\n\n        return value;\n    }\n    prepare(cells) {\n        var sum = 0;\n        var count = 0;\n\n        for (var ci = 0; ci < cells.length; ci++) {\n            var value = this.value(cells[ci]);\n\n            if (typeof value === \"number\") {\n                sum += value;\n                count ++;\n            }\n        }\n\n        if (count > 0) {\n            this._average = sum / count;\n        } else {\n            this._average = 0;\n        }\n    }\n    matches(value) {\n        return this._predicate(value);\n    }\n    aboveAverage(value) {\n        if (value instanceof Date) {\n            value = dateToSerial$1(value);\n        }\n\n        if (typeof value !== \"number\") {\n            return false;\n        }\n\n        return value > this._average;\n    }\n    belowAverage(value) {\n        if (value instanceof Date) {\n            value = dateToSerial$1(value);\n        }\n\n        if (typeof value !== \"number\") {\n            return false;\n        }\n\n        return value < this._average;\n    }\n    tomorrow(value) {\n        if (value instanceof Date) {\n            var tomorrow = kendoDate.addDays(kendoDate.today(), 1);\n\n            return kendoDate.getDate(value).getTime() === tomorrow.getTime();\n        }\n\n        return false;\n    }\n    today(value) {\n        if (value instanceof Date) {\n            return kendoDate.isToday(value);\n        }\n\n        return false;\n    }\n    yesterday(value) {\n        if (value instanceof Date) {\n            var yesterday = kendoDate.addDays(kendoDate.today(), -1);\n\n            return kendoDate.getDate(value).getTime() === yesterday.getTime();\n        }\n\n        return false;\n    }\n    nextWeek(value) {\n        return sameWeek(kendoDate.addDays(kendoDate.today(), 7), value);\n    }\n    thisWeek(value) {\n        return sameWeek(kendoDate.today(), value);\n    }\n    lastWeek(value) {\n        return sameWeek(kendoDate.addDays(kendoDate.today(), -7), value);\n    }\n    nextMonth(value) {\n        return sameMonth(value, 1);\n    }\n    thisMonth(value) {\n        return sameMonth(value, 0);\n    }\n    lastMonth(value) {\n        return sameMonth(value, -1);\n    }\n    nextQuarter(value) {\n        if (value instanceof Date) {\n            var today = kendoDate.today();\n\n            var diff = quarter(value) - quarter(today);\n\n            return (diff === 1 && today.getFullYear() === value.getFullYear()) ||\n                    (diff == -3 && today.getFullYear() + 1 === value.getFullYear());\n        }\n\n        return false;\n    }\n    thisQuarter(value) {\n        if (value instanceof Date) {\n            var today = kendoDate.today();\n\n            var diff = quarter(value) - quarter(today);\n\n            return diff === 0 && today.getFullYear() === value.getFullYear();\n        }\n\n        return false;\n    }\n    lastQuarter(value) {\n        if (value instanceof Date) {\n            var today = kendoDate.today();\n\n            var diff = quarter(today) - quarter(value);\n\n            return (diff === 1 && today.getFullYear() === value.getFullYear()) ||\n                    (diff == -3 && today.getFullYear() - 1 === value.getFullYear());\n        }\n\n        return false;\n    }\n    nextYear(value) {\n        return sameYear(value, 1);\n    }\n    thisYear(value) {\n        return sameYear(value, 0);\n    }\n    lastYear(value) {\n        return sameYear(value, -1);\n    }\n    yearToDate(value) {\n        if (value instanceof Date) {\n            var today = kendoDate.today();\n\n            return value.getFullYear() === today.getFullYear() && value <= today;\n        }\n\n        return false;\n    }\n    toJSON() {\n        return {\n            filter: \"dynamic\",\n            type: this._type\n        };\n    }\n}\n\nfiltersObj = {\n    Filter, ValueFilter, CustomFilter, TopFilter\n};\n\n[1, 2, 3, 4].forEach(function(target) {\n    DynamicFilter.prototype[\"quarter\" + target] = function(value) {\n        if (value instanceof Date) {\n            return quarter(value) === target;\n        }\n\n        return false;\n    };\n});\n\nconst initDynamicFilter = () => {\n    culture().calendar.months.format.wide.forEach(function(month, index) {\n        DynamicFilter.prototype[month.toLowerCase()] = function(value) {\n            if (value instanceof Date) {\n                return value.getMonth() === index;\n            }\n\n            return false;\n        };\n    });\n};\n\nfunction quarter(value) {\n    var month = value.getMonth() + 1;\n\n    if (month >= 1 && month <= 3) {\n        return 1;\n    } else if (month >= 4 && month <= 6) {\n        return 2;\n    } else if (month >= 7 && month <= 9) {\n        return 3;\n    } else {\n        return 4;\n    }\n}\n\nfunction sameYear(value, offset) {\n    if (value instanceof Date) {\n        var today = kendoDate.today();\n\n        today.setFullYear(today.getFullYear() + offset);\n\n        return today.getFullYear() === value.getFullYear();\n    }\n\n    return false;\n}\n\nfunction sameMonth(value, offset) {\n    if (value instanceof Date) {\n        var today = kendoDate.firstDayOfMonth(kendoDate.today());\n\n        today.setMonth(today.getMonth() + offset, 1);\n\n        return today.getTime() === kendoDate.firstDayOfMonth(value).getTime();\n    }\n\n    return false;\n}\n\nfunction sameWeek(a, b) {\n    if (b instanceof Date) {\n        var firstWeek = kendoDate.dayOfWeek(kendoDate.getDate(a), 1);\n\n        var secondWeek = kendoDate.dayOfWeek(kendoDate.getDate(b), 1);\n\n        return firstWeek.getTime() === secondWeek.getTime();\n    }\n\n    return false;\n}\n\n/* eslint-disable max-params */\n/* eslint-disable no-empty */\n/* eslint-disable no-loop-func */\n/* eslint-disable consistent-return */\n/* eslint-disable block-scoped-var */\n/* eslint-disable no-redeclare */\n/* eslint-disable no-var */\n/* eslint-disable eqeqeq */\n/* eslint-disable complexity */\n/* eslint-disable no-implicit-coercion */\n/* eslint-disable brace-style */\n/* eslint-disable key-spacing */\n/* eslint-disable no-else-return */\n/* eslint-disable default-case */\n/* eslint-disable no-param-reassign */\n\n\n// This is a “dynamic variable” (see Greenspun's 10th rule).  It's\n// bound to an array via sheet._saveModifiedFormulas (which see)\n// while the callback runs.  The goal is to enable external code\n// to get a list of formulas or validations that have been\n// adjusted as an effect of an insert/delete row/column operation,\n// to be able to undo it.\n//\n// The reason why simply saving the state via sheet.getState() or\n// range.getState() won't suffice is that an insert or delete\n// operation can have far-reaching effects, like adjusting\n// formulas from another sheet.\nvar MODIFIED_FORMULAS;\n\nconst DEFAULT_SHEET_STATE = 'visible';\n\nclass Selection {\n    constructor(sheet) {\n        this._sheet = sheet;\n        this.selection = FIRSTREF.toRangeRef();\n        this.originalSelection = FIRSTREF.toRangeRef();\n        this._activeCell = FIRSTREF.toRangeRef();\n        this.originalActiveCell = FIRSTREF;\n    }\n\n    currentSelectionRange() {\n        return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n    }\n\n    currentOriginalNavigationRange() {\n        return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef();\n    }\n\n    currentNavigationRange() {\n        if (this.singleCellSelection()) {\n            return this._sheet._sheetRef;\n        } else {\n            return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n        }\n    }\n\n    nextNavigationRange() {\n        if (!this.singleCellSelection()) {\n            this.selectionRangeIndex = this.selection.nextRangeIndex(this.selectionRangeIndex);\n        }\n\n        return this.currentNavigationRange();\n    }\n\n    previousNavigationRange() {\n        if (!this.singleCellSelection()) {\n            this.selectionRangeIndex = this.selection.previousRangeIndex(this.selectionRangeIndex);\n        }\n\n        return this.currentNavigationRange();\n    }\n\n    activeCell(ref) {\n        if (ref) {\n            this.originalActiveCell = ref.first();\n            this._activeCell = this._sheet.unionWithMerged(ref.toRangeRef());\n            this._sheet.focus(ref);\n            this._sheet.triggerChange({ activeCell: true, selection: true });\n        }\n\n        return this._activeCell;\n    }\n\n    select(ref, expanded, changeActiveCell, view) {\n        if (ref) {\n            if (ref.eq(this.originalSelection)) {\n                return;\n            }\n\n            this._sheet.triggerSelect(new Range$1(ref, this._sheet));\n\n            this.originalSelection = ref;\n\n            this.selection = expanded;\n\n            if (changeActiveCell !== false) {\n                if (ref.isCell()) {\n                    // when selecting part of a merged cell, i.e. A1:B2 is merged and select(B2)\n                    // is requested, mark A1 as the actually active cell.\n                    // https://github.com/telerik/kendo/issues/7698\n                    this._sheet.forEachMergedCell(ref, function(merged) {\n                        ref = merged.topLeft;\n                    });\n                    this.activeCell(ref);\n                } else {\n                    ref = this.selection.lastRange();\n                    if (view && view._sheet === this._sheet && view.panes[0]) {\n                        // we should intersect this ref with the range that's currently on\n                        // screen, so that the view doesn't scroll (that is, keep the activeCell\n                        // visible) - https://github.com/telerik/kendo-ui-core/issues/5182 —\n                        // XXX: fiddling with View internals here is probably bad practice, but\n                        // this whole thing is a mess already, so it can be forgiven. :-/\n                        var panes = view.panes;\n                        var i, pane, rows, cols, visible, newRef;\n\n                        for (i = 0; i < panes.length; i++) {\n                            pane = panes[i];\n                            if (!pane._currentView) {\n                                continue;\n                            }\n                            rows = pane._currentView.rows.values;\n                            cols = pane._currentView.columns.values;\n\n                            visible = new RangeRef(\n                                new CellRef(rows.start, cols.start),\n                                new CellRef(rows.end, cols.end)\n                            );\n\n                            newRef = ref.intersect(visible);\n\n                            if (newRef !== NULLREF) {\n                                break;\n                            }\n                        }\n\n                        if (newRef && newRef !== NULLREF) {\n                            ref = newRef;\n                        }\n                    }\n                    this.activeCell(ref.first());\n                }\n\n                this.selectionRangeIndex = this.selection.size() - 1;\n            } else {\n                this._sheet.triggerChange({ selection: true });\n            }\n        }\n\n        return this.selection;\n    }\n\n    singleCellSelection() {\n        return this._activeCell.eq(this.selection);\n    }\n}\n\nlet EDITORS = {};\n\nfunction registerEditor(name, editor) {\n    EDITORS[name] = editor;\n}\n\nclass Sheet extends Observable {\n    constructor() {\n        super();\n        this.events = [\n            \"changing\",\n            \"commandRequest\",\n            \"afterInsertRow\",\n            \"afterDeleteRow\",\n            \"insertRow\",\n            \"insertColumn\",\n            \"deleteRow\",\n            \"deleteColumn\",\n            \"hideRow\",\n            \"hideColumn\",\n            \"unhideRow\",\n            \"unhideColumn\",\n            \"select\",\n            \"dataBinding\",\n            \"dataBound\",\n            \"progress\"\n        ];\n\n        this.createSheetDataSource = Array.from(arguments).pop();\n\n        this._reinit.apply(this, arguments);\n    }\n\n    activeCellCustomEditor() {\n        let cell = this.activeCell().first();\n\n        if (this.range(cell).enable()) {\n            let val = this.validation(cell);\n            let key = this._properties.get(\"editor\", this._grid.cellRefIndex(cell));\n            let editor;\n\n            if (key != null) {\n                editor = EDITORS[key];\n            }\n            else if (val && val.showButton) {\n                key = \"_validation_\" + val.dataType;\n                editor = EDITORS[key];\n            }\n\n            if (typeof editor == \"function\") {\n                editor = EDITORS[key] = editor();\n            }\n\n            return editor;\n        }\n    }\n\n    _reinit(rowCount, columnCount, rowHeight, columnWidth, headerHeight, headerWidth, defaultCellStyle) {\n        defaultCellStyle = defaultCellStyle || {};\n\n        this._defaultCellStyle = {\n            background: defaultCellStyle.background,\n            color: defaultCellStyle.color,\n            fontFamily: defaultCellStyle.fontFamily,\n            fontSize: defaultCellStyle.fontSize,\n            italic: defaultCellStyle.italic,\n            bold: defaultCellStyle.bold,\n            underline: defaultCellStyle.underline,\n            wrap: defaultCellStyle.wrap,\n            verticalAlign: defaultCellStyle.verticalAlign,\n            textAlign: defaultCellStyle.textAlign\n        };\n\n        this._rows = new Axis(rowCount, rowHeight);\n        this._columns = new Axis(columnCount, columnWidth);\n        this._filteredRows = new RangeList(0, rowCount - 1, false);\n        this._mergedCells = [];\n        this._frozenRows = 0;\n        this._frozenColumns = 0;\n        this._suspendChanges = false;\n        this._filter = null;\n        this._showGridLines = true;\n        this._gridLinesColor = null;\n        this._grid = new Grid(this._rows, this._columns, rowCount, columnCount, headerHeight, headerWidth);\n        this._sheetRef = this._grid.normalize(SHEETREF);\n        this._properties = new PropertyBag(rowCount, columnCount, this._defaultCellStyle);\n        this._sorter = new Sorter(this._grid, this._properties.sortable());\n\n        this._viewSelection = new Selection(this);\n\n        this._editSelection = new Selection(this);\n\n        this._formulaSelections = [];\n        this._drawings = [];\n    }\n\n    resize(newRows, newCols) {\n        newRows = Math.max(newRows, 1);\n        newCols = Math.max(newCols, 1);\n        var oldRows = this._rows._count;\n        var oldCols = this._columns._count;\n        if (newRows < oldRows) {\n            this.range(newRows, 0, oldRows - newRows, oldCols).clear();\n        }\n        if (newCols < oldCols) {\n            this.range(0, newCols, oldRows, oldCols - newCols).clear();\n        }\n        this._rows._resize(newRows);\n        this._columns._resize(newCols);\n        this._grid._resize(newRows, newCols);\n        this._properties._resize(newRows, newCols);\n        this._sheetRef = this._grid.normalize(SHEETREF);\n        if (newRows > oldRows) {\n            this.range(oldRows, 0, newRows - oldRows, newCols).clear();\n            this._filteredRows.value(oldRows, newRows - 1, false);\n        }\n        if (newCols > oldCols) {\n            this.range(0, oldCols, newRows, newCols - oldCols).clear();\n        }\n        this.triggerChange({ layout: true });\n    }\n\n    _resizeAddRow(count) {\n        this.resize(this._rows._count + (count || 1), this._columns._count);\n    }\n\n    _resizeAddColumn(count) {\n        this.resize(this._rows._count, this._columns._count + (count || 1));\n    }\n\n    _resizeDeleteRow(count) {\n        this._resizeAddRow(-(count || 1));\n    }\n\n    _resizeDeleteColumn(count) {\n        this._resizeAddColumn(-(count || 1));\n    }\n\n    _resizeForJSON(rows) {\n        var rowCount = rows.length, colCount = 0;\n        for (var ri = 0; ri < rows.length; ++ri) {\n            var row = rows[ri];\n            if (row.index != null) {\n                rowCount = Math.max(rowCount, row.index + 1);\n            }\n            if (row.cells) {\n                colCount = Math.max(colCount, row.cells.length);\n                for (var ci = 0; ci < row.cells.length; ++ci) {\n                    var cell = row.cells[ci];\n                    if (cell.index != null) {\n                        colCount = Math.max(colCount, cell.index + 1);\n                    }\n                }\n            }\n        }\n        this.resize(Math.max(rowCount, this._rows._count),\n                    Math.max(colCount, this._columns._count));\n    }\n\n    _selectionState() {\n        return this._inEdit ? this._editSelection : this._viewSelection;\n    }\n\n    navigator() {\n        if (!this._navigator) {\n            this._navigator = new SheetNavigator(this);\n        }\n        return this._navigator;\n    }\n\n    axisManager() {\n        if (!this._axisManager) {\n            this._axisManager = new AxisManager(this);\n        }\n\n        return this._axisManager;\n    }\n\n    _name(value) {\n        if (!value) {\n            return this._sheetName;\n        }\n\n        this._sheetName = value;\n\n        return this;\n    }\n\n    name() {\n        return this._name();\n    }\n\n    _state(value) {\n        if (!value) {\n            return this._sheetState || DEFAULT_SHEET_STATE;\n        }\n\n        this._sheetState = value;\n\n        return this;\n    }\n\n    state() {\n        return this._state();\n    }\n\n    _property(accessor, value, reason) {\n        if (value === undefined) {\n            return accessor();\n        } else {\n            accessor(value);\n\n            return this.triggerChange(reason);\n        }\n    }\n\n    _field(name, value, reason) {\n        if (value === undefined) {\n            return this[name];\n        } else {\n            this[name] = value;\n\n            return this.triggerChange(reason);\n        }\n    }\n\n    suspendChanges(value) {\n        if (value === undefined) {\n            return this._suspendChanges;\n        }\n\n        this._suspendChanges = value;\n\n        return this;\n    }\n\n    triggerChange(reason) {\n        if (!this._suspendChanges) {\n            this.trigger(\"change\", reason);\n        } else if (reason && reason.isValue) {\n            this._valueChanged = true;\n        }\n        return this;\n    }\n\n    triggerSelect(range) {\n        this.trigger(\"select\", { range: range });\n    }\n\n    setDataSource(dataSource, columns) {\n        if (this.dataSourceBinder) {\n            this.dataSourceBinder.destroy();\n        }\n\n        this.dataSourceBinder = new SheetDataSourceBinder({\n            dataSource: dataSource,\n            sheet: this,\n            columns: columns,\n            createSheetDataSource: this.createSheetDataSource\n        });\n\n        this.dataSource = this.dataSourceBinder.dataSource;\n    }\n\n    hideColumn(columnIndex) {\n        if (this.trigger(\"hideColumn\", { index: columnIndex })) {\n            return;\n        }\n\n        return this._property(this._columns.hide.bind(this._columns), columnIndex, { layout: true });\n    }\n\n    unhideColumn(columnIndex) {\n        if (this.trigger(\"unhideColumn\", { index: columnIndex })) {\n            return;\n        }\n\n        return this._property(this._columns.unhide.bind(this._columns), columnIndex, { layout: true });\n    }\n\n    isHiddenColumn(columnIndex) {\n        return this._grid._columns.hidden(columnIndex);\n    }\n\n    _copyRange(sourceRangeRef, targetRef) {\n        var grid = this._grid;\n        var rowCount = grid.rowCount;\n\n        var nextRefTopLeft = grid.normalize(sourceRangeRef.topLeft);\n        var nextRefBottomRight = grid.normalize(sourceRangeRef.bottomRight);\n\n        var nextIndex = nextRefTopLeft.col * rowCount + nextRefTopLeft.row;\n        var nextBottomIndex = nextRefBottomRight.col * rowCount + nextRefBottomRight.row;\n\n        var targetIndex = targetRef.col * rowCount + targetRef.row;\n\n        this._properties.copy(nextIndex, nextBottomIndex, targetIndex);\n    }\n\n    _saveModifiedFormulas(array, callback) {\n        var save = MODIFIED_FORMULAS;\n        MODIFIED_FORMULAS = array;\n        var ret = callback();\n        MODIFIED_FORMULAS = save;\n        return ret;\n    }\n\n    _restoreModifiedFormulas(array) {\n        var wb = this._workbook;\n        array.forEach(function(f) {\n            var sheet = wb.sheetByName(f.sheet), index;\n            if (f instanceof calc.runtime.Formula) {\n                index = sheet._grid.cellRefIndex(f); // f has row, col\n                sheet._properties.set(\"formula\", index, index, f);\n            }\n            if (f instanceof validationExport.Validation) {\n                index = sheet._grid.cellRefIndex(f); // f has row, col\n                sheet._properties.set(\"validation\", index, index, f);\n            }\n        });\n    }\n\n    _adjustReferences(operation, start, delta, mergedCells) {\n        this._mergedCells = mergedCells.reduce(function(a, ref) {\n            ref = ref.adjust(null, null, null, null, operation === \"row\", start, delta);\n            if (ref instanceof RangeRef) {\n                a.push(ref);\n            }\n            return a;\n        }, []);\n        if (this._workbook) {\n            var affectedSheet = this._name();\n            this._workbook._sheets.forEach(function(sheet) {\n                sheet._forFormulas(function(formula) {\n                    var prev = formula.adjust(affectedSheet, operation, start, delta);\n                    if (prev && MODIFIED_FORMULAS) {\n                        // if formula.adjust returns non-null,\n                        // that means the formula was indeed\n                        // modified and the returned value is a\n                        // copy of the previous Formula, which we\n                        // can use for undoing the operation.\n                        MODIFIED_FORMULAS.push(prev);\n                    }\n                });\n\n                sheet._forValidations(function(validation) {\n                    var prev = validation.adjust(affectedSheet, operation, start, delta);\n                    if (prev && MODIFIED_FORMULAS) {\n                        MODIFIED_FORMULAS.push(prev);\n                    }\n                });\n            });\n            this._workbook.adjustNames(affectedSheet, operation === \"row\", start, delta);\n        }\n        var selection = this.select();\n        selection = selection.adjust(null, null, null, null, operation === \"row\", start, delta);\n        if (selection !== NULLREF) {\n            this.select(selection);\n        }\n        // adjust column widths or row heights and hidden attribute\n        var axis = operation === \"col\" ? this._columns : this._rows;\n        axis.adjust(start, delta);\n\n        if (operation === \"row\") {\n            if (delta < 0) {\n                this._filteredRows.copy(start - delta, this._rows._count - 1, start);\n            } else {\n                this._filteredRows.copy(start, this._rows._count, start + delta);\n                this._filteredRows.value(start, start + delta - 1, false);\n            }\n        }\n\n        // adjust drawing anchor cells\n        this._drawings.forEach(function(drawing) {\n            if (drawing.topLeftCell) {\n                drawing.topLeftCell = drawing.topLeftCell.adjust(null, null, null, null,\n                                                                    operation === \"row\", start, delta);\n            }\n        });\n    }\n\n    _forFormulas(callback) {\n        var props = this._properties;\n        var formulas = props.get(\"formula\").values();\n        var n = formulas.length;\n        formulas.forEach(function(f, i) {\n            callback.call(this, f.value, i, n);\n        }, this);\n    }\n\n    _forValidations(callback) {\n        var props = this._properties;\n        props.get(\"validation\").values().forEach(function(v) {\n            callback.call(this, v.value);\n        }, this);\n    }\n\n    insertRow(rowIndex, skipDataSourceInsert) {\n        if (this.trigger(\"insertRow\", { index: rowIndex })) {\n            return;\n        }\n\n        this.batch(function() {\n            this._resizeAddRow();\n\n            var grid = this._grid;\n            var columnCount = grid.columnCount;\n            var rowCount = grid.rowCount;\n\n            if (rowIndex + 1 === rowCount) {\n                // we just inserted after the last one, no need to shift data\n                return;\n            }\n\n            var frozenRows = this.frozenRows();\n\n            if (rowIndex < frozenRows) {\n                this.frozenRows(frozenRows + 1);\n            }\n\n            var mergedCells = this._mergedCells.slice();\n\n            for (var ci = 0; ci < columnCount; ci++) {\n                var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n\n                var topLeft = grid.normalize(ref.topLeft);\n                var bottomRight = grid.normalize(ref.bottomRight);\n\n                var nextRef = new RangeRef(\n                    new CellRef(topLeft.row, topLeft.col),\n                    new CellRef(rowCount - 2, bottomRight.col)\n                );\n\n                this._copyRange(nextRef, new CellRef(topLeft.row + 1, topLeft.col));\n\n                new Range$1(ref, this).clear({ clearAll: true, keepBorders: true });\n            }\n\n            this._adjustReferences(\"row\", rowIndex, 1, mergedCells);\n        }, {\n            recalc: true,\n            layout: true,\n            insertRow: { index: rowIndex },\n            ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n        });\n\n        if (!skipDataSourceInsert) {\n            this.trigger(\"afterInsertRow\", { index: rowIndex });\n        }\n\n        return this;\n    }\n\n    isEnabledRow(rowIndex) {\n        var ref = new RangeRef(new CellRef(rowIndex, 0), new CellRef(rowIndex, this._grid.columnCount));\n        return new Range$1(ref, this).enable();\n    }\n\n    deleteRow(rowIndex, skipDataSourceDelete) {\n        if (!this.isEnabledRow(rowIndex)) {\n            return this;\n        }\n\n        if (this.trigger(\"deleteRow\", { index: rowIndex })) {\n            return;\n        }\n\n        this.batch(function() {\n            var grid = this._grid;\n            var columnCount = grid.columnCount;\n\n            var frozenRows = this.frozenRows();\n            if (rowIndex < frozenRows) {\n                this.frozenRows(frozenRows - 1);\n            }\n\n            var mergedCells = this._mergedCells.slice();\n\n            for (var ci = 0; ci < columnCount; ci++) {\n                var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n\n                new Range$1(ref, this).clear({ clearAll: true, keepBorders: true });\n\n                var topLeft = grid.normalize(ref.topLeft);\n                var bottomRight = grid.normalize(ref.bottomRight);\n\n                var nextRef = new RangeRef(\n                    new CellRef(topLeft.row + 1, topLeft.col),\n                    new CellRef(Infinity, bottomRight.col)\n                );\n\n                this._copyRange(nextRef, topLeft);\n\n                var nextRefBottomRight = grid.normalize(nextRef.bottomRight);\n\n                new Range$1(new RangeRef(nextRefBottomRight, nextRefBottomRight), this).clear();\n            }\n\n            this._adjustReferences(\"row\", rowIndex, -1, mergedCells);\n\n            this._resizeDeleteRow();\n        }, {\n            recalc: true,\n            layout: true,\n            deleteRow: { index: rowIndex },\n            ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n        });\n\n        if (!skipDataSourceDelete) {\n            this.trigger(\"afterDeleteRow\", { index: rowIndex });\n        }\n\n        return this;\n    }\n\n    insertColumn(columnIndex) {\n        if (this.trigger(\"insertColumn\", { index: columnIndex })) {\n            return;\n        }\n\n        this.batch(function() {\n            this._resizeAddColumn();\n\n            var grid = this._grid;\n            var columnCount = grid.columnCount;\n\n            if (columnIndex + 1 === columnCount) {\n                // we just inserted after the last one, no need to shift data\n                return;\n            }\n\n            var frozenColumns = this.frozenColumns();\n\n            if (columnIndex < frozenColumns) {\n                this.frozenColumns(frozenColumns + 1);\n            }\n\n            var mergedCells = this._mergedCells.slice();\n\n            for (var ci = columnCount; ci >= columnIndex; ci--) {\n                var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n\n                new Range$1(ref, this).clear({ clearAll: true, keepBorders: true });\n\n                if (ci === columnIndex) {\n                    break;\n                }\n\n                var topLeft = grid.normalize(ref.topLeft);\n                var bottomRight = grid.normalize(ref.bottomRight);\n\n                var nextRef = new RangeRef(\n                    new CellRef(topLeft.row, topLeft.col - 1),\n                    new CellRef(bottomRight.row, bottomRight.col - 1)\n                );\n\n                this._copyRange(nextRef, topLeft);\n            }\n\n            this._adjustReferences(\"col\", columnIndex, 1, mergedCells);\n        }, {\n            recalc: true,\n            layout: true,\n            insertColumn: { index: columnIndex },\n            ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n        });\n\n        return this;\n    }\n\n    isEnabledColumn(columnIndex) {\n        var ref = new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, columnIndex));\n        return new Range$1(ref, this).enable();\n    }\n\n    deleteColumn(columnIndex) {\n        if (!this.isEnabledColumn(columnIndex)) {\n            return this;\n        }\n\n        if (this.trigger(\"deleteColumn\", { index: columnIndex })) {\n            return;\n        }\n\n        this.batch(function() {\n            var grid = this._grid;\n            var columnCount = grid.columnCount;\n\n            var frozenColumns = this.frozenColumns();\n\n            if (columnIndex < frozenColumns) {\n                this.frozenColumns(frozenColumns - 1);\n            }\n\n            var mergedCells = this._mergedCells.slice();\n\n            for (var ci = columnIndex; ci < columnCount; ci++) {\n                var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n\n                new Range$1(ref, this).clear({ clearAll: true, keepBorders: true });\n\n                if (ci === columnCount - 1) {\n                    break;\n                }\n\n                var topLeft = grid.normalize(ref.topLeft);\n                var bottomRight = grid.normalize(ref.bottomRight);\n\n                var nextRef = new RangeRef(\n                    new CellRef(topLeft.row, topLeft.col + 1),\n                    new CellRef(bottomRight.row, bottomRight.col + 1)\n                );\n\n                this._copyRange(nextRef, topLeft);\n            }\n\n            this._adjustReferences(\"col\", columnIndex, -1, mergedCells);\n\n            this._resizeDeleteColumn();\n        }, {\n            recalc: true,\n            layout: true,\n            deleteColumn: { index: columnIndex },\n            ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n        });\n\n        return this;\n    }\n\n    _filterRow(rowIndex) {\n        this._rows.hide(rowIndex);\n        this._filteredRows.value(rowIndex, rowIndex, true);\n        this.triggerChange({ layout: true });\n    }\n\n    hideRow(rowIndex) {\n        if (this.trigger(\"hideRow\", { index: rowIndex })) {\n            return;\n        }\n        return this._property(this._rows.hide.bind(this._rows), rowIndex, { layout: true });\n    }\n\n    unhideRow(rowIndex) {\n        if (this.trigger(\"unhideRow\", { index: rowIndex })) {\n            return;\n        }\n        return this._property(this._rows.unhide.bind(this._rows), rowIndex, { layout: true });\n    }\n\n    isHiddenRow(rowIndex) {\n        return this._grid._rows.hidden(rowIndex);\n    }\n\n    isFilteredRow(rowIndex) {\n        return this._filteredRows.value(rowIndex);\n    }\n\n    columnWidth(columnIndex, width) {\n        return this._property(this._columns.value.bind(this._columns, columnIndex, columnIndex), width, { layout: true });\n    }\n\n    rowHeight(rowIndex, height) {\n        return this._property(this._rows.value.bind(this._rows, rowIndex, rowIndex), height, { layout: true });\n    }\n\n    frozenRows(value) {\n        return this._field(\"_frozenRows\", value, { layout: true });\n    }\n\n    frozenColumns(value) {\n        return this._field(\"_frozenColumns\", value, { layout: true });\n    }\n\n    showGridLines(value) {\n        return this._field(\"_showGridLines\", value, { layout: true });\n    }\n\n    gridLinesColor(value) {\n        return this._field(\"_gridLinesColor\", value, { layout: true });\n    }\n\n    _ref(row, column, numRows, numColumns) {\n        var ref = null;\n\n        if (row instanceof Ref) {\n            return row;\n        }\n\n        if (row instanceof Range$1) {\n            return row._ref.toRangeRef();\n        }\n\n        if (typeof row === \"string\") {\n            ref = calc.parseReference(row);\n        } else {\n            if (!numRows) {\n                numRows = 1;\n            }\n\n            if (!numColumns) {\n                numColumns = 1;\n            }\n            ref = new RangeRef(new CellRef(row, column), new CellRef(row + numRows - 1, column + numColumns - 1));\n        }\n\n        return ref;\n    }\n\n    range(row, column, numRows, numColumns) {\n        return new Range$1(this._ref(row, column, numRows, numColumns), this);\n    }\n\n    _getMergedCells(range) {\n        var grid = this._grid;\n        var primary = {};\n        var secondary = {};\n        var hasMerged = false;\n\n        this.forEachMergedCell(range, function(ref) {\n            var topLeft = ref.topLeft;\n            grid.forEach(ref, function(cellRef) {\n                if (topLeft.eq(cellRef)) {\n                    primary[cellRef.print()] = ref;\n                    hasMerged = true;\n                } else if (range.contains(cellRef)) {\n                    secondary[cellRef.print()] = topLeft;\n                    hasMerged = true;\n                }\n            });\n        });\n\n        return { primary: primary, secondary: secondary, hasMerged: hasMerged };\n    }\n\n    forEachMergedCell(ref, callback) {\n        var selectAll = false;\n\n        if (typeof callback === \"undefined\") {\n            callback = ref;\n            selectAll = true;\n        }\n\n        this._mergedCells.forEach(function(merged) {\n            if (selectAll || merged.intersects(ref)) {\n                callback(merged);\n            }\n        });\n    }\n\n    forEachFilterHeader(ref, callback) {\n        var selectAll = false;\n\n        if (typeof callback === \"undefined\") {\n            callback = ref;\n            selectAll = true;\n        }\n\n        if (this._filter) {\n            var refs = [];\n\n            // get refs of all columns\n            this._filter.ref.forEachColumn(function(columnRef) {\n                if (selectAll || columnRef.intersects(ref)) {\n                    refs.push(columnRef.topLeft);\n                }\n            });\n\n            // filter out merged references\n            this._mergedCells.forEach(function(merged) {\n                refs = refs.map(function(ref) {\n                    if (merged.intersects(ref)) {\n                        return merged;\n                    }\n\n                    return ref;\n                });\n            });\n\n            // use only unique refs\n            refs.reduce(function unique(result, element) {\n                if (result.indexOf(element) < 0) {\n                    result.push(element);\n                }\n\n                return result;\n            }, []).forEach(callback);\n        }\n    }\n\n    forEach(ref, callback) {\n        var self = this;\n        function forEachRange(ref) {\n            if (!(ref instanceof RangeRef)) {\n                ref = ref.toRangeRef();\n            }\n            var topLeft = self._grid.normalize(ref.topLeft);\n            var bottomRight = self._grid.normalize(ref.bottomRight);\n            var ci, ri;\n\n            function doIt(value) {\n                callback(ri++, ci, value);\n            }\n\n            for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                ri = topLeft.row;\n                var startCellIndex = self._grid.index(ri, ci);\n                var endCellIndex = self._grid.index(bottomRight.row, ci);\n                self._properties.forEach(startCellIndex, endCellIndex, doIt);\n            }\n        }\n\n        if (!(ref instanceof RangeRef)) {\n            ref = self._ref(ref);\n        }\n\n        if (ref instanceof UnionRef) {\n            // _ref() might still return a UnionRef, for instance, if\n            // `ref` happens to be one.  Probably an oversight, but it\n            // turns out to be useful.\n            ref.forEach(forEachRange);\n        } else {\n            forEachRange(ref);\n        }\n    }\n\n    startResizing(initialPosition) {\n        this._initialPosition = initialPosition;\n        this._resizeInProgress = true;\n    }\n\n    startAutoFill() {\n        this._autoFillInProgress = true;\n        var selection = this.select();\n        this._autoFillOrigin = selection;\n        this._autoFillDest = selection;\n        this.triggerChange({ selection: true });\n    }\n\n    updateAutoFill(dest, punch, hint, direction) {\n        this._autoFillDest = dest;\n        this._autoFillPunch = punch;\n        this._autoFillHint = hint;\n        this._autoFillDirection = direction;\n        this.triggerChange({ selection: true });\n    }\n\n    autoFillRef() {\n        return this._autoFillDest;\n    }\n\n    autoFillPunch() {\n        return this._autoFillPunch;\n    }\n\n    autoFillInProgress() {\n        return this._autoFillInProgress;\n    }\n\n    resizingInProgress() {\n        return this._resizeInProgress;\n    }\n\n    draggingInProgress() {\n        return this._draggingInProgress;\n    }\n\n    completeResizing() {\n        if (this._resizeInProgress) {\n            this._resizeInProgress = false;\n            var hintPosition = this.resizeHintPosition();\n\n            if (this._initialPosition && hintPosition) {\n                var handlePosition = this.resizeHandlePosition();\n                if (handlePosition.col !== -Infinity) {\n                    this.trigger(\"commandRequest\", {\n                        command: \"ColumnWidthCommand\",\n                        options: {\n                            target: handlePosition.col,\n                            value: this.columnWidth(handlePosition.col) - (this._initialPosition.x - hintPosition.x)\n                        }\n                    });\n                } else {\n                    this.trigger(\"commandRequest\", {\n                        command: \"RowHeightCommand\",\n                        options: {\n                            target: handlePosition.row,\n                            value: this.rowHeight(handlePosition.row) - (this._initialPosition.y - hintPosition.y)\n                        }\n                    });\n                }\n            } else {\n                this.trigger(\"change\", { resize: true });\n            }\n        }\n    }\n\n    _visualRange(ref) {\n        var merged = this._mergedCells;\n        for (var i = merged.length; --i >= 0;) {\n            if (merged[i].intersects(ref)) {\n                return this.range(merged[i]);\n            }\n        }\n        return this.range(ref);\n    }\n\n    _renderComment(ref) {\n        var comment = null;\n        if (ref) {\n            var range = this._visualRange(ref);\n            comment = range.comment();\n            ref = range._ref.toRangeRef().topLeft;\n        }\n        if (comment) {\n            if (!this._commentRef || !ref.eq(this._commentRef)) {\n                this._commentRef = ref;\n                this.trigger(\"change\", { comment: true });\n            }\n        } else {\n            if (this._commentRef) {\n                this._commentRef = null;\n                this.trigger(\"change\", { comment: true });\n            }\n        }\n    }\n\n    resizeHandlePosition() {\n        return this._resizeHandlePosition;\n    }\n\n    resizeHintPosition(location) {\n        if (location !== undefined) {\n            this._resizeHintPosition = location;\n            this.trigger(\"change\", { resize: true });\n        }\n        return this._resizeHintPosition;\n    }\n\n    removeResizeHandle() {\n        if (this._resizeHandlePosition) {\n            this._resizeHintPosition = undefined;\n            this._resizeHandlePosition = undefined;\n            this._initialPosition = undefined;\n            this.trigger(\"change\", { resize: true });\n        }\n    }\n\n    positionResizeHandle(ref) {\n        this._resizeHandlePosition = ref;\n        this.trigger(\"change\", { resize: true });\n    }\n\n    startDragging(data) {\n        this._draggingInProgress = data;\n    }\n\n    completeDragging() {\n        var drag = this._draggingInProgress;\n        if (drag) {\n            this._draggingInProgress = null;\n            var drawing = drag.drawing;\n            if (drawing.eq(drag.copy)) {\n                return;\n            }\n            if (drawing.topLeftCell) {\n                // adjust reference - in case the top-left corner\n                // was moving, select the cell beneath it.\n                var box = this.drawingBoundingBox(drawing);\n                var row = this._rows.indexVisible(box.top);\n                var col = this._columns.indexVisible(box.left);\n                var ref = new CellRef(row, col);\n                var refBox = this.refBoundingBox(ref);\n                drawing.offsetX = box.left - refBox.left;\n                drawing.offsetY = box.top - refBox.top;\n                drawing.topLeftCell = ref;\n                this.triggerChange({ dragging: true });\n            }\n            this.trigger(\"commandRequest\", {\n                command: \"DrawingUpdateCommand\",\n                options: {\n                    sheet    : this,\n                    drawing  : drawing,\n                    previous : drag.copy\n                }\n            });\n        }\n    }\n\n    startSelection(view) {\n        if (this.frozenRows() || this.frozenColumns()) {\n            this._currentView = null;\n        } else if (view && view._sheet === this) {\n            this._currentView = view;\n        }\n        this._selectionInProgress = true;\n    }\n\n    completeSelection() {\n        if (this._selectionInProgress) {\n            this._selectionInProgress = false;\n            this._resizeHintPosition = undefined;\n            this.trigger(\"change\", { selection: true });\n        }\n        if (this._autoFillInProgress) {\n            this._autoFillInProgress = false;\n            var dest = this._autoFillDest;\n            var origin = this._autoFillOrigin;\n\n            if (this._autoFillPunch) { // we just clear data here\n                this.trigger(\"commandRequest\", {\n                    command: \"ClearContentCommand\", options: { operatingRange: this.range(this._autoFillPunch) }\n                });\n            } else {\n                if (!dest.eq(origin)) {\n                    this.trigger(\"commandRequest\", {\n                        command: \"AutoFillCommand\", options: { operatingRange: this.range(dest), origin: this.range(origin) }\n                    });\n                } else {\n                    this.triggerChange({ selection: true });\n                }\n            }\n\n            this._autoFillDest = null;\n            this._autoFillPunch = null;\n            this._autoFillOrigin = null;\n\n            this.select(dest);\n        }\n    }\n\n    selectionInProgress() {\n        return this._selectionInProgress;\n    }\n\n    select(ref, changeActiveCell) {\n        var selectionState = this._selectionState();\n\n        var expandedRef;\n\n        if (ref) {\n            ref = this._ref(ref);\n            ref = this._grid.normalize(ref);\n            expandedRef = this._grid.isAxis(ref) ? ref : this.unionWithMerged(ref);\n        }\n\n        return selectionState.select(ref, expandedRef, changeActiveCell, this._currentView);\n    }\n\n    originalSelect() {\n        return this._selectionState().originalSelection;\n    }\n\n    currentSelectionRange() {\n        return this._selectionState().currentSelectionRange();\n    }\n\n    currentOriginalSelectionRange() {\n        return this._selectionState().currentOriginalNavigationRange();\n    }\n\n    currentNavigationRange() {\n        return this._selectionState().currentNavigationRange();\n    }\n\n    nextNavigationRange() {\n        return this._selectionState().nextNavigationRange();\n    }\n\n    previousNavigationRange() {\n        return this._selectionState().previousNavigationRange();\n    }\n\n    selectionRangeIndex() {\n        return this._selectionState().selectionRangeIndex;\n    }\n\n    activeCell(ref) {\n        return this._selectionState().activeCell(ref);\n    }\n\n    originalActiveCell() {\n        return this._selectionState().originalActiveCell;\n    }\n\n    singleCellSelection() {\n        return this._selectionState().singleCellSelection();\n    }\n\n    unionWithMerged(ref) {\n        var mergedCells = this._mergedCells;\n\n        return ref.map(function(ref) {\n            return ref.toRangeRef().union(mergedCells);\n        });\n    }\n\n    trim(ref) {\n        var trims = [];\n        var grid = this._grid;\n        this._properties.forEachProperty(function(property) {\n            trims.push(grid.trim(ref, property.list));\n        });\n        return this.unionWithMerged(ref.topLeft.toRangeRef().union(trims));\n    }\n\n    focus(ref) {\n        if (ref) {\n            this._focus = ref.toRangeRef();\n        } else {\n            var focus = this._focus;\n            this._focus = null;\n            return focus;\n        }\n    }\n\n    activeCellSelection() {\n        return new Range$1(this._grid.normalize(this.activeCell()), this);\n    }\n\n    selection() {\n        return new Range$1(this._grid.normalize(this._selectionState().selection), this);\n    }\n\n    selectedHeaders() {\n        var selection = this.select();\n\n        var rows = {};\n        var cols = {};\n        var allCols = false;\n        var allRows = false;\n        var maxRow = this._grid.rowCount - 1;\n        var maxCol = this._grid.columnCount - 1;\n\n        selection.forEach(function(ref) {\n            var i;\n            var rowState = \"partial\";\n            var colState = \"partial\";\n            ref = ref.toRangeRef();\n\n            var bottomRight = ref.bottomRight;\n            var topLeft = ref.topLeft;\n\n            var rowSelection = topLeft.col <= 0 && bottomRight.col >= maxCol;\n            var colSelection = topLeft.row <= 0 && bottomRight.row >= maxRow;\n\n            if (colSelection) { //column selection\n                allRows = true;\n                colState = \"full\";\n            }\n\n            if (rowSelection) { //row selection\n                allCols = true;\n                rowState = \"full\";\n            }\n\n            if (!colSelection) { //column selection\n                for (i = topLeft.row; i <= bottomRight.row; i++) {\n                    if (rows[i] !== \"full\") {\n                        rows[i] = rowState;\n                    }\n                }\n            }\n\n            if (!rowSelection) {\n                for (i = topLeft.col; i <= bottomRight.col; i++) {\n                    if (cols[i] !== \"full\") {\n                        cols[i] = colState;\n                    }\n                }\n            }\n        });\n\n        return {\n            rows: rows,\n            cols: cols,\n            allRows: allRows,\n            allCols: allCols,\n            all: allRows && allCols\n        };\n    }\n\n    isInEditMode(isInEdit) {\n        if (isInEdit === undefined) {\n            return this._inEdit;\n        }\n\n        this._inEdit = isInEdit;\n\n        if (isInEdit) {\n            this._editSelection.selection = this._viewSelection.selection.clone();\n            this._editSelection.originalSelection = this._viewSelection.originalSelection.clone();\n            this._editSelection._activeCell = this._viewSelection._activeCell.clone();\n            this._editSelection.originalActiveCell = this._viewSelection.originalActiveCell.clone();\n        }\n    }\n\n    _setFormulaSelections(selection) {\n        this._formulaSelections = (selection || []).slice();\n        this.triggerChange({ selection: true });\n    }\n\n    _viewActiveCell() {\n        return this._viewSelection._activeCell.toRangeRef();\n    }\n\n    toJSON() {\n        var positions = {};\n\n        var rows = this._rows.toJSON(\"height\", positions);\n        var columns = this._columns.toJSON(\"width\", {});\n        var viewSelection = this._viewSelection;\n        var hyperlinks = [];\n        var defaultCellStyle = this._defaultCellStyle || {};\n\n        function clearDefaultStyle(cell) {\n            Object.keys(defaultCellStyle).forEach(function(key) {\n                if (cell[key] === defaultCellStyle[key]) {\n                    delete cell[key];\n                }\n            });\n        }\n\n        this.forEach(SHEETREF, function(row, col, cell) {\n            clearDefaultStyle(cell);\n\n            if (Object.keys(cell).length === 0) {\n                return;\n            }\n\n            if (cell.link) {\n                hyperlinks.push({\n                    ref    : Ref.display(null, row, col),\n                    target : cell.link\n                });\n            }\n\n            var position = positions[row];\n\n            if (position === undefined) {\n                position = rows.length;\n                rows.push({ index: row });\n                positions[row] = position;\n            }\n\n            row = rows[position];\n\n            cell.index = col;\n\n            if (row.cells === undefined) {\n                row.cells = [];\n            }\n\n            if (cell.formula) {\n                // stringify Formula object.\n                if (cell.formula.arrayFormulaRange) {\n                    cell.formula = {\n                        src: cell.formula.toString(),\n                        ref: cell.formula.arrayFormulaRange.toString()\n                    };\n                } else {\n                    cell.formula = cell.formula.toString();\n                }\n            }\n\n            if (cell.validation) {\n                cell.validation = cell.validation.toJSON();\n            }\n\n            if (cell.color) {\n                cell.color = parseColor(cell.color).toCss();\n            }\n\n            if (cell.background) {\n                cell.background = parseColor(cell.background).toCss();\n            }\n\n            if (cell.borderTop && cell.borderTop.color) {\n                cell.borderTop.color = parseColor(cell.borderTop.color).toCss();\n            }\n\n            if (cell.borderBottom && cell.borderBottom.color) {\n                cell.borderBottom.color = parseColor(cell.borderBottom.color).toCss();\n            }\n\n            if (cell.borderRight && cell.borderRight.color) {\n                cell.borderRight.color = parseColor(cell.borderRight.color).toCss();\n            }\n\n            if (cell.borderLeft && cell.borderLeft.color) {\n                cell.borderLeft.color = parseColor(cell.borderLeft.color).toCss();\n            }\n\n            row.cells.push(cell);\n        });\n\n        var json = {\n            name: this._name(),\n            state: this._state(),\n            rows: rows,\n            columns: columns,\n            selection: viewSelection.selection.toString(),\n            activeCell: viewSelection.activeCell().toString(),\n            frozenRows: this.frozenRows(),\n            frozenColumns: this.frozenColumns(),\n            showGridLines: this.showGridLines(),\n            gridLinesColor: this.gridLinesColor(),\n            mergedCells: this._mergedCells.map(function(ref) {\n                return ref.toString();\n            }),\n            hyperlinks: hyperlinks,\n            defaultCellStyle: defaultCellStyle,\n            drawings: this._drawings.map(function(dr) {\n                return dr.toJSON();\n            })\n        };\n\n        if (this._sort) {\n            json.sort = {\n                ref: this._sort.ref.toString(),\n                columns: this._sort.columns.map(function(column) {\n                    return {\n                        index: column.index,\n                        ascending: column.ascending\n                    };\n                })\n            };\n        }\n\n        if (this._filter) {\n            json.filter = {\n                ref: this._filter.ref.toString(),\n                columns: this._filter.columns.map(function(column) {\n                    var filter = column.filter.toJSON();\n                    filter.index = column.index;\n                    return filter;\n                })\n            };\n        }\n\n        return json;\n    }\n\n    fromJSON(json) {\n        this.batch(function() {\n            if (json.name !== undefined) {\n                this._name(json.name);\n            }\n\n            if (json.frozenColumns !== undefined) {\n                this.frozenColumns(json.frozenColumns);\n            }\n\n            if (json.frozenRows !== undefined) {\n                this.frozenRows(json.frozenRows);\n            }\n\n            if (json.columns !== undefined) {\n                this._columns.fromJSON(\"width\", json.columns);\n            }\n\n            if (json.rows !== undefined) {\n                this._resizeForJSON(json.rows);\n                this._rows.fromJSON(\"height\", json.rows);\n\n                for (var ri = 0; ri < json.rows.length; ri++) {\n                    var row = json.rows[ri];\n                    var rowIndex = row.index;\n\n                    if (rowIndex === undefined) {\n                        rowIndex = ri;\n                    }\n\n                    if (row.cells) {\n                        for (var ci = 0; ci < row.cells.length; ci++) {\n                            var cell = row.cells[ci];\n                            var columnIndex = cell.index;\n\n                            if (columnIndex === undefined) {\n                                columnIndex = ci;\n                            }\n\n                            if (cell.formula) {\n                                var isArray = typeof cell.formula != \"string\";\n                                var src = isArray ? cell.formula.src : cell.formula;\n                                var formula = this._compileFormula(rowIndex, columnIndex, src);\n                                if (isArray) {\n                                    formula.setArrayFormulaRange(\n                                        calc.parseReference(cell.formula.ref));\n                                }\n                                cell.formula = formula;\n                            }\n\n                            if (cell.validation) {\n                                cell.validation = this._compileValidation(rowIndex, columnIndex, cell.validation);\n                            }\n\n                            this._properties.fromJSON(this._grid.index(rowIndex, columnIndex), cell);\n                        }\n                    }\n                }\n            }\n\n            if (json.drawings) {\n                this._drawings = json.drawings.map(Drawing.fromJSON);\n            }\n\n            if (json.selection) {\n                this._viewSelection.selection =\n                    this._viewSelection.originalSelection = this._ref(json.selection);\n            }\n\n            if (json.activeCell) {\n                var activeCellRef = this._ref(json.activeCell);\n\n                this._viewSelection._activeCell = activeCellRef.toRangeRef();\n                this._viewSelection.originalActiveCell = activeCellRef.first();\n            }\n\n\n            if (json.mergedCells) {\n                json.mergedCells.forEach(function(ref) {\n                    this.range(ref).merge();\n                }, this);\n            }\n\n            if (json.filter) {\n                var ref = json.filter.ref;\n                var columns = json.filter.columns === undefined ? [] : json.filter.columns;\n\n                if (!ref) ; else {\n                    this._filter = {\n                        ref: this._ref(ref),\n                        columns: columns.map(function(column) {\n                            return {\n                                index: column.index,\n                                filter: Filter.create(column)\n                            };\n                        })\n                    };\n\n                    this._refreshFilter();\n                }\n            }\n\n            if (json.showGridLines !== undefined) {\n                this._showGridLines = json.showGridLines;\n            }\n\n            this._gridLinesColor = json.gridLinesColor;\n\n            if (json.sort) {\n                this._sortBy(this._ref(json.sort.ref), json.sort.columns.slice(0));\n            }\n        });\n\n        this._rows._refresh();\n        this._columns._refresh();\n    }\n\n    formula(ref) {\n        return this._properties.get(\"formula\", this._grid.cellRefIndex(ref));\n    }\n\n    validation(ref) {\n        return this._properties.get(\"validation\", this._grid.cellRefIndex(ref));\n    }\n\n    // NOTE: resetFormulas should be called first.  We don't do it in this\n    // function because it should be done from the Workbook object for all\n    // sheets.\n    resetFormulas() {\n        this._forFormulas(function(formula) {\n            formula.reset();\n        });\n    }\n\n    resetValidations() {\n        this._forValidations(function(validation) {\n            validation.reset();\n        });\n    }\n\n    recalc(context, callback) {\n        var formulas = this._properties.get(\"formula\").values();\n        var count = formulas.length, pending = 0, i = 0;\n        if (!count && callback) {\n            return callback();\n        }\n        function next() {\n            pending--;\n            if (i === count && !pending) {\n                callback();\n            }\n        }\n        while (i < count) {\n            pending++;\n            formulas[i++].value.exec(context, callback ? next : null);\n        }\n    }\n\n    revalidate(context) {\n        var self = this;\n        this._forValidations(function(validation) {\n            var cellRef = new CellRef(validation.row, validation.col);\n            var ref = new RangeRef(cellRef, cellRef);\n            validation.exec(context, self._get(ref, \"value\"), self._get(ref, \"format\"));\n        });\n    }\n\n    _value(row, col, value) {\n        var index = this._grid.index(row, col);\n\n        if (value !== undefined) {\n            this._properties.set(\"value\", index, index, value);\n        } else {\n            return this._properties.get(\"value\", index);\n        }\n    }\n\n    _validation(row, col) {\n        var index = this._grid.index(row, col);\n\n        return this._properties.get(\"validation\", index);\n    }\n\n    _compileValidation(row, col, curValidation) {\n        if (curValidation instanceof validationExport.Validation) {\n            // do not alter an existing object.\n            return curValidation.clone(this._name(), row, col);\n        }\n\n        if (curValidation.from != null) {\n            curValidation.from = (curValidation.from + \"\").replace(/^=/, \"\");\n        }\n\n        if (curValidation.to != null) {\n            curValidation.to = (curValidation.to + \"\").replace(/^=/, \"\");\n        }\n\n        return validationExport.compile(this._name(), row, col, curValidation);\n    }\n\n    _compileFormula(row, col, f) {\n        f = f.replace(/^=/, \"\");\n        f = calc.parseFormula(this._name(), row, col, f);\n        return calc.compile(f);\n    }\n\n    _copyValuesInRange(topLeft, bottomRight, value, property) {\n        var ci, start, end;\n\n        for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n            start = this._grid.index(topLeft.row, ci);\n            end = this._grid.index(bottomRight.row, ci);\n            for (var index = start, row = topLeft.row; index <= end; ++index, ++row) {\n                // Even if it's the same formula in multiple cells, we\n                // need to have different Formula objects, hence cloning\n                // it.  Don't worry, clone() is fast.\n                value = value.clone(this._name(), row, ci);\n                this._properties.set(property, index, index, value);\n            }\n        }\n        return value;\n    }\n\n    _set(ref, name, value) {\n        var topLeft = this._grid.normalize(ref.topLeft);\n        var bottomRight = this._grid.normalize(ref.bottomRight);\n        var ci, start, end;\n\n        if (typeof value == \"number\") {\n            // Apparently, Excel (and LibreOffice and Google\n            // Sheets) will limit precision to 14 digits; type:\n            // -4.2524999999999995 and you get -4.2525.  The\n            // formula engine already does something similar for\n            // intermediate formula results, but we must do it\n            // here as well for original input values.\n            value = calc.runtime.limitPrecision(value);\n        }\n\n        if (value && name === \"formula\") {\n            if (typeof value == \"string\") {\n                // get Formula object.  we don't care about handling errors\n                // here since it won't be called interactively.\n                value = this._compileFormula(topLeft.row, topLeft.col, value);\n            }\n\n            value = this._copyValuesInRange(topLeft, bottomRight, value, \"formula\");\n\n        } else if (value && name === \"validation\") {\n            value = this._compileValidation(topLeft.row, topLeft.col, value);\n            value = this._copyValuesInRange(topLeft, bottomRight, value, \"validation\");\n\n        } else {\n            for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                start = this._grid.index(topLeft.row, ci);\n                end = this._grid.index(bottomRight.row, ci);\n                this._properties.set(name, start, end, value);\n                if (name === \"formula\") {\n                    // removing a formula, must clear value.\n                    this._properties.set(\"value\", start, end, null);\n                }\n            }\n        }\n    }\n\n    _get(ref, name) {\n        var topLeft = this._grid.normalize(ref.topLeft);\n\n        var index = this._grid.index(topLeft.row, topLeft.col);\n\n        return this._properties.get(name, index);\n    }\n\n    batch(callback, reason) {\n        var suspended = this.suspendChanges();\n\n        this.suspendChanges(true);\n        this._valueChanged = false;\n\n        callback.call(this);\n\n        if (!reason) {\n            reason = { recalc: true };\n        }\n        if (this._valueChanged) {\n            reason.isValue = true;\n        }\n\n        return this.suspendChanges(suspended).triggerChange(reason);\n    }\n\n    _sortBy(ref, columns) {\n        var indices = null;\n\n        columns.forEach(function(column) {\n            indices = this._sorter.sortBy(ref, column.index, this._properties.get(\"value\"), column.ascending, indices);\n        }, this);\n\n        this._sort = {\n            ref: ref,\n            columns: columns\n        };\n\n        this._refreshFilter();\n\n        this.forEach(ref, function(row, col, props) {\n            var formula = props.formula;\n            if (formula) {\n                var diff = row - formula.row;\n                if (diff !== 0) {\n                    var start = diff > 0 ? formula.row : formula.row + diff;\n                    formula.adjust(this.name(), \"row\", start, diff);\n                }\n            }\n        }.bind(this));\n\n        this.triggerChange({ recalc: true });\n    }\n\n    _refreshFilter() {\n        if (this._filter) {\n            this._filterBy(this._filter.ref, this._filter.columns);\n        }\n    }\n\n    _filterBy(ref, columns) {\n        this.batch(function() {\n            for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                if (this.isFilteredRow(ri)) {\n                    this._filteredRows.value(ri, ri, false);\n                    this._rows.unhide(ri);\n                }\n            }\n\n            columns.forEach(function(column) {\n                // do not filter header row\n                var columnRef = ref.resize({ top: 1 }).toColumn(column.index);\n\n                var cells = [];\n\n                if (columnRef === NULLREF) {\n                    return;\n                }\n\n                this.forEach(columnRef, function(row, col, cell) {\n                    cell.row = row;\n                    cells.push(cell);\n                });\n\n                column.filter.prepare(cells);\n\n                for (var ci = 0; ci < cells.length; ci++) {\n                    var cell = cells[ci];\n                    var value = column.filter.value(cell);\n\n                    if (column.filter.matches(value) === false) {\n                        this._filterRow(cell.row);\n                    }\n                }\n            }, this);\n\n            this._filter = {\n                ref: ref,\n                columns: columns\n            };\n        }, { recalc: true, layout: true, filter: true });\n    }\n\n    filterColumn(ref) {\n        var filterRef = this.filter().ref;\n        return ref.toRangeRef().topLeft.col - filterRef.topLeft.col;\n    }\n\n    filter() {\n        return this._filter;\n    }\n\n    clearFilter(spec) {\n        this._clearFilter(spec instanceof Array ? spec : [spec]);\n    }\n\n    _clearFilter(indices) {\n        if (this._filter) {\n            this.batch(function() {\n                this._filter.columns = this._filter.columns.filter(function(column) {\n                    return indices.indexOf(column.index) < 0;\n                });\n\n                this._refreshFilter();\n            }, { recalc: true, layout: true, filter: true });\n        }\n    }\n\n    getAxisState() {\n        return {\n            rows: this._rows.getState(),\n            columns: this._columns.getState()\n        };\n    }\n\n    setAxisState(state) {\n        this._rows.setState(state.rows);\n        this._columns.setState(state.columns);\n        this.triggerChange({ layout: true });\n    }\n\n    getState() {\n        return {\n            rows: this._rows.getState(),\n            columns: this._columns.getState(),\n            mergedCells: this._mergedCells.map(function(cell) { return cell.clone(); }),\n            properties: this._properties.getState()\n        };\n    }\n\n    setState(state) {\n        this._rows.setState(state.rows);\n        this._columns.setState(state.columns);\n        this._mergedCells = state.mergedCells;\n        this._properties.setState(state.properties);\n        this.triggerChange(ALL_REASONS);\n    }\n\n    _merge(ref) {\n        var mergedCells = this._mergedCells;\n\n        var sheet = this;\n        var mergedRef;\n        this.batch(function() {\n            mergedRef = ref.map(function(ref) {\n                if (ref instanceof CellRef) {\n                    return ref;\n                }\n\n                var currentRef = ref.toRangeRef().union(mergedCells, function(ref) {\n                    mergedCells.splice(mergedCells.indexOf(ref), 1);\n                });\n\n                var range = new Range$1(currentRef, sheet);\n                var formula = range._get(\"formula\");\n                var value = range.value();\n                var format = range.format();\n                var background = range.background();\n\n                range.value(null);\n                range.format(null);\n                range.background(null);\n\n                var topLeft = new Range$1(currentRef.collapse(), sheet);\n\n                if (formula) {\n                    topLeft._set(\"formula\", formula);\n                } else {\n                    topLeft.value(value);\n                }\n                topLeft.format(format);\n                topLeft.background(background);\n\n                mergedCells.push(currentRef);\n                return currentRef;\n            });\n\n            var viewSelection = sheet._viewSelection;\n\n            viewSelection.selection = sheet.unionWithMerged(viewSelection.originalSelection);\n            viewSelection._activeCell = sheet.unionWithMerged(viewSelection.originalActiveCell);\n        }, { activeCell: true, selection: true });\n\n        return mergedRef;\n    }\n\n    _useCultureDecimals() {\n        return this._workbook && this._workbook.options.useCultureDecimals;\n    }\n\n    withCultureDecimals(f) {\n        var dot = \".\";\n        if (this._useCultureDecimals()) {\n            dot = culture().numbers.symbols.decimal;\n        }\n        return calc.withDecimalSeparator(dot, f);\n    }\n\n    drawingBoundingBox(drawing) {\n        var left = drawing.offsetX;\n        var top = drawing.offsetY;\n        if (drawing.topLeftCell) {\n            // offsets are relative to cell\n            left += this._columns.sum(0, drawing.topLeftCell.col - 1);\n            top += this._rows.sum(0, drawing.topLeftCell.row - 1);\n        }\n        return new Rectangle(left, top, drawing.width, drawing.height);\n    }\n\n    refBoundingBox(ref) {\n        return this._grid.rectangle(ref.toRangeRef());\n    }\n\n    addDrawing(drw, activate) {\n        if (!(drw instanceof Drawing)) {\n            drw = new Drawing(drw);\n        }\n        this._drawings.push(drw);\n        if (activate) {\n            this._activeDrawing = drw;\n        }\n        this.triggerChange({ layout: true });\n        return drw;\n    }\n\n    removeDrawing(drawing) {\n        var pos = this._drawings.indexOf(drawing);\n        if (pos >= 0) {\n            this._drawings.splice(pos, 1);\n            this.triggerChange({ layout: true });\n        }\n    }\n\n    usesImage(img) {\n        for (var i = this._drawings.length; --i >= 0;) {\n            if (this._drawings[i].image === img) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    isMerged(ref) {\n        var merged = this._mergedCells;\n        for (var i = merged.length; --i >= 0;) {\n            if (merged[i].eq(ref)) {\n                return true;\n            }\n        }\n        return false;\n    }\n}\n\nclass Drawing {\n    constructor(args) {\n        this.reset(args);\n    }\n\n    toJSON() {\n        return {\n            topLeftCell: this.topLeftCell.toString(),\n            offsetX: this.offsetX,\n            offsetY: this.offsetY,\n            width: this.width,\n            height: this.height,\n            image: this.image,\n            opacity: this.opacity\n        };\n    }\n\n    clone() {\n        return new Drawing(this);\n    }\n\n    reset(dr) {\n        var anchor = dr.topLeftCell;\n        if (typeof anchor == \"string\") {\n            anchor = calc.parseReference(anchor);\n        }\n        this.topLeftCell = anchor;\n        this.offsetX = dr.offsetX || 0;\n        this.offsetY = dr.offsetY || 0;\n        this.width = dr.width;\n        this.height = dr.height;\n        this.image = dr.image;\n        this.opacity = dr.opacity != null ? dr.opacity : 1;\n    }\n\n    eq(dr) {\n        return ((!this.topLeftCell && !dr.topLeftCell)\n                || (this.topLeftCell && dr.topLeftCell\n                    && this.topLeftCell.eq(dr.topLeftCell)))\n            && this.offsetX === dr.offsetX\n            && this.offsetY === dr.offsetY\n            && this.width === dr.width\n            && this.height === dr.height\n            && this.image === dr.image\n            && this.opacity === dr.opacity;\n    }\n}\n\nDrawing.fromJSON = function(args) {\n    return new Drawing(args);\n};\n\n/* eslint-disable no-param-reassign */\n/* eslint-disable key-spacing */\nlet PAPER_SIZE = {\n    a0        : [ 2383.94 , 3370.39 ],\n    a1        : [ 1683.78 , 2383.94 ],\n    a2        : [ 1190.55 , 1683.78 ],\n    a3        : [ 841.89 , 1190.55 ],\n    a4        : [ 595.28 , 841.89 ],\n    a5        : [ 419.53 , 595.28 ],\n    a6        : [ 297.64 , 419.53 ],\n    a7        : [ 209.76 , 297.64 ],\n    a8        : [ 147.40 , 209.76 ],\n    a9        : [ 104.88 , 147.40 ],\n    a10       : [ 73.70 , 104.88 ],\n    b0        : [ 2834.65 , 4008.19 ],\n    b1        : [ 2004.09 , 2834.65 ],\n    b2        : [ 1417.32 , 2004.09 ],\n    b3        : [ 1000.63 , 1417.32 ],\n    b4        : [ 708.66 , 1000.63 ],\n    b5        : [ 498.90 , 708.66 ],\n    b6        : [ 354.33 , 498.90 ],\n    b7        : [ 249.45 , 354.33 ],\n    b8        : [ 175.75 , 249.45 ],\n    b9        : [ 124.72 , 175.75 ],\n    b10       : [ 87.87 , 124.72 ],\n    c0        : [ 2599.37 , 3676.54 ],\n    c1        : [ 1836.85 , 2599.37 ],\n    c2        : [ 1298.27 , 1836.85 ],\n    c3        : [ 918.43 , 1298.27 ],\n    c4        : [ 649.13 , 918.43 ],\n    c5        : [ 459.21 , 649.13 ],\n    c6        : [ 323.15 , 459.21 ],\n    c7        : [ 229.61 , 323.15 ],\n    c8        : [ 161.57 , 229.61 ],\n    c9        : [ 113.39 , 161.57 ],\n    c10       : [ 79.37 , 113.39 ],\n    executive : [ 521.86 , 756.00 ],\n    folio     : [ 612.00 , 936.00 ],\n    legal     : [ 612.00 , 1008.00 ],\n    letter    : [ 612.00 , 792.00 ],\n    tabloid   : [ 792.00 , 1224.00 ]\n};\n\nfunction mm2pt(mm) {\n    return mm * (72 / 25.4);\n}\n\nfunction cm2pt(cm) {\n    return mm2pt(cm * 10);\n}\n\nfunction in2pt(inch) {\n    return inch * 72;\n}\n\nfunction unitsToPoints(x, def) {\n    if (typeof x == \"number\") {\n        return x;\n    }\n    if (typeof x == \"string\") {\n        let m;\n        m = /^\\s*([0-9.]+)\\s*(mm|cm|in|pt)\\s*$/.exec(x);\n        if (m) {\n            let num = parseFloat(m[1]);\n            if (!isNaN(num)) {\n                if (m[2] === \"pt\") {\n                    return num;\n                }\n                return {\n                    \"mm\": mm2pt,\n                    \"cm\": cm2pt,\n                    \"in\": in2pt\n                }[m[2]](num);\n            }\n        }\n    }\n    if (def != null) {\n        return def;\n    }\n    throw new Error(\"Can't parse unit: \" + x);\n}\n\nfunction getPaperOptions(getOption) {\n    if (typeof getOption != \"function\") {\n        let options = getOption;\n        getOption = function(key, def) {\n            return key in options ? options[key] : def;\n        };\n    }\n    let paperSize = getOption(\"paperSize\", PAPER_SIZE.a4);\n    if (!paperSize) {\n        return {};\n    }\n    if (typeof paperSize == \"string\") {\n        paperSize = PAPER_SIZE[paperSize.toLowerCase()];\n        if (paperSize == null) {\n            throw new Error(\"Unknown paper size\");\n        }\n    }\n\n    paperSize[0] = unitsToPoints(paperSize[0]);\n    paperSize[1] = unitsToPoints(paperSize[1]);\n\n    if (getOption(\"landscape\", false)) {\n        paperSize = [\n            Math.max(paperSize[0], paperSize[1]),\n            Math.min(paperSize[0], paperSize[1])\n        ];\n    }\n\n    let margin = getOption(\"margin\");\n    if (margin) {\n        if (typeof margin == \"string\" || typeof margin == \"number\") {\n            margin = unitsToPoints(margin, 0);\n            margin = { left: margin, top: margin, right: margin, bottom: margin };\n        } else {\n            margin = {\n                left   : unitsToPoints(margin.left, 0),\n                top    : unitsToPoints(margin.top, 0),\n                right  : unitsToPoints(margin.right, 0),\n                bottom : unitsToPoints(margin.bottom, 0)\n            };\n        }\n        if (getOption(\"addMargin\")) {\n            paperSize[0] += margin.left + margin.right;\n            paperSize[1] += margin.top + margin.bottom;\n        }\n    }\n    return { paperSize: paperSize, margin: margin };\n}\n\n/* eslint-disable no-nested-ternary */\n/* eslint-disable default-case */\n/* eslint-disable no-implicit-coercion */\n/* eslint-disable no-else-return */\n/* eslint-disable key-spacing */\n/* eslint-disable eqeqeq */\n/* eslint-disable no-param-reassign */\n\n\nlet GUIDELINE_WIDTH = 0.8;\n\n// This takes a list of row heights and the page height, and\n// produces a list of Y coordinates for each row, such that rows\n// are not truncated across pages.  However, the algorithm will\n// decide to truncate a row in the event that more than\n// `maxEmpty` (default 0.2) of the available space would\n// otherwise be left blank.\n//\n// It will be used for horizontal splitting too (will receive\n// column widths and page width, and produce a list of X coords).\n//\n// If the third argument (headerRows) is not null, it specifies a\n// number of rows to repeat on each page.  On pages other than the\n// first, the necessary space will be skipped at the top.  Header\n// coordinates (except for the first page) are pushed in\n// headerCoords.\nfunction distributeCoords(heights, pageHeight, maxEmpty, headerRows, headerCoords) {\n    let curr = 0;\n    let out = [];\n    let bottom = pageHeight;\n    let header = 0;\n    if (pageHeight && maxEmpty) {\n        maxEmpty *= pageHeight;\n    }\n    heights.forEach(function(h, i) {\n        if (headerRows != null && i < headerRows) {\n            header += h;\n        }\n        if (pageHeight && curr + h > bottom) {\n            if (bottom - curr < maxEmpty) {\n                // align to next page\n                curr = pageHeight * Math.ceil(curr / pageHeight) + header;\n                if (header > 0) {\n                    headerCoords.push(curr - header);\n                }\n            }\n            // update bottom anyway; don't just add pageHeight, as\n            // we might need multiple pages for the pathological\n            // case of one row higher than the page.\n            bottom += pageHeight * Math.ceil(h / pageHeight);\n        }\n        out.push(curr);\n        curr += h;\n    });\n    out.push(curr);\n    return out;\n}\n\nfunction doLayout(sheet, range, options) {\n    // normalize reference so we don't have to deal with Infinity here.\n    let grid = sheet._grid;\n    range = grid.normalize(range);\n\n    let wholeRect = grid.rectangle(range);\n    let drawings = [];\n    sheet._drawings.forEach(function(d) {\n        let box = sheet.drawingBoundingBox(d);\n        if (box.intersects(wholeRect)) {\n            drawings.push({\n                drawing: d,\n                box: box.offset(-wholeRect.left, -wholeRect.top)\n            });\n        }\n    });\n\n    // 1. obtain the list of cells that need to be printed, the\n    //    row heights and column widths.  Place in each cell row,\n    //    col (relative to range, i.e. first is 0,0), rowspan,\n    //    colspan and merged.  also place a list of drawings\n    //    anchored to that cell.\n    let cells = [];\n    let rowHeights = [];\n    let colWidths = [];\n    let mergedCells = sheet._getMergedCells(range);\n\n    let maxRow = -1, maxCol = -1;\n    sheet.forEach(range, function(row, col, cell) {\n        let relrow = row - range.topLeft.row;\n        let relcol = col - range.topLeft.col;\n        let rh = sheet.rowHeight(row);\n        let cw = sheet.columnWidth(col);\n        if (!options.forScreen) {\n            // for printing we'll need the list of anchored\n            // drawings so that we can adjust them after page\n            // splitting.\n            cell.drawings = drawings.filter(function(d) {\n                let tl = d.drawing.topLeftCell;\n                if (tl && tl.row == row && tl.col == col) {\n                    maxRow = Math.max(maxRow, sheet._rows.index(d.box.bottom));\n                    maxCol = Math.max(maxCol, sheet._columns.index(d.box.right));\n                    return true;\n                }\n            });\n        }\n        if (!relcol) {\n            rowHeights.push(rh);\n        }\n        if (!relrow) {\n            colWidths.push(cw);\n        }\n        let id = new CellRef(row, col).print();\n        if (mergedCells.secondary[id]) {\n            return;\n        }\n        cell.row = relrow;\n        cell.col = relcol;\n        let m = mergedCells.primary[id];\n        if (m) {\n            delete mergedCells.primary[id];\n            cell.merged = true;\n            cell.rowspan = m.height();\n            cell.colspan = m.width();\n            if (options.forScreen) {\n                cell.width = sheet._columns.sum(m.topLeft.col, m.bottomRight.col);\n                cell.height = sheet._rows.sum(m.topLeft.row, m.bottomRight.row);\n            }\n        } else {\n            cell.rowspan = 1;\n            cell.colspan = 1;\n        }\n        if (!sheet._grid._columns.sum(col, col + cell.colspan - 1) ||\n            !sheet._grid._rows.sum(row, row + cell.rowspan - 1)) {\n            return;\n        }\n        let nonEmpty = options.forScreen || shouldDrawCell(cell);\n        if (!(options.emptyCells || nonEmpty)) {\n            return;\n        }\n        if (nonEmpty) {\n            maxRow = Math.max(maxRow, relrow + cell.rowspan - 1);\n            maxCol = Math.max(maxCol, relcol + cell.colspan - 1);\n        } else {\n            cell.empty = true;\n        }\n        cells.push(cell);\n    });\n\n    if (!options.forScreen) {\n        // keep only the drawable area\n        rowHeights = rowHeights.slice(0, maxRow + 1);\n        colWidths = colWidths.slice(0, maxCol + 1);\n    }\n\n    let pageWidth = options.pageWidth;\n    let pageHeight = options.pageHeight;\n    let scaleFactor = options.scale || 1;\n\n    // when fitWidth is requested, we must update the page size\n    // with the corresponding scale factor; the algorithm below\n    // (2) will continue to work, just drawing on a bigger page.\n    if (options.fitWidth) {\n        let width = colWidths.reduce(sum, 0);\n        if (width > pageWidth) {\n            scaleFactor = pageWidth / width;\n        }\n    }\n    pageWidth = Math.ceil(pageWidth / scaleFactor);\n    pageHeight = Math.ceil(pageHeight / scaleFactor);\n\n    // 2. calculate top, left, bottom, right, width and height for\n    //    printable cells.  Merged cells will be split across\n    //    pages, unless the first row/col is shifted to next page.\n    //    boxWidth and boxHeight get the complete drawing size.\n    //    Note that cell coordinates keep increasing, i.e. they\n    //    are not reset to zero for a new page.  The print\n    //    function translates the view to current page.\n    let hyCoords = []; // will receive header Y coordinates, if needed\n    let yCoords = distributeCoords(rowHeights, pageHeight || 0, options.maxEmpty,\n                                    options.headerRows, hyCoords);\n    let xCoords = distributeCoords(colWidths, pageWidth || 0, options.maxEmpty);\n    let boxWidth = 0;\n    let boxHeight = 0;\n    let headerCells = [];\n    cells = cells.filter(function(cell) {\n        if (cell.empty && (cell.row > maxRow || cell.col > maxCol)) {\n            return false;\n        }\n        if (options.headerRows && cell.row < options.headerRows) {\n            headerCells.push(cell);\n        }\n        cell.left = xCoords[cell.col];\n        cell.top = yCoords[cell.row];\n        if (cell.merged) {\n            if (!options.forScreen) {\n                cell.right = orlast(xCoords, cell.col + cell.colspan);\n                cell.bottom = orlast(yCoords, cell.row + cell.rowspan);\n                cell.width = cell.right - cell.left;\n                cell.height = cell.bottom - cell.top;\n            } else {\n                cell.right = cell.left + cell.width;\n                cell.bottom = cell.top + cell.height;\n            }\n        } else {\n            cell.width = colWidths[cell.col];\n            cell.height = rowHeights[cell.row];\n            cell.bottom = cell.top + cell.height;\n            cell.right = cell.left + cell.width;\n        }\n        if (!options.forScreen) {\n            // page breaking will shift cell coordinates.  adjust\n            // anchored drawings.\n            cell.drawings.forEach(function(d) {\n                let box = d.box;\n                box.left = cell.left + d.drawing.offsetX;\n                box.top = cell.top + d.drawing.offsetY;\n                box.right = box.left + box.width;\n                box.bottom = box.top + box.height;\n            });\n        }\n        boxWidth = Math.max(boxWidth, cell.right);\n        boxHeight = Math.max(boxHeight, cell.bottom);\n        return true;\n    });\n\n    // 3. if any merged cells remain in \"primary\", they start\n    //    outside the printed range and we should still display\n    //    them partially.\n    Object.keys(mergedCells.primary).forEach(function(id) {\n        let ref = mergedCells.primary[id];\n        sheet.forEach(ref.topLeft.toRangeRef(), function(row, col, cell) {\n            let relrow = row - range.topLeft.row;\n            let relcol = col - range.topLeft.col;\n            cell.merged = true;\n            cell.colspan = ref.width();\n            cell.rowspan = ref.height();\n            if (relrow < 0) {\n                cell.top = -sheet._rows.sum(row, row - relrow - 1);\n            } else {\n                cell.top = yCoords[relrow];\n            }\n            if (relcol < 0) {\n                cell.left = -sheet._columns.sum(col, col - relcol - 1);\n            } else {\n                cell.left = xCoords[relcol];\n            }\n            cell.height = sheet._rows.sum(ref.topLeft.row, ref.bottomRight.row);\n            cell.width = sheet._columns.sum(ref.topLeft.col, ref.bottomRight.col);\n            if (cell.height > 0 && cell.width > 0) {\n                // zero means a fully hidden merged cell (all rows/columns are hidden)\n                // https://github.com/telerik/kendo-ui-core/issues/1794\n                cell.right = cell.left + cell.width;\n                cell.bottom = cell.top + cell.height;\n                cell.row = relrow;\n                cell.col = relcol;\n                cells.push(cell);\n            }\n        });\n    });\n\n    // 4. replicate header rows on all pages\n    if (options.headerRows) {\n        hyCoords.forEach(function(y) {\n            headerCells.forEach(function(cell) {\n                cell = clone(cell);\n                cell.top += y;\n                cell.bottom = cell.top + cell.height;\n                cells.push(cell);\n            });\n            yCoords.push(y);\n        });\n        yCoords.sort(orderCoords);\n    }\n\n    return {\n        width    : boxWidth,\n        height   : boxHeight,\n        cells    : cells.sort(orderCells),\n        scale    : scaleFactor,\n        xCoords  : xCoords,\n        yCoords  : yCoords,\n        drawings : drawings\n    };\n}\n\nfunction clone(hash, target) {\n    if (!target) {\n        target = {};\n    }\n    if (Object.assign) {\n        return Object.assign(target, hash);\n    }\n    return Object.keys(hash).reduce(function(copy, key) {\n        copy[key] = hash[key];\n        return copy;\n    }, target);\n}\n\nfunction sameBorder(a, b) {\n    return a.size === b.size && a.color === b.color;\n}\n\nfunction sum(a, b) {\n    return a + b;\n}\n\nfunction orlast(a, i) {\n    return i < a.length ? a[i] : a[a.length - 1];\n}\n\nfunction shouldDrawCell(cell) {\n    return cell.value != null\n        || cell.merged\n        || cell.background != null\n        || cell.borderRight != null\n        || cell.borderBottom != null\n        || cell.dBorders != null\n        || (cell.validation != null && !cell.validation.value)\n        || (cell.drawings && cell.drawings.length);\n}\n\nfunction orderCells(a, b) {\n    if (a.top < b.top) {\n        return -1;\n    } else if (a.top == b.top) {\n        if (a.left < b.left) {\n            return -1;\n        } else if (a.left == b.left) {\n            return 0;\n        } else {\n            return 1;\n        }\n    } else {\n        return 1;\n    }\n}\n\nfunction orderCoords(a, b) {\n    return a < b ? -1 : a > b ? 1 : 0;\n}\n\nfunction drawLayout(sheet, layout, group, options) {\n    // options:\n    // - pageWidth\n    // - pageHeight\n    // - fitWidth\n    // - hCenter\n    // - vCenter\n    let ncols = Math.ceil(layout.width / options.pageWidth);\n    let nrows = Math.ceil(layout.height / options.pageHeight);\n    let pageWidth = Math.ceil(options.pageWidth / layout.scale);\n    let pageHeight = Math.ceil(options.pageHeight / layout.scale);\n\n    for (let j = 0; j < nrows; ++j) {\n        for (let i = 0; i < ncols; ++i) {\n            addPage(j, i);\n        }\n    }\n\n    function addPage(row, col) {\n        let left = col * pageWidth;\n        let right = left + pageWidth;\n        let top = row * pageHeight;\n        let bottom = top + pageHeight;\n        let endbottom = 0, endright = 0;\n\n        function isInside(box) {\n            if (box.right <= left || box.left >= right ||\n                box.bottom <= top || box.top >= bottom) {\n                return false;\n            }\n            endbottom = Math.max(box.bottom, endbottom);\n            endright = Math.max(box.right, endright);\n            return true;\n        }\n\n        // XXX: this can be optimized - discard cells that won't\n        // be used again, and don't walk cells that stand no\n        // chance to fit.\n        let cells = layout.cells.filter(isInside);\n\n        let drawings = layout.drawings.filter(function(d) {\n            return isInside(d.box);\n        });\n\n        // merged cells might stretch beyond page; limit to that\n        endbottom = Math.min(endbottom, bottom);\n        endright = Math.min(endright, right);\n\n        if (cells.length || drawings.length) {\n            let page = new Group();\n            group.append(page);\n            // page.clip(drawing.Path.fromRect(\n            //     new geometry.Rect([ 0, 0 ],\n            //                  [ options.pageWidth, options.pageHeight ])));\n\n            let content = new Group();\n            page.append(content);\n\n            content.clip(Path.fromRect(\n                new Rect([ left - 1, top - 1 ], [ endright + 1, endbottom + 1 ])\n            ));\n\n            let matrix = Matrix$1.scale(layout.scale, layout.scale)\n                .multiplyCopy(Matrix$1.translate(-left, -top));\n\n            if (options.hCenter || options.vCenter) {\n                matrix = matrix.multiplyCopy(\n                    Matrix$1.translate(\n                        options.hCenter ? (right - endright) / 2 : 0,\n                        options.vCenter ? (bottom - endbottom) / 2 : 0)\n                );\n            }\n\n            content.transform(matrix);\n\n            if (options.guidelines) {\n                let prev = null;\n                layout.xCoords.forEach(function(x) {\n                    x = Math.min(x, endright);\n                    if (x !== prev && x >= left && x <= right) {\n                        prev = x;\n                        content.append(\n                            new Path()\n                                .moveTo(x, top)\n                                .lineTo(x, endbottom)\n                                .close()\n                                .stroke(options.guideColor, GUIDELINE_WIDTH)\n                        );\n                    }\n                });\n                prev = null;\n                layout.yCoords.forEach(function(y) {\n                    y = Math.min(y, endbottom);\n                    if (y !== prev && y >= top && y <= bottom) {\n                        prev = y;\n                        content.append(\n                            new Path()\n                                .moveTo(left, y)\n                                .lineTo(endright, y)\n                                .close()\n                                .stroke(options.guideColor, GUIDELINE_WIDTH)\n                        );\n                    }\n                });\n            }\n\n            let borders = Borders();\n            cells.forEach(function(cell) {\n                drawCell$1(cell, content, options);\n                borders.add(cell, sheet);\n            });\n\n            let bordersGroup = new Group();\n            borders.vert.forEach(function(a) {\n                a.forEach(function(b) {\n                    if (!b.rendered) {\n                        b.rendered = true;\n                        bordersGroup.append(\n                            new Path()\n                                .moveTo(b.x, b.top)\n                                .lineTo(b.x, b.bottom)\n                                .close()\n                                .stroke(b.color, b.size)\n                        );\n                    }\n                });\n            });\n            borders.horiz.forEach(function(a) {\n                a.forEach(function(b) {\n                    if (!b.rendered) {\n                        b.rendered = true;\n                        bordersGroup.append(\n                            new Path()\n                                .moveTo(b.left, b.y)\n                                .lineTo(b.right, b.y)\n                                .close()\n                                .stroke(b.color, b.size)\n                        );\n                    }\n                });\n            });\n            content.append(bordersGroup);\n\n            drawings.forEach(function(d) {\n                let drawing = d.drawing;\n                let image = drawing.image;\n                if (image != null) {\n                    let box = d.box;\n                    let url = sheet._workbook.imageUrl(image);\n                    content.append(\n                        new drawing.Image(url, new Rect(\n                            [ box.left, box.top ],\n                            [ box.width, box.height ]\n                        )).opacity(drawing.opacity)\n                    );\n                }\n            });\n        }\n    }\n}\n\nfunction drawCell$1(cell, content, options) {\n    let g = new Group();\n    content.append(g);\n    let rect = new Rect([ cell.left, cell.top ],\n                            [ cell.width, cell.height ]);\n    if (cell.background || cell.merged) {\n        let r2d2 = rect;\n        if (options.guidelines) {\n            r2d2 = rect.clone();\n            r2d2.origin.x += GUIDELINE_WIDTH / 2 + 0.1;\n            r2d2.origin.y += GUIDELINE_WIDTH / 2 + 0.1;\n            r2d2.size.width -= GUIDELINE_WIDTH + 0.2;\n            r2d2.size.height -= GUIDELINE_WIDTH + 0.2;\n        }\n        g.append(\n            new Rect$1(r2d2)\n                .fill(cell.background || \"#fff\")\n                .stroke(null)\n        );\n    }\n    if (cell.dBorders) {\n        if (cell.dBorders.type & 2) {\n            g.append(\n                new Path()\n                    .moveTo(cell.left, cell.bottom)\n                    .lineTo(cell.right, cell.top)\n                    .stroke(cell.dBorders.color, cell.dBorders.size)\n            );\n        }\n        if (cell.dBorders.type & 1) {\n            g.append(\n                new Path()\n                    .moveTo(cell.left, cell.top)\n                    .lineTo(cell.right, cell.bottom)\n                    .stroke(cell.dBorders.color, cell.dBorders.size)\n            );\n        }\n    }\n    let val = cell.value;\n    if (val != null) {\n        let type = typeof val == \"number\" ? \"number\" : null;\n        let clip = new Group();\n        clip.clip(Path.fromRect(rect));\n        g.append(clip);\n        let f, format = cell.format;\n        if (!format && type == \"number\" && val != Math.floor(val)) {\n            format = \"0.##############\";\n        }\n        if (format) {\n            f = formatting.textAndColor(val, format);\n            val = f.text;\n            if (f.type) {\n                type = f.type;\n            }\n        } else {\n            val += \"\";\n        }\n        if (!cell.textAlign) {\n            switch (type) {\n            case \"number\":\n            case \"date\":\n            case \"percent\":\n            case \"currency\":\n                cell.textAlign = \"right\";\n                break;\n            case \"boolean\":\n                cell.textAlign = \"center\";\n                break;\n            }\n        }\n        drawText(val, (f && f.color) || cell.color || \"#000\", cell, clip);\n    }\n}\n\nfunction applyIndent(cell, style) {\n    if (cell.indent) {\n        // OOXML spec states the indent is \"An integer value,\n        // where an increment of 1 represents 3 spaces\".  This, of\n        // course, bears no resemblance to what Excel actually\n        // does, so we need magic numbers here.\n        let indent = 1.4 * cell.indent;\n        switch (style.textAlign) {\n        case null:\n        case \"left\":\n            style.paddingLeft = indent + \"ch\";\n            break;\n        case \"right\":\n            style.paddingRight = indent + \"ch\";\n            break;\n        case \"center\":\n            style.paddingLeft = indent / 2 + \"ch\";\n            style.paddingRight = indent / 2 + \"ch\";\n            break;\n        }\n    }\n}\n\nlet CONT;\nfunction drawText(text, color, cell, group) {\n    if (!CONT) {\n        CONT = document.createElement(\"div\");\n        CONT.style.position = \"fixed\";\n        CONT.style.left = \"0px\";\n        CONT.style.top = \"0px\";\n        CONT.style.visibility = \"hidden\";\n        CONT.style.overflow = \"hidden\";\n        CONT.style.boxSizing = \"border-box\";\n        CONT.style.lineHeight = \"normal\";\n        document.body.appendChild(CONT);\n    }\n\n    if (CONT.firstChild) {\n        CONT.removeChild(CONT.firstChild);\n    }\n\n    CONT.style.padding = \"2px 4px\";\n    CONT.style.color = color;\n    CONT.style.font = makeFontDef(cell);\n    CONT.style.width = cell.width + \"px\";\n    CONT.style.textAlign = cell.textAlign || \"left\";\n    CONT.style.textDecoration = cell.underline ? \"underline\" : \"none\";\n\n    applyIndent(cell, CONT.style);\n\n    if (cell.wrap) {\n        CONT.style.whiteSpace = \"pre-wrap\";\n        CONT.style.overflowWrap = CONT.style.wordWrap = \"break-word\";\n    } else {\n        CONT.style.whiteSpace = \"pre\";\n        CONT.style.overflowWrap = CONT.style.wordWrap = \"normal\";\n    }\n\n    CONT.appendChild(document.createTextNode(text));\n\n    let vtrans = 0;\n    switch (cell.verticalAlign) {\n    case \"center\":\n        vtrans = (cell.height - CONT.offsetHeight) >> 1;\n        break;\n\n    case undefined:\n    case null:\n    case \"bottom\":\n        vtrans = (cell.height - CONT.offsetHeight);\n        break;\n    }\n    if (vtrans < 0) { vtrans = 0; }\n\n    let textGroup = drawText$1(CONT);\n    textGroup.transform(Matrix$1.translate(cell.left, cell.top + vtrans));\n    group.append(textGroup);\n}\n\nfunction makeFontDef(cell) {\n    let font = [];\n    if (cell.italic) {\n        font.push(\"italic\");\n    }\n    if (cell.bold) {\n        font.push(\"bold\");\n    }\n    font.push((cell.fontSize || 12) + \"px\");\n    font.push((cell.fontFamily || \"Arial\"));\n    return font.join(\" \");\n}\n\nfunction drawFn(sheet, range, options, callback) {\n    if (options == null && callback == null) {\n        callback = range;\n        options = {};\n        range = SHEETREF;\n    }\n    if (callback == null) {\n        callback = options;\n        if (range instanceof Range\n            || range instanceof Ref\n            || typeof range == \"string\") {\n            options = {};\n        } else {\n            options = range;\n            range = SHEETREF;\n        }\n    }\n    options = Object.assign({ }, {\n        paperSize  : \"A4\",\n        landscape  : true,\n        margin     : \"1cm\",\n        guidelines : true,\n        guideColor : \"#aaa\",\n        emptyCells : true,\n        fitWidth   : false,\n        center     : false,\n        headerRows : null,\n        maxEmpty   : 0.2,\n        scale      : 1\n    }, options);\n    let group = new Group();\n    let paper = getPaperOptions(options);\n    group.options.set(\"pdf\", {\n        author    : options.author,\n        creator   : options.creator,\n        date      : options.date,\n        keywords  : options.keywords,\n        margin    : paper.margin,\n        multiPage : true,\n        paperSize : paper.paperSize,\n        subject   : options.subject,\n        title     : options.title,\n        autoPrint : options.autoPrint\n    });\n    let pageWidth = paper.paperSize[0];\n    let pageHeight = paper.paperSize[1];\n    if (paper.margin) {\n        pageWidth -= paper.margin.left + paper.margin.right + 1;\n        pageHeight -= paper.margin.top + paper.margin.bottom + 1;\n    }\n    options.pageWidth = pageWidth;\n    options.pageHeight = pageHeight;\n    let layout = doLayout(sheet, sheet._ref(range), options);\n    drawLayout(sheet, layout, group, options);\n    callback(group);\n}\n\nSheet.prototype.draw = function(range, options, callback) {\n    let sheet = this;\n    if (sheet._workbook) {\n        sheet.recalc(sheet._workbook._context, function() {\n            drawFn(sheet, range, options, callback);\n        });\n    } else {\n        drawFn(sheet, range, options, callback);\n    }\n};\n\n// Hack: since we index the border arrays by relative row/col we\n// could end up with negative indexes, i.e. horiz[-2] = border.\n// Array forEach will ignore these, so we provide a simple\n// container here (outside code only needs forEach at this time).\nfunction Container() {}\nContainer.prototype = {\n    forEach: function(f) {\n        Object.keys(this).forEach(function(key) {\n            f(this[key], key, this);\n        }, this);\n    }\n};\n\nfunction Borders() {\n    let horiz = new Container();\n    let vert = new Container();\n    function add(cell, sheet) {\n        if (sheet) {\n            // reset borders here; the propertybag doesn't keep track of merged cells :-/ this\n            // is ugly, but the inner details of data storage have leaked everywhere anyway.\n            let pb = sheet._properties;\n            let grid = sheet._grid;\n            cell.borderLeft = pb.get(\"vBorders\", grid.index(cell.row, cell.col));\n            cell.borderRight = pb.get(\"vBorders\", grid.index(cell.row, cell.col + cell.colspan));\n            cell.borderTop = pb.get(\"hBorders\", grid.index(cell.row, cell.col));\n            cell.borderBottom = pb.get(\"hBorders\", grid.index(cell.row + cell.rowspan, cell.col));\n        }\n        if (cell.borderLeft) {\n            addVert(cell.row, cell.col, cell.borderLeft,\n                    cell.left, cell.top, cell.bottom);\n        }\n        if (cell.borderRight) {\n            addVert(cell.row, cell.col + cell.colspan, cell.borderRight,\n                    cell.right, cell.top, cell.bottom);\n        }\n        if (cell.borderTop) {\n            addHoriz(cell.row, cell.col, cell.borderTop,\n                        cell.top, cell.left, cell.right);\n        }\n        if (cell.borderBottom) {\n            addHoriz(cell.row + cell.rowspan, cell.col, cell.borderBottom,\n                        cell.bottom, cell.left, cell.right);\n        }\n    }\n    function addVert(row, col, border, x, top, bottom) {\n        let a = vert[col] || (vert[col] = new Container());\n        let prev = row > 0 && a[row - 1];\n        if (prev && sameBorder(prev, border)) {\n            a[row] = prev;\n            prev.bottom = bottom;\n        } else {\n            a[row] = {\n                size: border.size,\n                color: border.color || \"#000\",\n                x: x,\n                top: top,\n                bottom: bottom\n            };\n        }\n    }\n    function addHoriz(row, col, border, y, left, right) {\n        let a = horiz[row] || (horiz[row] = new Container());\n        let prev = col > 0 && a[col - 1];\n        if (prev && sameBorder(prev, border)) {\n            a[col] = prev;\n            prev.right = right;\n        } else {\n            a[col] = {\n                size: border.size,\n                color: border.color || \"#000\",\n                y: y,\n                left: left,\n                right: right\n            };\n        }\n    }\n    return { add: add, horiz: horiz, vert: vert };\n}\n\n// export function drawTabularData(options) {\n    // let progress = new $.Deferred();\n    // let promise = progress.promise();\n\n    // options = clone(options, {\n    //     dataSource       : null,\n    //     guidelines       : true,\n    //     guideColor       : \"#000\",\n    //     columns          : null,\n    //     headerBackground : \"#999\",\n    //     headerColor      : \"#000\",\n    //     oddBackground    : null,\n    //     evenBackground   : null,\n    //     fontFamily       : \"Arial\",\n    //     fontSize         : 12,\n    //     paperSize        : \"A4\",\n    //     margin           : \"1cm\",\n    //     landscape        : true,\n    //     fitWidth         : false,\n    //     scale            : 1,\n    //     rowHeight        : 20,\n    //     maxEmpty         : 1,\n    //     useGridFormat    : true\n    // });\n\n    // // retrieve fonts; custom fonts should be already loaded\n    // pdf.defineFont(\n    //     getFontFaces(document)\n    // );\n\n    // let charWidth = charWidthFunction(options.fontFamily, options.fontSize);\n\n    // function textWidth(value) {\n    //     if (value != null) {\n    //         let width = 12;         // magic numbers :-/\n    //         for (let i = value.length; --i >= 0;) {\n    //             width += charWidth(value.charAt(i));\n    //         }\n    //         return width;\n    //     }\n    //     return 0;\n    // }\n\n    // let border = options.guidelines ? { size: 1, color: options.guideColor } : null;\n\n    // function mkCell(data) {\n    //     if (!border) {\n    //         return data;\n    //     }\n    //     return clone(data, {\n    //         borderLeft: border,\n    //         borderTop: border,\n    //         borderRight: border,\n    //         borderBottom: border\n    //     });\n    // }\n\n    // options.dataSource.fetch(function() {\n    //     let data = options.dataSource.data();\n    //     if (!data.length) {\n    //         return progress.reject(\"Empty dataset\");\n    //     }\n\n    //     // this really must be present\n    //     let columns = options.columns.map(function(col) {\n    //         if (typeof col == \"string\") {\n    //             return { title: col, field: col };\n    //         } else {\n    //             return col;\n    //         }\n    //     });\n    //     let columnTitles = columns.map(function(col) {\n    //         return col.title || col.field;\n    //     });\n    //     let columnWidths = columnTitles.map(textWidth);\n\n    //     // prepare data for a Sheet object's fromJSON method\n    //     let rows = data.map(function(row, rowIndex) {\n    //         return {\n    //             cells: columns.map(function(col, colIndex) {\n    //                 let value = row[col.field];\n\n    //                 // NOTE: value might not be string.  I added option useGridFormat (default\n    //                 // true), which will use a column's format, if present, to convert the value\n    //                 // to a string, so that we can measure the width right now.\n    //                 if (options.useGridFormat) {\n    //                     if (value != null) {\n    //                         if (col.format) {\n    //                             value = intl().format(col.format, value);\n    //                         } else {\n    //                             value += \"\";\n    //                         }\n    //                     }\n    //                     // adjust the column widths while we're at it\n    //                     columnWidths[colIndex] = Math.max(\n    //                         textWidth(value),\n    //                         columnWidths[colIndex]\n    //                     );\n    //                 }\n\n    //                 // if options.useGridFormat is false and col.format is present, pass it over\n    //                 // to the spreadsheet.  In that case we should calculate the widths after\n    //                 // the spreadsheet is created (XXX to be implemented when someone needs it).\n    //                 return mkCell({\n    //                     value: value,\n    //                     format: options.useGridFormat ? null : col.format,\n    //                     background: rowIndex % 2 ? options.evenBackground : options.oddBackground\n    //                 });\n    //             })\n    //         };\n    //     });\n\n    //     // insert header line\n    //     rows.unshift({\n    //         cells: columnTitles.map(function(label) {\n    //             return mkCell({\n    //                 value: label,\n    //                 background: options.headerBackground,\n    //                 color: options.headerColor\n    //             });\n    //         })\n    //     });\n\n    //     // init a Sheet object.  Note that we have to add one\n    //     // extra-row and column, because the very last ones can't\n    //     // have right/bottom borders (known limitation).\n    //     let sheet = new Sheet(\n    //         rows.length + 1,        // rows\n    //         columns.length + 1,     // columns\n    //         options.rowHeight,      // row height\n    //         50,                     // column width\n    //         20,                     // header height\n    //         20,                     // header width,\n    //         {                       // default cell style\n    //             fontFamily: options.fontFamily,\n    //             fontSize: options.fontSize,\n    //             verticalAlign: \"center\"\n    //         }\n    //     );\n\n    //     // load data\n    //     sheet.fromJSON({\n    //         name: \"Sheet1\",\n    //         rows: rows,\n    //         columns: columnWidths.map(function(w, i) {\n    //             return { index: i, width: w };\n    //         })\n    //     });\n\n    //     sheet.draw({\n    //         paperSize  : options.paperSize,\n    //         landscape  : options.landscape,\n    //         margin     : options.margin,\n    //         guidelines : false, // using borders instead (better contrast)\n    //         scale      : options.scale,\n    //         fitWidth   : options.fitWidth,\n    //         maxEmpty   : options.maxEmpty,\n    //         headerRows : 1\n    //     }, progress.resolve.bind(progress));\n    // });\n\n    // return promise;\n// }\n\n// let CACHE_CHAR_WIDTH = {};\n\n// let charWidthFunction = function(fontFamily, fontSize) {\n//     let id = fontSize + \":\" + fontFamily;\n//     let func = CACHE_CHAR_WIDTH[id];\n//     if (!func) {\n//         let span, div = document.createElement(\"div\");\n//         div.style.position = \"fixed\";\n//         div.style.left = \"-10000px\";\n//         div.style.top = \"-10000px\";\n//         div.style.fontFamily = fontFamily;\n//         div.style.fontSize = fontSize + \"px\";\n//         div.style.whiteSpace = \"pre\";\n//         for (let i = 32; i < 128; ++i) {\n//             span = document.createElement(\"span\");\n//             span.appendChild(document.createTextNode(String.fromCharCode(i)));\n//             div.appendChild(span);\n//         }\n//         document.body.appendChild(div);\n//         let widths = {};\n//         for (let i = 32, span = div.firstChild; i < 128 && span; ++i, span = span.nextSibling) {\n//             widths[i] = span.offsetWidth;\n//         }\n//         while ((span = div.firstChild)) {\n//             div.removeChild(span);\n//         }\n//         func = CACHE_CHAR_WIDTH[id] = function(ch) {\n//             let code = ch.charCodeAt(0);\n//             let width = widths[code];\n//             if (width == null) {\n//                 // probably not an ASCII character, let's cache its width as well\n//                 span = document.createElement(\"span\");\n//                 span.appendChild(document.createTextNode(String.fromCharCode(code)));\n//                 div.appendChild(span);\n//                 width = widths[code] = span.offsetWidth;\n//                 div.removeChild(span);\n//             }\n//             return width;\n//         };\n//     }\n//     return func;\n// };\n\n// spreadsheet.draw = {\n//     Borders         : Borders,\n//     doLayout        : doLayout,\n//     applyIndent     : applyIndent\n// };\n\nconst draw = { Borders, doLayout, applyIndent };\n\n// spreadsheet.drawTabularData = drawTabularData;\n\nconst RESIZE_HANDLE_WIDTH = 7;\nconst EDIT_BUTTON_WIDTH = 20;\nconst DOT = \".\";\n\nconst viewClassNames = {\n    view: \"k-spreadsheet-view\",\n    fixedContainer: \"k-spreadsheet-fixed-container\",\n    editContainer: \"k-spreadsheet-edit-container\",\n    scroller: \"k-spreadsheet-scroller\",\n    viewSize: \"k-spreadsheet-view-size\",\n    clipboard: \"k-spreadsheet-clipboard\",\n    cellEditor: \"k-spreadsheet-cell-editor\",\n    barEditor: \"k-spreadsheet-editor\",\n    topCorner: \"k-spreadsheet-top-corner\",\n    filterHeadersWrapper: \"k-filter-wrapper\",\n    filterRange: \"k-filter-range\",\n    filterButton: \"k-spreadsheet-filter\",\n    filterButtonSelected: \"k-selected\",\n    horizontalResize: \"k-horizontal-resize\",\n    verticalResize: \"k-vertical-resize\",\n    icon: \"k-icon\",\n    iconFilterDefault: \"k-i-caret-alt-down\",\n    sheetsBar: \"k-spreadsheet-sheets-bar\",\n    sheetsBarActive: \"k-spreadsheet-sheets-bar-active\",\n    sheetsBarInactive: \"k-spreadsheet-sheets-bar-inactive\",\n    cellContextMenu: \"k-spreadsheet-cell-context-menu\",\n    rowHeaderContextMenu: \"k-spreadsheet-row-header-context-menu\",\n    colHeaderContextMenu: \"k-spreadsheet-col-header-context-menu\",\n    drawingContextMenu: \"k-spreadsheet-drawing-context-menu\"\n};\n\nconst paneClassNames = {\n    cell: \"k-spreadsheet-cell\",\n    vaxis: \"k-spreadsheet-vaxis\",\n    haxis: \"k-spreadsheet-haxis\",\n    vborder: \"k-spreadsheet-vborder\",\n    hborder: \"k-spreadsheet-hborder\",\n    rowHeader: \"k-spreadsheet-row-header\",\n    columnHeader: \"k-spreadsheet-column-header\",\n    pane: \"k-spreadsheet-pane\",\n    data: \"k-spreadsheet-data\",\n    mergedCell: \"k-spreadsheet-merged-cell\",\n    mergedCellsWrapper: \"k-merged-cells-wrapper\",\n    activeCell: \"k-spreadsheet-active-cell\",\n    selection: \"k-spreadsheet-selection\",\n    selectionWrapper: \"k-selection-wrapper\",\n    autoFillWrapper: \"k-auto-fill-wrapper\",\n    single: \"k-single\",\n    top: \"k-top\",\n    right: \"k-right\",\n    bottom: \"k-bottom\",\n    left: \"k-left\",\n    resizeHandle: \"k-resize-handle\",\n    columnResizeHandle: \"k-column-resize-handle\",\n    rowResizeHandle: \"k-row-resize-handle\",\n    resizeHint: \"k-resize-hint\",\n    resizeHintHandle: \"k-resize-hint-handle\",\n    resizeHintMarker: \"k-resize-hint-marker\",\n    resizeHintVertical: \"k-resize-hint-vertical\",\n    selectionHighlight: \"k-spreadsheet-selection-highlight\",\n    series: [\n        \"k-series-a\",\n        \"k-series-b\",\n        \"k-series-c\",\n        \"k-series-d\",\n        \"k-series-e\",\n        \"k-series-f\"\n    ]\n};\n\n/* eslint-disable complexity */\n\n\nfunction cellBorder(value) {\n    return (value.size || 1) + \"px solid \" + (value.color || \"#000\");\n}\n\nfunction asURL(link) {\n    if (!/:\\/\\//.test(link)) {\n        link = \"http://\" + link;\n    }\n    return link;\n}\n\nfunction drawCell(collection, cell, cls, showGrid) {\n    function maybeLink(el) {\n        let link = cell.link;\n        if (!link) {\n            if (typeof cell.value == \"object\") {\n                link = cell.value.link;\n            }\n        }\n        if (link) {\n            let style = {\n                textDecoration: \"none\"\n            };\n            if (cell.color) {\n                style.color = cell.color;\n            }\n            if (cell.underline) {\n                style.textDecoration = \"underline\";\n            }\n            return dom.element(\"a\", {\n                href   : asURL(link),\n                style  : style,\n                target : \"_blank\" // XXX: customizable?\n            }, el ? [ el ] : []);\n        }\n        return el;\n    }\n\n    let shouldDraw = (cell.value != null || (cell.validation != null && !cell.validation.value) || // jshint ignore:line\n                        cell.background || cell.merged || cell.comment || cell.dBorders);\n    if (!cls && !shouldDraw) {\n        return;\n    }\n\n    let style = { background: [] };\n    let background = cell.background;\n    if (background) {\n        let defaultBorder = background;\n        if (showGrid) {\n            // darken\n            defaultBorder = parseColor(defaultBorder).toHSV();\n            defaultBorder.v *= 0.9;\n            defaultBorder = defaultBorder.toCssRgba();\n        }\n        defaultBorder = cellBorder({ color: defaultBorder });\n        style.outline = defaultBorder;\n    }\n\n    if (cell.dBorders) {\n        if (cell.dBorders.type & 2) {\n            style.background.push(\"linear-gradient(to top left, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0) calc(50% - \" +\n                                    cell.dBorders.size + \"px), \" + cell.dBorders.color + \" 50%, rgba(0, 0, 0, 0) calc(50% + \" +\n                                    cell.dBorders.size + \"px), rgba(0, 0, 0, 0) 100%)\");\n        }\n        if (cell.dBorders.type & 1) {\n            style.background.push(\"linear-gradient(to top right, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0) calc(50% - \" +\n                                    cell.dBorders.size + \"px), \" + cell.dBorders.color + \" 50%, rgba(0, 0, 0, 0) calc(50% + \" +\n                                    cell.dBorders.size + \"px), rgba(0, 0, 0, 0) 100%)\");\n        }\n    }\n\n    if (background) {\n        style.background.push(background);\n    }\n\n    if (cell.color) {\n        style.color = cell.color;\n    }\n\n    if (cell.fontFamily) {\n        style.fontFamily = cell.fontFamily;\n    }\n\n    if (cell.underline) {\n        style.textDecoration = \"underline\";\n    }\n\n    if (cell.italic) {\n        style.fontStyle = \"italic\";\n    }\n\n    if (cell.textAlign) {\n        style.textAlign = cell.textAlign;\n    }\n\n    if (cell.bold) {\n        style.fontWeight = \"bold\";\n    }\n\n    if (cell.fontSize) {\n        style.fontSize = cell.fontSize + \"px\";\n    }\n\n    if (cell.wrap === true) {\n        style.whiteSpace = \"pre-wrap\";\n        style.overflowWrap = \"break-word\";\n        style.wordWrap = \"break-word\";\n    } else {\n        style.whiteSpace = \"pre\";\n        style.overflowWrap = \"normal\";\n        style.wordWrap = \"normal\";\n    }\n\n    style.left = (cell.left + 1) + \"px\";\n    style.top = (cell.top + 1) + \"px\";\n    style.width = (cell.width - 1) + \"px\";\n    style.height = (cell.height - 1) + \"px\";\n\n    let data = cell.value, type = typeof data, format = cell.format;\n    if (!format && type === \"number\" && data !== Math.floor(data)) {\n        format = \"0.##############\";\n    }\n    if (format && data != null) {\n        data = formatting.format(data, format);\n        if (data.__dataType) {\n            type = data.__dataType;\n        }\n    } else if (data != null) {\n        if (cell.html) {\n            data = dom.html(data);\n        } else {\n            data = dom.text(data);\n        }\n    }\n\n    if (!style.textAlign) {\n        switch (type) {\n        case \"number\":\n        case \"date\":\n        case \"percent\":\n        case \"currency\":\n            style.textAlign = \"right\";\n            break;\n        case \"boolean\":\n            style.textAlign = \"center\";\n            break;\n        }\n    }\n\n    // defined in print.js\n    draw.applyIndent(cell, style);\n\n    let classNames = [ paneClassNames.cell ];\n\n    if (cls) {\n        classNames.push(cls);\n    }\n    if (cell.enable === false) {\n        classNames.push(\"k-disabled\");\n    }\n    if (cell.merged) {\n        classNames.push(\"k-spreadsheet-merged-cell\");\n        if (!cell.enable) {\n            collection.push(dom.element(\"div\", {\n                className: \"k-spreadsheet-disabled-mask\",\n                style: {\n                    left: (cell.left + 1) + \"px\",\n                    top: (cell.top + 1) + \"px\",\n                    width: (cell.width - 1) + \"px\",\n                    height: (cell.height - 1) + \"px\"\n                }\n            }));\n        }\n    }\n    if (cell.comment) {\n        classNames.push(\"k-spreadsheet-has-comment\");\n    }\n\n    let verticalAlign = cell.verticalAlign || \"bottom\";\n\n    if (verticalAlign && data) {\n        data = dom.element(\"div\", { className: \"k-vertical-align-\" + verticalAlign }, [ maybeLink(data) ]);\n    } else {\n        data = maybeLink(data);\n    }\n\n    if (style.background.length) {\n        style.background = style.background.join(\",\");\n    } else {\n        delete style.background;\n    }\n\n    let children = data ? [ data ] : [];\n    let properties = {\n        style: style\n    };\n    let validation = cell.validation;\n    if (validation && !validation.value) {\n        children.push(dom.element(\"span\", { className: \"k-dirty\" }));\n        classNames.push(\"k-dirty-cell\");\n\n        properties.title = validation.message;\n    }\n    properties.className = classNames.join(\" \");\n\n    let div = dom.element(\"div\", properties, children);\n    collection.push(div);\n    return div;\n}\n\nclass Pane {\n    constructor(sheet, grid, getIconHTMLString) {\n        this._sheet = sheet;\n        this._grid = grid;\n        this.getIconHTMLString = getIconHTMLString;\n    }\n\n    refresh(width, height) {\n        this._grid.refresh(width, height);\n    }\n\n    isVisible(scrollLeft, scrollTop, ref) {\n        return this._grid.view(scrollLeft, scrollTop).ref.intersects(ref);\n    }\n\n    render(args) {\n        let scroller = args.scroller;\n        let scrollLeft = scroller.scrollLeft;\n        let scrollTop = scroller.scrollTop;\n\n        if (scrollTop < 0) {\n            scrollTop = 0;\n        }\n\n        if (scrollLeft < 0) {\n            scrollLeft = 0;\n        }\n\n        let classNames = Pane.classNames;\n        let sheet = this._sheet;\n        let grid = this._grid;\n        let view = grid.view(scrollLeft, scrollTop);\n        this._currentView = view;\n        this._currentRect = this._rectangle(view.ref);\n        this._selectedHeaders = sheet.selectedHeaders();\n\n        let children = [];\n\n        children.push(this.renderData(args));\n\n        if (!sheet._activeDrawing) {\n            children.push(this.renderSelection(scroller));\n        }\n\n        children.push(this.renderAutoFill());\n\n        children.push(this.renderEditorSelection());\n\n        children.push(this.renderFilterHeaders());\n\n        if (grid.hasRowHeader) {\n            let rowHeader = dom.element(\"div\", {\n                className: classNames.rowHeader,\n                style: {\n                    width: grid.headerWidth + \"px\",\n                    top: view.rowOffset + \"px\"\n                }\n            });\n            children.push(rowHeader);\n            sheet.forEach(view.ref.leftColumn(), function(row) {\n                if (!sheet.isHiddenRow(row)) {\n                    let text = row + 1, height = sheet.rowHeight(row);\n                    rowHeader.children.push(dom.element(\"div\", {\n                        className: this.headerClassName(row, \"row\"),\n                        style: {\n                            width: grid.headerWidth + \"px\",\n                            height: height + \"px\"\n                        }\n                    }, [ dom.element(\"div\", {\n                        className: \"k-vertical-align-center\"\n                    }, [ dom.text(text + \"\") ])]));\n                }\n            }.bind(this));\n        }\n\n        if (grid.hasColumnHeader) {\n            let columnHeader = dom.element(\"div\", {\n                className: classNames.columnHeader,\n                style: {\n                    top: \"0px\",\n                    left: view.columnOffset + \"px\",\n                    width: this._currentRect.width + \"px\",\n                    height: grid.headerHeight + \"px\"\n                }\n            });\n            children.push(columnHeader);\n            let left = 0;\n            sheet.forEach(view.ref.topRow(), function(row, col) {\n                if (!sheet.isHiddenColumn(col)) {\n                    let text = Ref.display(null, Infinity, col),\n                        width = sheet.columnWidth(col);\n                    columnHeader.children.push(dom.element(\"div\", {\n                        className: this.headerClassName(col, \"col\"),\n                        style: {\n                            position: \"absolute\",\n                            left: left + \"px\",\n                            width: width + \"px\",\n                            height: grid.headerHeight + \"px\"\n                        }\n                    }, [ dom.element(\"div\", {\n                        className: \"k-vertical-align-center\"\n                    }, [ dom.text(text + \"\") ])]));\n                    left += width;\n                }\n            }.bind(this));\n        }\n\n        if (sheet.resizeHandlePosition() && (grid.hasColumnHeader || grid.hasRowHeader)) {\n            if (!sheet.resizeHintPosition()) {\n                this.renderResizeHandle(children);\n            }\n        }\n\n        let paneClasses = [classNames.pane];\n\n        if (grid.hasColumnHeader) {\n            paneClasses.push(classNames.top);\n        }\n\n        if (grid.hasRowHeader) {\n            paneClasses.push(classNames.left);\n        }\n\n        return dom.element(\"div\", {\n            style: grid.style,\n            className: paneClasses.join(\" \")\n        }, children);\n    }\n\n    headerClassName(index, type) {\n        let selectedHeaders = this._selectedHeaders;\n\n        let itemSelection;\n        let allHeaders;\n\n        if (type === \"row\") {\n            itemSelection = selectedHeaders.rows[index];\n            allHeaders = selectedHeaders.allRows;\n        } else {\n            itemSelection = selectedHeaders.cols[index];\n            allHeaders = selectedHeaders.allCols;\n        }\n\n        let className = itemSelection || (selectedHeaders.all ? \"full\" : (allHeaders ? \"partial\" : \"none\"));\n\n        if (className) {\n            className = \"k-selection-\" + className;\n        }\n\n        return className;\n    }\n\n    renderData(args) {\n        let sheet = this._sheet;\n        let view = this._currentView;\n        let cont = dom.element(\"div\", {\n            className: Pane.classNames.data,\n            style: {\n                position: \"relative\",\n                left: view.columnOffset + \"px\",\n                top: view.rowOffset + \"px\"\n            }\n        });\n        let rect = this._currentRect;\n        let layout = draw.doLayout(sheet, view.ref, { forScreen: true }), prev;\n        let grid = this._grid;\n        let showGridLines = sheet._showGridLines;\n        if (showGridLines) {\n            // draw axis first\n            prev = null;\n            layout.xCoords.forEach(function(x) {\n                if (x !== prev) {\n                    prev = x;\n                    cont.children.push(dom.element(\"div\", {\n                        className: paneClassNames.vaxis,\n                        style: {\n                            left: x + \"px\",\n                            height: rect.height + \"px\",\n                            borderColor: sheet.gridLinesColor()\n                        }\n                    }));\n                }\n            });\n            prev = null;\n            layout.yCoords.forEach(function(y) {\n                if (y !== prev) {\n                    prev = y;\n                    cont.children.push(dom.element(\"div\", {\n                        className: paneClassNames.haxis,\n                        style: {\n                            top: y + \"px\",\n                            width: rect.width + \"px\",\n                            borderColor: sheet.gridLinesColor()\n                        }\n                    }));\n                }\n            });\n        }\n        let borders = draw.Borders();\n        let activeCellRange = sheet.activeCell().toRangeRef();\n        let activeCell = activeCellRange.topLeft;\n\n        layout.cells.forEach(function(cell) {\n            let cls = null;\n            let absRow = cell.row + view.ref.topLeft.row;\n            let absCol = cell.col + view.ref.topLeft.col;\n            if (sheet._activeDrawing) {\n                let ref = sheet._activeDrawing.topLeftCell;\n                if (ref && ref.row === absRow && ref.col === absCol) {\n                    cls = \"k-spreadsheet-drawing-anchor-cell\";\n                }\n            } else if (absRow === activeCell.row && absCol === activeCell.col) {\n                // active cell.  normally we enter here only once.\n                cls = [\n                    Pane.classNames.activeCell\n                ].concat(this._activeFormulaColor(),\n                            this._directionClasses(activeCellRange));\n                if (sheet.singleCellSelection()) {\n                    cls.push(Pane.classNames.single);\n                }\n                cls = cls.join(\" \");\n            }\n            borders.add(cell);\n            drawCell(cont.children, cell, cls, showGridLines);\n            if (cell.comment && sheet._commentRef &&\n                absRow === sheet._commentRef.row && absCol === sheet._commentRef.col) {\n                let ttOffset = 4;\n                let left = cell.right + grid.left + view.columnOffset + ttOffset;\n                let style = { top: (cell.top + grid.top + view.rowOffset) + \"px\" };\n                if (left + 200 > args.contentWidth) {\n                    style.right = (args.contentWidth - grid.left - cell.left - view.columnOffset + ttOffset) + \"px\";\n                } else {\n                    style.left = left + \"px\";\n                }\n                let div = dom.element(\"div\", {\n                    className: \"k-tooltip k-spreadsheet-cell-comment\",\n                    style: style\n                }, [ dom.text(cell.comment) ]);\n                args.toplevelElements.push(div);\n            }\n        }, this);\n        borders.vert.forEach(function(a) {\n            a.forEach(function(b) {\n                if (!b.rendered) {\n                    b.rendered = true;\n                    let style = {\n                        left        : b.x + \"px\",\n                        top         : b.top + \"px\",\n                        height      : (b.bottom - b.top + 1) + \"px\",\n                        borderWidth : b.size + \"px\",\n                        borderColor : b.color\n                    };\n                    if (b.size !== 1) {\n                        style.transform = \"translateX(-\" + (b.size - 1) / 2 + \"px)\";\n                    }\n                    cont.children.push(dom.element(\"div\", {\n                        className: paneClassNames.vborder,\n                        style: style\n                    }));\n                }\n            });\n        });\n        borders.horiz.forEach(function(a) {\n            a.forEach(function(b) {\n                if (!b.rendered) {\n                    b.rendered = true;\n                    let style = {\n                        top         : b.y + \"px\",\n                        left        : b.left + \"px\",\n                        width       : (b.right - b.left) + \"px\",\n                        borderWidth : b.size + \"px\",\n                        borderColor : b.color\n                    };\n                    if (b.size !== 1) {\n                        style.transform = \"translateY(-\" + (b.size - 1) / 2 + \"px)\";\n                    }\n                    cont.children.push(dom.element(\"div\", {\n                        className: paneClassNames.hborder,\n                        style: style\n                    }));\n                }\n            });\n        });\n        this.renderDrawings(layout, cont.children);\n        return cont;\n    }\n\n    renderDrawings(layout, container) {\n        let sheet = this._sheet;\n        let workbook = sheet._workbook;\n        layout.drawings.forEach(function(d) {\n            let drawing = d.drawing;\n            let box = d.box;\n            let div = box.toDiv(\"k-spreadsheet-drawing\");\n            if (drawing.image) {\n                div.children.push(dom.element(\"div\", {\n                    className: \"k-spreadsheet-drawing-image\",\n                    style: {\n                        backgroundImage: \"url('\" + workbook.imageUrl(drawing.image) + \"')\",\n                        opacity: drawing.opacity\n                    }\n                }));\n            }\n            if (drawing === sheet._activeDrawing) {\n                div.attr.className += \" k-spreadsheet-active-drawing\";\n                drawingResizeHandles(div.children);\n            }\n            container.push(div);\n        });\n    }\n\n    renderResizeHandle(container) {\n        let sheet = this._sheet;\n        let ref = sheet.resizeHandlePosition();\n        let rectangle = this._rectangle(ref);\n        let classNames = [ Pane.classNames.resizeHandle ];\n\n        let style;\n        if (ref.col !== -Infinity) {\n            if (this._grid.rows._start > 0) {\n                return;\n            }\n            style = {\n                height: this._grid.headerHeight + \"px\",\n                width: RESIZE_HANDLE_WIDTH + \"px\",\n                left: rectangle.right - RESIZE_HANDLE_WIDTH / 2 + \"px\",\n                top: \"0px\"\n            };\n            classNames.push(viewClassNames.horizontalResize);\n        } else {\n            if (this._grid.columns._start > 0) {\n                return;\n            }\n            style = {\n                height: RESIZE_HANDLE_WIDTH + \"px\",\n                width: this._grid.headerWidth + \"px\",\n                top: rectangle.bottom - RESIZE_HANDLE_WIDTH / 2 + \"px\",\n                left: \"0px\"\n            };\n            classNames.push(viewClassNames.verticalResize);\n        }\n\n        container.push(dom.element(\"div\", {\n            className: classNames.join(\" \"),\n            style: style\n        }));\n    }\n\n    filterIconRect(rect) {\n        let BUTTON_SIZE = 16;\n        let BUTTON_OFFSET = 3;\n\n        return new Rectangle(\n            rect.right - BUTTON_SIZE - BUTTON_OFFSET,\n            rect.top + BUTTON_OFFSET,\n            BUTTON_SIZE,\n            BUTTON_SIZE\n        );\n    }\n\n    icon(className) {\n        if (typeof this.getIconHTMLString === \"function\") {\n            return dom.element(this.getIconHTMLString(className));\n        }\n\n        return dom.element(\"span\", {\n            className: viewClassNames.icon + \" \" + className\n        });\n    }\n\n    renderFilterHeaders() {\n        let pane = this;\n        let sheet = this._sheet;\n        let children = [];\n        let classNames = viewClassNames;\n        let filter = sheet.filter();\n\n        function filterButton(classNames, position, index) {\n            let style = {\n                left: position.left + \"px\",\n                top: position.top + \"px\"\n            };\n            let filtered = filter && filter.columns.some(function(c) {\n                return c.index === index;\n            });\n            let classes = classNames.filterButton;\n\n            if (filtered) {\n                classes += \" \" + classNames.filterButtonSelected;\n            }\n\n            let button = dom.element(\n                \"span\",\n                { className: classes, style: style },\n                [ pane.icon(classNames.iconFilterDefault) ]\n            );\n\n            return button;\n        }\n\n        if (filter) {\n            this._addDiv(children, filter.ref, classNames.filterRange);\n        }\n\n        sheet.forEachFilterHeader(this._currentView.ref, function(ref) {\n            let rect = this._rectangle(ref);\n            let position = this.filterIconRect(rect);\n            let column = this._sheet.filterColumn(ref);\n            let button = filterButton(classNames, position, column);\n\n            children.push(button);\n        }.bind(this));\n\n        return dom.element(\"div\", {\n            className: classNames.filterHeadersWrapper\n        }, children);\n\n    }\n\n    renderEditorSelection() {\n        let classNames = Pane.classNames;\n        let sheet = this._sheet;\n        let selections = [];\n\n        sheet._formulaSelections.forEach(function(range) {\n            let ref = range.ref;\n\n            if (ref === NULLREF) {\n                return;\n            }\n\n            this._addDiv(selections, ref, classNames.selectionHighlight + \" \" + range.colorClass);\n        }.bind(this));\n\n        return dom.element(\"div\", { className: classNames.selectionWrapper }, selections);\n\n    }\n\n    renderSelection(scroller) {\n        let classNames = Pane.classNames;\n        let selections = [];\n        let selectionClasses = [classNames.selection];\n        let sheet = this._sheet;\n        let activeCell = sheet.activeCell().toRangeRef();\n        let selection = sheet.select();\n\n        selectionClasses = selectionClasses.concat(this._activeFormulaColor());\n\n        if (selection.size() === 1) {\n            selectionClasses.push(\"k-single-selection\");\n        }\n\n        if (this._sheet.autoFillPunch()) {\n            selectionClasses.push(\"k-dim-auto-fill-handle\");\n        }\n\n        selection.forEach(function(ref) {\n            if (ref !== NULLREF) {\n                this._addDiv(selections, ref, selectionClasses.join(\" \"));\n            }\n        }.bind(this));\n\n        this._renderCustomEditorButton(selections, activeCell, scroller);\n\n        return dom.element(\"div\", { className: classNames.selectionWrapper }, selections);\n    }\n\n    renderAutoFill() {\n        let autoFillRectangle = [];\n\n        if (this._sheet.autoFillInProgress()) {\n            let autoFillRef = this._sheet.autoFillRef();\n            let punch = this._sheet.autoFillPunch();\n            let direction = this._sheet._autoFillDirection;\n\n            this._addDiv(autoFillRectangle, autoFillRef, \"k-auto-fill\");\n\n            if (punch) { // collapsing, add overlay\n                this._addDiv(autoFillRectangle, punch, \"k-auto-fill-punch\");\n            } else if (direction !== undefined) { // expanding - add hint\n                let ref, cssClass;\n\n                switch (direction) {\n                case 0:\n                    ref = autoFillRef.bottomRight;\n                    cssClass = \"k-auto-fill-br-hint\";\n                    break;\n                case 1:\n                    ref = autoFillRef.bottomRight;\n                    cssClass = \"k-auto-fill-br-hint\";\n                    break;\n                case 2:\n                    ref = new CellRef(autoFillRef.topLeft.row, autoFillRef.bottomRight.col);\n                    cssClass = \"k-auto-fill-tr-hint\";\n                    break;\n                case 3:\n                    ref = new CellRef(autoFillRef.bottomRight.row, autoFillRef.topLeft.col);\n                    cssClass = \"k-auto-fill-bl-hint\";\n                    break;\n                }\n\n                let rectangle = this._addDiv(autoFillRectangle, ref, cssClass);\n                if (rectangle) {\n                    let hint = dom.element(\"span\", { className: \"k-tooltip\" }, [ dom.text(this._sheet._autoFillHint) ]);\n                    rectangle.children.push(hint);\n                }\n            }\n        }\n\n        return dom.element(\"div\", { className: Pane.classNames.autoFillWrapper }, autoFillRectangle);\n    }\n\n    _addDiv(collection, ref, className) {\n        let view = this._currentView, div;\n\n        if (view.ref.intersects(ref)) {\n            div = this._rectangle(ref).resize(1, 1).toDiv(className);\n            collection.push(div);\n        }\n        return div;\n    }\n\n    _renderCustomEditorButton(collection, ref, scroller) {\n        let self = this;\n        let sheet = self._sheet;\n        let view = self._currentView;\n        let columnCount = self._grid.columns._axis._count;\n        let ed = sheet.activeCellCustomEditor();\n\n        if (ed && view.ref.intersects(ref)) {\n            let rectangle = self._rectangle(ref);\n            sheet.forEach(ref.collapse(), function(row, col, cell) {\n                cell.left = rectangle.left;\n                cell.top = rectangle.top;\n                cell.width = rectangle.width;\n                cell.height = rectangle.height;\n\n                let btnClass = \"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-spreadsheet-editor-button\";\n                let isLastColumn = col === columnCount - 1 || self._buttonOutOfVisiblePane(row, col, scroller);\n                if (isLastColumn) {\n                    btnClass += \" k-spreadsheet-last-column\";\n                }\n                self._editorInLastColumn = isLastColumn;\n                let btn = dom.element(\"div\", {\n                    className: btnClass,\n                    style: {\n                        left   : (cell.left + (isLastColumn ? 0 : cell.width)) + \"px\",\n                        top    : cell.top + \"px\",\n                        height : cell.height + \"px\"\n                    }\n                });\n\n                if (ed.icon) {\n                    btn.children.push(self.icon(ed.icon));\n                }\n\n                collection.push(btn);\n            });\n        }\n    }\n\n    _activeFormulaColor() {\n        let activeFormulaSelection;\n        let colorClasses = [];\n\n        if (this._sheet.isInEditMode()) {\n            activeFormulaSelection = this._sheet._formulaSelections.filter(function(sel) { return sel.active && sel.type === \"ref\"; })[0];\n\n            if (activeFormulaSelection) {\n                colorClasses.push(activeFormulaSelection.colorClass);\n            }\n        }\n\n        return colorClasses;\n    }\n\n    _directionClasses(cell) {\n        let cellClasses = [];\n        let classNames = Pane.classNames;\n        let view = this._currentView.ref;\n\n        if (!cell.move(0, -1).intersects(view)) {\n            cellClasses.push(classNames.left);\n        }\n\n        if (!cell.move(-1, 0).intersects(view)) {\n            cellClasses.push(classNames.top);\n        }\n\n        if (!cell.move(0, 1).intersects(view)) {\n            cellClasses.push(classNames.right);\n        }\n\n        if (!cell.move(1, 0).intersects(view)) {\n            cellClasses.push(classNames.bottom);\n        }\n\n        return cellClasses;\n    }\n\n    _rectangle(ref) {\n        return this._grid.boundingRectangle(ref.toRangeRef()).offset(-this._currentView.mergedCellLeft, -this._currentView.mergedCellTop);\n    }\n\n    _buttonOutOfVisiblePane(row, col, scroller) {\n        let self = this;\n        let theGrid = self._grid;\n        let sheet = self._sheet;\n        let ref = sheet.range(row, col)._ref;\n        let boundaries = theGrid.scrollBoundaries(ref);\n        let scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n\n        if (boundaries.right + EDIT_BUTTON_WIDTH > scrollLeft || col + 1 === sheet.frozenColumns()) {\n            return true;\n        }\n    }\n}\n\nPane.classNames = paneClassNames;\n\nfunction drawingResizeHandles(container) {\n    [ \"N\", \"NE\", \"E\", \"SE\", \"S\", \"SW\", \"W\", \"NW\" ].forEach(function(direction) {\n        container.push(dom.element(\"div\", {\n            \"className\": \"k-spreadsheet-drawing-handle \" + direction,\n            \"data-direction\": direction\n        }));\n    });\n}\n\n/* eslint-disable no-unused-vars */\n/* eslint-disable no-param-reassign */\n/* eslint-disable no-else-return */\n/* eslint-disable no-multi-spaces */\n/* eslint-disable no-nested-ternary */\n\n\nlet styles = [\n    \"font-family\",\n    \"font-size\",\n    \"font-stretch\",\n    \"font-style\",\n    \"font-weight\",\n    \"letter-spacing\",\n    \"text-transform\",\n    \"line-height\"\n];\n\n//move to core\nlet KEY_NAMES = {\n    27: 'esc',\n    37: 'left',\n    39: 'right',\n    35: 'end',\n    36: 'home',\n    32: 'spacebar'\n};\n\nlet PRIVATE_FORMULA_CHECK = /(^_|[^a-z0-9]$)/i;\n\nclass FormulaInput extends Widget {\n    constructor(element, opt) {\n        const defaultOptions = {\n            name: \"FormulaInput\",\n            autoScale: false,\n            filterOperator: \"startswith\",\n            scalePadding: 30,\n            minLength: 1,\n            formulaBarWidth: null\n        };\n\n        const options = Object.assign({}, defaultOptions, opt);\n        super(element, options);\n\n        this.events = [\n            \"keyup\",\n            \"focus\"\n        ];\n\n        this.input = opt.input;\n\n        if (!element) {\n            return;\n        }\n\n        this.bind(this.events, this.options);\n\n        element.classList.add(FormulaInput.classNames.wrapper);\n\n        if (options && options.formulaBarWidth) ;\n\n        this._highlightedRefs = [];\n\n        this._formulaSource();\n\n        this._formulaList();\n\n        this._tooltip();\n\n        this._sync = this._sync.bind(this);\n        this.scale = this.scale.bind(this);\n        this._keydown = this._keydown.bind(this);\n        this._keyup = this._keyup.bind(this);\n        this._blur = this._blur.bind(this);\n        this._input = this._input.bind(this);\n        this._focus = this._focus.bind(this);\n        this._paste = this._paste.bind(this);\n\n        if (this.options.autoScale) {\n            element.addEventListener(\"input\", this.scale);\n        }\n\n        element.addEventListener(\"keydown\", this._keydown);\n        element.addEventListener(\"keyup\", this._keyup);\n        element.addEventListener(\"blur\", this._blur);\n        element.addEventListener(\"input\", this._input);\n        element.addEventListener(\"click\", this._input);\n        element.addEventListener(\"focus\", this._focus);\n        element.addEventListener(\"paste\", this._paste);\n    }\n\n    enable(enable) {\n        if (enable === undefined) {\n            return this.element.getAttribute(\"contenteditable\") === \"true\";\n        }\n\n        if (enable) {\n            this.element.setAttribute(\"contenteditable\", enable);\n        } else {\n            this.element.removeAttribute(\"contenteditable\");\n        }\n\n        this.element.classList.toggle(\"k-disabled\", !enable);\n    }\n\n    getPos() {\n        let div = this.element;\n        let sel = window.getSelection();\n        let a = lookup(sel.focusNode, sel.focusOffset);\n        let b = lookup(sel.anchorNode, sel.anchorOffset);\n        if (a != null && b != null) {\n            if (a > b) {\n                let tmp = a;\n                a = b;\n                b = tmp;\n            }\n            return { begin: a, end: b, collapsed: a === b };\n        }\n        function lookup(lookupNode, pos) {\n            try {\n                (function loop(node) {\n                    if (node === lookupNode) {\n                        throw pos;\n                    } else if (node.nodeType === 1 /* Element */) {\n                        for (let i = node.firstChild; i; i = i.nextSibling) {\n                            loop(i);\n                        }\n                    } else if (node.nodeType === 3 /* Text */) {\n                        pos += node.nodeValue.length;\n                    }\n                })(div);\n            } catch (index) {\n                return index;\n            }\n        }\n    }\n\n    setPos(begin, end) {\n        let eiv = this.element;\n        begin = lookup(eiv, begin);\n        if (end != null) {\n            end = lookup(eiv, end);\n        } else {\n            end = begin;\n        }\n        if (begin && end) {\n            this._setRange(begin, end);\n        }\n\n        function lookup(node, pos) {\n            try {\n                (function loop(node) {\n                    if (node.nodeType === 3 /* Text */) {\n                        let len = node.nodeValue.length;\n                        if (len >= pos) {\n                            throw node;\n                        }\n                        pos -= len;\n                    } else if (node.nodeType === 1 /* Element */) {\n                        for (let i = node.firstChild; i; i = i.nextSibling) {\n                            loop(i);\n                        }\n                    }\n                })(node);\n            } catch (el) {\n                return { node: el, pos: pos };\n            }\n        }\n    }\n\n    end() {\n        this.setPos(this.length());\n    }\n\n    home() {\n        this.setPos(0);\n    }\n\n    select() {\n        this.setPos(0, this.length());\n    }\n\n    length() {\n        return this.value().length;\n    }\n\n    _setRange(begin, end) {\n        let range = document.createRange();\n        range.setStart(begin.node, begin.pos);\n        range.setEnd(end.node, end.pos);\n        let sel = window.getSelection();\n        let currentRange = sel.getRangeAt(0);\n        if (differ(range, currentRange))  {\n            sel.removeAllRanges();\n            sel.addRange(range);\n        }\n\n        function differ(a, b) {\n            return (\n                a.startOffset !== b.startOffset ||\n                a.endOffset !== b.endOffset ||\n                a.startContainer !== b.endContainer ||\n                a.endContainer !== b.endContainer\n            );\n        }\n    }\n\n    _formulaSource() {\n        let result = [];\n        let value;\n\n        for (let key in calc.runtime.FUNCS) {\n            if (!PRIVATE_FORMULA_CHECK.test(key)) {\n                value = key.toUpperCase();\n                result.push({ value: value, text: value });\n            }\n        }\n\n        this.formulaSource = result;\n    }\n\n    get list() { return  this.input.current.list; }\n    get popup() { return  this.input.current.popup; }\n\n    _formulaList() {\n        this.list.data(this.formulaSource);\n        this.list.itemClick((value) => {\n            this._formulaListChange(value);\n        });\n    }\n\n    _formulaListChange(value) {\n        let tokenCtx = this._tokenContext();\n\n        if (!tokenCtx || this._mute) {\n            return;\n        }\n\n        let activeToken = tokenCtx.token;\n        let completion = value;\n        let ctx = {\n            replace: true,\n            token: activeToken,\n            end: activeToken.end\n        };\n\n        if (!tokenCtx.nextToken || tokenCtx.nextToken.value !== \"(\") {\n            completion += \"(\";\n        }\n\n        this._replaceAt(ctx, completion);\n        this.popup.close();\n    }\n\n    _blur() {\n        this.popup.close();\n        clearTimeout(this._focusId);\n        this.trigger(\"blur\");\n    }\n\n    _isFormula() {\n        return /^=/.test(this.value());\n    }\n\n    _keydown(e) {\n        let key = e.keyCode;\n        let that = this;\n\n        if (KEY_NAMES[key]) {\n            that.popup.close();\n            that._navigated = true;\n        } else if (that._move(key)) {\n            that._navigated = true;\n            e.preventDefault();\n        }\n\n        that._keyDownTimeout = setTimeout(that._syntaxHighlight.bind(that));\n    }\n\n    _keyup() {\n        let popup = this.popup;\n        let value;\n\n        if (this._isFormula() && !this._navigated) {\n            value = ((this._tokenContext() || {}).token || {}).value;\n\n            const data = this.filter(value);\n\n            if (!value || !data.length) {\n                popup.close();\n            } else {\n                popup[popup.visible() ? \"position\" : \"open\"]();\n                setTimeout(() => { this.list.focusFirst(); }, 0);\n            }\n        }\n\n        this._navigated = false;\n        this._syntaxHighlight();\n\n        this.trigger(\"keyup\");\n    }\n\n    _input() {\n        this._syntaxHighlight();\n    }\n\n    _focus() {\n        setTimeout(this._sync.bind(this));\n        this._focusTimeout = setTimeout(this._syntaxHighlight.bind(this));\n        this.trigger(\"focus\");\n    }\n\n    _paste(ev) {\n        ev.preventDefault();\n        let pos = this.getPos();\n        let text;\n        text = ev.clipboardData.getData(\"text/plain\");\n        let val = this.value();\n        val = val.substr(0, pos.begin) + text + val.substr(pos.end);\n        this.value(val);\n        this.setPos(pos.begin + text.length);\n        this.scale();\n    }\n\n    _move(key) {\n        let list = this.list;\n        let popup = this.popup;\n        if (popup.visible()) {\n            if (key === keys.DOWN) {\n                list.focusNext();\n                return true;\n            }\n            if (key === keys.UP) {\n                list.focusPrev();\n                return true;\n            }\n            if (key === keys.ENTER || key === keys.TAB) {\n                let focusIndex = typeof list.focusIndex === \"function\" ? list.focusIndex() : list.focus();\n                if (list.data()[focusIndex]) {\n                    this._formulaListChange(list.data()[focusIndex].value);\n                }\n\n                popup.close();\n                return true;\n            }\n            if (key === keys.PAGEUP) {\n                list.focusFirst();\n                return true;\n            }\n            if (key === keys.PAGEDOWN) {\n                list.focusLast();\n                return true;\n            }\n        }\n        return false; // key === keys.ENTER || key === keys.TAB;\n    }\n\n    _tokenContext() {\n        let point = this.getPos();\n        let value = this.value();\n\n        if (!value || !point || !point.collapsed) {\n            return null;\n        }\n\n        let tokens = calc.tokenize(value, this.row(), this.col());\n        let tok;\n\n        for (let i = 0; i < tokens.length; ++i) {\n            tok = tokens[i];\n            if (touches(tok, point) && /^(?:str|sym|func)$/.test(tok.type)) {\n                return { token: tok, nextToken: tokens[i + 1] };\n            }\n        }\n\n        return null;\n    }\n\n    _sync() {\n        if (this._editorToSync && this.isActive()) {\n            this._editorToSync.value(this.value());\n        }\n    }\n\n    _textContainer() {\n        let computedStyles = kendoGetComputedStyles(this.element, styles);\n\n        computedStyles.position = \"absolute\";\n        computedStyles.visibility = \"hidden\";\n        computedStyles.whiteSpace = \"pre\";\n        computedStyles.top = -3333;\n        computedStyles.left = -3333;\n\n        this._span = document.createElement('span');\n        this._span.style.whiteSpace = 'pre';\n        for (const style in computedStyles) {\n            if (Object.hasOwnProperty.call(computedStyles, style)) {\n                this._span.style[style] = computedStyles[style];\n            }\n        }\n        insertAfter(this._span, this.element);\n        // this._span = $(\"<span style='white-space: pre'/>\").css(computedStyles).insertAfter(this.element);\n    }\n\n    _tooltip() {\n        this._cellTooltip = document.createElement('div');\n        this._cellTooltip.className = 'k-widget k-tooltip';\n        this._cellTooltip.style.position = 'absolute';\n        this._cellTooltip.style.display = 'none';\n        this._cellTooltip.appendChild(document.createTextNode('A1'));\n        insertAfter(this._cellTooltip, this.element);\n        // this._cellTooltip = $('<div class=\"k-widget k-tooltip\" style=\"position:absolute; display:none\">A1</div>').insertAfter(this.element);\n    }\n\n    tooltip(value) {\n        while (this._cellTooltip.firstChild) {\n            this._cellTooltip.removeChild(this._cellTooltip.firstChild);\n        }\n        this._cellTooltip.appendChild(document.createTextNode(value));\n        // this._cellTooltip.text(value);\n    }\n\n    toggleTooltip(show) {\n        this._cellTooltip.style.display = (show ? '' : 'none');\n        // this._cellTooltip.toggle(show);\n    }\n\n    isActive() {\n        return this.element === _activeElement$1();\n    }\n\n    filter(value) {\n        if (!value || value.length < this.options.minLength) {\n            return;\n        }\n\n        const data = this.formulaSource.filter((item) => String(item.value).toLowerCase().startsWith(value.toLowerCase()));\n\n        this.list.data(data);\n\n        return data;\n    }\n\n    hide() {\n        this.enable(false);\n        this.element.style.display = 'none';\n        this._cellTooltip.style.display = 'none';\n    }\n\n    show() {\n        this.enable(true);\n        this.element.style.display = 'block';\n    }\n\n    row() {\n        if (this.activeCell) {\n            return this.activeCell.row;\n        }\n    }\n\n    col() {\n        if (this.activeCell) {\n            return this.activeCell.col;\n        }\n    }\n\n    position(rectangle) {\n        if (!rectangle) {\n            return;\n        }\n\n        this.show();\n\n        this.element.style.top = (rectangle.top + 1) + \"px\";\n        this.element.style.left = (rectangle.left + 1) + \"px\";\n\n        this._cellTooltip.style.top =  (rectangle.top - this._cellTooltip.offsetHeight - 10) + \"px\";\n        this._cellTooltip.style.left = rectangle.left + \"px\";\n    }\n\n    resize(rectangle) {\n        if (!rectangle) {\n            return;\n        }\n\n        this.element.style.width = (rectangle.width - 1) + \"px\";\n        this.element.style.height = (rectangle.height - 1) + \"px\";\n    }\n\n    canInsertRef(isKeyboardAction) {\n        return this._canInsertRef(isKeyboardAction);\n    }\n\n    _canInsertRef(isKeyboardAction) {\n        if (this.popup.visible()) {\n            return null;\n        }\n        let strictMode = isKeyboardAction;\n        let point = this.getPos();\n        let tokens, tok, i;\n\n        if (point && this._isFormula()) {\n            if (point.begin === 0) {\n                return null;\n            }\n\n            tokens = calc.tokenize(this.value(), this.row(), this.col());\n\n            for (i = 0; i < tokens.length; ++i) {\n                tok = tokens[i];\n                if (touches(tok, point)) {\n                    return canReplace(tok);\n                }\n                if (afterPoint(tok)) {\n                    return canInsertBetween(tokens[i - 1], tok);\n                }\n            }\n            return canInsertBetween(tok, null);\n        }\n\n        return null;\n\n        function afterPoint(tok) {\n            return tok.begin > point.begin;\n        }\n        function canReplace(tok) {\n            if (tok) {\n                if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                    return { replace: true, token: tok, end: tok.end };\n                }\n                if (/^(?:op|punc|startexp)$/.test(tok.type)) {\n                    if (tok.end === point.end) {\n                        return canInsertBetween(tok, tokens[i + 1]);\n                    }\n                    return canInsertBetween(tokens[i - 1], tok);\n                }\n            }\n        }\n        function canInsertBetween(left, right) {\n            if (left == null) {\n                return null;\n            }\n            if (right == null) {\n                if (/^(?:op|startexp)$/.test(left.type) || isOpenParen(left.value)) {\n                    return { token: left, end: point.end };\n                }\n                return null;\n            }\n            if (strictMode) {\n                if (left.type === \"op\" && /^(?:punc|op)$/.test(right.type)) {\n                    return { token: left, end: point.end };\n                }\n            } else {\n                if (left.type === \"startexp\") {\n                    return { token: left, end: point.end };\n                }\n                if (/^(?:op|punc)$/.test(left.type) && /^[,;({]$/.test(left.value)) {\n                    return { token: left, end: point.end };\n                }\n                if (/^(?:ref|sym)/.test(left.type)) {\n                    return { token: left, replace: true, end: left.end };\n                }\n                if (/^(?:ref|sym)/.test(right.type)) {\n                    return { token: right, replace: true, end: right.end };\n                }\n            }\n            return false;\n        }\n    }\n\n    refAtPoint(sheet) {\n        let x = this._canInsertRef();\n        if (x) {\n            let ref = sheet.selection()._ref.simplify().clone().relative(0, 0, 3);\n            if (sheet.isMerged(ref)) {\n                ref = ref.topLeft;\n            }\n            if (sheet !== this.activeSheet) {\n                ref = ref.setSheet(sheet.name(), true);\n            }\n            this._replaceAt(x, ref.print(0, 0));\n        }\n    }\n\n    _replaceAt(ctx, newValue) {\n        let value = this.value();\n        let tok = ctx.token;\n        let rest = value.substr(ctx.end);\n        value = value.substr(0, ctx.replace ? tok.begin : ctx.end) + newValue;\n        let point = value.length;\n        value += rest;\n        this._value(value);\n        this.setPos(point);\n        this.scale();\n        this._syntaxHighlight();\n    }\n\n    syncWith(formulaInput) {\n        this._editorToSync = formulaInput;\n        if (this.element) {\n            this.element.removeEventListener(\"input\", this._sync);\n            this.element.addEventListener(\"input\", this._sync);\n        }\n    }\n\n    scale() {\n        let element = this.element;\n        let width, height;\n\n        if (!this._span) {\n            this._textContainer();\n        }\n\n        this._span.innerHTML = element.innerHTML;\n\n        width = this._span.offsetWidth + this.options.scalePadding;\n        height = this._span.offsetHeight;\n\n        if (width > element.offsetWidth) {\n            element.style.width = width + 'px';\n        }\n\n        const activeCellOutlineWidth = 1;\n        if (height - activeCellOutlineWidth > element.offsetHeight) {\n            element.style.height = (height - activeCellOutlineWidth) + 'px';\n        }\n\n        this._sync();\n    }\n\n    _value(value) {\n        let txt = (this.element.innerText || this.element.textContent).replace(/\\n$/, \"\");\n        if (txt !== value) {\n            while (this.element.firstChild) {\n                this.element.removeChild(this.element.firstChild);\n            }\n            this.element.appendChild(document.createTextNode(value));\n        }\n    }\n\n    value(value) {\n        let txt = (this.element.innerText || this.element.textContent).replace(/\\n$/, \"\");\n        if (value === undefined) {\n            return txt;\n        }\n\n        if (txt !== value) {\n            this._value(value);\n            this._syntaxHighlight();\n        }\n    }\n\n    highlightedRefs() {\n        return this._highlightedRefs.slice();\n    }\n\n    _syntaxHighlight() {\n        let pos = this.getPos();\n        let value = this.value();\n        let refClasses = Pane.classNames.series;\n        let highlightedRefs = [];\n        let refIndex = 0;\n        let parens = [];\n        let tokens = [];\n        // let activeToken;\n\n        if (pos && !pos.collapsed) {\n            // Backward selection (hold shift, move right to left)\n            // will not work properly if we continuously re-set\n            // the HTML.  If the selection is on, presumably the\n            // text has already been highlighted, so stop here.\n            return;\n        }\n\n        if (!(/^=/.test(value))) {\n            // if an user deleted the initial =, reset the text to\n            // discard any highlighting.  Only do that once.\n            if (this._highlightedRefs.length) {\n                this._highlightedRefs = [];\n                this._value(value);\n            }\n\n            // also make sure the completion popup goes away\n            // if (this.popup) {\n                // this.popup.close();\n            // }\n\n            return; // avoid messing with the cursor position below\n        } else {\n            tokens = calc.tokenize(value, this.row(), this.col());\n            tokens.forEach(function(tok) {\n                tok.active = false;\n                tok.cls = [ \"k-syntax-\" + tok.type ];\n\n                if (tok.type === \"ref\") {\n                    tok.colorClass = refClasses[(refIndex++) % refClasses.length];\n                    tok.cls.push(tok.colorClass);\n                    highlightedRefs.push(tok);\n                }\n                if (pos && tok.type === \"punc\") {\n                    if (isOpenParen(tok.value)) {\n                        parens.unshift(tok);\n                    } else if (isCloseParen(tok.value)) {\n                        let open = parens.shift();\n                        if (open) {\n                            if (isMatchingParen(tok.value, open.value)) {\n                                if (touches(tok, pos) || touches(open, pos)) {\n                                    tok.cls.push(\"k-syntax-paren-match\");\n                                    open.cls.push(\"k-syntax-paren-match\");\n                                }\n                            } else {\n                                tok.cls.push(\"k-syntax-error\");\n                                open.cls.push(\"k-syntax-error\");\n                            }\n                        } else {\n                            tok.cls.push(\"k-syntax-error\");\n                        }\n                    }\n                }\n                if (pos && touches(tok, pos)) {\n                    tok.cls.push(\"k-syntax-at-point\");\n                    tok.active = true;\n                    // activeToken = tok;\n                }\n                if (tok.type === \"func\" && !knownFunction(tok.value) && (!pos || !touches(tok, pos))) {\n                    tok.cls.push(\"k-syntax-error\");\n                }\n            });\n            tokens.reverse().forEach(function(tok) {\n                let begin = tok.begin, end = tok.end;\n                let text = htmlEncode(value.substring(begin, end));\n                value = value.substr(0, begin) +\n                    \"<span class='\" + tok.cls.join(\" \") + \"'>\" + text + \"</span>\" +\n                    value.substr(end);\n            });\n            this.element.innerHTML = value;\n        }\n        if (pos) {\n            this.setPos(pos.begin, pos.end);\n        }\n\n        this._highlightedRefs = highlightedRefs;\n    }\n\n    destroy() {\n        this._editorToSync = null;\n\n        this.element.removeEventListener(\"input\", this.scale);\n        this.element.removeEventListener(\"keydown\", this._keydown);\n        this.element.removeEventListener(\"keyup\", this._keyup);\n        this.element.removeEventListener(\"blur\", this._blur);\n        this.element.removeEventListener(\"input\", this._input);\n        this.element.removeEventListener(\"click\", this._input);\n        this.element.removeEventListener(\"focus\", this._focus);\n        this.element.removeEventListener(\"paste\", this._paste);\n\n        clearTimeout(this._focusTimeout);\n        clearTimeout(this._keyDownTimeout);\n\n        this._cellTooltip = null;\n        this._span = null;\n\n        super.destroy();\n    }\n\n    insertNewline() {\n        let val = this.value();\n        let pos = this.getPos();\n        let eof = pos.end === val.length;\n        val = val.substr(0, pos.begin) + (eof ? \"\\n\\n\" : \"\\n\" + val.substr(pos.end));\n        this.value(val);\n        this.setPos(pos.begin + 1);\n    }\n}\n\nFormulaInput.classNames = {\n    wrapper: \"k-spreadsheet-formula-input\",\n    listWrapper: \"k-spreadsheet-formula-list\"\n};\n\nfunction isOpenParen(ch) {\n    return ch === \"(\" || ch === \"[\" || ch === \"{\";\n}\n\nfunction isCloseParen(ch) {\n    return ch === \")\" || ch === \"]\" || ch === \"}\";\n}\n\nfunction isMatchingParen(close, open) {\n    return open === \"(\" ? close === \")\"\n        :  open === \"[\" ? close === \"]\"\n        :  open === \"{\" ? close === \"}\"\n        :  false;\n}\n\nfunction touches(pos, target) {\n    return pos.begin <= target.begin && pos.end >= target.end;\n}\n\nfunction knownFunction(name) {\n    return calc.runtime.FUNCS[name.toLowerCase()];\n}\n\nclass FormulaBar extends Widget {\n    constructor(element, options) {\n        super(element, options);\n\n        const formulaInputDiv = element && element.querySelector(\".k-spreadsheet-formula-input:not(.k-spreadsheet-cell-editor)\");\n        this.formulaInput = new FormulaInput(formulaInputDiv, this.options);\n    }\n\n    destroy() {\n        if (this.formulaInput) {\n            this.formulaInput.destroy();\n        }\n        this.formulaInput = null;\n    }\n}\n\nclass NameEditor extends Widget {\n    readData() {\n        const data = [];\n        this._workbook.forEachName(function(def) {\n            if (!def.hidden && def.value instanceof Ref) {\n                data.push({ name: def.name });\n            }\n        });\n        return data;\n    }\n    value(val) {\n        if (this.options.combobox.current) {\n            return this.options.combobox.current.value(val);\n        }\n    }\n}\n\nclass SheetsBar extends Widget {\n    constructor(element, options) {\n        super(element, Object.assign({}, { name: \"SheetsBar\" }, options));\n        this.events = [\n            \"select\",\n            \"reorder\",\n            \"rename\"\n        ];\n    }\n\n    onSheetReorderEnd(e) {\n        this.trigger(\"reorder\", { oldIndex: e.oldIndex, newIndex: e.newIndex });\n    }\n    onSheetRemove(removedSheetName) {\n        this.trigger(\"remove\", { name: removedSheetName, confirmation: true });\n    }\n    onSheetSelect(selectedSheetText) {\n        this.trigger(\"select\", { name: selectedSheetText, isAddButton: false });\n    }\n    onSheetRename(newSheetName, sheetIndex) {\n        this.trigger(\"rename\", { name: newSheetName, sheetIndex: sheetIndex });\n    }\n    onAddSelect() {\n        this.trigger(\"select\", { isAddButton: true });\n    }\n    destroy() {\n        super.destroy();\n    }\n}\n\n/* eslint-disable complexity */\n/* eslint-disable consistent-return */\n/* eslint-disable default-case */\n/* eslint-disable no-implicit-coercion */\n/* eslint-disable no-nested-ternary */\n/* eslint-disable key-spacing */\n/* eslint-disable no-param-reassign */\n\n\nfunction selectElementContents(el) {\n    let sel = window.getSelection();\n    sel.removeAllRanges();\n\n    let range = document.createRange();\n    range.selectNodeContents(el);\n\n    sel.addRange(range);\n}\n\nfunction cellBefore(table, row) {\n    let cells = table.trs[row].children;\n    return cells[cells.length - 2];\n}\n\nfunction cellAbove(table, row) {\n    let prevRow = table.trs[row - 1];\n    let index = table.trs[row].children.length - 1;\n\n    if (prevRow && index >= 0) {\n        return prevRow.children[index];\n    }\n}\n\nfunction addCell(table, row, cell) {\n    let style = {};\n\n    if (cell.background) {\n        style.backgroundColor = cell.background;\n    }\n\n    if (cell.color) {\n        style.color = cell.color;\n    }\n\n    if (cell.fontFamily) {\n        style.fontFamily = cell.fontFamily;\n    }\n\n    if (cell.underline) {\n        style.textDecoration = \"underline\";\n    }\n\n    if (cell.italic) {\n        style.fontStyle = \"italic\";\n    }\n\n    if (cell.textAlign) {\n        style.textAlign = cell.textAlign;\n    }\n\n    if (cell.verticalAlign) {\n        style.verticalAlign = (cell.verticalAlign === \"center\") ? \"middle\" : cell.verticalAlign;\n    }\n\n    if (cell.bold) {\n        style.fontWeight = \"bold\";\n    }\n\n    if (cell.fontSize) {\n        style.fontSize = cell.fontSize + \"px\";\n    }\n\n    if (cell.wrap === true) {\n        style.whiteSpace = \"pre-wrap\";\n    }\n\n    if (cell.borderRight) {\n        style.borderRight = cellBorder(cell.borderRight);\n    } else if (cell.background) {\n        style.borderRightColor = cell.background;\n    }\n\n    if (cell.borderBottom) {\n        style.borderBottom = cellBorder(cell.borderBottom);\n    } else if (cell.background) {\n        style.borderBottomColor = cell.background;\n    }\n\n    let data = cell.value, type = typeof data, format = cell.format;\n    if (!format && type === \"number\" && data !== Math.floor(data)) {\n        format = \"0.##############\";\n    }\n    if (format && data != null) {\n        data = formatting.format(data, format);\n        if (data.__dataType) {\n            type = data.__dataType;\n        }\n    }\n\n    let attrs = { style: style };\n\n    if (!style.textAlign) {\n        switch (type) {\n            case \"number\":\n            case \"date\":\n            case \"percent\":\n            case \"currency\":\n                style.textAlign = \"right\";\n                break;\n            case \"boolean\":\n                style.textAlign = \"center\";\n                break;\n        }\n    }\n\n    if (!/^(?:string|undefined)$/.test(type)) {\n        // provide original value and number format for better\n        // interoperability with google sheets and libre office.\n        attrs.sdval = cell.value;\n        attrs[\"data-sheets-value\"] = JSON.stringify({ 1: 3, 3: cell.value });\n        if (format) {\n            attrs.sdnum = format;\n            attrs[\"data-sheets-numberformat\"] = JSON.stringify({ 1: 2, 2: format, 3: 1 });\n        }\n    }\n    if (cell.formula) {\n        attrs[\"data-sheets-formula\"] = \"=\" + cell.formula.print();\n    }\n\n    let className = null;\n\n    if (cell.enable === false) {\n        className = \"k-disabled\";\n    }\n\n    let td = table.addCell(row, data, attrs, className, cell.validation);\n\n    let border, sibling;\n\n    if (cell.borderLeft) {\n        sibling = cellBefore(table, row);\n        border = cellBorder(cell.borderLeft);\n        if (sibling && border) {\n            sibling.attr.style.borderRight = border;\n        }\n    } else if (cell.background) {\n        style.borderLeftColor = cell.background;\n    }\n\n    if (cell.borderTop) {\n        sibling = cellAbove(table, row);\n        border = cellBorder(cell.borderTop);\n        if (sibling && border) {\n            sibling.attr.style.borderBottom = border;\n        }\n    } else if (cell.background) {\n        style.borderTopColor = cell.background;\n    }\n\n    return td;\n}\n\nclass HtmlTable {\n    constructor() {\n        this.cols = [];\n        this.trs = [];\n        this._height = 0;\n        this._width = 0;\n    }\n\n    addColumn(width) {\n        this._width += width;\n\n        let col = dom.element(\"col\", { style: { width: width + \"px\" } });\n\n        col.visible = width > 0;\n\n        this.cols.push(col);\n    }\n\n    addRow(height) {\n        let attr = null;\n\n        attr = { style: { height: height + \"px\" } };\n\n        this._height += height;\n\n        let tr = dom.element(\"tr\", attr);\n\n        tr.visible = height > 0;\n\n        this.trs.push(tr);\n    }\n\n    addCell(rowIndex, text, attrs, className, validation) {\n        if (text === null || text === undefined) {\n            text = \"\";\n        }\n        if (!(text instanceof dom.Node)) {\n            text = dom.text(text);\n        }\n\n        let children = [text];\n\n        if (validation && !validation.value) {\n            children.push(dom.element(\"span\", { className: \"k-dirty\" }));\n\n            className = (className || \"\") + (className ? \" \" : \"\") + \"k-dirty-cell\";\n            attrs.title = validation.message;\n        }\n\n        if (className) {\n            attrs.className = className;\n        }\n        let td = dom.element(\"td\", attrs, children);\n\n        this.trs[rowIndex].children.push(td);\n        return td;\n    }\n\n    toDomTree(x, y, className) {\n        this.trs = this.trs.filter(function (tr) {\n            return tr.visible;\n        });\n\n        let offset = 0;\n        this.cols = this.cols.filter(function (col, ci) {\n            if (!col.visible) {\n                this.trs.forEach(function (tr) {\n                    tr.children.splice(ci - offset, 1);\n                });\n                offset++;\n            }\n\n            return col.visible;\n        }, this);\n\n        return dom.element(\"table\", {\n            style: { left: x + \"px\", top: y + \"px\", height: this._height + \"px\", width: this._width + \"px\" },\n            className: className,\n            role: \"presentation\"\n        }, [\n            dom.element(\"colgroup\", null, this.cols),\n            dom.element(\"tbody\", null, this.trs)\n        ]);\n    }\n}\n\nfunction within(value, min, max) {\n    return value >= min && value <= max;\n}\n\nclass View extends Observable {\n    constructor(element, options) {\n        super();\n        let classNames = View.classNames;\n\n        this.element = element;\n\n        this.options = deepExtend({}, {\n            messages: messages.view\n        }, this.options, options);\n\n        this.events = ['update', 'message'];\n\n        this._chrome();\n\n        this._dialogs = [];\n\n        this._formulaInput();\n\n        this.wrapper = element.querySelector(DOT + classNames.view);\n        this.container = element.querySelector(DOT + classNames.fixedContainer);\n        this.scroller = element.querySelector(DOT + classNames.scroller);\n        this.clipboard = element.querySelector(DOT + classNames.clipboard);\n\n        this.viewSize = this.scroller ?\n            this.scroller.querySelector(\".k-spreadsheet-view-size\") || this.scroller.firstElementChild :\n            null;\n\n        if (!this.viewSize) {\n            throw new Error(\"The scroller element does not contain a view size element.\");\n        }\n\n        this.tree = new dom.Tree(this.container);\n        this.clipboardContents = new dom.Tree(this.clipboard);\n\n        this.editor = new SheetEditor(this);\n\n        this._sheetsbar();\n\n        this.options.createContextMenus?.();\n    }\n\n    enableClipboard(enable) {\n        this.isClipboardDeactivated = !enable;\n\n        if (enable) {\n            this.clipboard.setAttribute(\"contenteditable\", enable);\n        } else {\n            this.clipboard.removeAttribute(\"contenteditable\");\n        }\n    }\n\n    _resize() {\n        // let actionBar = $(this.formulaBar.element).parents(\".k-spreadsheet-action-bar\");\n        // let outerHeight = kendo._outerHeight;\n        // let tabstripHeight = this.tabstrip ? outerHeight(this.tabstrip.element) : 0;\n        // let formulaBarHeight = actionBar ? outerHeight(actionBar) : 0;\n        // let sheetsBarHeight = this.sheetsbar ? outerHeight(this.sheetsbar.element) : 0;\n\n        // this.wrapper.height(\n        //     this.element.height() -\n        //         (tabstripHeight + formulaBarHeight + sheetsBarHeight)\n        // );\n\n        // if (this.tabstrip) {\n        //     this.tabstrip.quickAccessAdjust();\n        // }\n    }\n\n    _chrome() {\n        // let wrapper = document.createElement('div');\n        // wrapper.className = 'k-spreadsheet-action-bar';\n        // this.element.appendChild(wrapper);\n\n        let nameEditor = this.element.querySelector('.k-spreadsheet-name-editor');\n        this.nameEditor = new NameEditor(nameEditor, { combobox: this.options.nameBoxRef });\n\n        // let formulaBar = document.createElement('div');\n        // wrapper.appendChild(formulaBar);\n        let formulaBar = this.element.querySelector('.k-spreadsheet-formula-bar');\n        this.formulaBar = new FormulaBar(formulaBar, { input: this.options.formulaBarInputRef });\n\n        // if (this.options.toolbar) {\n        this._tabstrip();\n        // }\n    }\n\n    _formulaInput() {\n        let editor = this.element.querySelector(DOT + View.classNames.cellEditor);\n\n        this.formulaInput = new FormulaInput(editor, {\n            autoScale: true,\n            input: this.options.formulaCellInputRef\n        });\n    }\n\n    _sheetsbar() {\n        if (this.options.sheetsbar) {\n            this.sheetsbar = new SheetsBar(this.element.querySelector(DOT + View.classNames.sheetsBar), this.options.sheetsbar);\n            this.options.createSheetBar?.(this.options.openDialogCallback);\n        }\n    }\n\n    _tabstrip() {\n        this.tabstrip = this.options.createTabStrip?.();\n        // let messages = this.options.messages.tabs;\n        // let options = $.extend(true, { home: true, insert: true, data: true }, this.options.toolbar);\n        // let tabs = [];\n\n        // if (this.tabstrip) {\n        //     this.tabstrip.destroy();\n        //     this.element.children(\".k-tabstrip\").remove();\n        // }\n\n        // for (let name in options) {\n        //     if (options[name] === true || options[name] instanceof Array) {\n        //         tabs.push({ id: name, text: messages[name], content: \"\" });\n        //     }\n        // }\n\n        // this.tabstrip = new kendo.spreadsheet.TabStrip($(\"<div />\").prependTo(this.element), {\n        //     animation: false,\n        //     dataTextField: \"text\",\n        //     dataContentField: \"content\",\n        //     dataSource: tabs,\n        //     toolbarOptions: options,\n        //     view: this\n        // });\n\n        // this.tabstrip.select(0);\n    }\n\n    _executeCommand(e) {\n        this._sheet.trigger(\"commandRequest\", e);\n    }\n\n    workbook(workbook) {\n        this._workbook = workbook;\n        workbook._view = this;\n        this.nameEditor._workbook = workbook;\n    }\n\n    sheet(sheet) {\n        this._sheet = sheet;\n    }\n\n    activeCellRectangle() {\n        return this.cellRectangle(this._sheet._viewActiveCell());\n    }\n\n    _rectangle(pane, ref) {\n        return pane._grid.boundingRectangle(ref.toRangeRef());\n    }\n\n    isColumnResizer(x, pane, col) {\n        // relative to content\n        x -= this._sheet._grid._headerWidth;\n\n        // add scroll if pane is not frozen\n        if (!pane._grid.columns.frozen) {\n            x += this.scroller.scrollLeft;\n        }\n\n        col = this._sheet._grid._columns.locate(0, col, function (w) {\n            return Math.abs(x - w) <= RESIZE_HANDLE_WIDTH / 2;\n        });\n\n        return col !== null && !this._sheet.isHiddenColumn(col) ? col : null;\n    }\n\n    isRowResizer(y, pane, row) {\n        // relative to content\n        y -= this._sheet._grid._headerHeight;\n\n        // add scroll if pane is not frozen\n        if (!pane._grid.rows.frozen) {\n            y += this.scroller.scrollTop;\n        }\n\n        row = this._sheet._grid._rows.locate(0, row, function (h) {\n            return Math.abs(y - h) <= RESIZE_HANDLE_WIDTH / 2;\n        });\n\n        return row !== null && !this._sheet.isHiddenRow(row) ? row : null;\n    }\n\n    isFilterIcon(x, y, pane, ref) {\n        let self = this;\n        let theGrid = pane._grid;\n        let scrollTop = theGrid.rows.frozen ? 0 : self.scroller.scrollTop;\n        let scrollLeft = theGrid.columns.frozen ? 0 : self.scroller.scrollLeft;\n\n        x -= self._sheet._grid._headerWidth - scrollLeft;\n        y -= self._sheet._grid._headerHeight - scrollTop;\n\n        return withExit(function (exit) {\n            self._sheet.forEachFilterHeader(ref, function (ref) {\n                let rect = self._rectangle(pane, ref);\n                if (pane.filterIconRect(rect).intersects(x, y)) {\n                    exit(true);\n                }\n            });\n        });\n    }\n\n    isAutoFill(x, y, pane) {\n        let selection = this._sheet.select();\n\n        if (selection.size > 1) {\n            return false;\n        }\n\n        x -= this._sheet._grid._headerWidth;\n        y -= this._sheet._grid._headerHeight;\n\n        if (!pane._grid.columns.frozen) {\n            x += this.scroller.scrollLeft;\n        }\n\n        if (!pane._grid.rows.frozen) {\n            y += this.scroller.scrollTop;\n        }\n\n        let rectangle = this._rectangle(pane, selection);\n\n        return Math.abs(rectangle.right - x) < 8 && Math.abs(rectangle.bottom - y) < 8;\n    }\n\n    isEditButton(x, y, pane) {\n        let ed = this._sheet.activeCellCustomEditor();\n        if (ed) {\n            let r = this.activeCellRectangle();\n            // XXX: hard-coded button width (20)\n\n            if (y >= r.top && y <= r.bottom) {\n                return pane._editorInLastColumn ? x < r.left && x >= r.left - EDIT_BUTTON_WIDTH\n                    : x > r.right && x <= r.right + EDIT_BUTTON_WIDTH;\n            }\n        }\n    }\n\n    drawingAt(x, y, pane) {\n        x -= this._sheet._grid._headerWidth;\n        y -= this._sheet._grid._headerHeight;\n\n        if (!pane._grid.columns.frozen) {\n            x += this.scroller.scrollLeft;\n        }\n\n        if (!pane._grid.rows.frozen) {\n            y += this.scroller.scrollTop;\n        }\n\n        let sheet = this._sheet;\n        let drawings = this._sheet._drawings;\n        for (let i = drawings.length; --i >= 0;) {\n            let d = drawings[i];\n            let box = sheet.drawingBoundingBox(d);\n            if (box.intersects(x, y)) {\n                return {\n                    drawing: d,\n\n                    // also include how far is the drawing's\n                    // top-left from the mouse position, as it's\n                    // not easy to compute some place else.\n                    drx: box.left - x,\n                    dry: box.top - y\n                };\n            }\n        }\n    }\n\n    objectAt(x, y, noDrawing) {\n        let grid = this._sheet._grid;\n        let object, pane;\n\n        if (x < 0 || y < 0 || x > this.scroller.clientWidth || y > this.scroller.clientHeight) {\n            object = { type: \"outside\" };\n        } else if (x < grid._headerWidth && y < grid._headerHeight) {\n            object = { type: \"topcorner\" };\n        } else {\n            pane = this.paneAt(x, y);\n\n            if (!pane) {\n                object = { type: \"outside\" };\n            } else {\n                if (!noDrawing) {\n                    let drawing = this.drawingAt(x, y, pane);\n                    if (drawing) {\n                        return {\n                            type: \"drawing\",\n                            drawing: drawing.drawing,\n                            drx: drawing.drx,\n                            dry: drawing.dry,\n                            pane: pane,\n                            startX: x,\n                            startY: y\n                        };\n                    }\n                }\n\n                let row = pane._grid.rows.indexVisible(y, this.scroller.scrollTop);\n                let column = pane._grid.columns.indexVisible(x, this.scroller.scrollLeft);\n\n                let type = \"cell\";\n                let ref = new CellRef(row, column);\n                let selecting = this._sheet.selectionInProgress();\n\n                if (this.isAutoFill(x, y, pane)) {\n                    type = \"autofill\";\n                } else if (this.isFilterIcon(x, y, pane, ref)) {\n                    type = \"filtericon\";\n                } else if (!selecting && x < grid._headerWidth) {\n                    type = \"rowheader\";\n                    if ((row = this.isRowResizer(y, pane, row)) !== null) {\n                        ref = new CellRef(row, -Infinity);\n                        type = \"rowresizehandle\";\n                    }\n                } else if (!selecting && y < grid._headerHeight) {\n                    type = \"columnheader\";\n                    if ((column = this.isColumnResizer(x, pane, column)) !== null) {\n                        ref = new CellRef(-Infinity, column);\n                        type = \"columnresizehandle\";\n                    }\n                } else if (this.isEditButton(x, y, pane)) {\n                    type = \"editor\";\n                }\n\n                object = { type: type, ref: ref };\n            }\n        }\n\n        object.pane = pane;\n        object.x = x;\n        object.y = y;\n        return object;\n    }\n\n    paneAt(x, y) {\n        return this.panes.filter(function paneLocationWithin(pane) {\n            let grid = pane._grid;\n            return within(y, grid.top, grid.bottom) && within(x, grid.left, grid.right);\n        })[0];\n    }\n\n    containingPane(cell) {\n        return this.panes.filter(function (pane) {\n            if (pane._grid.contains(cell)) {\n                return true;\n            }\n            return false;\n        })[0];\n    }\n\n    cellRectangle(cell) {\n        let theGrid = this.containingPane(cell)._grid;\n        let rectangle = this._sheet._grid.rectangle(cell);\n\n        return rectangle.offset(\n            theGrid.headerWidth - (theGrid.columns.frozen ? 0 : this.scroller.scrollLeft),\n            theGrid.headerHeight - (theGrid.rows.frozen ? 0 : this.scroller.scrollTop)\n        );\n    }\n\n    refresh(reason) {\n        let sheet = this._sheet;\n\n        // if (this.tabstrip) {\n        //     this.tabstrip.refreshTools(sheet.range(sheet.activeCell()));\n        // }\n\n        this.trigger('update', { reason, range: sheet.range(sheet.activeCell()), sheet });\n\n        // if (reason.sheetSelection && this.sheetsbar) {\n        //    this.sheetsbar.renderSheets(this._workbook.sheets(), this._workbook.sheetIndex(this._sheet));\n        // }\n\n        this._resize();\n\n        //TODO: refresh sheets list on sheetSelection\n        this.viewSize.style.height = sheet._grid.totalHeight() + \"px\";\n        this.viewSize.style.width = sheet._grid.totalWidth() + \"px\";\n\n        if (reason.layout) {\n            let frozenColumns = sheet.frozenColumns();\n            let frozenRows = sheet.frozenRows();\n\n            // main or bottom or right pane\n            this.panes = [this._pane(frozenRows, frozenColumns)];\n\n            // left pane\n            if (frozenColumns > 0) {\n                this.panes.push(this._pane(frozenRows, 0, null, frozenColumns));\n            }\n\n            // top pane\n            if (frozenRows > 0) {\n                this.panes.push(this._pane(0, frozenColumns, frozenRows, null));\n            }\n\n            // left-top \"fixed\" pane\n            if (frozenRows > 0 && frozenColumns > 0) {\n                this.panes.push(this._pane(0, 0, frozenRows, frozenColumns));\n            }\n        }\n\n        if (reason.filter) {\n            this._destroyFilterMenu();\n        }\n\n        if (reason.activeCell) {\n            this._focus = sheet.activeCell().toRangeRef();\n        }\n    }\n\n    createFilterMenu(column) {\n        this._destroyFilterMenu();\n\n        let sheet = this._sheet;\n        let ref = sheet.filter().ref;\n        let range = new Range$1(ref, sheet);\n\n        let options = { column: column, range: range };\n\n        this._filterMenu = this.options.createFilterMenu(options);\n\n        return this._filterMenu;\n    }\n\n    selectClipboardContents() {\n        if (!this.isClipboardDeactivated) {\n            this.clipboard.focus({ preventScroll: true });\n            selectElementContents(this.clipboard);\n        }\n    }\n\n    scrollIntoView(cell) {\n        let willScroll = false;\n        let theGrid = this.containingPane(cell)._grid;\n\n        let boundaries = theGrid.scrollBoundaries(cell);\n\n        let scroller = this.scroller;\n        let scrollTop = theGrid.rows.frozen ? 0 : scroller.scrollTop;\n        let scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n\n        if (boundaries.top < scrollTop) {\n            willScroll = true;\n            scroller.scrollTop = boundaries.scrollTop;\n        }\n\n        if (boundaries.bottom > scrollTop) {\n            willScroll = true;\n            scroller.scrollTop = boundaries.scrollBottom;\n        }\n\n        if (boundaries.left < scrollLeft) {\n            willScroll = true;\n            scroller.scrollLeft = boundaries.scrollLeft;\n        }\n\n        if (boundaries.right > scrollLeft) {\n            willScroll = true;\n            scroller.scrollLeft = boundaries.scrollRight;\n        }\n\n        return willScroll;\n    }\n\n    _destroyDialog() {\n        this._dialogs.pop();\n    }\n\n    openCustomEditor() {\n        let self = this;\n        let cell = self._sheet.activeCell().first();\n        let editor = self._sheet.activeCellCustomEditor();\n        let range = self._sheet.range(cell);\n        editor.edit({\n            range: range,\n            rect: self.activeCellRectangle(),\n            view: this,\n            validation: this._sheet.validation(cell),\n            callback: function (value, parse) {\n                self._executeCommand({\n                    command: \"EditCommand\",\n                    options: {\n                        operatingRange: range,\n                        editRange: range,\n                        property: parse ? \"input\" : \"value\",\n                        value: value\n                    }\n                });\n            }\n        });\n    }\n\n    openDialog(name, options) {\n        let sheet = this._sheet;\n        return sheet.withCultureDecimals(function () {\n            let ref = sheet.activeCell();\n            let range = new Range$1(ref, sheet);\n            let args = { ...options, name, ref, range };\n            this.trigger('message', args);\n            return args.dialog;\n        }.bind(this));\n    }\n\n    showError(options, reopenEditor) {\n        let currentDialogs = this._dialogs;\n        let errorMessages = this.options.messages.errors;\n\n        if (currentDialogs.length > 0) {\n            return;\n        }\n\n        let onClose = function () {\n            currentDialogs.pop();\n            // let dlg = e.sender;\n            this.selectClipboardContents();\n            if (reopenEditor) { // dlg._retry &&\n                reopenEditor();\n            }\n        }.bind(this);\n\n        const dialogOptions = {\n            title: options.title || \"Error\",\n            text: options.body ? options.body : errorMessages[options.type],\n            close: onClose\n        };\n\n        currentDialogs.push(dialogOptions);\n\n        this.openDialog(options.type || \"message\", dialogOptions);\n    }\n\n    destroy() {\n        this.unbind();\n\n        [this.tree, this.clipboardContents].forEach(el => {\n            while (el && el.root && el.root.lastChild) {\n                el.root.removeChild(el.root.lastChild);\n            }\n        });\n        this.tree = this.clipboardContents = null;\n\n        // this._dialogs.forEach(function(dialog) {\n        //     dialog.destroy();\n        // });\n\n        // if (this.cellContextMenu) {\n        //     this.cellContextMenu.destroy();\n        // }\n\n        // this.rowHeaderContextMenu.destroy();\n        // this.colHeaderContextMenu.destroy();\n        // this.drawingContextMenu.destroy();\n\n        // this.cellContextMenu = this.rowHeaderContextMenu =\n        //                         this.colHeaderContextMenu =\n        //                         this.drawingContextMenu = null;\n\n        if (this.tabstrip) {\n            this.tabstrip.destroy();\n            this.tabstrip = null;\n        }\n\n        this._destroyFilterMenu();\n    }\n\n    _destroyFilterMenu() {\n        if (this._filterMenu) {\n            this._filterMenu.destroy();\n            this._filterMenu = undefined;\n        }\n    }\n\n    render(reason) {\n        // if (!this.element.is(\":visible\")) {\n        //     return;\n        // }\n        let sheet = this._sheet;\n        let focus = sheet.focus();\n        let scrollbarSize = scrollbar();\n        let contentWidth = this.wrapper.clientWidth - scrollbarSize;\n        let contentHeight = this.wrapper.clientHeight - scrollbarSize;\n\n        if (focus && this.scrollIntoView(focus)) {\n            return;\n        }\n\n        let resizeDirection =\n            !sheet.resizingInProgress() ? \"none\" :\n                sheet.resizeHandlePosition().col === -Infinity ? \"column\" :\n                    \"row\";\n\n        this.wrapper.classList.toggle(viewClassNames.editContainer, this.editor.isActive());\n        this.wrapper.classList.toggle(viewClassNames.horizontalResize, resizeDirection === \"row\");\n        this.wrapper.classList.toggle(viewClassNames.verticalResize, resizeDirection === \"column\");\n\n        let grid = sheet._grid;\n        let content = [];\n        let args = {\n            scroller: this.scroller,\n            toplevelElements: content,\n            contentWidth: contentWidth,\n            contentHeight: contentHeight\n        };\n        this.panes.forEach(function (pane) {\n            content.push(pane.render(args));\n        });\n\n        let topCorner = dom.element(\"div\", {\n            style: { width: grid._headerWidth + \"px\", height: grid._headerHeight + \"px\" },\n            className: View.classNames.topCorner\n        });\n\n        content.push(topCorner);\n\n        if (sheet.resizeHandlePosition() && sheet.resizeHintPosition()) {\n            content.push(this.renderResizeHint());\n        }\n\n        this.tree.render(content);\n\n        this.container.style.width = contentWidth + 'px';\n        this.container.style.height = contentHeight + 'px';\n        // $(this.container).css({\n        //     width: contentWidth,\n        //     height: contentHeight\n        // });\n\n        if (this.editor.isActive()) {\n            this.editor.toggleTooltip(this.activeCellRectangle());\n        } else if (!(reason.resize ||\n            reason.comment ||\n            sheet.selectionInProgress() ||\n            sheet.resizingInProgress() ||\n            sheet.draggingInProgress() ||\n            sheet.isInEditMode())) {\n            this.renderClipboardContents();\n        }\n    }\n\n    // this renders the big blue line during resizing\n    renderResizeHint() {\n        let sheet = this._sheet;\n        let ref = sheet.resizeHandlePosition();\n\n        let horizontal = ref.col !== -Infinity;\n\n        let style;\n        if (horizontal) {\n            style = {\n                height: this.scroller.clientHeight + \"px\",\n                width: RESIZE_HANDLE_WIDTH + \"px\",\n                left: sheet.resizeHintPosition().x + \"px\",\n                top: \"0px\"\n            };\n        } else {\n            style = {\n                height: RESIZE_HANDLE_WIDTH + \"px\",\n                width: this.scroller.clientWidth + \"px\",\n                top: sheet.resizeHintPosition().y + \"px\",\n                left: \"0px\"\n            };\n        }\n\n        let classNames = Pane.classNames;\n\n        return dom.element(\"div\", {\n            className: classNames.resizeHint + (!horizontal ? \" \" + classNames.resizeHintVertical : \"\"),\n            style: style\n        }, [\n            dom.element(\"div\", { className: classNames.resizeHintHandle }),\n            dom.element(\"div\", { className: classNames.resizeHintMarker })\n        ]);\n    }\n\n    renderClipboardContents() {\n        let sheet = this._sheet;\n        let grid = sheet._grid;\n\n        // if (sheet._activeDrawing && sheet._activeDrawing.image) {\n        //     let url = this._workbook.imageUrl(sheet._activeDrawing.image);\n        //     let img = dom.element(\"img\", {\n        //         src: url,\n        //         style: {\n        //             width: sheet._activeDrawing.width + \"px\",\n        //             height: sheet._activeDrawing.height + \"px\"\n        //         }\n        //     });\n        //     this.clipboardContents.render([ img ]);\n        //     this.selectClipboardContents();\n        //     return;\n        // }\n\n        let selection = grid.normalize(sheet.select().toRangeRef());\n        let status = this._workbook.clipboard().canCopy();\n        if (status.canCopy === false && status.multiSelection) {\n            this.clipboardContents.render([]);\n            this.selectClipboardContents();\n            return;\n        }\n\n        selection = sheet.trim(selection);\n\n        let table = new HtmlTable();\n\n        let selectionView = grid.rangeDimensions(selection);\n\n        selectionView.rows.forEach(function (height) {\n            table.addRow(height);\n        });\n\n        selectionView.columns.forEach(function (width) {\n            table.addColumn(width);\n        });\n\n        let tmp = sheet._getMergedCells(selection);\n        let primaryMergedCells = tmp.primary;\n        let secondaryMergedCells = tmp.secondary;\n\n        sheet.forEach(selection, function (row, col, cell) {\n            let location = new CellRef(row, col).print();\n\n            if (!secondaryMergedCells[location]) {\n                let td = addCell(table, row - selection.topLeft.row, cell);\n\n                let mergedCell = primaryMergedCells[location];\n\n                if (mergedCell) {\n                    td.attr.colspan = mergedCell.width();\n                    td.attr.rowspan = mergedCell.height();\n                }\n            }\n        });\n\n        this.clipboardContents.render([table.toDomTree(0, 0, \"kendo-clipboard-\" + this._workbook.clipboard()._uid)]);\n\n        this.selectClipboardContents();\n    }\n\n    _pane(row, column, rowCount, columnCount) {\n        let pane = new Pane(this._sheet, this._sheet._grid.pane({ row: row, column: column, rowCount: rowCount, columnCount: columnCount }), this.options.getIconHTMLString);\n        pane.refresh(this.scroller.clientWidth, this.scroller.clientHeight);\n        return pane;\n    }\n}\n\nView.classNames = viewClassNames;\n\nconst reTable = /<table[^>]+>/gmi;\nconst tables = contentStr => ((contentStr || '').match(reTable) || []);\n\nclass Clipboard {\n    constructor(workbook) {\n        this._content = {};\n        this._externalContent = {};\n        this._internalContent = {};\n        this.workbook = workbook;\n        this.origin = NULLREF;\n        this.iframe = document.createElement(\"iframe\");\n        this.iframe.className = \"k-spreadsheet-clipboard-paste\";\n        this.iframe.setAttribute(\"title\", \"Spreadsheet clipboard iframe\");\n        this.menuInvoked = false;\n        this._uid = guid();\n        document.body.appendChild(this.iframe);\n    }\n\n    destroy() {\n        if (this.iframe && this.iframe.parentNode) {\n            this.iframe.parentNode.removeChild(this.iframe);\n        }\n    }\n\n    canCopy() {\n        let status = { canCopy: true };\n        let selection = this.workbook.activeSheet().select();\n        if (selection === NULLREF) {\n            status.canCopy = false;\n        }\n        if (selection instanceof UnionRef) {\n            status.canCopy = false;\n            status.multiSelection = true;\n        }\n        if (this.menuInvoked) {\n            status.canCopy = false;\n            status.menuInvoked = true;\n        }\n        return status;\n    }\n\n    canPaste() {\n        let sheet = this.workbook.activeSheet();\n        let ref = this.pasteRef();\n        let range = sheet.range(ref);\n        let status = { canPaste: true, pasteOnMerged: false, pasteOnDisabled: false };\n\n        if (!range.enable()) {\n            status.canPaste = false;\n            status.pasteOnDisabled = true;\n        }\n        if (!ref.eq(sheet.unionWithMerged(ref))) {\n            status.canPaste = false;\n            status.pasteOnMerged = true;\n        }\n        if (this.menuInvoked) {\n            status.canPaste = false;\n            status.menuInvoked = true;\n        }\n        return status;\n    }\n\n    intersectsMerged() {\n        let sheet = this.workbook.activeSheet();\n        this.parse();\n        this.origin = this._content.origRef;\n        let ref = this.pasteRef();\n        return !ref.eq(sheet.unionWithMerged(ref));\n    }\n\n    copy() {\n        let sheet = this.workbook.activeSheet();\n        this.origin = sheet.select();\n        this._internalContent = sheet.selection().getState();\n        delete this._externalContent.html;\n        delete this._externalContent.plain;\n    }\n\n    cut() {\n        let sheet = this.workbook.activeSheet();\n        this.copy();\n        sheet.range(sheet.select()).clear();\n    }\n\n    pasteRef() {\n        let sheet = this.workbook.activeSheet();\n\n        // When pasting from an external source, origin will be\n        // NULLREF.  Just return the destination range.\n        // https://github.com/telerik/kendo-ui-core/issues/3486\n        if (this.origin === NULLREF) {\n            return sheet.select();\n        }\n\n        let destination = sheet.activeCell().first();\n        let originActiveCell = this.origin.first();\n        let rowDelta = originActiveCell.row - destination.row;\n        let colDelta = originActiveCell.col - destination.col;\n\n        return this.origin.relative(rowDelta, colDelta, 3);\n    }\n\n    paste() {\n        let sheet = this.workbook.activeSheet();\n        let pasteRef = this.pasteRef();\n        if (pasteRef.bottomRight.row >= sheet._rows._count || pasteRef.bottomRight.col >= sheet._columns._count) {\n            sheet.resize(\n                Math.max(pasteRef.bottomRight.row + 1, sheet._rows._count),\n                Math.max(pasteRef.bottomRight.col + 1, sheet._columns._count)\n            );\n        }\n        sheet.range(pasteRef).setState(this._content, this);\n        sheet.triggerChange({ recalc: true, ref: pasteRef });\n    }\n\n    external(data) {\n        if (data && (data.html || data.plain)) {\n            this._externalContent = data;\n        } else {\n            return this._externalContent;\n        }\n    }\n\n    isExternal() {\n        return !this._isInternal();\n    }\n\n    parse() {\n        let state;\n\n        if (this._isInternal()) {\n            state = this._internalContent;\n        } else {\n            let data = this._externalContent;\n            state = data.plain ? parseTSV(data.plain) : newState();\n            if (data.html) {\n                let doc = this.iframe.contentWindow.document;\n                doc.open();\n                doc.write(data.html);\n                doc.close();\n                let table = doc.querySelector(\"table\"),\n                    program = doc.head.querySelector(\"meta[name=ProgId]\")?.getAttribute(\"content\");\n                if (table) {\n                    let richState = parseHTML(table, program);\n\n                    // fixup #### values that are sent by Excel when the column is too\n                    // narrow. It turns out that the plain text clipboard data contains the\n                    // actual values. https://github.com/telerik/kendo-ui-core/issues/5277\n                    richState.data.forEach(function(rowData, rowIndex) {\n                        rowData.forEach(function(colData, colIndex) {\n                            if (/^\\s*#+\\s*$/.test(colData.value)) {\n                                colData.value = state.data[rowIndex][colIndex].value;\n                            }\n                        });\n                    });\n                    state = richState;\n                }\n            }\n            this.origin = state.origRef;\n        }\n\n        this._content = state;\n    }\n\n    _isInternal() {\n        if (this._externalContent.html === undefined) {\n            return true;\n        }\n\n        const uid = \"kendo-clipboard-\" + this._uid;\n        const includeUid = tablesArr => tablesArr.some(table => table.includes(uid));\n\n        return includeUid(tables(this._externalContent.html)) || includeUid(tables(this._externalContent.plain));\n    }\n}\n\nfunction newState() {\n    let ref = new CellRef(0, 0, 0);\n    return {\n        ref: ref,\n        mergedCells: [],\n        data: [],\n        foreign: true,\n        origRef: ref.toRangeRef()\n    };\n}\n\nfunction setStateData(state, row, col, value) {\n    let data = state.data || (state.data = []);\n    if (!data[row]) {\n        data[row] = [];\n    }\n    data[row][col] = value;\n    let br = state.origRef.bottomRight;\n    br.row = Math.max(br.row, row);\n    br.col = Math.max(br.col, col);\n}\n\nfunction stripStyle(style) {\n    return style.replace(/^-(?:ms|moz|webkit)-/, \"\");\n}\n\nfunction borderObject(element, styles) {\n    // MS Office uses class name and writes borders in the <style> section, so for it we need to\n    // use the computed styles.  For Google Sheets / LibreOffice, however, the inline styles are\n    // more accurate.\n    if (!element.className) {\n        styles = element.style;\n    }\n    let obj = {};\n    [\n        \"borderBottom\",\n        \"borderRight\",\n        \"borderLeft\",\n        \"borderTop\"\n    ].forEach(function(key) {\n        let width = styles[key + \"Width\"];\n        if (width) {\n            width = parseInt(width, 10);\n        }\n        if (width) {\n            obj[key] = {\n                size: width,\n                color: styles[key + \"Color\"] || \"#000\"\n            };\n        }\n    });\n    return obj;\n}\n\nfunction cellState(row, col, element, hBorders, vBorders, program) {\n    let styles = window.getComputedStyle(element),\n        isExcel = typeof program === \"string\" && program.indexOf(\"Excel\") > -1;\n    let value, format, formula;\n\n    // google sheets\n    if (!isExcel && (value = element.getAttribute(\"data-sheets-value\"))) {\n        value = JSON.parse(value);\n        value = value[value[1]];\n    }\n    if (!isExcel && (format = element.getAttribute(\"data-sheets-numberformat\"))) {\n        format = JSON.parse(format);\n        format = format[format[1]];\n    }\n    formula = element.getAttribute(\"data-sheets-formula\");\n\n    // libre office\n    if (!isExcel && value == null && format == null && formula == null) {\n        value = element.getAttribute(\"sdval\");\n        format = element.getAttribute(\"sdnum\");\n        if (format) {\n            // for ungoogable reasons, libreoffice prepends format strings with\n            // \"1033;\" and sometimes with \"1033;0;\". discard it below.\n            format = format.replace(/^1033;(?:0;)?/, \"\");\n        }\n    }\n\n    // note: Chrome 70 appends a \\t to a cell's text, which is actually mandated by the standard\n    // ([1] item 6).  We remove it below.  In [2] it's suggested they might switch back to\n    // previous behavior, but removing an eventual last TAB won't hurt anyway.\n    //\n    // [1] https://www.w3.org/TR/html53/dom.html#dom-htmlelement-innertext\n    // [2] https://bugs.chromium.org/p/chromium/issues/detail?id=897373\n    if (value == null) {\n        value = (element.innerText || element.textContent).replace(/\\t$/, \"\");\n    }\n\n    let borders = borderObject(element, styles);\n    let state = {\n        value: value === \"\" ? null : value,\n        formula: formula,\n\n        borderTop: borders.borderTop || hBorders.get(row, col) || null,\n        borderBottom: borders.borderBottom || hBorders.get(row + 1, col) || null,\n        borderLeft: borders.borderLeft || vBorders.get(row, col) || null,\n        borderRight: borders.borderRight || vBorders.get(row, col + 1) || null,\n\n        fontSize: parseInt(styles[\"fontSize\"], 10)\n    };\n\n    if (format != null) {\n        state.format = format;\n    }\n\n    hBorders.set(row, col, state.borderTop);\n    hBorders.set(row + 1, col, state.borderBottom);\n    vBorders.set(row, col, state.borderLeft);\n    vBorders.set(row, col + 1, state.borderRight);\n\n    if (styles[\"backgroundColor\"] !== \"rgb(0, 0, 0)\" && styles[\"backgroundColor\"] !== \"rgba(0, 0, 0, 0)\") {\n        state.background = styles[\"backgroundColor\"];\n    }\n    if (stripStyle(styles[\"textAlign\"]) !== \"right\") {\n        state.textAlign = stripStyle(styles[\"textAlign\"]);\n    }\n    if (styles[\"verticalAlign\"] !== \"middle\") {\n        state.verticalAlign = styles[\"verticalAlign\"];\n    }\n    if (styles[\"wordWrap\"] !== \"normal\" ) {\n        state.wrap = true;\n    }\n\n    const txtElem = element.querySelector(\"font\"); // libre office\n    if (txtElem) {\n        styles = window.getComputedStyle(txtElem);\n    }\n\n    if (styles.color !== \"rgb(0, 0, 0)\" && styles.color !== \"rgba(0, 0, 0, 0)\") {\n        state.color = styles.color;\n    }\n    if (/^underline/.test(styles[\"textDecoration\"])) {\n        state.underline = true;\n    }\n    if (styles[\"fontStyle\"] == \"italic\") {\n        state.italic = true;\n    }\n    if (/^(?:bold|[67]00)$/i.test(styles[\"fontWeight\"])) {\n        state.bold = true;\n    }\n\n    return state;\n}\n\nfunction parseHTML(table, program) {\n    let state = newState();\n\n    let done = [], row = 0, col = 0;\n    for (let i = 0; i < table.rows.length; ++i) {\n        done.push([]);\n    }\n    let hBorders = new calc.runtime.Matrix();\n    let vBorders = new calc.runtime.Matrix();\n\n    for (let ri = 0; ri < table.rows.length; ++ri, ++row) {\n        let tr = table.rows[ri];\n        col = 0;\n        for (let ci = 0; ci < tr.cells.length; ++ci) {\n            let td = tr.cells[ci];\n            let rowSpan = td.rowSpan;\n            let colSpan = td.colSpan;\n            while (done[row][col]) {\n                col++;\n            }\n\n            // A cell containing a long text overflowing the next (empty) cell will weirdly be\n            // reported as merged by Excel (has colspan=2).  Then, Excel informatively suggests\n            // us to ignore the colSpan by passing mso-ignore:colspan in the style.  Much thanks!\n            // https://github.com/telerik/kendo-ui-core/issues/3760\n            let style = td.getAttribute(\"style\");\n            let ignoreColspan = /mso-ignore:colspan/.test(style);\n\n            setStateData(state, row, col, cellState(row, col, td, hBorders, vBorders, program));\n            if (rowSpan > 1 || (colSpan > 1 && !ignoreColspan)) {\n                state.mergedCells.push(\n                    new RangeRef(\n                        new CellRef(row, col),\n                        new CellRef(row + rowSpan - 1, col + colSpan - 1)\n                    ).toString());\n            }\n            for (let dr = row + rowSpan; --dr >= row;) {\n                for (let dc = col + colSpan; --dc >= col;) {\n                    if (dr < done.length) {\n                        done[dr][dc] = true;\n                        if (!(dr === row && dc === col)) {\n                            setStateData(state, dr, dc, {});\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    return state;\n}\n\nfunction parseTSV(data) {\n    let state = newState();\n    if (data.indexOf(\"\\t\") === -1 && data.indexOf(\"\\n\") === -1) {\n        setStateData(state, 0, 0, { value: data });\n    } else {\n        let rows = data.split(\"\\n\");\n        for (let ri = 0; ri < rows.length; ri++) {\n            let cols = rows[ri].split(\"\\t\");\n            for (let ci = 0; ci < cols.length; ci++) {\n                setStateData(state, ri, ci, { value: cols[ci] });\n            }\n        }\n    }\n    return state;\n}\n\n/* eslint-disable no-else-return */\n/* eslint-disable consistent-return */\n/* eslint-disable space-before-blocks */\n/* eslint-disable no-implicit-coercion */\n\n\nlet COMMAND_TYPES = {\n    AUTO_FILL: \"autoFill\",\n    CLEAR: \"clear\",\n    CUT: \"cut\",\n    EDIT: \"edit\",\n    PASTE: \"paste\",\n    VALIDATION: \"validation\"\n};\n\nconst noop = () => { /* */ };\n\nclass Command {\n    constructor(options) {\n        this.options = options;\n        this._workbook = options.workbook;\n        this._property = options && options.property;\n        this._state = {};\n    }\n    range(range) {\n        if (range !== undefined) {\n            this._setRange(range);\n        }\n\n        return this._range;\n    }\n    _setRange(range) {\n        this._range = range;\n    }\n    redo() {\n        this.range().select();\n        this.exec();\n    }\n    undo() {\n        this.setState(this._state);\n    }\n    getState() {\n        this._state = this.range().getState(this._property);\n    }\n    setState(state) {\n        this.range().setState(state);\n    }\n    rejectState(validationState) {\n        this.undo();\n        return {\n            title: validationState.title,\n            body: validationState.message,\n            reason: \"error\",\n            type: \"validationError\"\n        };\n    }\n    _forEachCell(callback) {\n        let range = this.range();\n        let ref = range._ref;\n\n        ref.forEach(function(ref) {\n            range.sheet().forEach(ref.toRangeRef(), callback.bind(this));\n        }.bind(this));\n    }\n    usesImage(/* image id from workbook._images */) {\n        return false;\n    }\n}\n\nclass DrawingUpdateCommand extends Command {\n    constructor(options) {\n        super(options);\n        this._sheet = options.sheet;\n        this._drawing = options.drawing;\n        this._orig = this._drawing.clone();\n        this._previous = options.previous;\n    }\n    exec() {}\n    undo() {\n        this._drawing.reset(this._previous);\n        this._sheet._activeDrawing = this._drawing;\n        this._sheet.triggerChange({ layout: true });\n    }\n    redo() {\n        this._drawing.reset(this._orig);\n        this._sheet._activeDrawing = this._drawing;\n        this._sheet.triggerChange({ layout: true });\n    }\n    usesImage(img) {\n        return this._drawing.image === img\n            || this._orig.image === img\n            || this._previous.image === img;\n    }\n}\n\nclass DrawingCommand extends Command {\n    constructor(options) {\n        super(options);\n        this._drawing = options.drawing;\n    }\n    usesImage(img) {\n        return this._drawing.image === img;\n    }\n}\n\nclass InsertImageCommand extends DrawingCommand {\n    constructor(options) {\n        super(options);\n        this._blob = options.blob;\n        this._width = options.width;\n        this._height = options.height;\n    }\n    exec() {\n        let range = this.range();\n        let sheet = range.sheet();\n        let width = this._width;\n        let height = this._height;\n        let aspect = width / height;\n        if (width > height) {\n            width = Math.min(width, 300);\n            height = width / aspect;\n        } else {\n            height = Math.min(height, 300);\n            width = height * aspect;\n        }\n        this._drawing = sheet.addDrawing({\n            topLeftCell: range.topLeft(),\n            offsetX: 5,\n            offsetY: 5,\n            width: width,\n            height: height,\n            opacity: 1,\n            image: this._workbook.addImage(this._blob)\n        }, true);\n        this._blob = null;\n    }\n    undo() {\n        let sheet = this.range().sheet();\n        sheet._activeDrawing = null;\n        sheet.removeDrawing(this._drawing);\n    }\n    redo() {\n        let sheet = this.range().sheet();\n        sheet._activeDrawing = this._drawing;\n        sheet.addDrawing(this._drawing);\n    }\n}\n\nclass DeleteDrawingCommand extends DrawingCommand {\n    exec() {\n        let sheet = this.range().sheet();\n        sheet._activeDrawing = null;\n        sheet.removeDrawing(this._drawing);\n    }\n    undo() {\n        let sheet = this.range().sheet();\n        sheet._activeDrawing = this._drawing;\n        sheet.addDrawing(this._drawing);\n    }\n    redo() {\n        this.exec();\n    }\n}\n\nclass ReorderDrawingsCommand extends DrawingCommand {\n    exec() {\n        let sheet = this.range().sheet();\n        this._origIndex = sheet._drawings.indexOf(this._drawing);\n        sheet._drawings.splice(this._origIndex, 1);\n        this._newIndex = this._reorder();\n        sheet._drawings.splice(this._newIndex, 0, this._drawing);\n        sheet.triggerChange({ drawings: true });\n    }\n    undo() {\n        let sheet = this.range().sheet();\n        sheet._drawings.splice(this._newIndex, 1);\n        sheet._drawings.splice(this._origIndex, 0, this._drawing);\n        sheet.triggerChange({ drawings: true });\n    }\n}\n\nclass BringToFrontCommand extends ReorderDrawingsCommand {\n    _reorder() {\n        return this.range().sheet()._drawings.length;\n    }\n}\n\nclass SendToBackCommand extends ReorderDrawingsCommand {\n    _reorder() {\n        return 0;\n    }\n}\n\nclass TargetValueCommand extends Command {\n    constructor(options) {\n        super(options);\n        this._target = options.target;\n        this._value = options.value;\n    }\n    exec() {\n        this.getState();\n        this.setState(this._value);\n    }\n}\n\nclass ColumnWidthCommand extends TargetValueCommand {\n    getState() {\n        this._state = this.range().sheet().columnWidth(this._target);\n    }\n    setState(state) {\n        this.range().sheet().columnWidth(this._target, state);\n    }\n}\n\nclass RowHeightCommand extends TargetValueCommand {\n    getState() {\n        this._state = this.range().sheet().rowHeight(this._target);\n    }\n    setState(state) {\n        this.range().sheet().rowHeight(this._target, state);\n    }\n}\n\nclass HyperlinkCommand extends Command {\n    constructor(options) {\n        super(options);\n        this._link = options.link;\n    }\n    exec() {\n        let range = this.range();\n        this._prevLink = range.link();\n        this._prevUnderline = range.underline();\n        range.link(this._link);\n        range.underline(true);\n        if (range.value() == null) {\n            this._hasSetValue = true;\n            range.value(this._link);\n        }\n    }\n    undo() {\n        let range = this.range();\n        range.link(this._prevLink);\n        range.underline(this._prevUnderline);\n        if (this._hasSetValue) {\n            range.value(null);\n        }\n    }\n}\n\nclass GridLinesChangeCommand extends TargetValueCommand {\n    getState() {\n        this._state = this._range.sheet().showGridLines();\n    }\n    setState(v) {\n        this._range.sheet().showGridLines(v);\n    }\n}\n\nclass PropertyChangeCommand extends Command {\n    _setRange(range) {\n        Command.prototype._setRange.call(this, range.skipHiddenCells());\n    }\n    constructor(options) {\n        super(options);\n        this._value = options.value;\n    }\n    exec() {\n        let range = this.range();\n        if (range.enable()) {\n            this.getState();\n\n            if (this.options.property === \"format\") {\n                this._workbook.trigger(\"changeFormat\", { range: range });\n            }\n\n            range[this._property](this._value);\n        }\n    }\n}\n\nclass PropertyCleanCommand extends PropertyChangeCommand {\n    exec() {\n        let range = this.range();\n        if (range.enable()) {\n            this.getState();\n            range.clearFormat();\n        }\n    }\n}\n\nclass ClearContentCommand extends Command {\n    exec() {\n        let values = [], range, rowValues, nullValues, validationState, currentRange;\n        if (!this.range().enable()) {\n            return { reason: \"error\", type: \"cannotModifyDisabled\" };\n        }\n        if (!this.range().canEditArrayFormula()) {\n            return { reason: \"error\", type: \"intersectsArray\" };\n        }\n        this.getState();\n        range = this.range().skipHiddenCells();\n\n        if (range._ref.refs && range._ref.refs.length > 1) {\n            range._ref.refs.forEach(function(ref) {\n                currentRange = range.sheet().range(ref);\n                values = values.concat(currentRange.values());\n            });\n        } else {\n            values = range.values();\n        }\n        nullValues = [];\n        values.forEach(function(row) {\n            rowValues = [];\n            row.forEach(function() {\n                rowValues.push(null);\n            });\n            nullValues.push(rowValues);\n        });\n        if (range.sheet().trigger(\"changing\", { data: nullValues, range: range, changeType: COMMAND_TYPES.CLEAR })) {\n            return;\n        }\n        range.clearContent();\n        validationState = range._getValidationState();\n        if (validationState) {\n            return this.rejectState(validationState);\n        }\n    }\n    undo() {\n        let range = this.range().skipHiddenCells();\n        let sheet = range.sheet();\n        let data = this._state.data;\n        let values = [];\n        let rowValues;\n        data.forEach(function(row) {\n            rowValues = [];\n            row.forEach(function(cell) {\n                rowValues.push(cell.value);\n            });\n            values.push(rowValues);\n        });\n        if (sheet.trigger(\"changing\", { data: values, range: range, changeType: COMMAND_TYPES.CLEAR })) {\n            return;\n        }\n        this.setState(this._state);\n    }\n}\n\nclass EditCommand extends PropertyChangeCommand {\n    constructor(options) {\n        options.property = options.property || \"input\";\n        super(options);\n    }\n    _setRange(range) {\n        PropertyChangeCommand.prototype._setRange.apply(this, arguments);\n        this._editRange = this.options.arrayFormula ? range : range.sheet().activeCellSelection();\n    }\n    getState() {\n        this._state = this.range().getState();\n    }\n    exec() {\n        return this.range().sheet().withCultureDecimals(this._exec.bind(this));\n    }\n    undo() {\n        let editRange = this._editRange;\n        let state = this._state;\n        if (editRange.sheet().trigger(\"changing\", { data: state.data[0][0].value, range: editRange, changeType: COMMAND_TYPES.EDIT })) {\n            return;\n        }\n        this.setState(this._state);\n    }\n    _exec() {\n        let arrayFormula = this.options.arrayFormula;\n        let editRange = this._editRange;\n\n        if (!editRange.enable()) {\n            return { reason: \"error\", type: \"rangeDisabled\" };\n        }\n\n        if (!editRange.canEditArrayFormula()) {\n            return { reason: \"error\", type: \"intersectsArray\" };\n        }\n\n        let value = this._value;\n        this.getState();\n        if (this.range().sheet().trigger(\"changing\", { data: value, range: this._editRange, changeType: COMMAND_TYPES.EDIT })) {\n            return;\n        }\n\n        if (this._property === \"value\") {\n            editRange.value(value);\n            return;\n        }\n\n        try {\n            editRange.link(null);\n            if (value === \"\") {\n                editRange.value(null);\n            } else {\n                editRange.input(value, { arrayFormula: arrayFormula });\n                if (/\\n/.test(editRange.value())) {\n                    editRange.wrap(true);\n                }\n            }\n            editRange._adjustRowHeight();\n\n            let validationState = editRange._getValidationState();\n            if (validationState) {\n                return this.rejectState(validationState);\n            }\n        } catch (ex) {\n            if (ex instanceof calc.runtime.ParseError) {\n                return {\n                    title: \"Error in formula\",\n                    body: ex + \"\",\n                    reason: \"error\"\n                };\n            } else {\n                throw ex;\n            }\n        }\n    }\n}\n\nclass InsertCommentCommand extends PropertyChangeCommand {\n    constructor(options) {\n        options.property = \"comment\";\n        super(options);\n    }\n}\n\nclass TextWrapCommand extends PropertyChangeCommand {\n    constructor(options) {\n        options.property = \"wrap\";\n        super(options);\n\n        this._value = options.value;\n    }\n    getState() {\n        let rowHeight = {};\n        this.range().forEachRow(function(range) {\n            let index = range.topLeft().row;\n\n            rowHeight[index] = range.sheet().rowHeight(index);\n        });\n\n        this._state = this.range().getState(this._property);\n        this._rowHeight = rowHeight;\n    }\n    undo() {\n        let sheet = this.range().sheet();\n        let rowHeight = this._rowHeight;\n\n        this.range().setState(this._state);\n\n        for (let row in rowHeight) {\n            sheet.rowHeight(row, rowHeight[row]);\n        }\n    }\n}\n\nclass AdjustDecimalsCommand extends Command {\n    constructor(options) {\n        options.property = \"format\";\n        super(options);\n        this._delta = options.value;\n    }\n    exec() {\n        let sheet = this.range().sheet();\n        let delta = this._delta;\n\n        this.getState();\n\n        sheet.batch(function() {\n            this.range().forEachCell(function(row, col, cell) {\n                let format = cell.format;\n\n                if (!format) {\n                    let value = cell.value;\n                    if (typeof value == \"number\" && /\\./.test(value)) {\n                        format = \"0.\" + String(value).split(\".\")[1].replace(/\\d/g, \"0\");\n                    }\n                }\n\n                if (format || delta > 0) {\n                    format = formatting.adjustDecimals(format || \"0\", delta);\n                    sheet.range(row, col).format(format);\n                }\n            });\n        }.bind(this));\n    }\n}\n\nclass BorderChangeCommand extends Command {\n    constructor(options) {\n        options.property = \"border\";\n        super(options);\n        this._type = options.border;\n        this._style = options.style;\n    }\n    _batch(f) {\n        return this.range().sheet().batch(f, {});\n    }\n    exec() {\n        let self = this;\n\n        if (!self._type) {\n            return;\n        }\n        \n        self.getState();\n        self._batch(function(){\n            self[self._type](self._style);\n        });\n    }\n    noBorders() {\n        this.range().insideBorders(null);\n        this.outsideBorders(null);\n    }\n    allBorders(style) {\n        this.range().insideBorders(style);\n        this.outsideBorders(style);\n    }\n    leftBorder(style) {\n        this.range().leftColumn().borderLeft(style);\n    }\n    rightBorder(style) {\n        this.range().rightColumn().borderRight(style);\n    }\n    topBorder(style) {\n        this.range().topRow().borderTop(style);\n    }\n    bottomBorder(style) {\n        this.range().bottomRow().borderBottom(style);\n    }\n    outsideBorders(style) {\n        let range = this.range();\n        range.leftColumn().borderLeft(style);\n        range.topRow().borderTop(style);\n        range.rightColumn().borderRight(style);\n        range.bottomRow().borderBottom(style);\n    }\n    insideBorders(style) {\n        this.range().insideBorders(style);\n        this.outsideBorders(null);\n    }\n    insideHorizontalBorders(style) {\n        this.range().insideHorizontalBorders(style);\n    }\n    insideVerticalBorders(style) {\n        this.range().insideVerticalBorders(style);\n    }\n}\n\nclass MergeCellCommand extends Command {\n    constructor(options) {\n        super(options);\n        this._type = options.value;\n    }\n    exec() {\n        this.getState();\n        this[this._type]();\n        this.range().sheet().triggerChange({ recalc: true });\n    }\n    activate(ref) {\n        this.range().sheet().activeCell(ref);\n    }\n    getState() {\n        this._state = this.range().getState();\n    }\n    undo() {\n        if (this._type !== \"unmerge\") {\n            this.range().unmerge();\n            this.activate(this.range().topLeft());\n        }\n        this.range().setState(this._state);\n    }\n    cells() {\n        let range = this.range();\n        let ref = range._ref;\n\n        range.merge();\n        this.activate(ref);\n    }\n    horizontally() {\n        let ref = this.range().topRow()._ref;\n\n        this.range().forEachRow(function(range) {\n            range.merge();\n        });\n\n        this.activate(ref);\n    }\n    vertically() {\n        let ref = this.range().leftColumn()._ref;\n\n        this.range().forEachColumn(function(range) {\n            range.merge();\n        });\n\n        this.activate(ref);\n    }\n    unmerge() {\n        let range = this.range();\n        let ref = range._ref.topLeft;\n\n        range.unmerge();\n        this.activate(ref);\n    }\n}\n\nclass FreezePanesCommand extends Command {\n    constructor(options) {\n        super(options);\n        this._type = options.value;\n    }\n    exec() {\n        this.getState();\n        this._topLeft = this.range().topLeft();\n        this[this._type]();\n    }\n    getState() {\n        this._state = this.range().sheet().getState();\n    }\n    undo() {\n        this.range().sheet().setState(this._state);\n    }\n    panes() {\n        let topLeft = this._topLeft;\n        let sheet = this.range().sheet();\n\n        sheet.frozenColumns(topLeft.col).frozenRows(topLeft.row);\n    }\n    rows() {\n        let topLeft = this._topLeft;\n        let sheet = this.range().sheet();\n\n        sheet.frozenRows(topLeft.row);\n    }\n    columns() {\n        let topLeft = this._topLeft;\n        let sheet = this.range().sheet();\n\n        sheet.frozenColumns(topLeft.col);\n    }\n    unfreeze() {\n        let sheet = this.range().sheet();\n        sheet.frozenRows(0).frozenColumns(0);\n    }\n}\n\nclass PasteCommand extends Command {\n    constructor(options) {\n        super(options);\n        this._clipboard = options.workbook.clipboard();\n        this._clipboard.parse();\n        this._event = options.event;\n        this._clipboardContent = this._clipboard._content;\n        this._sheet = this._workbook.activeSheet();\n        this._range = this._sheet.selection ? this._sheet.selection() : this._sheet.range(this._clipboard.pasteRef());\n        this._state = this._range.getState();\n        this._targetRangeRefs = (this._range._ref instanceof UnionRef ? this._range._ref.refs : [this._range._ref]).map(function(ref){\n            return ref.toRangeRef();\n        });\n    }\n    exec() {\n        return this.range().sheet().withCultureDecimals(this._exec.bind(this));\n    }\n    undo() {\n        let sheet = this._sheet;\n        let range = this._range;\n\n        if (sheet.trigger(\"changing\", { data: this._state.data, range: range, changeType: COMMAND_TYPES.PASTE })) {\n            return;\n        }\n\n        this.setState(this._state);\n    }\n    _exec() {\n        let status = this._clipboard.canPaste();\n\n        if (!status.canPaste) {\n            if (status.menuInvoked) {\n                return { reason: \"error\", type: \"useKeyboard\" };\n            }\n            if (status.pasteOnMerged) {\n                return { reason: \"error\", type: \"modifyMerged\" };\n            }\n            if (status.pasteOnDisabled) {\n                this._event.preventDefault();\n                return { reason: \"error\", type: \"cannotModifyDisabled\" };\n            }\n            return { reason: \"error\" };\n        }\n\n        let sheet = this._sheet;\n        let range = this._range;\n\n        if (this._workbook.trigger(\"paste\", { range: range, clipboardContent: this._clipboardContent }) ||\n            sheet.trigger(\"changing\", { data: this._clipboardContent.data, range: range, changeType: COMMAND_TYPES.PASTE })) {\n            this._event.preventDefault();\n            return;\n        } else {\n            this._processPaste();\n        }\n    }\n    _adjustPasteTarget(multipliers, sourceRows, sourceCols) {\n        let that = this;\n        let targetRangeRefs = that._targetRangeRefs;\n        let sheet = that._sheet;\n        let refs = [];\n        let compare = function(a, b) {\n            let result = 0;\n            let topLeftA = a.topLeft;\n            let topLeftB = b.topLeft;\n\n            if (topLeftA.row > topLeftB.row) {\n                result = 1;\n            } else if (topLeftA.row < topLeftB.row) {\n                result = -1;\n            } else if (topLeftA.col > topLeftB.col) {\n                result = 1;\n            } else if (topLeftA.col < topLeftB.col) {\n                result = -1;\n            }\n\n            return result;\n        };\n\n        let refToSelect, rangeToSelect, ref, topLeft, multiplier, i, bottomRight;\n\n        for (i = 0; i < targetRangeRefs.length; i += 1) {\n            ref = targetRangeRefs[i];\n            multiplier = multipliers[i];\n            topLeft = ref.topLeft;\n            bottomRight = {\n                row: multiplier.rows * sourceRows + topLeft.row - 1,\n                col: multiplier.cols * sourceCols + topLeft.col - 1\n            };\n\n            refToSelect = new RangeRef(topLeft, bottomRight);\n            refs.push(refToSelect);\n        }\n\n        if (refs.length === 1) {\n            rangeToSelect = sheet.range(refToSelect);\n        } else {\n            refs.sort(compare);\n            rangeToSelect = sheet.range(new UnionRef(refs));\n        }\n\n        rangeToSelect.select();\n        that._range = rangeToSelect;\n        that._state = that._range.getState();\n    }\n    _processPaste() {\n        let that = this;\n        let sheet = that._sheet;\n        let clipboardContent = that._clipboardContent;\n        let range = that._range;\n        let sourceData = clipboardContent.data;\n        let sourceRows = sourceData.length;\n        let sourceCols = sourceData[0].length;\n        let targetRangeRefs = that._targetRangeRefs;\n        let multipliers = that._targetRanges(sourceRows, sourceCols);\n        let i;\n\n        let pasteRef = this._clipboard.pasteRef();\n        if (pasteRef.bottomRight.row >= sheet._rows._count || pasteRef.bottomRight.col >= sheet._columns._count) {\n            sheet.resize(\n                Math.max(pasteRef.bottomRight.row + 1, sheet._rows._count),\n                Math.max(pasteRef.bottomRight.col + 1, sheet._columns._count)\n            );\n        }\n\n        that._adjustPasteTarget(multipliers, sourceRows, sourceCols);\n\n        sheet.batch(function() {\n            for (i = 0; i < targetRangeRefs.length; i++) {\n                that._populateTargetRange(targetRangeRefs[i], sourceRows, sourceCols, multipliers[i]);\n            }\n        }, {\n            recalc: true,\n            ref: that._range._ref\n        });\n\n        range._adjustRowHeight();\n    }\n    _populateTargetRange(ref, sourceRows, sourceCols, multipliers) {\n        let topLeft = ref.topLeft;\n        let range, i, j;\n\n        for (i = 0; i < multipliers.rows; i++) {\n            for (j = 0; j < multipliers.cols; j++) {\n                range = this._sheet.range(topLeft.row + sourceRows * i, topLeft.col + sourceCols * j);\n                range.setState(this._clipboardContent, this._clipboard);\n            }\n        }\n    }\n    _targetRangeDimensions(ref, sourceRows, sourceCols) {\n        let topLeft = ref.topLeft;\n        let bottomRight = ref.bottomRight;\n        let targetRangeRows = bottomRight.row - topLeft.row + 1;\n        let targetRangeCols = bottomRight.col - topLeft.col + 1;\n        let rowsMultiplier = 1;\n        let colsMultiplier = 1;\n\n        if ((targetRangeRows % sourceRows === 0 && targetRangeCols % sourceCols === 0)) {\n            rowsMultiplier = targetRangeRows / sourceRows;\n            colsMultiplier = targetRangeCols / sourceCols;\n        }\n\n        return {\n            rows: rowsMultiplier,\n            cols: colsMultiplier\n        };\n    }\n    _targetRanges(sourceRows, sourceCols) {\n        let targetRangeRefs = this._targetRangeRefs;\n        let multipliers = [];\n        let i;\n\n        for (i = 0; i < targetRangeRefs.length; i++) {\n            multipliers.push(this._targetRangeDimensions(targetRangeRefs[i], sourceRows, sourceCols));\n        }\n\n        return multipliers;\n    }\n}\n\nclass AdjustRowHeightCommand extends Command {\n    exec() {\n        let options = this.options;\n        let sheet = this._workbook.activeSheet();\n        let range = options.range || sheet.range(options.rowIndex);\n\n        range._adjustRowHeight();\n    }\n}\n\nclass ToolbarPasteCommand extends Command {\n    exec() {\n        if (detectClipboardAccess().paste) {\n            this._workbook._view.clipboard.focus();\n            // explore programmatic pasting further\n            document.execCommand('paste');\n        } else {\n            return { reason: \"error\", type: \"useKeyboard\" };\n        }\n    }\n}\n\nclass CutCommand extends Command {\n    constructor(options) {\n        super(options);\n        this._eventType = \"cut\";\n        this._clipboard = options.workbook.clipboard();\n        this._event = options.event;\n    }\n    exec() {\n        let status = this._clipboard.canCopy();\n        let data = [], rangeValues, currentRow;\n        if (!status.canCopy) {\n            if (status.menuInvoked) {\n                return { reason: \"error\", type: \"useKeyboard\" };\n            } else if (status.multiSelection) {\n                return { reason: \"error\", type: \"unsupportedSelection\" };\n            }\n            return;\n        }\n        let range = this._workbook.activeSheet().selection();\n        if (this._eventType === \"cut\") {\n            if (!range.enable()) {\n                this._event.preventDefault();\n                return { reason: \"error\", type: \"cannotModifyDisabled\" };\n            }\n            this.getState();\n        }\n        if (this._workbook.trigger(this._eventType, { range: range })) {\n            this._event.preventDefault();\n        } else if (this._eventType === \"cut\") {\n            rangeValues = range.values();\n            rangeValues.forEach(function(row){\n                currentRow = [];\n                row.forEach(function(){\n                    currentRow.push({});\n                });\n                data.push(currentRow);\n            });\n            if (range.sheet().trigger(\"changing\", { data: data, range: range, changeType: COMMAND_TYPES.CUT })) {\n                return;\n            }\n            this._clipboard.cut();\n        } else {\n            this._clipboard.copy();\n        }\n    }\n    undo() {\n        let range = this.range();\n        if (range.sheet().trigger(\"changing\", { data: this._state.data, range: range, changeType: COMMAND_TYPES.CUT })) {\n            return;\n        }\n        this.setState(this._state);\n    }\n}\n\nclass CopyCommand extends CutCommand {\n    constructor(options) {\n        super(options);\n        this._eventType = \"copy\";\n        this.undo = noop;\n    }\n}\n\n// function copyToClipboard(html) {\n//     let textarea = document.createElement('textarea');\n//     $(textarea).addClass(\"k-spreadsheet-clipboard\")\n//         .val(html)\n//         .appendTo(document.body)\n//         .trigger(\"focus\")\n//         .select();\n\n//     document.execCommand('copy');\n\n//     $(textarea).remove();\n// }\n\nfunction detectClipboardAccess() {\n    const commands = {\n        copy: document.queryCommandSupported ? document.queryCommandSupported(\"copy\") : false,\n        cut: document.queryCommandSupported ? document.queryCommandSupported(\"cut\") : false,\n        paste: document.queryCommandSupported ? document.queryCommandSupported(\"paste\") : false\n    };\n\n    return commands;\n}\n\nclass ToolbarCopyCommand extends Command {\n    constructor(options) {\n        super(options);\n        this._clipboard = options.workbook.clipboard();\n        this.cannotUndo = true;\n    }\n    exec() {\n        if (detectClipboardAccess().copy) {\n            document.execCommand('copy');\n        } else {\n            return { reason: \"error\", type: \"useKeyboard\" };\n        }\n    }\n}\n\nclass AutoFillCommand extends Command {\n    constructor(options) {\n        super(options);\n    }\n    origin(origin) {\n        this._origin = origin;\n    }\n    exec() {\n        let range = this.range(), autoFillData;\n        if (!range.enable()) {\n            return { reason: \"error\", type: \"rangeDisabled\" };\n        }\n        if (range.intersectingArrayFormula()) {\n            return { reason: \"error\", type: \"intersectsArray\" };\n        }\n        this.getState();\n        try {\n            autoFillData = range._previewFillFrom(this._origin);\n            if (range.sheet().trigger(\"changing\", { data: autoFillData.props, range: autoFillData.dest, changeType: COMMAND_TYPES.AUTO_FILL })) {\n                return;\n            }\n            autoFillData.dest._properties(autoFillData.props, true);\n        } catch (ex) {\n            if (ex instanceof Range$1.FillError) {\n                return { reason: \"error\", type: ex.code };\n            }\n            throw ex;\n        }\n    }\n    undo() {\n        let range = this.range();\n        let state = this._state;\n        if (range.sheet().trigger(\"changing\", { data: state.data, range: range, changeType: COMMAND_TYPES.AUTO_FILL })) {\n            return;\n        }\n        this.setState(this._state);\n    }\n}\n\nclass ToolbarCutCommand extends Command {\n    constructor(options) {\n        super(options);\n        this._clipboard = options.workbook.clipboard();\n        this.cannotUndo = true;\n    }\n    exec() {\n        if (detectClipboardAccess().copy) {\n            document.execCommand('cut');\n        } else {\n            return { reason: \"error\", type: \"useKeyboard\" };\n        }\n    }\n}\n\nclass FilterCommand extends Command {\n    undo() {\n        this.range().filter(this._state);\n    }\n    exec() {\n        let range = this.range();\n        this._state = range.hasFilter();\n        range.filter(!this._state);\n    }\n}\n\nclass SortCommand extends Command {\n    undo() {\n        let sheet = this.range().sheet();\n        sheet.setState(this._state);\n    }\n    exec() {\n        let range = this.range();\n        let sheet = range.sheet();\n        let activeCell = sheet.activeCell();\n        let col = this.options.sheet ? activeCell.topLeft.col : (this.options.column || 0);\n        let ascending = this.options.value === \"asc\" ? true : false;\n\n        this._state = sheet.getState();\n\n        if (this.options.sheet) {\n            range = this.expandRange();\n        }\n\n        let reason = range.cantSort();\n        if (reason) {\n            return { reason: \"error\", type: reason.code };\n        }\n\n        range.sort({ column: col, ascending: ascending });\n    }\n    expandRange() {\n        let sheet = this.range().sheet();\n        return new Range$1(sheet._sheetRef, sheet);\n    }\n}\n\nclass ApplyFilterCommand extends Command {\n    column() {\n        return this.options.column || 0;\n    }\n    undo() {\n        let sheet = this.range().sheet();\n\n        sheet.clearFilter(this.column());\n\n        if (this._state.length) {\n            this.range().filter(this._state);\n        }\n    }\n    getState() {\n        let sheet = this.range().sheet();\n        let current = sheet.filter();\n\n        if (current) {\n            this._state = current.columns.filter(function(c) {\n                return c.index === this.column();\n            }.bind(this));\n        }\n    }\n    exec() {\n        let range = this.range();\n        let column = this.column();\n        let current = range.sheet().filter();\n        let options;\n        let filterRule;\n        let exists = false;\n\n        if (this.options.valueFilter) {\n            filterRule = { column: column, filter: new ValueFilter(this.options.valueFilter) };\n        } else if (this.options.customFilter) {\n            filterRule = { column: column, filter: new CustomFilter(this.options.customFilter) };\n        }\n\n        this.getState();\n\n        if (current && current.ref.eq(range._ref) && current.columns.length) {\n            current.columns.forEach(function(element) {\n                if (element.index === column) {\n                    exists = true;\n                }\n            });\n\n            options = current.columns.map(function(element) {\n                return element.index === column ? filterRule : { column: element.index, filter: element.filter };\n            });\n\n            if (!exists) {\n                options.push(filterRule);\n            }\n        } else {\n            options = filterRule;\n        }\n\n        range.filter(options);\n    }\n}\n\nclass ClearFilterCommand extends ApplyFilterCommand {\n    exec() {\n        let range = this.range();\n        let column = this.column();\n\n        this.getState();\n        range.clearFilter(column);\n    }\n}\n\nclass HideLineCommand extends Command {\n    constructor(options) {\n        super(options);\n        this.axis = options.axis;\n    }\n\n    undo() {\n        let sheet = this.range().sheet();\n        sheet.setAxisState(this._state);\n    }\n\n    exec() {\n        let sheet = this.range().sheet();\n        this._state = sheet.getAxisState();\n\n        if (this.axis === \"row\") {\n            sheet.axisManager().hideSelectedRows();\n        } else {\n            sheet.axisManager().hideSelectedColumns();\n        }\n    }\n}\n\nclass UnHideLineCommand extends HideLineCommand {\n    exec() {\n        let sheet = this.range().sheet();\n        this._state = sheet.getAxisState();\n\n        if (this.axis === \"row\") {\n            sheet.axisManager().unhideSelectedRows();\n        } else {\n            sheet.axisManager().unhideSelectedColumns();\n        }\n    }\n}\n\nclass DeleteCommand extends Command {\n    exec() {\n        this._expandedRange = this._expand(this.range());\n        this._state = this._expandedRange.getState();\n        this._indexes = this._exec(this._expandedRange.sheet());\n    }\n    undo() {\n        let self = this;\n        let range = self._expandedRange;\n        let sheet = range.sheet();\n        sheet.batch(function(){\n            self._indexes.forEach(function(x){\n                self._undoOne(sheet, x);\n                sheet._restoreModifiedFormulas(x.formulas);\n            });\n            range.setState(self._state);\n        }, { layout: true, recalc: true, ref: range._ref, isValue: true });\n    }\n}\n\nclass DeleteRowCommand extends DeleteCommand {\n    _expand(range) {\n        return range.resize({ left: -Infinity, right: +Infinity });\n    }\n    _exec(sheet) {\n        return sheet.axisManager().deleteSelectedRows();\n    }\n    _undoOne(sheet, x) {\n        sheet.insertRow(x.index);\n        sheet.rowHeight(x.index, x.height);\n    }\n}\n\nclass DeleteColumnCommand extends DeleteCommand {\n    _expand(range) {\n        return range.resize({ top: -Infinity, bottom: +Infinity });\n    }\n    _exec(sheet) {\n        return sheet.axisManager().deleteSelectedColumns();\n    }\n    _undoOne(sheet, x) {\n        sheet.insertColumn(x.index);\n        sheet.columnWidth(x.index, x.width);\n    }\n}\n\nclass AddCommand extends Command {\n    constructor(options) {\n        super(options);\n        this._value = options.value;\n    }\n    undo() {\n        let self = this;\n        let sheet = self.range().sheet();\n        sheet.batch(function(){\n            for (let i = self._pos.count; --i >= 0;) {\n                self._undoOne(sheet, self._pos.base);\n            }\n        }, { layout: true, recalc: true });\n    }\n}\n\nclass AddColumnCommand extends AddCommand {\n    exec() {\n        let value = this._value;\n        let sheet = this.range().sheet();\n\n        if (value === \"left\") {\n            this._pos = sheet.axisManager().addColumnLeft();\n        } else {\n            this._pos = sheet.axisManager().addColumnRight();\n        }\n    }\n    _undoOne(sheet, index) {\n        sheet.deleteColumn(index);\n    }\n}\n\nclass AddRowCommand extends AddCommand {\n    exec() {\n        let value = this._value;\n        let sheet = this.range().sheet();\n\n        if (value === \"above\") {\n            this._pos = sheet.axisManager().addRowAbove();\n        } else {\n            this._pos = sheet.axisManager().addRowBelow();\n        }\n    }\n    _undoOne(sheet, index) {\n        sheet.deleteRow(index);\n    }\n}\n\nclass EditValidationCommand extends Command {\n    constructor(options) {\n        super(options);\n        this._value = options.value;\n    }\n    exec() {\n        let self = this, sheet = self.range().sheet();\n        this.getState();\n        if (sheet.trigger(\"changing\", { data: self._value, range: self.range(), changeType: COMMAND_TYPES.VALIDATION })) {\n            return;\n        }\n        try {\n            sheet.withCultureDecimals(function(){\n                self.range().validation(self._value);\n            });\n        } catch (ex) {\n            if (ex instanceof calc.runtime.ParseError) {\n                return {\n                    title: \"Error in formula\",\n                    body: ex + \"\",\n                    reason: \"error\"\n                };\n            } else {\n                throw ex;\n            }\n        }\n    }\n    undo() {\n        let editRange = this.range();\n        let state = this._state;\n        if (editRange.sheet().trigger(\"changing\", { data: state.data[0][0].validation, range: editRange, changeType: COMMAND_TYPES.VALIDATION })) {\n            return;\n        }\n        this.setState(this._state);\n    }\n}\n\nclass OpenCommand extends Command {\n    constructor(options) {\n        super(options);\n        this.cannotUndo = true;\n    }\n    exec() {\n        let file = this.options.file;\n        if (file.name.match(/.xlsx$/i) === null) {\n            return { reason: \"error\", type: \"openUnsupported\" };\n        }\n\n        let workbook = this.options.workbook;\n        workbook.fromFile(this.options.file);\n\n        let errors = workbook.excelImportErrors;\n        if (errors && errors.length) {\n            workbook._view.openDialog(\"importError\", {\n                errors: errors\n            });\n        }\n    }\n}\n\nclass SaveAsCommand extends Command {\n    constructor(options) {\n        super(options);\n        this.cannotUndo = true;\n    }\n    exec() {\n        let fileName = this.options.name + this.options.extension;\n        if (this.options.extension === \".xlsx\") {\n            return this.options.workbook.saveAsExcel({\n                fileName: fileName\n            });\n        } else if (this.options.extension === \".pdf\") {\n            this.options.workbook.saveAsPDF(deepExtend(this.options.pdf, { workbook: this.options.workbook, fileName: fileName }));\n        }\n    }\n}\n\nclass NameCommand extends Command {\n    constructor(options) {\n        super(options);\n        this._name = options.name;\n        this._value = options.value;\n    }\n    getState() {\n        this._state = this._workbook.nameDefinition(this._name);\n    }\n    setState() {\n        this._workbook.nameDefinition(this._name, this._state);\n        this._workbook.trigger(\"change\", { recalc: true });\n    }\n}\n\nclass DefineNameCommand extends NameCommand {\n    exec() {\n        this.getState();\n        try {\n            this._workbook.defineName(this._name, this._value);\n            this._workbook.trigger(\"change\", { recalc: true });\n        } catch (ex) {\n            return {\n                title: \"Error\",\n                body: ex + \"\",\n                reason: \"error\"\n            };\n        }\n    }\n}\n\nclass DeleteNameCommand extends NameCommand {\n    exec() {\n        this.getState();\n        this._workbook.undefineName(this._name);\n        this._workbook.trigger(\"change\", { recalc: true });\n    }\n}\n\nvar commands = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    AddColumnCommand: AddColumnCommand,\n    AddCommand: AddCommand,\n    AddRowCommand: AddRowCommand,\n    AdjustDecimalsCommand: AdjustDecimalsCommand,\n    AdjustRowHeightCommand: AdjustRowHeightCommand,\n    ApplyFilterCommand: ApplyFilterCommand,\n    AutoFillCommand: AutoFillCommand,\n    BorderChangeCommand: BorderChangeCommand,\n    BringToFrontCommand: BringToFrontCommand,\n    ClearContentCommand: ClearContentCommand,\n    ClearFilterCommand: ClearFilterCommand,\n    ColumnWidthCommand: ColumnWidthCommand,\n    Command: Command,\n    CopyCommand: CopyCommand,\n    CutCommand: CutCommand,\n    DefineNameCommand: DefineNameCommand,\n    DeleteColumnCommand: DeleteColumnCommand,\n    DeleteCommand: DeleteCommand,\n    DeleteDrawingCommand: DeleteDrawingCommand,\n    DeleteNameCommand: DeleteNameCommand,\n    DeleteRowCommand: DeleteRowCommand,\n    DrawingCommand: DrawingCommand,\n    DrawingUpdateCommand: DrawingUpdateCommand,\n    EditCommand: EditCommand,\n    EditValidationCommand: EditValidationCommand,\n    FilterCommand: FilterCommand,\n    FreezePanesCommand: FreezePanesCommand,\n    GridLinesChangeCommand: GridLinesChangeCommand,\n    HideLineCommand: HideLineCommand,\n    HyperlinkCommand: HyperlinkCommand,\n    InsertCommentCommand: InsertCommentCommand,\n    InsertImageCommand: InsertImageCommand,\n    MergeCellCommand: MergeCellCommand,\n    NameCommand: NameCommand,\n    OpenCommand: OpenCommand,\n    PasteCommand: PasteCommand,\n    PropertyChangeCommand: PropertyChangeCommand,\n    PropertyCleanCommand: PropertyCleanCommand,\n    ReorderDrawingsCommand: ReorderDrawingsCommand,\n    RowHeightCommand: RowHeightCommand,\n    SaveAsCommand: SaveAsCommand,\n    SendToBackCommand: SendToBackCommand,\n    SortCommand: SortCommand,\n    TargetValueCommand: TargetValueCommand,\n    TextWrapCommand: TextWrapCommand,\n    ToolbarCopyCommand: ToolbarCopyCommand,\n    ToolbarCutCommand: ToolbarCutCommand,\n    ToolbarPasteCommand: ToolbarPasteCommand,\n    UnHideLineCommand: UnHideLineCommand\n});\n\nclass UndoRedoStack extends Observable {\n    constructor(options) {\n        super();\n        this.options = options;\n        this.events = [ \"undo\", \"redo\" ];\n        this.clear();\n    }\n\n    push(command) {\n        this.stack = this.stack.slice(0, this.currentCommandIndex + 1);\n        this.currentCommandIndex = this.stack.push(command) - 1;\n    }\n    undo() {\n        if (this.canUndo()) {\n            let command = this.stack[this.currentCommandIndex--];\n            command.undo();\n            this.trigger(\"undo\", { command: command });\n        }\n    }\n    redo() {\n        if (this.canRedo()) {\n            let command = this.stack[++this.currentCommandIndex];\n            command.redo();\n            this.trigger(\"redo\", { command: command });\n        }\n    }\n    clear() {\n        this.stack = [];\n        this.currentCommandIndex = -1;\n    }\n    canUndo() {\n        return this.currentCommandIndex >= 0;\n    }\n    canRedo() {\n        return this.currentCommandIndex !== this.stack.length - 1;\n    }\n}\n\n/* eslint-disable no-param-reassign */\n// SAX-style XML parser ====================================================\nlet STRING = String.fromCharCode;\n\n// XXX: add more here?\nlet ENTITIES = {\n    \"amp\": 38,\n    \"lt\": 60,\n    \"gt\": 62,\n    \"quot\": 34,\n    \"apos\": 39,\n    \"nbsp\": 160\n};\n\nfunction CODE(str) {\n    let out = [];\n    for (let i = 0; i < str.length; ++i) {\n        out.push(str.charCodeAt(i));\n    }\n    return out;\n}\n\nfunction UCS2(out, code) {\n    if (code > 0xFFFF) {\n        code -= 0x10000;\n        out.push(code >>> 10 & 0x3FF | 0xD800,\n                    0xDC00 | code & 0x3FF);\n    } else {\n        out.push(code);\n    }\n}\n\nlet START_CDATA = CODE(\"<![CDATA[\");\nlet END_CDATA = CODE(\"]]>\");\nlet END_COMMENT = CODE(\"-->\");\nlet START_COMMENT = CODE(\"!--\");\nlet END_SHORT_TAG = CODE(\"/>\");\nlet END_TAG = CODE(\"</\");\nlet END_DECLARATION = CODE(\"?>\");\nlet QUESTION_MARK = CODE(\"?\");\nlet LESS_THAN = CODE(\"<\");\nlet GREATER_THAN = CODE(\">\");\nlet SEMICOLON = CODE(\";\");\nlet EQUAL = CODE(\"=\");\nlet AMPERSAND = CODE(\"&\");\nlet QUOTE = CODE('\"');\nlet APOSTROPHE = CODE(\"'\");\nlet SHARP = CODE(\"#\");\nlet LOWERCASE_X = CODE(\"x\");\nlet UPPERCASE_X = CODE(\"X\");\n\nlet EXIT = {};\n\nfunction parse$1(data, callbacks) {\n    let index = 0;\n    let stack = [];\n    let object = {\n        is: function(selector) {\n            let i = stack.length, j = selector.length;\n            while (--i >= 0 && --j >= 0) {\n                if (stack[i].$tag !== selector[j] && selector[j] !== \"*\") {\n                    return false;\n                }\n            }\n            return j < 0 ? stack[stack.length - 1] : null;\n        },\n        exit: function() {\n            throw EXIT;\n        },\n        stack: stack\n    };\n\n    function readChar(body) {\n        let code = data[index++];\n        if (!(code & 0xF0 ^ 0xF0)) {// 4 bytes\n            UCS2(body,\n                    ((code & 0x03) << 18) |\n                    ((data[index++] & 0x3F) << 12) |\n                    ((data[index++] & 0x3F) << 6) |\n                    (data[index++] & 0x3F));\n        } else if (!(code & 0xE0 ^ 0xE0)) {// 3 bytes\n            UCS2(body,\n                    ((code & 0x0F) << 12) |\n                    ((data[index++] & 0x3F) << 6) |\n                    (data[index++] & 0x3F));\n        } else if (!(code & 0xC0 ^ 0xC0)) {// 2 bytes\n            UCS2(body,\n                    ((code & 0x1F) << 6) |\n                    (data[index++] & 0x3F));\n        } else {\n            body.push(code);\n        }\n    }\n\n    function croak(msg) {\n        throw new Error(msg + \", at \" + index);\n    }\n\n    function readWhile(pred) {\n        let a = [];\n        while (index < data.length && pred(data[index])) {\n            a.push(data[index++]);\n        }\n        return a;\n    }\n\n    function readAsciiWhile(pred) {\n        return STRING.apply(0, readWhile(pred));\n    }\n\n    function skipWhitespace() {\n        readWhile(isWhitespace);\n    }\n\n    function eat(a) {\n        let save = index;\n        for (let i = 0; i < a.length; ++i) {\n            if (data[index++] !== a[i]) {\n                index = save;\n                return false;\n            }\n        }\n        return a;\n    }\n\n    function skip(code) {\n        if (!eat(code)) {\n            croak(\"Expecting \" + code.join(\", \"));\n        }\n    }\n\n    function isWhitespace(code) {\n        return code === 9 || code === 10 || code === 13 || code === 32;\n    }\n\n    function isDigit(code) {\n        return code >= 48 && code <= 57;\n    }\n\n    function isHexDigit(code) {\n        return (code >= 48 && code <= 57) ||\n                ((code |= 32) >= 97 && code <= 102); // a..f or A..F\n    }\n\n    function isNameStart(code) {\n        return code === 58 ||                      // :\n                code === 95 ||                      // _\n                ((code |= 32) >= 97 && code <= 122); // a..z or A..Z\n    }\n\n    function isName(code) {\n        return code === 45 ||                      // -\n                isDigit(code) ||\n                isNameStart(code);\n    }\n\n    function xmlComment() {\n        let body = [];\n        while (index < data.length) {\n            if (eat(END_COMMENT)) {\n                return call(\"comment\", STRING.apply(0, body));\n            }\n            readChar(body);\n        }\n    }\n\n    function xmlTag() {\n        let name, attrs;\n        if (eat(QUESTION_MARK)) {\n            xmlDecl();\n        } else if (eat(START_COMMENT)) {\n            xmlComment();\n        } else {\n            name = xmlName();\n            attrs = xmlAttrs(name);\n            stack.push(attrs);\n            if (eat(END_SHORT_TAG)) {\n                call(\"enter\", name, attrs, true);\n            } else {\n                skip(GREATER_THAN);\n                call(\"enter\", name, attrs);\n                xmlContent(name);\n                if (name !== xmlName()) {\n                    croak(\"Bad closing tag\");\n                }\n                call(\"leave\", name, attrs);\n                skipWhitespace();\n                skip(GREATER_THAN);\n            }\n            stack.pop();\n        }\n    }\n\n    function xmlContent(name) {\n        let body = [];\n        while (index < data.length) {\n            if (eat(END_TAG)) {\n                return body.length && call(\"text\", STRING.apply(0, body));\n            } else if (eat(START_CDATA)) {\n                while (index < data.length && !eat(END_CDATA)) {\n                    readChar(body);\n                }\n            } else if (eat(LESS_THAN)) {\n                if (body.length) {\n                    call(\"text\", STRING.apply(0, body));\n                }\n                xmlTag();\n                body = [];\n            } else if (eat(AMPERSAND)) {\n                xmlEntity(body);\n            } else {\n                readChar(body);\n            }\n        }\n        croak(\"Unclosed tag \" + name);\n    }\n\n    function xmlName() {\n        if (!isNameStart(data[index])) {\n            croak(\"Expecting XML name\");\n        }\n        return readAsciiWhile(isName);\n    }\n\n    function xmlString() {\n        let quote = eat(QUOTE) || eat(APOSTROPHE);\n        if (!quote) {\n            croak(\"Expecting string\");\n        }\n        let body = [];\n        while (index < data.length) {\n            if (eat(quote)) {\n                return STRING.apply(0, body);\n            } else if (eat(AMPERSAND)) {\n                xmlEntity(body);\n            } else {\n                readChar(body);\n            }\n        }\n        croak(\"Unfinished string\");\n    }\n\n    function xmlEntity(body) {\n        let code;\n        if (eat(SHARP)) {\n            if (eat(LOWERCASE_X) || eat(UPPERCASE_X)) {\n                code = parseInt(readAsciiWhile(isHexDigit), 16);\n            } else {\n                code = parseInt(readAsciiWhile(isDigit), 10);\n            }\n            if (isNaN(code)) {\n                croak(\"Bad numeric entity\");\n            }\n        } else {\n            let name = xmlName();\n            code = ENTITIES[name];\n            if (code === undefined) {\n                croak(\"Unknown entity \" + name);\n            }\n        }\n        UCS2(body, code);\n        skip(SEMICOLON);\n    }\n\n    function xmlDecl() {\n        call(\"decl\", xmlName(), xmlAttrs());\n        skip(END_DECLARATION);\n    }\n\n    function xmlAttrs(name) {\n        let map = { $tag: name };\n        while (index < data.length) {\n            skipWhitespace();\n            let code = data[index];\n            if (code === 63 || code === 62 || code === 47) { // ?, > or /\n                break;\n            }\n            map[xmlName()] = ( skip(EQUAL), xmlString() );\n        }\n        return map;\n    }\n\n    function call(what, thing, arg1, arg2) {\n        let f = callbacks && callbacks[what];\n        if (f) {\n            f.call(object, thing, arg1, arg2);\n        }\n    }\n\n    // skip BOM\n    let tmp = [];\n    readChar(tmp);\n    if (tmp[0] !== 65279) {\n        index = 0;\n    }\n\n    while (index < data.length) {\n        skipWhitespace();\n        skip(LESS_THAN);\n        xmlTag();\n        skipWhitespace();\n    }\n}\n\n// Exports ================================================================\nconst parseXML = function parseXML() {\n    try {\n        return parse$1.apply(this, arguments);\n    } catch (ex) {\n        if (ex !== EXIT) {\n            throw ex;\n        }\n    }\n};\n\nclass Deferred {\r\n    constructor() {\r\n        this._progressHandlers = [];\r\n        this._resolved = false;\r\n        this._rejected = false;\r\n        this.promise = new window.Promise((resolve, reject) => {\r\n            this._resolve = (value) => {\r\n                if (!this._resolved && !this._rejected) {\r\n                    this._resolved = true;\r\n                    resolve(value);\r\n                }\r\n            };\r\n            this._reject = (reason) => {\r\n                if (!this._resolved && !this._rejected) {\r\n                    this._rejected = true;\r\n                    reject(reason);\r\n                }\r\n            };\r\n        });\r\n    }\r\n\r\n    resolve(value) {\r\n        this._resolve(value);\r\n        return this;\r\n    }\r\n\r\n    reject(reason) {\r\n        this._reject(reason);\r\n        return this;\r\n    }\r\n\r\n    notify(value) {\r\n        if (!this._resolved && !this._rejected) {\r\n            this._progressHandlers.forEach(handler => handler(value));\r\n        }\r\n    }\r\n\r\n    progress(callback) {\r\n        this._progressHandlers.push(callback);\r\n        return this;\r\n    }\r\n\r\n    then(onFulfilled, onRejected, onProgress) {\r\n        if (onProgress) {\r\n            this.progress(onProgress);\r\n        }\r\n        return this.promise.then(onFulfilled, onRejected);\r\n    }\r\n\r\n    promise() {\r\n        return this.promise;\r\n    }\r\n}\n\n/* eslint-disable complexity */\n/* eslint-disable camelcase */\n/* eslint-disable key-spacing */\n/* eslint-disable no-nested-ternary */\n/* eslint-disable brace-style */\n/* eslint-disable no-implicit-coercion */\n/* eslint-disable no-loop-func */\n/* eslint-disable no-param-reassign */\n\n// WARNING: removing the following jshint declaration and turning\n// == into === to make JSHint happy will break functionality.\n\nlet MAP_EXCEL_OPERATOR = {\n    // includes only what differs; key is Excel's operator, value\n    // is our operator.\n    greaterThanOrEqual: \"greaterThanOrEqualTo\",\n    lessThanOrEqual: \"lessThanOrEqualTo\"\n};\n\nlet ERROR_LOG = null;\n\nfunction readExcel(file, workbook, deferred) {\n    let reader = new FileReader();\n    reader.onload = async function(e) {\n        JSZip.loadAsync(e.target.result)\n            .then(async zip => await readWorkbook(zip, workbook, deferred));\n    };\n\n    reader.readAsArrayBuffer(file);\n}\n\nlet SEL_CELL = [\"sheetData\", \"row\", \"c\"];\nlet SEL_COL = [\"cols\", \"col\"];\nlet SEL_DEFINED_NAME = [\"definedNames\", \"definedName\"];\nlet SEL_FORMULA = [\"sheetData\", \"row\", \"c\", \"f\"];\nlet SEL_MERGE = [\"mergeCells\", \"mergeCell\"];\nlet SEL_PANE = [\"sheetViews\", \"sheetView\", \"pane\"];\nlet SEL_ROW = [\"sheetData\", \"row\"];\nlet SEL_SELECTION = [\"sheetViews\", \"sheetView\", \"selection\"];\nlet SEL_SHEET = [\"sheets\", \"sheet\"];\nlet SEL_STRING = [\"sheetData\", \"row\", \"c\", \"is\"];\nlet SEL_TEXT = [\"t\"];\nlet SEL_SHARED_STRING = [\"si\"];\nlet SEL_VALUE = [\"sheetData\", \"row\", \"c\", \"v\"];\nlet SEL_VIEW = [\"bookViews\", \"workbookView\"];\nlet SEL_SHEET_VIEW = [\"sheetViews\", \"sheetView\"];\nlet SEL_HYPERLINK = [\"hyperlinks\", \"hyperlink\"];\nlet SEL_PROTECTION = [\"sheetProtection\"];\n\n/* A validation section looks like this:\n    *\n    * <dataValidations count=\"1\">\n    *   <dataValidation type=\"list\" allowBlank=\"1\" showInputMessage=\"1\" showErrorMessage=\"1\" sqref=\"B2\">\n    *     <formula1>$E$2:$E$5</formula1>\n    *   </dataValidation>\n    * </dataValidations>\n    */\nlet SEL_VALIDATION = [\"dataValidations\", \"dataValidation\"];\nlet SEL_VALIDATION_FORMULA1 = [\"dataValidations\", \"dataValidation\", \"formula1\"];\nlet SEL_VALIDATION_FORMULA2 = [\"dataValidations\", \"dataValidation\", \"formula2\"];\n\n/* However, when a validation formula in one sheet references\n    * cells from another sheet, Excel produces this version instead:\n    *\n    * <extLst>\n    *   <ext xmlns:x14=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main\" uri=\"{CCE6A557-97BC-4b89-ADB6-D9C93CAAB3DF}\">\n    *     <x14:dataValidations xmlns:xm=\"http://schemas.microsoft.com/office/excel/2006/main\" count=\"1\">\n    *       <x14:dataValidation type=\"list\" allowBlank=\"1\" showInputMessage=\"1\" showErrorMessage=\"1\">\n    *         <x14:formula1>\n    *           <xm:f>Sheet2!$B$3:$B$6</xm:f>\n    *         </x14:formula1>\n    *         <xm:sqref>B1</xm:sqref>\n    *       </x14:dataValidation>\n    *     </x14:dataValidations>\n    *   </ext>\n    * </extLst>\n    *\n    * I call it the \"insane version\", because that's what it is.\n    * Barring the case that the engineers who produced this horror\n    * were on LSD, the only plausible reason for it is that Microsoft\n    * does not want third party software to be compatible with Excel\n    * (sentiment I've had over and over while working on the\n    * Spreadsheet widget).\n    */\n// XXX: technically, the aliases `x14` and `xm` below could be\n// different, but Excel seems to be hard-coded on these; our\n// parser does not support proper namespaces for now anyway, so\n// hard-coded they are.\nlet SEL_VALIDATION_INSANE = [\"x14:dataValidations\", \"x14:dataValidation\"];\nlet SEL_VALIDATION_SQREF_INSANE = [\"x14:dataValidations\", \"x14:dataValidation\", \"xm:sqref\"];\nlet SEL_VALIDATION_FORMULA1_INSANE = [\"x14:dataValidations\", \"x14:dataValidation\", \"x14:formula1\", \"xm:f\"];\nlet SEL_VALIDATION_FORMULA2_INSANE = [\"x14:dataValidations\", \"x14:dataValidation\", \"x14:formula2\", \"xm:f\"];\n\n// comment selectors (in files like comments1.xml)\nlet SEL_COMMENT = [\"commentList\", \"comment\"];\nlet SEL_AUTHOR = [\"authors\", \"author\"];\nlet SEL_COMMENT_TEXT = [\"t\"];\n\nfunction xl(file) {\n    if (!/^\\//.test(file)) {\n        if (!/^xl\\//.test(file)) {\n            file = \"xl/\" + file;\n        }\n    } else {\n        file = file.substr(1);\n    }\n    return file;\n}\n\nasync function readWorkbook(zip, workbook, progress) {\n    ERROR_LOG = workbook.excelImportErrors = [];\n\n    let strings = await readStrings(zip);\n    let relationships = await readRelationships(zip, \"_rels/workbook.xml\");\n    let theme = await readTheme(zip, relationships.byType.theme[0]);\n    let styles = await readStyles(zip, theme);\n    let items = [];\n    let activeSheet = 0;\n\n    await parse(zip, \"xl/workbook.xml\", {\n        enter: function(tag, attrs) {\n            if (this.is(SEL_SHEET)) {\n                let relId = attrs[\"r:id\"];\n                let file = relationships.byId[relId];\n                let name = attrs.name;\n                let state = attrs.state;\n                let dim = sheetDimensions(relationships.bytes[file]);\n\n                workbook.options.columnWidth = dim.columnWidth || workbook.options.columnWidth;\n                workbook.options.rowHeight = dim.rowHeight || workbook.options.rowHeight;\n\n                items.push({\n                    workbook: workbook,\n                    zip: zip,\n                    strings: strings,\n                    styles: styles,\n                    file: file,\n                    options: {\n                        state: state,\n                        name: name,\n                        rows: Math.max(workbook.options.rows || 0, dim.rows),\n                        columns: Math.max(workbook.options.columns || 0, dim.cols),\n                        columnWidth: dim.columnWidth,\n                        rowHeight: dim.rowHeight\n                    }\n                });\n            } else if (this.is(SEL_VIEW)) {\n                if (attrs.activeTab) {\n                    activeSheet = integer(attrs.activeTab);\n                }\n            }\n        },\n        text: function(text) {\n            let attrs = this.is(SEL_DEFINED_NAME);\n            if (attrs && !(bool(attrs[\"function\"]) || bool(attrs.vbProcedure))) {\n                let localSheetId = attrs.localSheetId;\n                let sheet = null;\n                if (localSheetId != null) {\n                    sheet = items[localSheetId].options.name;\n                }\n                let name = attrs.name;\n                if (name !== \"_xlnm._FilterDatabase\") {\n                    if (sheet) {\n                        name = \"'\" + sheet.replace(/\\'/g, \"\\\\'\") + \"'!\" + name;\n                    }\n                    withErrorLog(sheet, null, function() {\n                        workbook.defineName(name, text, bool(attrs.hidden));\n                    }, \"reading user-defined name: \" + name);\n                }\n            }\n        }\n    });\n\n    let loading = new Deferred();\n    loading.progress(function(args) {\n        if (progress) {\n            progress.notify(args);\n        }\n    })\n    .then(function() {\n        let sheets = workbook.sheets();\n        recalcSheets(sheets);\n\n        workbook.activeSheet(sheets[activeSheet]);\n\n        if (progress) {\n            progress.resolve();\n        }\n    });\n\n    loadSheets(items, workbook, loading);\n}\n\nfunction loadSheets(items, workbook, progress) {\n    let ready = window.Promise.resolve();\n    for (let i = 0; i < items.length; i++) {\n        (function(entry, i) {\n            ready = ready.then(function() {\n                let sheet = workbook.insertSheet(entry.options);\n                sheet.suspendChanges(true);\n\n                let promise = queueSheet(sheet, entry);\n                let args = {\n                    sheet: sheet,\n                    progress: i === 1 ? 1 : (i / (items.length - 1))\n                };\n\n                promise.then(function() {\n                    progress.notify(args);\n                });\n\n                return promise;\n            });\n        })(items[i], i);\n    }\n\n    ready.then(function() {\n        progress.resolve();\n    });\n}\n\nfunction queueSheet(sheet, ctx) {\n    let deferred = new Deferred();\n\n    setTimeout(async function() {\n        await readSheet(ctx.zip, ctx.file, sheet, ctx.strings, ctx.styles);\n        deferred.resolve();\n    }, 0);\n\n    return deferred;\n}\n\nfunction recalcSheets(sheets) {\n    for (let i = 0; i < sheets.length; i++) {\n        sheets[i]\n            .suspendChanges(false)\n            .triggerChange({ recalc: true });\n    }\n}\n\nfunction sheetDimensions(bytes) {\n    let ref, dim = {\n            rows: 0,\n            cols: 0\n        };\n\n    parseXML(bytes, {\n        enter: function(tag, attrs) {\n            if (tag === \"dimension\") {\n                ref = calc.parseReference(attrs.ref);\n                if (ref.bottomRight) {\n                    dim.cols = ref.bottomRight.col + 1;\n                    dim.rows = ref.bottomRight.row + 1;\n                }\n            } else if (tag === \"sheetFormatPr\") {\n                if (attrs.defaultColWidth) {\n                    dim.columnWidth = toColWidth(parseFloat(attrs.defaultColWidth));\n                }\n\n                if (attrs.defaultRowHeight) {\n                    dim.rowHeight = toRowHeight(parseFloat(attrs.defaultRowHeight));\n                }\n            } else if (this.is(SEL_ROW) && attrs.r) {\n                dim.rows = Math.max(dim.rows, +attrs.r);\n            } else if (this.is(SEL_CELL) && attrs.r) {\n                ref = calc.parseReference(attrs.r);\n                dim.rows = Math.max(dim.rows, ref.row + 1);\n                dim.cols = Math.max(dim.cols, ref.col + 1);\n            }\n        }\n    });\n\n    return dim;\n}\n\nfunction toColWidth(size) {\n    // No font to compute agains, hence the magic number\n    let maximumDigitWidth = 7;\n\n    // The formula below is taken from the OOXML spec\n    let fraction = (256 * size + Math.floor(128 / maximumDigitWidth)) / 256;\n    return fraction * maximumDigitWidth;\n}\n\nfunction toRowHeight(pts) {\n    return pts * (4 / 3);\n}\n\nasync function readSheet(zip, file, sheet, strings, styles) {\n    let sharedFormulas = {};\n    let ref, type, value, formula, formulaRange, isArrayFormula;\n    let nCols = sheet._columns._count;\n    let prevCellRef = null;\n    let relsFile = file.replace(/worksheets\\//, \"worksheets/_rels/\");\n    let relationships = await readRelationships(zip, relsFile);\n    let formula1, formula2;\n\n    let filterRef;\n    let filterColumn;\n    let customFilterLogic;\n    let customFilterCriteria;\n    let valueFilterBlanks;\n    let valueFilterValues;\n    let filters = [];\n    let deferredStyles = [];\n\n    ERROR_LOG = sheet._workbook.excelImportErrors;\n\n    file = xl(file);\n\n    await parse(zip, file, {\n        enter: function(tag, attrs, closed) {\n            let tmp;\n            if (this.is(SEL_FORMULA)) {\n                if (closed) {\n                    if (attrs.t === \"shared\" && attrs.si != null) {\n                        formula = sheet.range(sharedFormulas[attrs.si])._get(\"formula\");\n                    }\n                }\n            } else if (this.is(SEL_CELL)) {\n                value = null;\n                formula = null;\n                ref = attrs.r;\n                formulaRange = null;\n\n                if (ref == null) {\n                    // apparently some tools omit the `r` for\n                    // consecutive cells in a row, so we'll figure\n                    // it out from the previous cell's reference.\n                    // XXX: this could be slightly optimized by\n                    // keeping it parsed instead of stringifying\n                    // it to parse it again later.\n                    ref = calc.parseReference(prevCellRef);\n                    ref.col++;\n                    ref = ref.toString();\n                }\n                prevCellRef = ref;\n\n                // XXX: can't find no type actually, so everything is\n                // interpreted as string.  Additionally, cells having\n                // a formula will contain both <f> and <v> nodes,\n                // which makes the value take precedence because it's\n                // the second node; hence, the hack is to keep note of\n                // them in the `text` handler, and apply the\n                // appropriate one in the `leave` handler below.\n                type = attrs.t;\n\n                let styleIndex = attrs.s;\n                if (styleIndex != null) {\n                    deferredStyles.push({ ref: ref,  sty: +styleIndex });\n                }\n            } else if (this.is(SEL_MERGE)) {\n                sheet.range(attrs.ref).merge();\n            } else if (this.is(SEL_COL)) {\n                let start = integer(attrs.min) - 1;\n                let stop = Math.min(nCols, integer(attrs.max)) - 1;\n                let width;\n                if (attrs.width) {\n                    width = toColWidth(parseFloat(attrs.width));\n                    if (width !== 0) {\n                        sheet._columns.values.value(start, stop, width);\n                    }\n                }\n                if (attrs.hidden === \"1\" || width === 0) {\n                    for (let ci = start; ci <= stop; ci++) {\n                        sheet.hideColumn(ci);\n                    }\n                }\n                if (attrs.style != null) {\n                    // apply style on a whole range of columns\n                    deferredStyles.unshift({\n                        ref: new RangeRef(\n                            new CellRef(-Infinity, start),\n                            new CellRef(+Infinity, stop)\n                        ),\n                        sty: +attrs.style\n                    });\n                }\n            } else if (this.is(SEL_ROW)) {\n                let row = integer(attrs.r) - 1;\n                let height;\n                if (attrs.ht) {\n                    height = toRowHeight(parseFloat(attrs.ht));\n                    if (height !== 0) {\n                        sheet._rows.values.value(row, row, height);\n                    }\n                }\n                if (attrs.hidden === \"1\" || height === 0) {\n                    sheet.hideRow(row);\n                }\n            } else if (this.is(SEL_SELECTION)) {\n                if (attrs.activeCell) {\n                    let acRef = calc.parseReference(attrs.activeCell);\n                    sheet.select(acRef, true);\n                }\n            } else if (this.is(SEL_PANE)) {\n                if (attrs.state && attrs.state.indexOf(\"frozen\") > -1) {\n                    if (attrs.xSplit) {\n                        sheet.frozenColumns(integer(attrs.xSplit));\n                    }\n\n                    if (attrs.ySplit) {\n                        sheet.frozenRows(integer(attrs.ySplit));\n                    }\n                }\n            } else if (this.is(SEL_SHEET_VIEW)) {\n                sheet.showGridLines(bool(attrs.showGridLines, true));\n            } else if (this.is(SEL_HYPERLINK)) {\n                let relId = attrs[\"r:id\"];\n                let target = relationships.byId[relId];\n                if (target) {\n                    sheet.range(attrs.ref).link(target);\n                }\n            } else if (this.is(SEL_PROTECTION)) {\n                if (attrs.sheet) {\n                    sheet.range(SHEETREF).enable(false);\n                }\n            } else if (this.is([\"autoFilter\"])) {\n                filterRef = attrs.ref;\n                if (closed) {\n                    addAutoFilter();\n                }\n            } else if (filterRef) {\n                if (this.is([\"filterColumn\"])) {\n                    filterColumn = parseInt(attrs.colId, 10);\n                } else if (this.is([\"customFilters\"])) {\n                    customFilterLogic = bool(attrs.and) ? \"and\" : \"or\";\n                    customFilterCriteria = [];\n                } else if (this.is([\"customFilter\"])) {\n                    tmp = getCustomFilter(attrs.operator, attrs.val);\n                    if (tmp) {\n                        customFilterCriteria.push({\n                            operator: tmp.operator,\n                            value: tmp.value\n                        });\n                    }\n                } else if (this.is([\"dynamicFilter\"])) {\n                    filters.push({\n                        column: filterColumn,\n                        filter: new DynamicFilter({\n                            type: dynamicFilterType(attrs.type)\n                        })\n                    });\n                }\n                else if (this.is([\"top10\"])) {\n                    filters.push({\n                        column: filterColumn,\n                        filter: new TopFilter({\n                            value: getFilterVal(attrs.val),\n                            type: (function(percent, top) {\n                                return percent && top ? \"topPercent\"\n                                    : top ? \"topNumber\"\n                                    : percent ? \"bottomPercent\"\n                                    : \"bottomNumber\";\n                            })(bool(attrs.percent), bool(attrs.top))\n                        })\n                    });\n                }\n                else if (this.is([\"filters\"])) {\n                    valueFilterBlanks = bool(attrs.blank);\n                    valueFilterValues = [];\n                }\n                else if (this.is([\"filter\"])) {\n                    valueFilterValues.push(getFilterVal(attrs.val));\n                }\n            }\n        },\n        leave: function(tag, attrs) {\n            if (this.is(SEL_FORMULA)) {\n                if (!formula && attrs.t === \"shared\" && attrs.si != null) {\n                    formula = sheet.range(sharedFormulas[attrs.si])._get(\"formula\");\n                }\n            }\n            else if (this.is(SEL_CELL)) {\n                if (formula != null) {\n                    let failed = withErrorLog(sheet, formulaRange || ref, function() {\n                        sheet.range(formulaRange || ref).formula(formula, isArrayFormula);\n                    }, \"parsing formula\");\n                    if (failed) {\n                        sheet.range(formulaRange || ref).value(formula)\n                            .background(\"#ffaaaa\");\n                    }\n                } else if (value != null) {\n                    let range = sheet.range(ref);\n\n                    if (!range._get(\"formula\")) {\n                        // Check for \"shared\" formulas before applying a value.\n                        if (!type || type === \"n\") {\n                            value = parseFloat(value);\n                        } else if (type === \"s\") {\n                            value = strings[integer(value)];\n                        } else if (type === \"b\") {\n                            value = value === \"1\";\n                        } else if (type === \"d\") {\n                            value = intl().parseDate(value);\n                        }\n\n                        if (value != null) {\n                            range.value(value);\n                        }\n                    }\n                }\n            } else if (this.is(SEL_VALIDATION) ||\n                        this.is(SEL_VALIDATION_INSANE)) {\n                (function() {\n                    let refs = calc.parseSqref(attrs.sqref);\n                    let type = attrs.type.toLowerCase();\n                    let operator = attrs.operator;\n                    if (/^(?:whole|decimal)$/.test(type)) {\n                        // we only support \"number\"\n                        type = \"number\";\n                    } else if (type === \"list\") {\n                        // there'll be no operator from Excel for lists\n                        operator = \"list\";\n                    }\n                    if (!operator && /^(?:number|date)$/.test(type)) {\n                        // Excel skips setting the operator for\n                        // \"between\", because why not.\n                        operator = \"between\";\n                    }\n                    refs.forEach(function(ref) {\n                        withErrorLog(sheet, ref, function() {\n                            sheet.range(ref).validation({\n                                type             : bool(attrs.showErrorMessage, true) ? \"reject\" : \"warning\",\n                                from             : formula1,\n                                to               : formula2,\n                                dataType         : type,\n                                comparerType     : MAP_EXCEL_OPERATOR[operator] || operator,\n                                allowNulls       : bool(attrs.allowBlank),\n                                showButton       : bool(attrs.showDropDown) || type === \"date\" || type === \"list\",\n                                messageTemplate  : attrs.error,\n                                titleTemplate    : attrs.errorTitle\n                            });\n                        }, \"parsing validation\");\n                    });\n                })();\n            } else if (tag === \"cols\") {\n                sheet._columns._refresh();\n            } else if (tag === \"sheetData\") {\n                sheet._rows._refresh();\n            } else if (tag === \"autoFilter\") {\n                addAutoFilter();\n            } else if (filterRef) {\n                if (tag === \"customFilters\") {\n                    filters.push({\n                        column: filterColumn,\n                        filter: new CustomFilter({\n                            logic: customFilterLogic,\n                            criteria: customFilterCriteria\n                        })\n                    });\n                } else if (tag === \"filters\") {\n                    filters.push({\n                        column: filterColumn,\n                        filter: new ValueFilter({\n                            values: valueFilterValues,\n                            blanks: valueFilterBlanks\n                        })\n                    });\n                }\n            }\n        },\n        text: function(text) {\n            let attrs;\n            if (this.is(SEL_VALUE) || this.is(SEL_STRING)) {\n                value = text;\n            } else if ((attrs = this.is(SEL_FORMULA))) {\n                formula = text;\n                isArrayFormula = attrs.t === \"array\";\n                if (isArrayFormula) {\n                    formulaRange = attrs.ref;\n                } else if (attrs.t === \"shared\") {\n                    sharedFormulas[attrs.si] = ref;\n                }\n            } else if (this.is(SEL_VALIDATION_FORMULA1) ||\n                        this.is(SEL_VALIDATION_FORMULA1_INSANE)) {\n                formula1 = text;\n            } else if (this.is(SEL_VALIDATION_FORMULA2) ||\n                        this.is(SEL_VALIDATION_FORMULA2_INSANE)) {\n                formula2 = text;\n            } else if (this.is(SEL_VALIDATION_SQREF_INSANE)) {\n                // put it in <dataValidation>'s attributes where it should be\n                this.stack[this.stack.length - 2].sqref = text;\n            }\n        }\n    });\n\n    deferredStyles.forEach(({ ref, sty }) => applyStyle(sheet, ref, styles, sty));\n\n    if (relationships.byType.comments) {\n        let commentFile = relative_file(file, relationships.byType.comments[0]);\n        await readComments(zip, commentFile, sheet);\n    }\n\n    if (relationships.byType.drawing) {\n        let drawingFile = relative_file(file, relationships.byType.drawing[0]);\n        await readDrawings(zip, drawingFile, sheet);\n    }\n\n    function addAutoFilter() {\n        sheet.range(filterRef).filter(filters);\n        filterRef = null;\n    }\n}\n\nfunction getContentType(filename) {\n    let m = /\\.([^.]+)$/.exec(filename);\n    if (m && m[1]) {\n        return {\n            jpg  : \"image/jpeg\",\n            jpeg : \"image/jpeg\",\n            png  : \"image/png\",\n            gif  : \"image/gif\",\n            wmf  : \"image/wmf\"\n        }[m[1].toLowerCase()];\n    }\n}\n\nfunction getFileName(filename) {\n    let m = /[^/]+$/.exec(filename);\n    return m && m[0];\n}\n\nasync function readDrawings(zip, file, sheet) {\n    let sel_two_cell_anchor = [ \"xdr:twoCellAnchor\" ];\n    let sel_ext = [ \"xdr:ext\" ];\n    let sel_one_cell_anchor = [ \"xdr:oneCellAnchor\" ];\n    let sel_from = [ \"xdr:from\" ];\n    let sel_to = [ \"xdr:to\" ];\n    let sel_row = [ \"xdr:row\" ];\n    let sel_col = [ \"xdr:col\" ];\n    let sel_row_offset = [ \"xdr:rowOff\" ];\n    let sel_col_offset = [ \"xdr:colOff\" ];\n    let sel_blip = [ \"xdr:blipFill\", \"a:blip\" ];\n\n    let relsFile = file.replace(/drawings\\//, \"drawings/_rels/\");\n    let relationships = await readRelationships(zip, relsFile);\n\n    if (relationships.byType.image) {\n        let relkeys = Object.keys(relationships.byId);\n        for (let i = 0; i < relkeys.length; ++i) {\n            let id = relkeys[i];\n            let img = relative_file(file, relationships.byId[id]);\n            let type = getContentType(img);\n\n            if (type) {\n                let data = await zip.file(img).async(\"arraybuffer\");\n                let name = getFileName(img);\n                let blob = name && !(browser.edge)\n                    ? new window.File([ data ], name, { type: type })\n                    : new window.Blob([ data ], { type: type });\n                relationships.byId[id] = sheet._workbook.addImage(blob);\n            }\n        }\n    }\n\n    let cdr, ref, width, height;\n    await parse(zip, file, {\n        enter: function(tag, attrs) {\n            if (this.is(sel_two_cell_anchor) || this.is(sel_one_cell_anchor)) {\n                cdr = {};\n            }\n            else if (this.is(sel_from) || this.is(sel_to)) {\n                ref = {};\n            }\n            else if (this.is(sel_blip)) {\n                let id = attrs[\"r:embed\"];\n                cdr.image = relationships.byId[id];\n            }\n            else if (this.is(sel_ext)) {\n                width = excelToPixels(parseFloat(attrs.cx));\n                height = excelToPixels(parseFloat(attrs.cy));\n            }\n        },\n        leave: function() {\n            if (this.is(sel_from)) {\n                cdr.topLeftCell = new CellRef(ref.row, ref.col);\n                cdr.offsetX = excelToPixels(ref.colOffset);\n                cdr.offsetY = excelToPixels(ref.rowOffset);\n            }\n            else if (this.is(sel_to)) {\n                cdr.brCell = new CellRef(ref.row, ref.col);\n                cdr.brX = excelToPixels(ref.colOffset);\n                cdr.brY = excelToPixels(ref.rowOffset);\n            }\n            // Add drawing only when it is image\n            else if (this.is(sel_two_cell_anchor) && cdr.image) {\n                let left = sheet._columns.sum(0, cdr.topLeftCell.col - 1) + cdr.offsetX;\n                let top = sheet._rows.sum(0, cdr.topLeftCell.row - 1) + cdr.offsetY;\n                let right = sheet._columns.sum(0, cdr.brCell.col - 1) + cdr.brX;\n                let bottom = sheet._rows.sum(0, cdr.brCell.row - 1) + cdr.brY;\n\n                sheet.addDrawing({\n                    topLeftCell : cdr.topLeftCell,\n                    offsetX     : cdr.offsetX,\n                    offsetY     : cdr.offsetY,\n                    width       : width != null ? width : right - left,\n                    height      : height != null ? height : bottom - top,\n                    image       : cdr.image,\n                    opacity     : 1\n                });\n            }\n            // Add drawing only when it is image\n            else if (this.is(sel_one_cell_anchor) && cdr.image) {\n                sheet.addDrawing({\n                    topLeftCell : cdr.topLeftCell,\n                    offsetX     : cdr.offsetX,\n                    offsetY     : cdr.offsetY,\n                    width       : width,\n                    height      : height,\n                    image       : cdr.image,\n                    opacity     : 1\n                });\n            }\n        },\n        text: function(text) {\n            if (this.is(sel_row)) {\n                ref.row = parseFloat(text);\n            }\n            else if (this.is(sel_col)) {\n                ref.col = parseFloat(text);\n            }\n            else if (this.is(sel_row_offset)) {\n                ref.rowOffset = parseFloat(text);\n            }\n            else if (this.is(sel_col_offset)) {\n                ref.colOffset = parseFloat(text);\n            }\n        }\n    });\n}\n\nasync function readComments(zip, file, sheet) {\n    let authors = [];\n    let author;\n    let comment;\n    await parse(zip, file, {\n        enter: function(tag, attrs) {\n            if (this.is(SEL_COMMENT)) {\n                comment = {\n                    author: authors[attrs.authorId],\n                    ref: attrs.ref,\n                    text: \"\"\n                };\n            } else if (this.is(SEL_AUTHOR)) {\n                author = \"\";\n            }\n        },\n        leave: function() {\n            if (this.is(SEL_COMMENT)) {\n                sheet.range(comment.ref).comment(comment.text);\n            } else if (this.is(SEL_AUTHOR)) {\n                authors.push(author);\n            }\n        },\n        text: function(text) {\n            if (this.is(SEL_COMMENT_TEXT)) {\n                comment.text += text;\n            } else if (this.is(SEL_AUTHOR)) {\n                author += text;\n            }\n        }\n    });\n}\n\nfunction getCustomFilter(op, value) {\n    let ourOp = {\n        equal               : \"eq\",\n        notEqual            : \"ne\",\n        greaterThan         : \"gt\",\n        greaterThanOrEqual  : \"gte\",\n        lessThan            : \"lt\",\n        lessThanOrEqual     : \"lte\"\n    }[op];\n\n    value = getFilterVal(value);\n\n    if (ourOp && typeof value == \"number\") {\n        return { operator: ourOp, value: value };\n    }\n\n    if ((op === \"notEqual\" || !op) && typeof value == \"string\") {\n        // Excel text operators support * and ? wildcards.  Since\n        // our startswith/endswith/contains filters do not, we\n        // can't really use them here, so we'll apply the more\n        // generic \"matches\" and \"doesnotmatch\" filters.\n        return {\n            operator: op ? \"doesnotmatch\" : \"matches\",\n            value: value\n        };\n    }\n}\n\nfunction dynamicFilterType(type) {\n    return {\n        Q1  : \"quarter1\",\n        Q2  : \"quarter2\",\n        Q3  : \"quarter3\",\n        Q4  : \"quarter4\",\n        M1  : \"january\",\n        M2  : \"february\",\n        M3  : \"march\",\n        M4  : \"april\",\n        M5  : \"may\",\n        M6  : \"june\",\n        M7  : \"july\",\n        M8  : \"august\",\n        M9  : \"september\",\n        M10 : \"october\",\n        M11 : \"november\",\n        M12 : \"december\"\n    }[type.toUpperCase()] || type;\n}\n\nfunction getFilterVal(val) {\n    let tmp = parseFloat(val);\n    if (!isNaN(tmp) && tmp === val) {\n        return tmp;\n    }\n    return val;\n}\n\nfunction withErrorLog(sheet, ref, func, context) {\n    try {\n        func();\n        return false;\n    } catch (ex) {\n        let err = { context: context, error: String(ex) };\n        if (sheet && sheet.name) {\n            err.sheet = sheet.name();\n        } else if (sheet) {\n            err.sheet = sheet;\n        }\n        if (ref) {\n            err.location = String(ref);\n        }\n        ERROR_LOG.push(err);\n        return true;\n    }\n}\n\nlet BORDER_WIDTHS = {\n    \"none\"            : 0,\n    \"thin\"            : 1,\n    \"medium\"          : 2,\n    \"dashed\"          : 1,\n    \"dotted\"          : 1,\n    \"thick\"           : 3,\n    \"double\"          : 3,\n    \"hair\"            : 1,\n    \"mediumDashed\"    : 2,\n    \"dashDot\"         : 1,\n    \"mediumDashDot\"   : 2,\n    \"dashDotDot\"      : 1,\n    \"mediumDashDotDot\": 2,\n    \"slantDashDot\"    : 1\n};\n\nlet DEFAULT_FORMATS = {\n    0  : \"General\",\n    1  : \"0\",\n    2  : \"0.00\",\n    3  : \"#,##0\",\n    4  : \"#,##0.00\",\n    9  : \"0%\",\n    10 : \"0.00%\",\n    11 : \"0.00E+00\",\n    12 : \"# ?/?\",\n    13 : \"# ??/??\",\n    14 : \"mm-dd-yy\",\n    15 : \"d-mmm-yy\",\n    16 : \"d-mmm\",\n    17 : \"mmm-yy\",\n    18 : \"h:mm AM/PM\",\n    19 : \"h:mm:ss AM/PM\",\n    20 : \"h:mm\",\n    21 : \"h:mm:ss\",\n    22 : \"m/d/yy h:mm\",\n    37 : \"#,##0 ;(#,##0)\",\n    38 : \"#,##0 ;[Red](#,##0)\",\n    39 : \"#,##0.00;(#,##0.00)\",\n    40 : \"#,##0.00;[Red](#,##0.00)\",\n    45 : \"mm:ss\",\n    46 : \"[h]:mm:ss\",\n    47 : \"mmss.0\",\n    48 : \"##0.0E+0\",\n    49 : \"@\"\n};\n\nfunction applyStyle(sheet, ref, styles, styleIndex) {\n    let range = sheet.range(ref);\n    let xf = styles.inlineStyles[styleIndex], base, value;\n    if (xf.xfId) {\n        base = styles.namedStyles[xf.xfId];\n    }\n    if (shouldSet(\"applyBorder\", \"borderId\")) {\n        setBorder(styles.borders[value]);\n    }\n    if (shouldSet(\"applyFont\", \"fontId\")) {\n        setFont(styles.fonts[value]);\n    }\n    if (shouldSet(\"applyAlignment\", \"textAlign\")) {\n        range.textAlign(value);\n    }\n    if (shouldSet(\"applyAlignment\", \"verticalAlign\")) {\n        range.verticalAlign(value);\n    }\n    if (shouldSet(\"applyAlignment\", \"indent\")) {\n        range.indent(value);\n    }\n    if (shouldSet(\"applyAlignment\", \"wrapText\")) {\n        // don't use range.wrap to avoid recomputing row height\n        range._property(\"wrap\", value);\n    }\n    if (shouldSet(\"applyFill\", \"fillId\")) {\n        setFill(styles.fills[value]);\n    }\n    if (shouldSet(\"applyNumberFormat\", \"numFmtId\")) {\n        setFormat(styles.numFmts[value] || DEFAULT_FORMATS[value]);\n    }\n    if (shouldSet(\"applyProtection\", \"protection\")) {\n        range.enable(!xf.protection.locked);\n    }\n\n    function setFormat(f) {\n        let format = typeof f == \"string\" ? f : f.formatCode;\n        if (format != null && !/^general$/i.test(format)) {\n            // XXX: drop locale info.\n            // http://stackoverflow.com/questions/894805/excel-number-format-what-is-409\n            // not supported by the formatting library.\n            format = format.replace(/^\\[\\$-[0-9]+\\]/, \"\");\n            range.format(format);\n        }\n    }\n\n    function setFill(f) {\n        if (f.type === \"solid\") {\n            range.background(f.color);\n        }\n    }\n\n    function setFont(f) {\n        range.fontFamily(f.name);\n        //range.fontSize(f.size); //XXX: will recalc row height.\n        // converting from points to pixels\n        if (f.size) {\n            range._property(\"fontSize\", f.size * 4 / 3);\n        }\n        if (f.bold) {\n            range.bold(true);\n        }\n        if (f.italic) {\n            range.italic(true);\n        }\n        if (f.underline) {\n            range.underline(true);\n        }\n        if (f.color) {\n            range.color(f.color);\n        }\n    }\n\n    function setBorder(b) {\n        function set(side, prop) {\n            let border = b[side];\n            if (!border) {\n                return;\n            }\n\n            let width = BORDER_WIDTHS[border.style];\n            if (!width) {\n                return;\n            }\n\n            let color = border.color;\n            if (color == null) {\n                color = \"#000\";\n            }\n\n            let value = { size: width, color: color };\n            if (side === \"diagonal\") {\n                value.type = border.up << 1 | border.down;\n            }\n\n            range._property(prop, value);\n        }\n\n        set(\"left\", \"borderLeft\");\n        set(\"top\", \"borderTop\");\n        set(\"right\", \"borderRight\");\n        set(\"bottom\", \"borderBottom\");\n        set(\"diagonal\", \"dBorders\");\n    }\n\n    function shouldSet(applyName, propName) {\n        let t = xf[applyName];\n        if (t != null && !t) {\n            return false;\n        }\n        value = xf[propName];\n        if (base && value == null) {\n            t = base[applyName];\n            if (t != null && !t) {\n                return false;\n            }\n            value = base[propName];\n        }\n        return value != null;\n    }\n}\n\nfunction parse(zip, file, callbacks) {\n    return new window.Promise(resolve => {\n        let obj = zip.file(file);\n        if (obj) {\n            obj.async(\"uint8array\").then(bytes => {\n                parseXML(bytes, callbacks);\n                resolve();\n            });\n        } else {\n            resolve();\n        }\n    });\n}\n\nasync function readStrings(zip) {\n    let strings = [];\n    let current = null;\n    await parse(zip, \"xl/sharedStrings.xml\", {\n        leave: function() {\n            if (this.is(SEL_SHARED_STRING)) {\n                strings.push(current);\n                current = null;\n            }\n        },\n        text: function(text) {\n            if (this.is(SEL_TEXT)) {\n                if (current == null) {\n                    current = \"\";\n                }\n                current += text;\n            }\n        }\n    });\n    return strings;\n}\n\nasync function readRelationships(zip, file) {\n    let map = { byId: {}, byType: { theme: [] }, bytes: {} };\n    await parse(zip, xl(file) + \".rels\", {\n        enter: function(tag, attrs) {\n            if (tag === \"Relationship\") {\n                map.byId[attrs.Id] = attrs.Target;\n\n                let type = attrs.Type.match(/\\w+$/)[0];\n                let entries = map.byType[type] || [];\n                entries.push(attrs.Target);\n                map.byType[type] = entries;\n            }\n        }\n    });\n    let names = [];\n    let promises = [];\n    Object.keys(map.byId).forEach(id => {\n        let filename = map.byId[id];\n        let obj = zip.file(xl(filename));\n        if (obj) {\n            names.push(filename);\n            promises.push(obj.async(\"uint8array\"));\n        }\n    });\n    let data = await window.Promise.all(promises);\n    names.forEach((name, i) => map.bytes[name] = data[i]);\n    return map;\n}\n\nlet SEL_BORDER = [\"borders\", \"border\"];\nlet SEL_FILL = [\"fills\", \"fill\"];\nlet SEL_FONT = [\"fonts\", \"font\"];\nlet SEL_INLINE_STYLE = [\"cellXfs\", \"xf\"];\nlet SEL_NAMED_STYLE = [\"cellStyleXfs\", \"xf\"];\nlet SEL_NUM_FMT = [\"numFmts\", \"numFmt\"];\n\nlet INDEXED_COLORS = [\n    toCSSColor(\"FF000000\"), toCSSColor(\"FFFFFFFF\"), toCSSColor(\"FFFF0000\"),\n    toCSSColor(\"FF00FF00\"), toCSSColor(\"FF0000FF\"), toCSSColor(\"FFFFFF00\"),\n    toCSSColor(\"FFFF00FF\"), toCSSColor(\"FF00FFFF\"), toCSSColor(\"FF000000\"),\n    toCSSColor(\"FFFFFFFF\"), toCSSColor(\"FFFF0000\"), toCSSColor(\"FF00FF00\"),\n    toCSSColor(\"FF0000FF\"), toCSSColor(\"FFFFFF00\"), toCSSColor(\"FFFF00FF\"),\n    toCSSColor(\"FF00FFFF\"), toCSSColor(\"FF800000\"), toCSSColor(\"FF008000\"),\n    toCSSColor(\"FF000080\"), toCSSColor(\"FF808000\"), toCSSColor(\"FF800080\"),\n    toCSSColor(\"FF008080\"), toCSSColor(\"FFC0C0C0\"), toCSSColor(\"FF808080\"),\n    toCSSColor(\"FF9999FF\"), toCSSColor(\"FF993366\"), toCSSColor(\"FFFFFFCC\"),\n    toCSSColor(\"FFCCFFFF\"), toCSSColor(\"FF660066\"), toCSSColor(\"FFFF8080\"),\n    toCSSColor(\"FF0066CC\"), toCSSColor(\"FFCCCCFF\"), toCSSColor(\"FF000080\"),\n    toCSSColor(\"FFFF00FF\"), toCSSColor(\"FFFFFF00\"), toCSSColor(\"FF00FFFF\"),\n    toCSSColor(\"FF800080\"), toCSSColor(\"FF800000\"), toCSSColor(\"FF008080\"),\n    toCSSColor(\"FF0000FF\"), toCSSColor(\"FF00CCFF\"), toCSSColor(\"FFCCFFFF\"),\n    toCSSColor(\"FFCCFFCC\"), toCSSColor(\"FFFFFF99\"), toCSSColor(\"FF99CCFF\"),\n    toCSSColor(\"FFFF99CC\"), toCSSColor(\"FFCC99FF\"), toCSSColor(\"FFFFCC99\"),\n    toCSSColor(\"FF3366FF\"), toCSSColor(\"FF33CCCC\"), toCSSColor(\"FF99CC00\"),\n    toCSSColor(\"FFFFCC00\"), toCSSColor(\"FFFF9900\"), toCSSColor(\"FFFF6600\"),\n    toCSSColor(\"FF666699\"), toCSSColor(\"FF969696\"), toCSSColor(\"FF003366\"),\n    toCSSColor(\"FF339966\"), toCSSColor(\"FF003300\"), toCSSColor(\"FF333300\"),\n    toCSSColor(\"FF993300\"), toCSSColor(\"FF993366\"), toCSSColor(\"FF333399\"),\n    toCSSColor(\"FF333333\"),\n    toCSSColor(\"FF000000\"), // System Foreground\n    toCSSColor(\"FFFFFFFF\")  // System Background\n];\n\nasync function readStyles(zip, theme) {\n    let styles = {\n        fonts        : [],\n        numFmts      : {},\n        fills        : [],\n        borders      : [],\n        namedStyles  : [],\n        inlineStyles : []\n    };\n    let font = null;\n    let fill = null;\n    let border = null;\n    let xf = null;\n    await parse(zip, \"xl/styles.xml\", {\n        enter: function(tag, attrs, closed) {\n            if (this.is(SEL_NUM_FMT)) {\n                styles.numFmts[attrs.numFmtId] = attrs;\n            }\n            else if (this.is(SEL_FONT)) {\n                styles.fonts.push(font = {});\n                if (closed) {\n                    // apparently, there's XLSX in the wild with\n                    // <font/>, because why not (also, <border/>).\n                    // if we don't null the variable, we always\n                    // enter below and effectively ignore the rest\n                    // of the file.\n                    font = null;\n                }\n            } else if (font) {\n                if (tag === \"sz\") {\n                    font.size = parseFloat(attrs.val);\n                } else if (tag === \"name\") {\n                    font.name = attrs.val;\n                } else if (tag === \"b\") {\n                    font.bold = bool(attrs.val, true);\n                } else if (tag === \"i\") {\n                    font.italic = bool(attrs.val, true);\n                } else if (tag === \"u\") {\n                    font.underline = (attrs.val == null || attrs.val === \"single\");\n                } else if (tag === \"color\") {\n                    font.color = getColor(attrs, null);\n                }\n            }\n            else if (this.is(SEL_FILL)) {\n                styles.fills.push(fill = {});\n                if (closed) {\n                    fill = null;\n                }\n            } else if (fill) {\n                if (tag === \"patternFill\") {\n                    fill.type = attrs.patternType;\n                } else if (tag === \"fgColor\" && fill.type === \"solid\") {\n                    fill.color = getColor(attrs, INDEXED_COLORS[0]);\n                } else if (tag === \"bgColor\" && fill.type !== \"solid\") {\n                    fill.color = getColor(attrs, INDEXED_COLORS[0]);\n                }\n            }\n            else if (this.is(SEL_BORDER)) {\n                styles.borders.push(border = {\n                    diagonalUp   : +bool(attrs.diagonalUp, 0),\n                    diagonalDown : +bool(attrs.diagonalDown, 0)\n                });\n                if (closed) {\n                    border = null;\n                }\n            } else if (border) {\n                if (/^(?:left|top|right|bottom|diagonal)$/.test(tag)) {\n                    border[tag] = { style: attrs.style || \"none\" };\n                    if (tag === \"diagonal\") {\n                        border.diagonal.up = border.diagonalUp;\n                        border.diagonal.down = border.diagonalDown;\n                    }\n                }\n                if (tag === \"color\") {\n                    let side = this.stack[this.stack.length - 2].$tag;\n                    border[side].color = getColor(attrs, INDEXED_COLORS[0]);\n                }\n            }\n            else if (this.is(SEL_NAMED_STYLE)) {\n                xf = getXf(attrs);\n                styles.namedStyles.push(xf);\n                if (closed) {\n                    xf = null;\n                }\n            } else if (this.is(SEL_INLINE_STYLE)) {\n                xf = getXf(attrs);\n                styles.inlineStyles.push(xf);\n                if (closed) {\n                    xf = null;\n                }\n            } else if (xf) {\n                if (tag === \"alignment\") {\n                    if (/^(?:left|center|right|justify)$/.test(attrs.horizontal)) {\n                        xf.textAlign = attrs.horizontal;\n                    }\n                    if (/^(?:top|center|bottom)$/.test(attrs.vertical)) {\n                        xf.verticalAlign = attrs.vertical;\n                    }\n                    if (attrs.wrapText != null) {\n                        xf.wrapText = bool(attrs.wrapText);\n                    }\n                    if (attrs.indent != null) {\n                        xf.indent = integer(attrs.indent);\n                    }\n                } else if (tag == \"protection\") {\n                    xf.protection = {\n                        locked: bool(attrs.locked)\n                    };\n                }\n            }\n        },\n        leave: function(tag) {\n            if (this.is(SEL_FONT)) {\n                font = null;\n            } else if (this.is(SEL_FILL)) {\n                fill = null;\n            } else if (this.is(SEL_BORDER)) {\n                border = null;\n            } else if (tag === \"xf\") {\n                xf = null;\n            }\n        }\n    });\n\n    function getXf(attrs) {\n        let xf = {\n            borderId          : integer(attrs.borderId),\n            fillId            : integer(attrs.fillId),\n            fontId            : integer(attrs.fontId),\n            numFmtId          : integer(attrs.numFmtId),\n            pivotButton       : bool(attrs.pivotButton),\n            quotePrefix       : bool(attrs.quotePrefix),\n            xfId              : integer(attrs.xfId)\n        };\n        addBool(\"applyAlignment\");\n        addBool(\"applyBorder\");\n        addBool(\"applyFill\");\n        addBool(\"applyFont\");\n        addBool(\"applyNumberFormat\");\n        if (addBool(\"applyProtection\")) {\n            xf.protection = { locked: true };\n        }\n        function addBool(name) {\n            if (attrs[name] != null) {\n                return xf[name] = bool(attrs[name]);\n            }\n        }\n        return xf;\n    }\n\n    function getColor(attrs, defaultThemeColor) {\n        if (attrs.rgb) {\n            return toCSSColor(attrs.rgb);\n        } else if (attrs.indexed) {\n            return INDEXED_COLORS[integer(attrs.indexed)];\n        } else if (attrs.theme) {\n            let themeColor = theme.colorScheme[integer(attrs.theme)];\n            if (!themeColor) {\n                // returning black by default for font color causes\n                // https://github.com/telerik/kendo-ui-core/issues/5826\n                // in default cell style, color is undefined\n                return defaultThemeColor;\n            }\n\n            let color = parseColor(themeColor);\n\n            if (attrs.tint) {\n                color = color.toHSL();\n\n                let tint = parseFloat(attrs.tint);\n                if (tint < 0) {\n                    color.l = color.l * (1 + tint);\n                } else {\n                    color.l = color.l * (1 - tint) + (100 - 100 * (1 - tint));\n                }\n            }\n\n            return color.toCssRgba();\n        }\n    }\n\n    return styles;\n}\n\nlet SEL_SCHEME_RGBCLR = [\"a:clrScheme\", \"*\", \"a:srgbClr\"];\nlet SEL_SCHEME_SYSCLR = [\"a:clrScheme\", \"*\", \"a:sysClr\"];\nasync function readTheme(zip, rel) {\n    let scheme = [];\n    let theme = {\n        colorScheme: scheme\n    };\n\n    let file = xl(rel);\n    if (zip.file(file)) {\n        await parse(zip, file, {\n            enter: function(tag, attrs) {\n                if (this.is(SEL_SCHEME_SYSCLR)) {\n                    scheme.push(toCSSColor(\n                        attrs.val === \"window\" ? \"FFFFFFFF\" : \"FF000000\"\n                    ));\n                } else if (this.is(SEL_SCHEME_RGBCLR)) {\n                    scheme.push(toCSSColor(\"FF\" + attrs.val));\n                }\n            }\n        });\n\n        if (scheme.length > 3) {\n            // lt1 <-> dk1\n            swap(scheme, 0, 1);\n            // lt2 <-> dk2\n            swap(scheme, 2, 3);\n        }\n    }\n\n    function swap(arr, a, b) {\n        let tmp = arr[a];\n        arr[a] = arr[b];\n        arr[b] = tmp;\n    }\n\n    return theme;\n}\n\nfunction integer(val) {\n    return val == null ? null : parseInt(val, 10);\n}\n\nfunction bool(val, def) {\n    if (val == null) {\n        return def;\n    }\n    return val === \"true\" || val === true || val === 1 || val === '1';\n}\n\nfunction toCSSColor(rgb) {\n    let m = /^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(rgb);\n    return \"rgba(\" +\n        parseInt(m[2], 16) + \", \" +\n        parseInt(m[3], 16) + \", \" +\n        parseInt(m[4], 16) + \", \" +\n        parseInt(m[1], 16) / 255 + \")\";\n}\n\nfunction relative_file(base, name) {\n    base = base.split(/\\/+/);\n    name = name.split(/\\/+/);\n    base.pop();\n    while (name.length) {\n        let part = name.shift();\n        if (part === \"\") {\n            base = [];      // absolute\n        } else if (part === \".\") {\n            continue;\n        } else if (part === \"..\") {\n            base.pop();\n        } else {\n            base.push(part);\n        }\n    }\n    return base.join(\"/\");\n}\n\nfunction excelToPixels(val) {\n    return val / 9525;\n}\n\n/* eslint-disable no-undef */\n/* eslint-disable no-nested-ternary */\n/* eslint-disable key-spacing */\n/* eslint-disable consistent-return */\n/* eslint-disable no-param-reassign */\n\n\nconst events$1 = [\n    \"cut\",\n    \"copy\",\n    \"paste\",\n    \"changing\",\n    \"change\",\n    \"contextmenu\",\n    \"excelImport\",\n    \"excelExport\",\n    \"insertSheet\",\n    \"removeSheet\",\n    \"selectSheet\",\n    \"renameSheet\",\n    \"insertRow\",\n    \"insertColumn\",\n    \"deleteRow\",\n    \"deleteColumn\",\n    \"hideRow\",\n    \"hideColumn\",\n    \"unhideRow\",\n    \"unhideColumn\",\n    \"select\",\n    \"changeFormat\",\n    \"dataBinding\",\n    \"dataBound\",\n    \"progress\"\n];\n\nfunction loadBinary(url, callback) {\n    let xhr = new XMLHttpRequest();\n    xhr.onload = function() {\n        callback(xhr.response, xhr.getResponseHeader(\"Content-Type\"));\n    };\n    xhr.onerror = function() {\n        callback(null);\n    };\n    xhr.open(\"GET\", url);\n    xhr.responseType = \"arraybuffer\";\n    xhr.send();\n}\n\nclass Workbook extends Observable {\n    constructor(options, view) {\n        super();\n        this.events = events$1;\n\n        this.options = options;\n\n        this._view = view;\n        this._sheets = [];\n        this._images = {};\n        this._imgID = 0;\n\n        this._sheetsSearchCache = {};\n\n        this._sheet = this.insertSheet({\n            rows: this.options.rows,\n            columns: this.options.columns,\n            rowHeight: this.options.rowHeight,\n            columnWidth: this.options.columnWidth,\n            headerHeight: this.options.headerHeight,\n            headerWidth: this.options.headerWidth,\n            dataSource: this.options.dataSource\n        });\n\n        this.undoRedoStack = new UndoRedoStack();\n        this.undoRedoStack.bind([\"undo\", \"redo\"], this._onUndoRedo.bind(this));\n\n        this._context = new FormulaContext(this);\n        this._validationContext = new ValidationFormulaContext(this);\n        this._names = Object.create(null);\n\n        this.fromJSON(this.options);\n    }\n\n    clipboard() {\n        if (!this._clipboard) {\n            this._clipboard = new Clipboard(this);\n        }\n        return this._clipboard;\n    }\n\n    destroy() {\n        this.unbind();\n\n        if (this._clipboard) {\n            this._clipboard.destroy();\n        }\n    }\n\n    _sheetChanging(e) {\n        if (this.trigger(\"changing\", e)) {\n            e.preventDefault();\n        }\n    }\n\n    _sheetChange(e) {\n        this.trigger(\"change\", e);\n    }\n\n    _sheetInsertRow(e) {\n        if (this.trigger(\"insertRow\", {\n            sheet: e.sender,\n            index: e.index\n        })) {\n            e.preventDefault();\n        }\n    }\n\n    _sheetInsertColumn(e) {\n        if (this.trigger(\"insertColumn\", {\n            sheet: e.sender,\n            index: e.index\n        })) {\n            e.preventDefault();\n        }\n    }\n\n    _sheetDeleteRow(e) {\n        if (this.trigger(\"deleteRow\", {\n            sheet: e.sender,\n            index: e.index\n        })) {\n            e.preventDefault();\n        }\n    }\n\n    _sheetDeleteColumn(e) {\n        if (this.trigger(\"deleteColumn\", {\n            sheet: e.sender,\n            index: e.index\n        })) {\n            e.preventDefault();\n        }\n    }\n\n    _sheetHideRow(e) {\n        if (this.trigger(\"hideRow\", {\n            sheet: e.sender,\n            index: e.index\n        })) {\n            e.preventDefault();\n        }\n    }\n\n    _sheetHideColumn(e) {\n        if (this.trigger(\"hideColumn\", {\n            sheet: e.sender,\n            index: e.index\n        })) {\n            e.preventDefault();\n        }\n    }\n\n    _sheetUnhideRow(e) {\n        if (this.trigger(\"unhideRow\", {\n            sheet: e.sender,\n            index: e.index\n        })) {\n            e.preventDefault();\n        }\n    }\n\n    _sheetUnhideColumn(e) {\n        if (this.trigger(\"unhideColumn\", {\n            sheet: e.sender,\n            index: e.index\n        })) {\n            e.preventDefault();\n        }\n    }\n\n    _sheetSelect(e) {\n        this.trigger(\"select\", e);\n    }\n\n    _sheetDataBinding(e) {\n        if (this.trigger(\"dataBinding\", {\n            sheet: e.sender\n        })) {\n            e.preventDefault();\n        }\n    }\n\n    _sheetDataBound(e) {\n        this.trigger(\"dataBound\", {\n            sheet: e.sender\n        });\n    }\n\n    _sheetProgress(e) {\n        let that = this;\n\n        setTimeout(function() {\n            that.trigger(\"progress\", {\n                toggle: e.toggle\n            });\n        });\n    }\n\n    _sheetCommandRequest(e) {\n        this.trigger(\"commandRequest\", e);\n    }\n\n    _inputForRef(ref) {\n        let self = this;\n        return self._sheet.withCultureDecimals(function() {\n            return new Range$1(ref, self._sheet).input();\n        });\n    }\n\n    _onUndoRedo(e) {\n        e.command.range().select();\n    }\n\n    execute(options) {\n        let commandOptions = Object.assign({}, { workbook: this }, options.options);\n        let command;\n\n        if (this.options.getWorkbookCommand) {\n            command = this.options.getWorkbookCommand(options.command, commandOptions);\n        }\n\n        command = command || new commands[options.command](commandOptions);\n        let sheet = this.activeSheet();\n\n        if (commandOptions.origin) {\n            command.origin(commandOptions.origin);\n        }\n\n        if (commandOptions.operatingRange) {\n            command.range(commandOptions.operatingRange);\n        } else {\n            command.range(sheet.selection());\n        }\n\n        if (commandOptions.editRange) {\n            command._editRange = commandOptions.editRange;\n        }\n\n        let result = command.exec();\n\n        if (!result || result.reason !== \"error\") {\n            if (!command.cannotUndo) {\n                this.undoRedoStack.push(command);\n            }\n        }\n\n        // when the undo/redo stack is truncated (by e.g. adding a\n        // non-redo command after undoing) it's possible to\n        // discard images from the dropped commands.\n        this.cleanupImages();\n\n        return result;\n    }\n\n    resetFormulas() {\n        this._sheets.forEach(function(sheet) {\n            sheet.resetFormulas();\n        });\n    }\n\n    resetValidations() {\n        this._sheets.forEach(function(sheet) {\n            sheet.resetValidations();\n        });\n    }\n\n    refresh(reason) {\n        if (reason.recalc) {\n            this.resetFormulas();\n            this.resetValidations();\n            this._sheet.recalc(this._context);\n            this._sheet.revalidate(this._validationContext);\n        }\n    }\n\n    activeSheet(sheet) {\n        if (sheet === undefined) {\n            return this._sheet;\n        }\n\n        if (!this.sheetByName(sheet.name())) {\n            return undefined;\n        }\n\n        this._sheet = sheet;\n\n        //TODO: better way to get all reasons?\n        sheet.triggerChange(ALL_REASONS);\n    }\n\n    moveSheetToIndex(sheet, toIndex) {\n        let fromIndex = this.sheetIndex(sheet);\n        let sheets = this._sheets;\n\n        if (fromIndex === -1) {\n            return;\n        }\n\n        this._sheetsSearchCache = {};\n\n        sheets.splice(toIndex, 0, sheets.splice(fromIndex, 1)[0]);\n\n        this.trigger(\"change\", { sheetSelection: true });\n    }\n\n    insertSheet(options) {\n        options = options || {};\n        let that = this;\n        let insertIndex = typeof options.index === \"number\" ? options.index : that._sheets.length;\n        let sheetName;\n        let sheets = that._sheets;\n        const messages = this.options.messages;\n\n        let getUniqueSheetName = function(sheetNameSuffix) {\n            sheetNameSuffix = sheetNameSuffix ? sheetNameSuffix : 1;\n\n            let name = messages.workbook.defaultSheetName + sheetNameSuffix;\n\n            if (!that.sheetByName(name)) {\n                return name;\n            }\n\n            return getUniqueSheetName(sheetNameSuffix + 1);\n        };\n\n        if (options.name && that.sheetByName(options.name)) {\n            return undefined;\n        }\n\n        this._sheetsSearchCache = {};\n\n        sheetName = options.name || getUniqueSheetName();\n\n        let sheet = new Sheet(\n            options.rows || this.options.rows,\n            options.columns || this.options.columns,\n            options.rowHeight || this.options.rowHeight,\n            options.columnWidth || this.options.columnWidth,\n            options.headerHeight || this.options.headerHeight,\n            options.headerWidth || this.options.headerWidth,\n            options.defaultCellStyle || this.options.defaultCellStyle,\n            options.createSheetDataSource || this.options.createSheetDataSource\n        );\n\n        sheet._workbook = this;\n\n        sheet._name(sheetName);\n        sheet._state(options.state);\n\n        this._bindSheetEvents(sheet);\n\n        sheets.splice(insertIndex, 0, sheet);\n\n        if (options.data) {\n            sheet.fromJSON(options.data);\n        }\n\n        if (options.dataSource) {\n            sheet.setDataSource(options.dataSource);\n        }\n\n        this.trigger(\"change\", { sheetSelection: true });\n\n        return sheet;\n    }\n\n    _bindSheetEvents(sheet) {\n        sheet.bind(\"changing\", this._sheetChanging.bind(this));\n        sheet.bind(\"change\", this._sheetChange.bind(this));\n        sheet.bind(\"insertRow\", this._sheetInsertRow.bind(this));\n        sheet.bind(\"insertColumn\", this._sheetInsertColumn.bind(this));\n        sheet.bind(\"deleteRow\", this._sheetDeleteRow.bind(this));\n        sheet.bind(\"deleteColumn\", this._sheetDeleteColumn.bind(this));\n        sheet.bind(\"hideRow\", this._sheetHideRow.bind(this));\n        sheet.bind(\"hideColumn\", this._sheetHideColumn.bind(this));\n        sheet.bind(\"unhideRow\", this._sheetUnhideRow.bind(this));\n        sheet.bind(\"unhideColumn\", this._sheetUnhideColumn.bind(this));\n        sheet.bind(\"select\", this._sheetSelect.bind(this));\n        sheet.bind(\"commandRequest\", this._sheetCommandRequest.bind(this));\n        sheet.bind(\"dataBinding\", this._sheetDataBinding.bind(this));\n        sheet.bind(\"dataBound\", this._sheetDataBound.bind(this));\n        sheet.bind(\"progress\", this._sheetProgress.bind(this));\n    }\n\n    sheets() {\n        return this._sheets.slice();\n    }\n\n    sheetByName(sheetName) {\n        return this._sheets[this.sheetIndex(sheetName)];\n    }\n\n    sheetByIndex(index) {\n        return this._sheets[index];\n    }\n\n    sheetIndex(sheet) {\n        let sheets = this._sheets;\n        let sheetName = (typeof sheet == \"string\" ? sheet : sheet.name()).toLowerCase();\n        let idx = this._sheetsSearchCache[sheetName];\n\n        if (idx >= 0) {\n            return idx;\n        }\n\n        for (idx = 0; idx < sheets.length; idx++) {\n            let name = sheets[idx].name().toLowerCase();\n            this._sheetsSearchCache[name] = idx;\n\n            if (name === sheetName) {\n                return idx;\n            }\n        }\n\n        return -1;\n    }\n\n    renameSheet(sheet, newSheetName) {\n        let oldSheetName = sheet.name().toLowerCase();\n\n        if (!newSheetName ||\n            oldSheetName === newSheetName.toLowerCase() ||\n            this.sheetByName(newSheetName)) {\n            return;\n        }\n\n        sheet = this.sheetByName(oldSheetName);\n\n        if (!sheet) {\n            return;\n        }\n\n        this._sheetsSearchCache = {};\n\n        if (this.trigger(\"renameSheet\", {\n            sheet: sheet,\n            newSheetName: newSheetName\n        })) {\n            return;\n        }\n\n        // update references\n        this._sheets.forEach(function(sheet) {\n            sheet._forFormulas(function(formula) {\n                formula.renameSheet(oldSheetName, newSheetName);\n            });\n        });\n\n        this.forEachName(function(def, name) {\n            // 1. redefine sheet-local names\n            if (def.nameref.renameSheet(oldSheetName, newSheetName)) {\n                this.undefineName(name);\n                def.name = def.nameref.print();\n                this.nameDefinition(def.name, def);\n            }\n            // 2. if the value is reference or formula, update it\n            if (def.value instanceof Ref || def.value instanceof calc.runtime.Formula) {\n                def.value.renameSheet(oldSheetName, newSheetName);\n            }\n        }.bind(this));\n\n        sheet._name(newSheetName);\n\n        this.trigger(\"change\", { sheetSelection: true });\n\n        return sheet;\n    }\n\n    removeSheet(sheet) {\n        let that = this;\n        let sheets = that._sheets;\n        let name = sheet.name();\n        let index = that.sheetIndex(sheet);\n\n        if (sheets.length === 1) {\n            return;\n        }\n\n        if (this.trigger(\"removeSheet\", { sheet: sheet })) {\n            return;\n        }\n\n        this._sheetsSearchCache = {};\n\n        if (index > -1) {\n            sheet.unbind();\n\n            sheets.splice(index, 1);\n\n            if (that.activeSheet().name() === name) {\n                let newSheet = sheets[index === sheets.length ? index - 1 : index];\n                that.activeSheet(newSheet);\n            } else {\n                this.trigger(\"change\", { recalc: true, sheetSelection: true });\n            }\n        }\n    }\n\n    _clearSheets() {\n        for (let i = 0; i < this._sheets.length; i++) {\n            this._sheets[i]._activeDrawing = [];\n            this._sheets[i]._drawings = [];\n            this._sheets[i].unbind();\n        }\n        this._sheets = [];\n        this._sheetsSearchCache = {};\n        this._names = {};\n        this._images = {};\n        this._imgID = 0;\n    }\n\n    _loadImages() {\n        let self = this;\n        let ids = Object.keys(self._images);\n        let count = ids.length;\n        if (count) {\n            ids.forEach(function(id){\n                let img = self._images[id];\n                if (!img.blob) {\n                    loadBinary(img.url, function(data, type) {\n                        // XXX: can we do something better in case of error?\n                        if (data != null) {\n                            img.blob = new Blob([ data ], { type: type });\n                            delete img.url;\n                        }\n                        next();\n                    });\n                }\n            });\n        } else {\n            next();\n        }\n        function next() {\n            if (--count <= 0) {\n                self.activeSheet().triggerChange({ layout: true });\n            }\n        }\n    }\n\n    fromJSON(json) {\n        if (json.sheets) {\n            this._clearSheets();\n\n            if (json.images) {\n                this._imgID = 0;\n                this._images = {};\n                Object.keys(json.images).forEach(function(id) {\n                    if (!isNaN(id)) {\n                        let num = parseFloat(id);\n                        if (isFinite(num)) {\n                            this._imgID = Math.max(this._imgID, num);\n                        }\n                    }\n                    this._images[id] = { url: json.images[id] };\n                }, this);\n                this._loadImages();\n            }\n\n            for (let idx = 0; idx < json.sheets.length; idx++) {\n                let data = json.sheets[idx];\n                let args = sheetParamsFromJSON(data, this.options);\n                let sheet = this.insertSheet({\n                    rows         : args.rowCount,\n                    columns      : args.columnCount,\n                    rowHeight    : args.rowHeight,\n                    columnWidth  : args.columnWidth,\n                    headerHeight : args.headerHeight,\n                    headerWidth  : args.headerWidth,\n                    data         : data\n                });\n\n                if (data.dataSource) {\n                    sheet.setDataSource(data.dataSource);\n                }\n            }\n        }\n\n        if (json.activeSheet) {\n            this.activeSheet(this.sheetByName(json.activeSheet));\n        } else {\n            this.activeSheet(this._sheets[0]);\n        }\n\n        if (json.names) {\n            json.names.forEach(function(def) {\n                this.defineName(def.name, def.value, def.hidden);\n            }, this);\n        }\n    }\n\n    toJSON() {\n        this.resetFormulas();\n        this.resetValidations();\n        let names = Object.keys(this._names).map(function(name) {\n            let def = this._names[name];\n            let val = def.value;\n            if (val instanceof Ref || val instanceof calc.runtime.Formula) {\n                val = val.print(0, 0, true);\n            } else if (val instanceof CalcError) {\n                val = String(val);\n            } else {\n                val = JSON.stringify(val);\n            }\n            return {\n                value     : val,\n                hidden    : def.hidden,\n                name      : def.name,\n\n                // these two are not really useful in\n                // deserialization, but are handy in OOXML export.\n                sheet     : def.nameref.sheet,\n                localName : def.nameref.name\n            };\n        }, this);\n        return {\n            activeSheet: this.activeSheet().name(),\n            sheets: this._sheets.map(function(sheet) {\n                sheet.recalc(this._context);\n                sheet.revalidate(this._validationContext);\n                return sheet.toJSON();\n            }, this),\n            names: names,\n            images: {},\n            columnWidth: this.options.columnWidth,\n            rowHeight: this.options.rowHeight\n        };\n    }\n\n    saveJSON() {\n        let self = this;\n        let data = self.toJSON();\n        let ids = Object.keys(self._images).filter(function(id) {\n            return self.usesImage(id) === 1;\n        });\n        let count = ids.length;\n\n        const promises = [];\n\n        if (count) {\n            ids.forEach(function(id) {\n                let img = self._images[id];\n                if (img.blob) {\n                    const promise = new Promise((resolve) => {\n                        let reader = new FileReader();\n                        reader.onload = function() {\n                            data.images[id] = reader.result;\n                            resolve();\n                        };\n                        reader.readAsDataURL(img.blob);\n                    });\n                    promises.push(promise);\n                } else {\n                    data.images[id] = img.url;\n                }\n            });\n        }\n\n        return Promise.all(promises).then(() => data);\n    }\n\n    fromFile(file) {\n        const deferred = new Deferred();\n\n        if (file && !this.trigger(\"excelImport\", { file, deferred })) {\n            this._clearSheets();\n            this._readExcel(file, this, deferred);\n        }\n\n        return deferred.promise;\n    }\n\n    _readExcel(file, workbook, deferred) {\n        readExcel(file, workbook, deferred);\n    }\n\n    saveAsExcel(options) {\n        let self = this;\n        options = deepExtend({}, self.options.excel, options);\n        let data = self.toJSON();\n\n        if (self.trigger(\"excelExport\", { workbook: data })) {\n            return;\n        }\n\n        let ids = Object.keys(self._images).filter(function(id) {\n            return self.usesImage(id) === 1;\n        });\n        let count = ids.length;\n        let images = count ? {} : null;\n        const promises = [];\n\n        if (count) {\n            ids.forEach(function(id) {\n                let img = self._images[id];\n\n                if (img.blob) {\n                    const promise = new Promise((resolve) => {\n                        let reader = new FileReader();\n                        reader.onload = function() {\n                            images[id] = {\n                                type: img.blob.type,\n                                name: img.blob.name,\n                                data: reader.result\n                            };\n\n                            count--;\n                            resolve();\n                        };\n                        reader.readAsArrayBuffer(img.blob);\n                    });\n\n                    promises.push(promise);\n                } else {\n                    const promise = new Promise((resolve) => {\n                        loadBinary(img.url, function(data, type) {\n                            images[id] = { type: type, data: data };\n                            count--;\n                            resolve();\n                        });\n                    });\n                    promises.push(promise);\n                }\n            });\n\n            return Promise.all(promises)\n                    .then(() => {\n                        return next();\n                    });\n        } else {\n            return next();\n        }\n\n        function next() {\n            if (--count <= 0) {\n                data.images = images;\n                let workbook = new options.Workbook(data);\n                const promise = options.forceProxy ? workbook.toDataURL() : workbook.toBlob();\n\n                if (!options.saveAs) {\n                    return promise;\n                }\n\n                return promise.then(blob => {\n                    options.saveAs(blob, data.fileName || options.fileName, {\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy\n                    });\n                });\n            }\n\n            return Promise.resolve();\n        }\n    }\n\n    draw(options, callback) {\n        if (typeof options == \"function\" && !callback) {\n            callback = options;\n            options = {};\n        }\n        let parts = [], sheets = this._sheets;\n        (function loop(i) {\n            if (i < sheets.length) {\n                sheets[i].draw(SHEETREF, options, function(group) {\n                    parts.push(group);\n                    loop(i + 1);\n                });\n            } else {\n                let group = parts[0];\n                for (i = 1; i < parts.length; ++i) {\n                    group.children = group.children.concat(parts[i].children);\n                }\n                callback(group);\n            }\n        })(0);\n    }\n\n    nameForRef(ref, sheet) {\n        if (sheet === undefined) {\n            sheet = ref.sheet;\n        }\n        sheet = sheet.toLowerCase();\n        let str = String(ref);\n        for (let name in this._names) {\n            let def = this._names[name];\n            let val = def.value;\n            if (val instanceof Ref) {\n                if (!val.sheet || (val.sheet && sheet === val.sheet.toLowerCase())) {\n                    if (String(val) === str) {\n                        return def;\n                    }\n                }\n            }\n        }\n        return { name: str };\n    }\n\n    defineName(name, value, hidden) {\n        let x = calc.parseNameDefinition(name, value);\n        name = x.name.print();\n        this._names[name.toLowerCase()] = {\n            value   : x.value,\n            hidden  : hidden,\n            name    : name,\n            nameref : x.name\n        };\n    }\n\n    undefineName(name) {\n        delete this._names[name.toLowerCase()];\n    }\n\n    nameValue(name) {\n        name = name.toLowerCase();\n        if (name in this._names) {\n            return this._names[name].value;\n        }\n        return null;\n    }\n\n    nameDefinition(name, def) {\n        name = name.toLowerCase();\n        if (arguments.length > 1) {\n            if (def === undefined) {\n                delete this._names[name];\n            } else {\n                this._names[name] = def;\n            }\n        }\n        return this._names[name];\n    }\n\n    forEachName(func) {\n        Object.keys(this._names).forEach(function(name) {\n            func(this._names[name], name);\n        }, this);\n    }\n\n    adjustNames(affectedSheet, forRow, start, delta) {\n        affectedSheet = affectedSheet.toLowerCase();\n        Object.keys(this._names).forEach(function(name) {\n            let def = this._names[name];\n            let x = def.value;\n            if (x instanceof Ref &&\n                x.sheet.toLowerCase() === affectedSheet) {\n                def.value = x.adjust(null, null, null, null, forRow, start, delta);\n            } else if (x instanceof calc.runtime.Formula) {\n                x.adjust(affectedSheet, forRow ? \"row\" : \"col\", start, delta);\n            }\n        }, this);\n    }\n\n    addImage(image) {\n        let id = String(++this._imgID);\n        if (typeof image == \"string\") {\n            this._images[id] = { url: image };\n        } else {\n            this._images[id] = { blob: image };\n        }\n        return id;\n    }\n\n    imageUrl(id) {\n        let img = this._images[id];\n        let url = img.url;\n        if (!url) {\n            url = img.url = window.URL.createObjectURL(img.blob);\n        }\n        return url;\n    }\n\n    cleanupImages() {\n        Object.keys(this._images).forEach(function(id) {\n            if (!this.usesImage(id)) {\n                let url = this._images[id].url;\n                if (url) {\n                    window.URL.revokeObjectURL(url);\n                }\n                delete this._images[id];\n            }\n        }, this);\n    }\n\n    usesImage(img) {\n        let i;\n        let sheets = this._sheets;\n        for (i = sheets.length; --i >= 0;) {\n            if (sheets[i].usesImage(img)) {\n                return 1;\n            }\n        }\n        let stack = this.undoRedoStack.stack;\n        for (i = stack.length; --i >= 0;) {\n            if (stack[i].usesImage(img)) {\n                return 2; // signal that it's only in the undo stack\n            }\n        }\n        return false;\n    }\n}\n\nfunction sheetParamsFromJSON(data, options) {\n    function or(a, b, c) {\n        return a !== undefined ? a : b !== undefined ? b : c;\n    }\n\n    let rowCount = or(data.rowCount, options.rows, 200),\n        columnCount = or(data.columnCount, options.columns, 50),\n        rowHeight = or(data.rowHeight, options.rowHeight, 20),\n        columnWidth = or(data.columnWidth, options.columnWidth, 64),\n        headerHeight = or(data.headerHeight, options.headerHeight, 20),\n        headerWidth = or(data.headerWidth, options.headerWidth, 32);\n\n    if (data.rows !== undefined) {\n        for (let i = 0; i < data.rows.length; ++i) {\n            let row = data.rows[i];\n            let ri = or(row.index, i);\n            if (ri >= rowCount) { rowCount = ri + 1; }\n            if (row.cells) {\n                for (let j = 0; j < row.cells.length; ++j) {\n                    let cell = row.cells[j];\n                    let ci = or(cell.index, j);\n                    if (ci >= columnCount) { columnCount = ci + 1; }\n                }\n            }\n        }\n    }\n\n    return {\n        rowCount     : rowCount,\n        columnCount  : columnCount,\n        rowHeight    : rowHeight,\n        columnWidth  : columnWidth,\n        headerHeight : headerHeight,\n        headerWidth  : headerWidth\n    };\n}\n\n// if (kendo.PDFMixin) {\n//     kendo.PDFMixin.extend(Workbook.prototype);\n\n//     Workbook.prototype.saveAsPDF = function(options) {\n//         let progress = new $.Deferred();\n//         let promise = progress.promise();\n//         let args = { promise: promise };\n//         if (this.trigger(\"pdfExport\", args)) {\n//             return;\n//         }\n\n//         this._drawPDF(options, progress)\n//         .then(function(root) {\n//             return options.forceProxy\n//                 ? kendo.pdf.exportPDF(root) // produce data URI for proxy\n//                 : kendo.pdf.exportPDFToBlob(root);\n//         })\n//         .done(function(dataURI) {\n//             kendo.saveAs({\n//                 dataURI: dataURI,\n//                 fileName: options.fileName,\n//                 proxyURL: options.proxyURL,\n//                 forceProxy: options.forceProxy,\n//                 proxyTarget: options.proxyTarget\n//             });\n\n//             progress.resolve();\n//         })\n//         .fail(function(err) {\n//             progress.reject(err);\n//         });\n\n//         return promise;\n//     };\n\n//     Workbook.prototype._drawPDF = function(options) {\n//         let result = new $.Deferred();\n//         let callback = function(group) {\n//             result.resolve(group);\n//         };\n//         switch (options.area) {\n//         case \"workbook\":\n//             options.workbook.draw(options, callback);\n//             break;\n//         case \"sheet\":\n//             options.workbook.activeSheet().draw(options, callback);\n//             break;\n//         case \"selection\":\n//             options.workbook.activeSheet().selection().draw(options, callback);\n//             break;\n//         }\n\n//         return result.promise();\n//     };\n// }\n\n/* eslint-disable no-param-reassign */\n\nconst events = [\n    \"cut\",\n    \"copy\",\n    \"paste\",\n    \"pdfExport\",\n    \"excelExport\",\n    \"excelImport\",\n    \"changing\",\n    \"change\",\n    \"render\",\n    \"removeSheet\",\n    \"selectSheet\",\n    \"renameSheet\",\n    \"insertRow\",\n    \"insertColumn\",\n    \"deleteRow\",\n    \"insertSheet\",\n    \"deleteColumn\",\n    \"hideRow\",\n    \"hideColumn\",\n    \"unhideRow\",\n    \"unhideColumn\",\n    \"select\",\n    \"changeFormat\",\n    \"dataBinding\",\n    \"dataBound\",\n    \"update\",\n    \"message\",\n    \"contextmenu\",\n];\n\nclass SpreadsheetWidget extends Widget {\n    constructor(element, options$1) {\n        super(element, deepExtend({}, options, options$1));\n        this.events = events;\n        this.bind(this.events, this.options);\n\n        intl({ locale: this.options.locale, ...this.options.intl });\n        initDynamicFilter();\n\n        this._view = new View(this.element, {\n            messages: this.options.messages.view,\n            toolbar: this.options.toolbar,\n            sheetsbar: this.options.sheetsbar,\n            formulaBarInputRef: this.options.formulaBarInputRef,\n            formulaCellInputRef: this.options.formulaCellInputRef,\n            nameBoxRef: this.options.nameBoxRef,\n            createTabStrip: this.options.createTabStrip,\n            createFilterMenu: this.options.createFilterMenu,\n            createContextMenus: this.options.createContextMenus,\n            createSheetBar: this.options.createSheetBar,\n            getIconHTMLString: this.options.getIconHTMLString,\n            openDialogCallback: this.openDialog.bind(this),\n        });\n\n        this._workbook = new Workbook(this.options, this._view);\n\n        this._controller = new Controller(this._view, this._workbook);\n\n        this._autoRefresh = true;\n\n        this._bindWorkbookEvents();\n        this._bindViewEvents();\n\n        this._view.workbook(this._workbook);\n\n        this._view.enableClipboard(false);\n        this.refresh();\n        this._view.enableClipboard(true);\n\n        this._resizeHandler = this.resize.bind(this);\n        window.addEventListener('resize', this._resizeHandler);\n\n        this._keyDownHandler = this._keyDown.bind(this);\n        this.element.addEventListener(\"keydown\", this._keyDownHandler);\n    }\n\n    get view() {\n        return this._view;\n    }\n\n    get workbook () {\n        return this._workbook;\n    }\n\n    _keyDown(e) {\n        let key = e.keyCode;\n        let controlKey = e.ctrlKey || e.metaKey;\n\n        this.trigger(\"keydown\", e);\n\n        if (key === keys.F11 && e.shiftKey) {\n            this._view.sheetsbar.onAddSelect();\n            e.preventDefault();\n            return;\n        } else if (e.altKey && key === keys.PAGEDOWN) {\n            let activeSheetIndex = this.sheetIndex(this.activeSheet());\n            let nextSheetName = this.sheetByIndex(activeSheetIndex + 1)?.name();\n\n            if (nextSheetName){\n                this._view.sheetsbar.onSheetSelect(nextSheetName);\n            }\n        } else if (e.altKey && key === keys.PAGEUP) {\n            let activeSheetIndex = this.sheetIndex(this.activeSheet());\n            let prevSheetName = this.sheetByIndex(activeSheetIndex - 1)?.name();\n\n            if (prevSheetName) {\n                this._view.sheetsbar.onSheetSelect(prevSheetName);\n            }\n        } else if (e.altKey && key === keys.DELETE) {\n            this._view.sheetsbar.onSheetRemove(this.activeSheet()._name());\n            e.preventDefault();\n            return;\n        } else if (e.altKey && key === keys.R) {\n            this.options.createSheetEditor?.();\n            e.preventDefault();\n            return;\n        } else if (controlKey && key === keys.B) {\n            this._handleTypographicalEmphasis('bold');\n        } else if (controlKey && key === keys.I) {\n            this._handleTypographicalEmphasis('italic');\n        } else if (controlKey && key === keys.U) {\n            this._handleTypographicalEmphasis('underline');\n        } else if (e.altKey && key === keys.H) {\n            this._view.tabstrip?.select(\"home\");\n            e.preventDefault();\n            return;\n        } else if (e.altKey && key === keys.N) {\n            this._view.tabstrip?.select(\"insert\");\n            e.preventDefault();\n            return;\n        } else if (e.altKey && key === keys.A) {\n            this._view.tabstrip?.select(\"data\");\n            e.preventDefault();\n            return;\n        } else if (key === keys.F10) {\n            e.preventDefault();\n            this._view.tabstrip?.focus();\n        }\n    }\n\n    _handleTypographicalEmphasis(command) {\n        const sheet = this.activeSheet();\n\n        if (sheet) {\n            this.executeCommand({\n                command: 'PropertyChangeCommand',\n                options: {\n                    property: command,\n                    value: !sheet.range(sheet.activeCell())[command]()\n                }\n            });\n        }\n    }\n\n    _resize() {\n        this.refresh({ layout: true });\n    }\n\n    _workbookChanging(e) {\n        if (this.trigger(\"changing\", e)) {\n            e.preventDefault();\n        }\n    }\n\n    _workbookChange(e) {\n        if (this._autoRefresh) {\n            this.refresh(e);\n        }\n\n        if (e.recalc && e.ref) {\n            let range = e.range || new Range$1(e.ref, this.activeSheet());\n            this.trigger(\"change\", { range: range });\n        }\n    }\n\n    _workbookCut(e) {\n        this.trigger(\"cut\", e);\n    }\n\n    _workbookCopy(e) {\n        this.trigger(\"copy\", e);\n    }\n\n    _workbookPaste(e) {\n        this.trigger(\"paste\", e);\n    }\n\n    activeSheet(sheet) {\n        return this._workbook.activeSheet(sheet);\n    }\n\n    moveSheetToIndex(sheet, index) {\n        return this._workbook.moveSheetToIndex(sheet, index);\n    }\n\n    insertSheet(options) {\n        return this._workbook.insertSheet(options);\n    }\n\n    sheets() {\n        return this._workbook.sheets();\n    }\n\n    removeSheet(sheet) {\n        return this._workbook.removeSheet(sheet);\n    }\n\n    sheetByName(sheetName) {\n        return this._workbook.sheetByName(sheetName);\n    }\n\n    sheetIndex(sheet) {\n        return this._workbook.sheetIndex(sheet);\n    }\n\n    sheetByIndex(index) {\n        return this._workbook.sheetByIndex(index);\n    }\n\n    renameSheet(sheet, newSheetName) {\n        return this._workbook.renameSheet(sheet, newSheetName);\n    }\n\n    executeCommand(options) {\n        return this._controller.executeCommand(options);\n    }\n\n    refresh(reason) {\n        if (!reason) {\n            reason = ALL_REASONS;\n        }\n\n        if (!reason.editorClose) {\n            this._view.sheet(this._workbook.activeSheet());\n            this._controller.sheet(this._workbook.activeSheet());\n\n            this._workbook.refresh(reason);\n        }\n\n        if (!reason.editorChange) {\n            this._view.refresh(reason);\n            this._controller.refresh();\n\n            this._view.render(reason);\n            this.trigger(\"render\");\n        }\n\n        return this;\n    }\n\n    openDialog(name, options) {\n        return this._view.openDialog(name, options);\n    }\n\n    autoRefresh(value) {\n        if (value !== undefined) {\n            this._autoRefresh = value;\n\n            if (value === true) {\n                this.refresh();\n            }\n\n            return this;\n        }\n\n        return this._autoRefresh;\n    }\n\n    toJSON() {\n        return this._workbook.toJSON();\n    }\n\n    fromJSON(json) {\n        if (json.sheets) {\n            this._workbook.destroy();\n\n            this._workbook = new Workbook(deepExtend({}, this.options, json));\n\n            this._bindWorkbookEvents();\n\n            this._view.workbook(this._workbook);\n            this._controller.workbook(this._workbook);\n\n            this.activeSheet(this.activeSheet());\n        } else {\n            this.refresh();\n        }\n    }\n\n    saveJSON() {\n        return this._workbook.saveJSON();\n    }\n\n    fromFile(blob) {\n        return this._workbook.fromFile(blob);\n    }\n\n    saveAsPDF(options) {\n        this._workbook.saveAsPDF(\n            deepExtend({}, this.options.pdf, options, { workbook: this._workbook })\n        );\n    }\n\n    saveAsExcel(options) {\n        return this._workbook.saveAsExcel(options);\n    }\n\n    draw(options, callback) {\n        this._workbook.draw(options, callback);\n    }\n\n    _workbookExcelExport(e) {\n        if (this.trigger(\"excelExport\", e)) {\n            e.preventDefault();\n        }\n    }\n\n    _workbookExcelImport(e) {\n        if (this.trigger(\"excelImport\", e)) {\n            e.preventDefault();\n        }\n    }\n\n    // _initProgress(deferred) {\n    //     let loading =\n    //         $(\"<div class='k-loading-mask' \" +\n    //                \"style='width: 100%; height: 100%; top: 0;'>\" +\n    //             \"<div class='k-loading-color'></div>\" +\n    //         \"</div>\")\n    //         .appendTo(this.element);\n\n    //     let pb = $(\"<div class='k-loading-progress'>\")\n    //     .appendTo(loading)\n    //     .kendoProgressBar({\n    //         type: \"chunk\", chunkCount: 10,\n    //         min: 0, max: 1, value: 0\n    //     }).data(\"kendoProgressBar\");\n\n    //     deferred.progress(function(e) {\n    //         pb.value(e.progress);\n    //     })\n    //     .always(function() {\n    //         kendo.destroy(loading);\n    //         loading.remove();\n    //     });\n    // }\n\n    _workbookPdfExport(e) {\n        if (this.trigger(\"pdfExport\", e)) {\n            e.preventDefault();\n        }\n    }\n\n    _workbookInsertSheet(e) {\n        if (this.trigger(\"insertSheet\", e)) {\n            e.preventDefault();\n        }\n    }\n\n    _workbookRemoveSheet(e) {\n        if (this.trigger(\"removeSheet\", e)) {\n            e.preventDefault();\n        }\n    }\n\n    _workbookSelectSheet(e) {\n        if (this.trigger(\"selectSheet\", e)) {\n            e.preventDefault();\n        }\n    }\n\n    _workbookRenameSheet(e) {\n        if (this.trigger(\"renameSheet\", e)) {\n            e.preventDefault();\n        }\n    }\n\n    _workbookInsertRow(e) {\n        if (this.trigger(\"insertRow\", e)) {\n            e.preventDefault();\n        }\n    }\n\n    _workbookInsertColumn(e) {\n        if (this.trigger(\"insertColumn\", e)) {\n            e.preventDefault();\n        }\n    }\n\n    _workbookDeleteRow(e) {\n        if (this.trigger(\"deleteRow\", e)) {\n            e.preventDefault();\n        }\n    }\n\n    _workbookDeleteColumn(e) {\n        if (this.trigger(\"deleteColumn\", e)) {\n            e.preventDefault();\n        }\n    }\n\n    _workbookHideRow(e) {\n        if (this.trigger(\"hideRow\", e)) {\n            e.preventDefault();\n        }\n    }\n\n    _workbookHideColumn(e) {\n        if (this.trigger(\"hideColumn\", e)) {\n            e.preventDefault();\n        }\n    }\n\n    _workbookUnhideRow(e) {\n        if (this.trigger(\"unhideRow\", e)) {\n            e.preventDefault();\n        }\n    }\n\n    _workbookUnhideColumn(e) {\n        if (this.trigger(\"unhideColumn\", e)) {\n            e.preventDefault();\n        }\n    }\n\n    _workbookSelect(e) {\n        this.trigger(\"select\", e);\n    }\n\n    _workbookChangeFormat(e) {\n        this.trigger(\"changeFormat\", e);\n    }\n\n    _workbookDataBinding(e) {\n        if (this.trigger(\"dataBinding\", e)) {\n            e.preventDefault();\n        }\n    }\n\n    _workbookDataBound(e) {\n        this.trigger(\"dataBound\", e);\n    }\n\n    _workbookProgress() {\n        // kendo.ui.progress(this.element, e.toggle);\n    }\n\n    _viewUpdate(e) {\n        this.trigger(\"update\", e);\n    }\n\n    _viewMessage(e) {\n        this.trigger(\"message\", e);\n    }\n\n    _onContextMenu(e) {\n        this.trigger(\"contextmenu\", e);\n    }\n\n    _bindWorkbookEvents() {\n        this._workbook.bind(\"cut\", this._workbookCut.bind(this));\n        this._workbook.bind(\"copy\", this._workbookCopy.bind(this));\n        this._workbook.bind(\"paste\", this._workbookPaste.bind(this));\n        this._workbook.bind(\"changing\", this._workbookChanging.bind(this));\n        this._workbook.bind(\"change\", this._workbookChange.bind(this));\n        this._workbook.bind(\"excelExport\", this._workbookExcelExport.bind(this));\n        this._workbook.bind(\"excelImport\", this._workbookExcelImport.bind(this));\n        this._workbook.bind(\"pdfExport\", this._workbookPdfExport.bind(this));\n        this._workbook.bind(\"insertSheet\", this._workbookInsertSheet.bind(this));\n        this._workbook.bind(\"removeSheet\", this._workbookRemoveSheet.bind(this));\n        this._workbook.bind(\"selectSheet\", this._workbookSelectSheet.bind(this));\n        this._workbook.bind(\"renameSheet\", this._workbookRenameSheet.bind(this));\n        this._workbook.bind(\"insertRow\", this._workbookInsertRow.bind(this));\n        this._workbook.bind(\"insertColumn\", this._workbookInsertColumn.bind(this));\n        this._workbook.bind(\"deleteRow\", this._workbookDeleteRow.bind(this));\n        this._workbook.bind(\"deleteColumn\", this._workbookDeleteColumn.bind(this));\n        this._workbook.bind(\"hideRow\", this._workbookHideRow.bind(this));\n        this._workbook.bind(\"hideColumn\", this._workbookHideColumn.bind(this));\n        this._workbook.bind(\"unhideRow\", this._workbookUnhideRow.bind(this));\n        this._workbook.bind(\"unhideColumn\", this._workbookUnhideColumn.bind(this));\n        this._workbook.bind(\"select\", this._workbookSelect.bind(this));\n        this._workbook.bind(\"changeFormat\", this._workbookChangeFormat.bind(this));\n        this._workbook.bind(\"dataBinding\", this._workbookDataBinding.bind(this));\n        this._workbook.bind(\"dataBound\", this._workbookDataBound.bind(this));\n        this._workbook.bind(\"progress\", this._workbookProgress.bind(this));\n        this._workbook.bind(\"contextmenu\", this._onContextMenu.bind(this));\n    }\n\n    _bindViewEvents() {\n        this._view.bind(\"update\", this._viewUpdate.bind(this));\n        this._view.bind(\"message\", this._viewMessage.bind(this));\n    }\n\n    destroy() {\n        window.removeEventListener('resize', this._resizeHandler);\n        this.element.removeEventListener(\"keydown\", this._keyDownHandler);\n\n        this.unbind();\n\n        this._workbook.destroy();\n        this._controller.destroy();\n        this._view.destroy();\n    }\n\n    defineName(name, value, hidden) {\n        return this._workbook.defineName(name, value, hidden);\n    }\n\n    undefineName(name) {\n        return this._workbook.undefineName(name);\n    }\n\n    nameValue(name) {\n        return this._workbook.nameValue(name);\n    }\n\n    forEachName(func) {\n        return this._workbook.forEachName(func);\n    }\n\n    cellContextMenu() {\n        return this._view.cellContextMenu;\n    }\n\n    rowHeaderContextMenu() {\n        return this._view.rowHeaderContextMenu;\n    }\n\n    colHeaderContextMenu() {\n        return this._view.colHeaderContextMenu;\n    }\n\n    addImage(image) {\n        return this._workbook.addImage(image);\n    }\n\n    cleanupImages() {\n        return this._workbook.cleanupImages();\n    }\n}\n\n/* -----[ Excel operators ]----- */\n\n\nconst {\n    FUNCS,\n    defineBuiltinFunction,\n    limitPrecision,\n    packDate: packDate$1,\n    unpackDate: unpackDate$1,\n    daysInMonth,\n    daysInYear,\n    isLeapYear,\n} = calc.runtime;\n\ndefineBuiltinFunction('binary+', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false) || ($a == null ? ($a = 0, true) : false))) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!((typeof ($b = this.force($b)) == 'number' ? ($b = limitPrecision($b), true) : false) || (typeof $b == 'boolean' ? ($b = +$b, true) : false) || (typeof $b == 'string' && !/^(?:=|true|false)/i.test($b) ? (tmp = calc.parse(0, 0, 0, $b), /^date|number|percent$/.test(tmp.type) ? ($b = +tmp.value, true) : false) : false) || ($b == null ? ($b = 0, true) : false))) {\n                if ($b instanceof CalcError)\n                    return $b;\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $a = this._arrayArg(args[i]);\n        if ($a) {\n            xargs.push($a);\n            width = Math.max(width, $a.width);\n            height = Math.max(height, $a.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $b = this._arrayArg(args[i]);\n        if ($b) {\n            xargs.push($b);\n            width = Math.max(width, $b.width);\n            height = Math.max(height, $b.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (a, b) {\n    return a + b;\n});\n\ndefineBuiltinFunction('binary-', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false) || ($a == null ? ($a = 0, true) : false))) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!((typeof ($b = this.force($b)) == 'number' ? ($b = limitPrecision($b), true) : false) || (typeof $b == 'boolean' ? ($b = +$b, true) : false) || (typeof $b == 'string' && !/^(?:=|true|false)/i.test($b) ? (tmp = calc.parse(0, 0, 0, $b), /^date|number|percent$/.test(tmp.type) ? ($b = +tmp.value, true) : false) : false) || ($b == null ? ($b = 0, true) : false))) {\n                if ($b instanceof CalcError)\n                    return $b;\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $a = this._arrayArg(args[i]);\n        if ($a) {\n            xargs.push($a);\n            width = Math.max(width, $a.width);\n            height = Math.max(height, $a.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $b = this._arrayArg(args[i]);\n        if ($b) {\n            xargs.push($b);\n            width = Math.max(width, $b.width);\n            height = Math.max(height, $b.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (a, b) {\n    return a - b;\n});\n\ndefineBuiltinFunction('binary*', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false) || ($a == null ? ($a = 0, true) : false))) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!((typeof ($b = this.force($b)) == 'number' ? ($b = limitPrecision($b), true) : false) || (typeof $b == 'boolean' ? ($b = +$b, true) : false) || (typeof $b == 'string' && !/^(?:=|true|false)/i.test($b) ? (tmp = calc.parse(0, 0, 0, $b), /^date|number|percent$/.test(tmp.type) ? ($b = +tmp.value, true) : false) : false) || ($b == null ? ($b = 0, true) : false))) {\n                if ($b instanceof CalcError)\n                    return $b;\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $a = this._arrayArg(args[i]);\n        if ($a) {\n            xargs.push($a);\n            width = Math.max(width, $a.width);\n            height = Math.max(height, $a.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $b = this._arrayArg(args[i]);\n        if ($b) {\n            xargs.push($b);\n            width = Math.max(width, $b.width);\n            height = Math.max(height, $b.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (a, b) {\n    return a * b;\n});\n\ndefineBuiltinFunction('binary/', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false) || ($a == null ? ($a = 0, true) : false))) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!(((typeof ($b = this.force($b)) == 'number' ? ($b = limitPrecision($b), true) : false) || (typeof $b == 'boolean' ? ($b = +$b, true) : false) || (typeof $b == 'string' && !/^(?:=|true|false)/i.test($b) ? (tmp = calc.parse(0, 0, 0, $b), /^date|number|percent$/.test(tmp.type) ? ($b = +tmp.value, true) : false) : false)) && ($b == 0 ? (err = 'DIV/0', false) : true))) {\n                if ($b instanceof CalcError)\n                    return $b;\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $a = this._arrayArg(args[i]);\n        if ($a) {\n            xargs.push($a);\n            width = Math.max(width, $a.width);\n            height = Math.max(height, $a.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $b = this._arrayArg(args[i]);\n        if ($b) {\n            xargs.push($b);\n            width = Math.max(width, $b.width);\n            height = Math.max(height, $b.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (a, b) {\n    return a / b;\n});\n\ndefineBuiltinFunction('binary^', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false) || ($a == null ? ($a = 0, true) : false))) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!((typeof ($b = this.force($b)) == 'number' ? ($b = limitPrecision($b), true) : false) || (typeof $b == 'boolean' ? ($b = +$b, true) : false) || (typeof $b == 'string' && !/^(?:=|true|false)/i.test($b) ? (tmp = calc.parse(0, 0, 0, $b), /^date|number|percent$/.test(tmp.type) ? ($b = +tmp.value, true) : false) : false) || ($b == null ? ($b = 0, true) : false))) {\n                if ($b instanceof CalcError)\n                    return $b;\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $a = this._arrayArg(args[i]);\n        if ($a) {\n            xargs.push($a);\n            width = Math.max(width, $a.width);\n            height = Math.max(height, $a.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $b = this._arrayArg(args[i]);\n        if ($b) {\n            xargs.push($b);\n            width = Math.max(width, $b.width);\n            height = Math.max(height, $b.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (a, b) {\n    return Math.pow(a, b);\n});\n\ndefineBuiltinFunction('binary&', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false) || (typeof $a == 'string' || typeof $a == 'boolean' || typeof $a == 'number' ? ($a += '', true) : $a === undefined ? ($a = '', true) : false) || typeof $a == 'boolean' || $a == null)) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!((typeof ($b = this.force($b)) == 'number' ? ($b = limitPrecision($b), true) : false) || (typeof $b == 'boolean' ? ($b = +$b, true) : false) || (typeof $b == 'string' && !/^(?:=|true|false)/i.test($b) ? (tmp = calc.parse(0, 0, 0, $b), /^date|number|percent$/.test(tmp.type) ? ($b = +tmp.value, true) : false) : false) || (typeof $b == 'string' || typeof $b == 'boolean' || typeof $b == 'number' ? ($b += '', true) : $b === undefined ? ($b = '', true) : false) || typeof $b == 'boolean' || $b == null)) {\n                if ($b instanceof CalcError)\n                    return $b;\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $a = this._arrayArg(args[i]);\n        if ($a) {\n            xargs.push($a);\n            width = Math.max(width, $a.width);\n            height = Math.max(height, $a.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $b = this._arrayArg(args[i]);\n        if ($b) {\n            xargs.push($b);\n            width = Math.max(width, $b.width);\n            height = Math.max(height, $b.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (a, b) {\n    if (a == null) {\n        a = '';\n    }\n    if (b == null) {\n        b = '';\n    }\n    return '' + a + b;\n});\n\nfunction equals(a, b) {\n    a = typeof(a) === \"string\" ? a.toLowerCase() : a;\n    b = typeof(b) === \"string\" ? b.toLowerCase() : b;\n\n    // special cases\n    if (a === false && b == null) { return true; }\n    if (b === false && a == null) { return true; }\n    if (a === 0 && b == null) { return true; }\n    if (b === 0 && a == null) { return true; }\n    if (a === \"\" && b == null) { return true; }\n    if (b === \"\" && a == null) { return true; }\n\n    return a === b;\n}\n\ndefineBuiltinFunction('binary=', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!($a = this.force($a), i <= args.length)) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!($b = this.force($b), i <= args.length)) {\n                if ($b instanceof CalcError)\n                    return $b;\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $a = this._arrayArg(args[i]);\n        if ($a) {\n            xargs.push($a);\n            width = Math.max(width, $a.width);\n            height = Math.max(height, $a.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $b = this._arrayArg(args[i]);\n        if ($b) {\n            xargs.push($b);\n            width = Math.max(width, $b.width);\n            height = Math.max(height, $b.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (a, b) {\n    return equals(a, b);\n});\n\ndefineBuiltinFunction('binary<>', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!($a = this.force($a), i <= args.length)) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!($b = this.force($b), i <= args.length)) {\n                if ($b instanceof CalcError)\n                    return $b;\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $a = this._arrayArg(args[i]);\n        if ($a) {\n            xargs.push($a);\n            width = Math.max(width, $a.width);\n            height = Math.max(height, $a.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $b = this._arrayArg(args[i]);\n        if ($b) {\n            xargs.push($b);\n            width = Math.max(width, $b.width);\n            height = Math.max(height, $b.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (a, b) {\n    return !equals(a, b);\n});\n\nfunction binaryCompare(left, right, func) {\n    if (typeof left == \"string\" && typeof right != \"string\") {\n        right = right == null ? \"\" : right + \"\";\n    }\n    if (typeof left != \"string\" && typeof right == \"string\") {\n        left = left == null ? \"\" : left + \"\";\n    }\n    if (typeof left == \"number\" && right == null) {\n        right = 0;\n    }\n    if (typeof right == \"number\" && left == null) {\n        left = 0;\n    }\n    if (typeof left == \"string\" && typeof right == \"string\") {\n        // string comparison is case insensitive\n        left = left.toLowerCase();\n        right = right.toLowerCase();\n    }\n    if (typeof right == typeof left) {\n        // for issue https://github.com/telerik/kendo-ui-core/issues/6879, limitPrecision\n        // digits got bumped to 16, but it's too much for the case 9.302 - 0.002 (issue\n        // https://github.com/telerik/kendo-ui-core/issues/7170).\n        left = maybeRoundFloatErrors(left, 15);\n        right = maybeRoundFloatErrors(right, 15);\n        return func(left, right);\n    } else {\n        return new CalcError(\"VALUE\");\n    }\n}\n\ndefineBuiltinFunction('binary<', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!($a = this.force($a), i <= args.length)) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!($b = this.force($b), i <= args.length)) {\n                if ($b instanceof CalcError)\n                    return $b;\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $a = this._arrayArg(args[i]);\n        if ($a) {\n            xargs.push($a);\n            width = Math.max(width, $a.width);\n            height = Math.max(height, $a.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $b = this._arrayArg(args[i]);\n        if ($b) {\n            xargs.push($b);\n            width = Math.max(width, $b.width);\n            height = Math.max(height, $b.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (a, b) {\n    return binaryCompare(a, b, (a, b) => a < b);\n});\n\ndefineBuiltinFunction('binary<=', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!($a = this.force($a), i <= args.length)) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!($b = this.force($b), i <= args.length)) {\n                if ($b instanceof CalcError)\n                    return $b;\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $a = this._arrayArg(args[i]);\n        if ($a) {\n            xargs.push($a);\n            width = Math.max(width, $a.width);\n            height = Math.max(height, $a.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $b = this._arrayArg(args[i]);\n        if ($b) {\n            xargs.push($b);\n            width = Math.max(width, $b.width);\n            height = Math.max(height, $b.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (a, b) {\n    return binaryCompare(a, b, (a, b) => a <= b);\n});\n\ndefineBuiltinFunction('binary>', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!($a = this.force($a), i <= args.length)) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!($b = this.force($b), i <= args.length)) {\n                if ($b instanceof CalcError)\n                    return $b;\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $a = this._arrayArg(args[i]);\n        if ($a) {\n            xargs.push($a);\n            width = Math.max(width, $a.width);\n            height = Math.max(height, $a.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $b = this._arrayArg(args[i]);\n        if ($b) {\n            xargs.push($b);\n            width = Math.max(width, $b.width);\n            height = Math.max(height, $b.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (a, b) {\n    return binaryCompare(a, b, (a, b) => a > b);\n});\n\ndefineBuiltinFunction('binary>=', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!($a = this.force($a), i <= args.length)) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!($b = this.force($b), i <= args.length)) {\n                if ($b instanceof CalcError)\n                    return $b;\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $a = this._arrayArg(args[i]);\n        if ($a) {\n            xargs.push($a);\n            width = Math.max(width, $a.width);\n            height = Math.max(height, $a.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $b = this._arrayArg(args[i]);\n        if ($b) {\n            xargs.push($b);\n            width = Math.max(width, $b.width);\n            height = Math.max(height, $b.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (a, b) {\n    return binaryCompare(a, b, (a, b) => a >= b);\n});\n\ndefineBuiltinFunction('unary+', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false) || ($a == null ? ($a = 0, true) : false))) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $a = this._arrayArg(args[i]);\n        if ($a) {\n            xargs.push($a);\n            width = Math.max(width, $a.width);\n            height = Math.max(height, $a.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (a) {\n    return a;\n});\n\ndefineBuiltinFunction('unary-', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false) || ($a == null ? ($a = 0, true) : false))) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $a = this._arrayArg(args[i]);\n        if ($a) {\n            xargs.push($a);\n            width = Math.max(width, $a.width);\n            height = Math.max(height, $a.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (a) {\n    return -a;\n});\n\ndefineBuiltinFunction('unary%', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false) || ($a == null ? ($a = 0, true) : false))) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $a = this._arrayArg(args[i]);\n        if ($a) {\n            xargs.push($a);\n            width = Math.max(width, $a.width);\n            height = Math.max(height, $a.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (a) {\n    return a / 100;\n});\n\n// range operator\ndefineBuiltinFunction('binary:', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!($a instanceof CellRef)) {\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!($b instanceof CellRef)) {\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    return { check: check };\n}(), function (a, b) {\n    return new RangeRef(a, b).setSheet(a.sheet || this.formula.sheet, a.hasSheet());\n});\n\n// union operator\ndefineBuiltinFunction('binary,', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!($a instanceof Ref)) {\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!($b instanceof Ref)) {\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    return { check: check };\n}(), function (a, b) {\n    return new UnionRef([\n        a,\n        b\n    ]);\n});\n\n// intersection operator\ndefineBuiltinFunction('binary ', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!($a instanceof Ref)) {\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!($b instanceof Ref)) {\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    return { check: check };\n}(), function (a, b) {\n    return a.intersect(b);\n});\n\n/* -----[ conditionals ]----- */\n\ndefineBuiltinFunction('not', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!(($a = this.force($a)) != null && i <= args.length || ($a == null ? ($a = 0, true) : false))) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $a = this._arrayArg(args[i]);\n        if ($a) {\n            xargs.push($a);\n            width = Math.max(width, $a.width);\n            height = Math.max(height, $a.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (a) {\n    return !this.bool(a);\n});\n\n/* -----[ the IS* functions ]----- */\n\ndefineBuiltinFunction('isblank', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $value = args[i++];\n            if (!(i <= args.length)) {\n                return new CalcError(err);\n            }\n            xargs.push($value);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $value = this._arrayArg(args[i]);\n        if ($value) {\n            xargs.push($value);\n            width = Math.max(width, $value.width);\n            height = Math.max(height, $value.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        arrayArgs: arrayArgs\n    };\n}(), function (val) {\n    if (val instanceof CellRef) {\n        val = this.getRefData(val);\n        return val == null;\n    }\n    return false;\n});\n\ndefineBuiltinFunction('iserror', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $value = args[i++];\n            if (!($value = this.force($value), i <= args.length)) {\n                return new CalcError(err);\n            }\n            xargs.push($value);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $value = this._arrayArg(args[i]);\n        if ($value) {\n            xargs.push($value);\n            width = Math.max(width, $value.width);\n            height = Math.max(height, $value.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (val) {\n    return val instanceof CalcError;\n});\n\ndefineBuiltinFunction('iserr', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $value = args[i++];\n            if (!($value = this.force($value), i <= args.length)) {\n                return new CalcError(err);\n            }\n            xargs.push($value);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $value = this._arrayArg(args[i]);\n        if ($value) {\n            xargs.push($value);\n            width = Math.max(width, $value.width);\n            height = Math.max(height, $value.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (val) {\n    return val instanceof CalcError && val.code != 'N/A';\n});\n\ndefineBuiltinFunction('isna', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $value = args[i++];\n            if (!($value = this.force($value), i <= args.length)) {\n                return new CalcError(err);\n            }\n            xargs.push($value);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $value = this._arrayArg(args[i]);\n        if ($value) {\n            xargs.push($value);\n            width = Math.max(width, $value.width);\n            height = Math.max(height, $value.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (val) {\n    return val instanceof CalcError && val.code == 'N/A';\n});\n\ndefineBuiltinFunction('islogical', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $value = args[i++];\n            if (!($value = this.force($value), i <= args.length)) {\n                return new CalcError(err);\n            }\n            xargs.push($value);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $value = this._arrayArg(args[i]);\n        if ($value) {\n            xargs.push($value);\n            width = Math.max(width, $value.width);\n            height = Math.max(height, $value.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (val) {\n    return typeof val == 'boolean';\n});\n\ndefineBuiltinFunction('isnontext', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $value = args[i++];\n            if (!($value = this.force($value), i <= args.length)) {\n                return new CalcError(err);\n            }\n            xargs.push($value);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $value = this._arrayArg(args[i]);\n        if ($value) {\n            xargs.push($value);\n            width = Math.max(width, $value.width);\n            height = Math.max(height, $value.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (val) {\n    return typeof val != 'string';\n});\n\ndefineBuiltinFunction('istext', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $value = args[i++];\n            if (!($value = this.force($value), i <= args.length)) {\n                return new CalcError(err);\n            }\n            xargs.push($value);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $value = this._arrayArg(args[i]);\n        if ($value) {\n            xargs.push($value);\n            width = Math.max(width, $value.width);\n            height = Math.max(height, $value.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (val) {\n    return typeof val == 'string';\n});\n\ndefineBuiltinFunction('isnumber', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $value = args[i++];\n            if (!($value = this.force($value), i <= args.length)) {\n                return new CalcError(err);\n            }\n            xargs.push($value);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $value = this._arrayArg(args[i]);\n        if ($value) {\n            xargs.push($value);\n            width = Math.max(width, $value.width);\n            height = Math.max(height, $value.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (val) {\n    return typeof val == 'number';\n});\n\ndefineBuiltinFunction('isref', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $value = args[i++];\n            if (!(i <= args.length)) {\n                return new CalcError(err);\n            }\n            xargs.push($value);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $value = this._arrayArg(args[i]);\n        if ($value) {\n            xargs.push($value);\n            width = Math.max(width, $value.width);\n            height = Math.max(height, $value.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        arrayArgs: arrayArgs\n    };\n}(), function (val) {\n    return val instanceof CellRef || val instanceof RangeRef;\n});\n\ndefineBuiltinFunction('_matrix', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $m = args[i++];\n            if ($m instanceof CalcError)\n                return $m;\n            if (!(((m = this.asMatrix($m)) ? $m = m : false) || (typeof $m == 'string' || typeof $m == 'boolean' || typeof $m == 'number' ? ($m += '', true) : $m === undefined ? ($m = '', true) : false))) {\n                if ($m instanceof CalcError)\n                    return $m;\n                return new CalcError(err);\n            }\n            xargs.push($m);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (m) {\n    if (typeof m == 'string') {\n        m = this.asMatrix([m.split(/\\s*,\\s*/)]);\n    }\n    return m;\n});\n\n/* -----[ resolve NameRef-s ]----- */\n\nFUNCS[\",getname\"] = function(callback, args) {\n    this.fetchName(args[0], callback);\n};\n\n// --------------------------------------------runtime-functions.js\n\n/* -----[ Math functions ]----- */\n\ndefineBuiltinFunction('abs', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $n = args[i++];\n            if ($n instanceof CalcError)\n                return $n;\n            if (!((typeof ($n = this.force($n)) == 'number' ? ($n = limitPrecision($n), true) : false) || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false))) {\n                if ($n instanceof CalcError)\n                    return $n;\n                return new CalcError(err);\n            }\n            xargs.push($n);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $n = this._arrayArg(args[i]);\n        if ($n) {\n            xargs.push($n);\n            width = Math.max(width, $n.width);\n            height = Math.max(height, $n.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), Math.abs);\ndefineBuiltinFunction('cos', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $n = args[i++];\n            if ($n instanceof CalcError)\n                return $n;\n            if (!((typeof ($n = this.force($n)) == 'number' ? ($n = limitPrecision($n), true) : false) || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false))) {\n                if ($n instanceof CalcError)\n                    return $n;\n                return new CalcError(err);\n            }\n            xargs.push($n);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $n = this._arrayArg(args[i]);\n        if ($n) {\n            xargs.push($n);\n            width = Math.max(width, $n.width);\n            height = Math.max(height, $n.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), Math.cos);\ndefineBuiltinFunction('sin', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $n = args[i++];\n            if ($n instanceof CalcError)\n                return $n;\n            if (!((typeof ($n = this.force($n)) == 'number' ? ($n = limitPrecision($n), true) : false) || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false))) {\n                if ($n instanceof CalcError)\n                    return $n;\n                return new CalcError(err);\n            }\n            xargs.push($n);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $n = this._arrayArg(args[i]);\n        if ($n) {\n            xargs.push($n);\n            width = Math.max(width, $n.width);\n            height = Math.max(height, $n.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), Math.sin);\ndefineBuiltinFunction('acos', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $n = args[i++];\n            if ($n instanceof CalcError)\n                return $n;\n            if (!((typeof ($n = this.force($n)) == 'number' ? ($n = limitPrecision($n), true) : false) || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false))) {\n                if ($n instanceof CalcError)\n                    return $n;\n                return new CalcError(err);\n            }\n            xargs.push($n);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $n = this._arrayArg(args[i]);\n        if ($n) {\n            xargs.push($n);\n            width = Math.max(width, $n.width);\n            height = Math.max(height, $n.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), Math.acos);\ndefineBuiltinFunction('asin', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $n = args[i++];\n            if ($n instanceof CalcError)\n                return $n;\n            if (!((typeof ($n = this.force($n)) == 'number' ? ($n = limitPrecision($n), true) : false) || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false))) {\n                if ($n instanceof CalcError)\n                    return $n;\n                return new CalcError(err);\n            }\n            xargs.push($n);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $n = this._arrayArg(args[i]);\n        if ($n) {\n            xargs.push($n);\n            width = Math.max(width, $n.width);\n            height = Math.max(height, $n.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), Math.asin);\ndefineBuiltinFunction('tan', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $n = args[i++];\n            if ($n instanceof CalcError)\n                return $n;\n            if (!((typeof ($n = this.force($n)) == 'number' ? ($n = limitPrecision($n), true) : false) || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false))) {\n                if ($n instanceof CalcError)\n                    return $n;\n                return new CalcError(err);\n            }\n            xargs.push($n);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $n = this._arrayArg(args[i]);\n        if ($n) {\n            xargs.push($n);\n            width = Math.max(width, $n.width);\n            height = Math.max(height, $n.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), Math.tan);\ndefineBuiltinFunction('atan', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $n = args[i++];\n            if ($n instanceof CalcError)\n                return $n;\n            if (!((typeof ($n = this.force($n)) == 'number' ? ($n = limitPrecision($n), true) : false) || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false))) {\n                if ($n instanceof CalcError)\n                    return $n;\n                return new CalcError(err);\n            }\n            xargs.push($n);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $n = this._arrayArg(args[i]);\n        if ($n) {\n            xargs.push($n);\n            width = Math.max(width, $n.width);\n            height = Math.max(height, $n.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), Math.atan);\ndefineBuiltinFunction('exp', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $n = args[i++];\n            if ($n instanceof CalcError)\n                return $n;\n            if (!((typeof ($n = this.force($n)) == 'number' ? ($n = limitPrecision($n), true) : false) || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false))) {\n                if ($n instanceof CalcError)\n                    return $n;\n                return new CalcError(err);\n            }\n            xargs.push($n);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $n = this._arrayArg(args[i]);\n        if ($n) {\n            xargs.push($n);\n            width = Math.max(width, $n.width);\n            height = Math.max(height, $n.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), Math.exp);\ndefineBuiltinFunction('sqrt', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $n = args[i++];\n            if ($n instanceof CalcError)\n                return $n;\n            if (!((typeof ($n = this.force($n)) == 'number' ? ($n = limitPrecision($n), true) : false) || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false))) {\n                if ($n instanceof CalcError)\n                    return $n;\n                return new CalcError(err);\n            }\n            xargs.push($n);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $n = this._arrayArg(args[i]);\n        if ($n) {\n            xargs.push($n);\n            width = Math.max(width, $n.width);\n            height = Math.max(height, $n.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), Math.sqrt);\ndefineBuiltinFunction('ln', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $n = args[i++];\n            if ($n instanceof CalcError)\n                return $n;\n            if (!((typeof ($n = this.force($n)) == 'number' ? ($n = limitPrecision($n), true) : false) || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false))) {\n                if ($n instanceof CalcError)\n                    return $n;\n                return new CalcError(err);\n            }\n            xargs.push($n);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $n = this._arrayArg(args[i]);\n        if ($n) {\n            xargs.push($n);\n            width = Math.max(width, $n.width);\n            height = Math.max(height, $n.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), Math.log);\n\ndefineBuiltinFunction('log', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $num = args[i++];\n            if ($num instanceof CalcError)\n                return $num;\n            if (!(((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false)) && ($num > 0 ? true : (err = 'NUM', false)))) {\n                if ($num instanceof CalcError)\n                    return $num;\n                return new CalcError(err);\n            }\n            xargs.push($num);\n        }\n        {\n            var $base = args[i++];\n            if ($base instanceof CalcError)\n                return $base;\n            if (!(((typeof ($base = this.force($base)) == 'number' ? ($base = limitPrecision($base), true) : false) || (typeof $base == 'boolean' ? ($base = +$base, true) : false) || (typeof $base == 'string' && !/^(?:=|true|false)/i.test($base) ? (tmp = calc.parse(0, 0, 0, $base), /^date|number|percent$/.test(tmp.type) ? ($base = +tmp.value, true) : false) : false)) && ($base > 0 ? true : (err = 'NUM', false)) || ($base == null ? ($base = 10, true) : false))) {\n                if ($base instanceof CalcError)\n                    return $base;\n                return new CalcError(err);\n            }\n            xargs.push($base);\n        }\n        {\n            if (!($base != 1 ? true : (err = 'DIV/0', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $num = this._arrayArg(args[i]);\n        if ($num) {\n            xargs.push($num);\n            width = Math.max(width, $num.width);\n            height = Math.max(height, $num.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $base = this._arrayArg(args[i]);\n        if ($base) {\n            xargs.push($base);\n            width = Math.max(width, $base.width);\n            height = Math.max(height, $base.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (num, base) {\n    return Math.log(num) / Math.log(base);\n});\n\ndefineBuiltinFunction('log10', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $num = args[i++];\n            if ($num instanceof CalcError)\n                return $num;\n            if (!(((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false)) && ($num > 0 ? true : (err = 'NUM', false)))) {\n                if ($num instanceof CalcError)\n                    return $num;\n                return new CalcError(err);\n            }\n            xargs.push($num);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $num = this._arrayArg(args[i]);\n        if ($num) {\n            xargs.push($num);\n            width = Math.max(width, $num.width);\n            height = Math.max(height, $num.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (num) {\n    return Math.log(num) / Math.log(10);\n});\n\ndefineBuiltinFunction('pi', false, function () {\n    function check(args) {\n        var xargs = [], i = 0;\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    return { check: check };\n}(), function () {\n    return Math.PI;\n});\n\ndefineBuiltinFunction('sqrtpi', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $num = args[i++];\n            if ($num instanceof CalcError)\n                return $num;\n            if (!(((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false)) && ($num >= 0 ? true : (err = 'NUM', false)))) {\n                if ($num instanceof CalcError)\n                    return $num;\n                return new CalcError(err);\n            }\n            xargs.push($num);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $num = this._arrayArg(args[i]);\n        if ($num) {\n            xargs.push($num);\n            width = Math.max(width, $num.width);\n            height = Math.max(height, $num.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (n) {\n    return Math.sqrt(n * Math.PI);\n});\n\ndefineBuiltinFunction('degrees', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $radians = args[i++];\n            if ($radians instanceof CalcError)\n                return $radians;\n            if (!((typeof ($radians = this.force($radians)) == 'number' ? ($radians = limitPrecision($radians), true) : false) || (typeof $radians == 'boolean' ? ($radians = +$radians, true) : false) || (typeof $radians == 'string' && !/^(?:=|true|false)/i.test($radians) ? (tmp = calc.parse(0, 0, 0, $radians), /^date|number|percent$/.test(tmp.type) ? ($radians = +tmp.value, true) : false) : false))) {\n                if ($radians instanceof CalcError)\n                    return $radians;\n                return new CalcError(err);\n            }\n            xargs.push($radians);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $radians = this._arrayArg(args[i]);\n        if ($radians) {\n            xargs.push($radians);\n            width = Math.max(width, $radians.width);\n            height = Math.max(height, $radians.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (rad) {\n    return 180 * rad / Math.PI % 360;\n});\n\ndefineBuiltinFunction('radians', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $degrees = args[i++];\n            if ($degrees instanceof CalcError)\n                return $degrees;\n            if (!((typeof ($degrees = this.force($degrees)) == 'number' ? ($degrees = limitPrecision($degrees), true) : false) || (typeof $degrees == 'boolean' ? ($degrees = +$degrees, true) : false) || (typeof $degrees == 'string' && !/^(?:=|true|false)/i.test($degrees) ? (tmp = calc.parse(0, 0, 0, $degrees), /^date|number|percent$/.test(tmp.type) ? ($degrees = +tmp.value, true) : false) : false))) {\n                if ($degrees instanceof CalcError)\n                    return $degrees;\n                return new CalcError(err);\n            }\n            xargs.push($degrees);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $degrees = this._arrayArg(args[i]);\n        if ($degrees) {\n            xargs.push($degrees);\n            width = Math.max(width, $degrees.width);\n            height = Math.max(height, $degrees.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (deg) {\n    return Math.PI * deg / 180;\n});\n\nfunction _cosh(n){\n    return (Math.exp(n) + Math.exp(-n)) / 2;\n}\n\ndefineBuiltinFunction('cosh', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $num = args[i++];\n            if ($num instanceof CalcError)\n                return $num;\n            if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                if ($num instanceof CalcError)\n                    return $num;\n                return new CalcError(err);\n            }\n            xargs.push($num);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $num = this._arrayArg(args[i]);\n        if ($num) {\n            xargs.push($num);\n            width = Math.max(width, $num.width);\n            height = Math.max(height, $num.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), _cosh);\n\ndefineBuiltinFunction('acosh', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $num = args[i++];\n            if ($num instanceof CalcError)\n                return $num;\n            if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                if ($num instanceof CalcError)\n                    return $num;\n                return new CalcError(err);\n            }\n            xargs.push($num);\n        }\n        {\n            if (!($num >= 1 ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $num = this._arrayArg(args[i]);\n        if ($num) {\n            xargs.push($num);\n            width = Math.max(width, $num.width);\n            height = Math.max(height, $num.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (n) {\n    return Math.log(n + Math.sqrt(n - 1) * Math.sqrt(n + 1));\n});\n\nfunction _sinh(n){\n    return (Math.exp(n) - Math.exp(-n)) / 2;\n}\n\ndefineBuiltinFunction('sinh', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $num = args[i++];\n            if ($num instanceof CalcError)\n                return $num;\n            if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                if ($num instanceof CalcError)\n                    return $num;\n                return new CalcError(err);\n            }\n            xargs.push($num);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $num = this._arrayArg(args[i]);\n        if ($num) {\n            xargs.push($num);\n            width = Math.max(width, $num.width);\n            height = Math.max(height, $num.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), _sinh);\n\ndefineBuiltinFunction('asinh', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $num = args[i++];\n            if ($num instanceof CalcError)\n                return $num;\n            if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                if ($num instanceof CalcError)\n                    return $num;\n                return new CalcError(err);\n            }\n            xargs.push($num);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $num = this._arrayArg(args[i]);\n        if ($num) {\n            xargs.push($num);\n            width = Math.max(width, $num.width);\n            height = Math.max(height, $num.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (n) {\n    return Math.log(n + Math.sqrt(n * n + 1));\n});\n\ndefineBuiltinFunction('sec', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $num = args[i++];\n            if ($num instanceof CalcError)\n                return $num;\n            if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                if ($num instanceof CalcError)\n                    return $num;\n                return new CalcError(err);\n            }\n            xargs.push($num);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $num = this._arrayArg(args[i]);\n        if ($num) {\n            xargs.push($num);\n            width = Math.max(width, $num.width);\n            height = Math.max(height, $num.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (n) {\n    return 1 / Math.cos(n);\n});\n\ndefineBuiltinFunction('sech', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $num = args[i++];\n            if ($num instanceof CalcError)\n                return $num;\n            if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                if ($num instanceof CalcError)\n                    return $num;\n                return new CalcError(err);\n            }\n            xargs.push($num);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $num = this._arrayArg(args[i]);\n        if ($num) {\n            xargs.push($num);\n            width = Math.max(width, $num.width);\n            height = Math.max(height, $num.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (n) {\n    return 1 / _cosh(n);\n});\n\ndefineBuiltinFunction('csc', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $num = args[i++];\n            if ($num instanceof CalcError)\n                return $num;\n            if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                if ($num instanceof CalcError)\n                    return $num;\n                return new CalcError(err);\n            }\n            xargs.push($num);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $num = this._arrayArg(args[i]);\n        if ($num) {\n            xargs.push($num);\n            width = Math.max(width, $num.width);\n            height = Math.max(height, $num.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (n) {\n    return 1 / Math.sin(n);\n});\n\ndefineBuiltinFunction('csch', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $num = args[i++];\n            if ($num instanceof CalcError)\n                return $num;\n            if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                if ($num instanceof CalcError)\n                    return $num;\n                return new CalcError(err);\n            }\n            xargs.push($num);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $num = this._arrayArg(args[i]);\n        if ($num) {\n            xargs.push($num);\n            width = Math.max(width, $num.width);\n            height = Math.max(height, $num.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (n) {\n    return 1 / _sinh(n);\n});\n\ndefineBuiltinFunction('atan2', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x == 0 ? (err = 'DIV/0', false) : true))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        {\n            var $y = args[i++];\n            if ($y instanceof CalcError)\n                return $y;\n            if (!((typeof ($y = this.force($y)) == 'number' ? ($y = limitPrecision($y), true) : false) || (typeof $y == 'boolean' ? ($y = +$y, true) : false) || (typeof $y == 'string' && !/^(?:=|true|false)/i.test($y) ? (tmp = calc.parse(0, 0, 0, $y), /^date|number|percent$/.test(tmp.type) ? ($y = +tmp.value, true) : false) : false))) {\n                if ($y instanceof CalcError)\n                    return $y;\n                return new CalcError(err);\n            }\n            xargs.push($y);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $x = this._arrayArg(args[i]);\n        if ($x) {\n            xargs.push($x);\n            width = Math.max(width, $x.width);\n            height = Math.max(height, $x.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $y = this._arrayArg(args[i]);\n        if ($y) {\n            xargs.push($y);\n            width = Math.max(width, $y.width);\n            height = Math.max(height, $y.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (x, y) {\n    return Math.atan(y / x);\n});\n\nfunction _tanh(n) {\n    return _sinh(n) / _cosh(n);\n}\n\ndefineBuiltinFunction('tanh', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $num = args[i++];\n            if ($num instanceof CalcError)\n                return $num;\n            if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                if ($num instanceof CalcError)\n                    return $num;\n                return new CalcError(err);\n            }\n            xargs.push($num);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $num = this._arrayArg(args[i]);\n        if ($num) {\n            xargs.push($num);\n            width = Math.max(width, $num.width);\n            height = Math.max(height, $num.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), _tanh);\n\ndefineBuiltinFunction('atanh', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $num = args[i++];\n            if ($num instanceof CalcError)\n                return $num;\n            if (!(((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false)) && ($num > -1 && $num < 1 ? true : (err = 'NUM', false)))) {\n                if ($num instanceof CalcError)\n                    return $num;\n                return new CalcError(err);\n            }\n            xargs.push($num);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $num = this._arrayArg(args[i]);\n        if ($num) {\n            xargs.push($num);\n            width = Math.max(width, $num.width);\n            height = Math.max(height, $num.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (n) {\n    return Math.log(Math.sqrt(1 - n * n) / (1 - n));\n});\n\ndefineBuiltinFunction('cot', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $num = args[i++];\n            if ($num instanceof CalcError)\n                return $num;\n            if (!(((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false)) && ($num == 0 ? (err = 'DIV/0', false) : true))) {\n                if ($num instanceof CalcError)\n                    return $num;\n                return new CalcError(err);\n            }\n            xargs.push($num);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $num = this._arrayArg(args[i]);\n        if ($num) {\n            xargs.push($num);\n            width = Math.max(width, $num.width);\n            height = Math.max(height, $num.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (n) {\n    return 1 / Math.tan(n);\n});\n\ndefineBuiltinFunction('coth', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $num = args[i++];\n            if ($num instanceof CalcError)\n                return $num;\n            if (!(((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false)) && ($num == 0 ? (err = 'DIV/0', false) : true))) {\n                if ($num instanceof CalcError)\n                    return $num;\n                return new CalcError(err);\n            }\n            xargs.push($num);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $num = this._arrayArg(args[i]);\n        if ($num) {\n            xargs.push($num);\n            width = Math.max(width, $num.width);\n            height = Math.max(height, $num.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (n) {\n    return 1 / _tanh(n);\n});\n\ndefineBuiltinFunction('acot', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $num = args[i++];\n            if ($num instanceof CalcError)\n                return $num;\n            if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                if ($num instanceof CalcError)\n                    return $num;\n                return new CalcError(err);\n            }\n            xargs.push($num);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $num = this._arrayArg(args[i]);\n        if ($num) {\n            xargs.push($num);\n            width = Math.max(width, $num.width);\n            height = Math.max(height, $num.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (n) {\n    return Math.PI / 2 - Math.atan(n);\n});\n\ndefineBuiltinFunction('acoth', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $num = args[i++];\n            if ($num instanceof CalcError)\n                return $num;\n            if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                if ($num instanceof CalcError)\n                    return $num;\n                return new CalcError(err);\n            }\n            xargs.push($num);\n        }\n        {\n            if (!(($num < -1 ? true : (err = 'N/A', false)) || ($num > 1 ? true : (err = 'N/A', false))))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $num = this._arrayArg(args[i]);\n        if ($num) {\n            xargs.push($num);\n            width = Math.max(width, $num.width);\n            height = Math.max(height, $num.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (n) {\n    return Math.log((n + 1) / (n - 1)) / 2;\n});\n\ndefineBuiltinFunction('power', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false))) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!((typeof ($b = this.force($b)) == 'number' ? ($b = limitPrecision($b), true) : false) || (typeof $b == 'boolean' ? ($b = +$b, true) : false) || (typeof $b == 'string' && !/^(?:=|true|false)/i.test($b) ? (tmp = calc.parse(0, 0, 0, $b), /^date|number|percent$/.test(tmp.type) ? ($b = +tmp.value, true) : false) : false))) {\n                if ($b instanceof CalcError)\n                    return $b;\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $a = this._arrayArg(args[i]);\n        if ($a) {\n            xargs.push($a);\n            width = Math.max(width, $a.width);\n            height = Math.max(height, $a.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $b = this._arrayArg(args[i]);\n        if ($b) {\n            xargs.push($b);\n            width = Math.max(width, $b.width);\n            height = Math.max(height, $b.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (a, b) {\n    return Math.pow(a, b);\n});\n\ndefineBuiltinFunction('mod', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false))) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!(((typeof ($b = this.force($b)) == 'number' ? ($b = limitPrecision($b), true) : false) || (typeof $b == 'boolean' ? ($b = +$b, true) : false) || (typeof $b == 'string' && !/^(?:=|true|false)/i.test($b) ? (tmp = calc.parse(0, 0, 0, $b), /^date|number|percent$/.test(tmp.type) ? ($b = +tmp.value, true) : false) : false)) && ($b == 0 ? (err = 'DIV/0', false) : true))) {\n                if ($b instanceof CalcError)\n                    return $b;\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $a = this._arrayArg(args[i]);\n        if ($a) {\n            xargs.push($a);\n            width = Math.max(width, $a.width);\n            height = Math.max(height, $a.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $b = this._arrayArg(args[i]);\n        if ($b) {\n            xargs.push($b);\n            width = Math.max(width, $b.width);\n            height = Math.max(height, $b.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (a, b) {\n    return a % b;\n});\n\ndefineBuiltinFunction('quotient', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false))) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!(((typeof ($b = this.force($b)) == 'number' ? ($b = limitPrecision($b), true) : false) || (typeof $b == 'boolean' ? ($b = +$b, true) : false) || (typeof $b == 'string' && !/^(?:=|true|false)/i.test($b) ? (tmp = calc.parse(0, 0, 0, $b), /^date|number|percent$/.test(tmp.type) ? ($b = +tmp.value, true) : false) : false)) && ($b == 0 ? (err = 'DIV/0', false) : true))) {\n                if ($b instanceof CalcError)\n                    return $b;\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $a = this._arrayArg(args[i]);\n        if ($a) {\n            xargs.push($a);\n            width = Math.max(width, $a.width);\n            height = Math.max(height, $a.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $b = this._arrayArg(args[i]);\n        if ($b) {\n            xargs.push($b);\n            width = Math.max(width, $b.width);\n            height = Math.max(height, $b.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (a, b) {\n    return Math.floor(a / b);\n});\n\ndefineBuiltinFunction('ceiling', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $number = args[i++];\n            if ($number instanceof CalcError)\n                return $number;\n            if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                if ($number instanceof CalcError)\n                    return $number;\n                return new CalcError(err);\n            }\n            xargs.push($number);\n        }\n        {\n            var $significance = args[i++];\n            if ($significance instanceof CalcError)\n                return $significance;\n            if (!((typeof ($significance = this.force($significance)) == 'number' ? ($significance = limitPrecision($significance), true) : false) || (typeof $significance == 'boolean' ? ($significance = +$significance, true) : false) || (typeof $significance == 'string' && !/^(?:=|true|false)/i.test($significance) ? (tmp = calc.parse(0, 0, 0, $significance), /^date|number|percent$/.test(tmp.type) ? ($significance = +tmp.value, true) : false) : false))) {\n                if ($significance instanceof CalcError)\n                    return $significance;\n                return new CalcError(err);\n            }\n            xargs.push($significance);\n        }\n        {\n            if (!($significance >= 0 || $number < 0 ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $number = this._arrayArg(args[i]);\n        if ($number) {\n            xargs.push($number);\n            width = Math.max(width, $number.width);\n            height = Math.max(height, $number.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $significance = this._arrayArg(args[i]);\n        if ($significance) {\n            xargs.push($significance);\n            width = Math.max(width, $significance.width);\n            height = Math.max(height, $significance.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (num, s) {\n    return s ? s * Math.ceil(num / s) : 0;\n});\n\ndefineBuiltinFunction('ceiling.precise', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $number = args[i++];\n            if ($number instanceof CalcError)\n                return $number;\n            if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                if ($number instanceof CalcError)\n                    return $number;\n                return new CalcError(err);\n            }\n            xargs.push($number);\n        }\n        {\n            var $significance = args[i++];\n            if ($significance instanceof CalcError)\n                return $significance;\n            if (!((typeof ($significance = this.force($significance)) == 'number' ? ($significance = limitPrecision($significance), true) : false) || (typeof $significance == 'boolean' ? ($significance = +$significance, true) : false) || (typeof $significance == 'string' && !/^(?:=|true|false)/i.test($significance) ? (tmp = calc.parse(0, 0, 0, $significance), /^date|number|percent$/.test(tmp.type) ? ($significance = +tmp.value, true) : false) : false) || ($significance == null ? ($significance = 1, true) : false))) {\n                if ($significance instanceof CalcError)\n                    return $significance;\n                return new CalcError(err);\n            }\n            xargs.push($significance);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $number = this._arrayArg(args[i]);\n        if ($number) {\n            xargs.push($number);\n            width = Math.max(width, $number.width);\n            height = Math.max(height, $number.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $significance = this._arrayArg(args[i]);\n        if ($significance) {\n            xargs.push($significance);\n            width = Math.max(width, $significance.width);\n            height = Math.max(height, $significance.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (num, s) {\n    s = Math.abs(s);\n    return s ? s * Math.ceil(num / s) : 0;\n});\n\ncalc.runtime.defineAlias(\"iso.ceiling\", \"ceiling.precise\");\n\n// XXX: how do we know if this function is correct?\n//\n// https://support.office.com/en-gb/article/CEILING-MATH-function-80f95d2f-b499-4eee-9f16-f795a8e306c8\n//\n// “There are many combinations of Significance and Mode values that affect rounding of negative\n// numbers in different ways.” — right, thanks for the info. :-\\\ndefineBuiltinFunction('ceiling.math', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $number = args[i++];\n            if ($number instanceof CalcError)\n                return $number;\n            if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                if ($number instanceof CalcError)\n                    return $number;\n                return new CalcError(err);\n            }\n            xargs.push($number);\n        }\n        {\n            var $significance = args[i++];\n            if ($significance instanceof CalcError)\n                return $significance;\n            if (!((typeof ($significance = this.force($significance)) == 'number' ? ($significance = limitPrecision($significance), true) : false) || (typeof $significance == 'boolean' ? ($significance = +$significance, true) : false) || (typeof $significance == 'string' && !/^(?:=|true|false)/i.test($significance) ? (tmp = calc.parse(0, 0, 0, $significance), /^date|number|percent$/.test(tmp.type) ? ($significance = +tmp.value, true) : false) : false) || ($significance == null ? ($significance = $number < 0 ? -1 : 1, true) : false))) {\n                if ($significance instanceof CalcError)\n                    return $significance;\n                return new CalcError(err);\n            }\n            xargs.push($significance);\n        }\n        {\n            var $mode = args[i++];\n            if ($mode instanceof CalcError)\n                return $mode;\n            if (!(typeof ($mode = this.force($mode)) == 'boolean' || (typeof $mode == 'number' ? ($mode = !!$mode, true) : false) || ($mode == null ? ($mode = 0, true) : false))) {\n                if ($mode instanceof CalcError)\n                    return $mode;\n                return new CalcError(err);\n            }\n            xargs.push($mode);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $number = this._arrayArg(args[i]);\n        if ($number) {\n            xargs.push($number);\n            width = Math.max(width, $number.width);\n            height = Math.max(height, $number.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $significance = this._arrayArg(args[i]);\n        if ($significance) {\n            xargs.push($significance);\n            width = Math.max(width, $significance.width);\n            height = Math.max(height, $significance.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $mode = this._arrayArg(args[i]);\n        if ($mode) {\n            xargs.push($mode);\n            width = Math.max(width, $mode.width);\n            height = Math.max(height, $mode.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (num, s, mode) {\n    if (!s || !num) {\n        return 0;\n    }\n    if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n        s = -s;\n    }\n    return s ? s * Math.ceil(num / s) : 0;\n});\n\ndefineBuiltinFunction('floor', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $number = args[i++];\n            if ($number instanceof CalcError)\n                return $number;\n            if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                if ($number instanceof CalcError)\n                    return $number;\n                return new CalcError(err);\n            }\n            xargs.push($number);\n        }\n        {\n            var $significance = args[i++];\n            if ($significance instanceof CalcError)\n                return $significance;\n            if (!((typeof ($significance = this.force($significance)) == 'number' ? ($significance = limitPrecision($significance), true) : false) || (typeof $significance == 'boolean' ? ($significance = +$significance, true) : false) || (typeof $significance == 'string' && !/^(?:=|true|false)/i.test($significance) ? (tmp = calc.parse(0, 0, 0, $significance), /^date|number|percent$/.test(tmp.type) ? ($significance = +tmp.value, true) : false) : false))) {\n                if ($significance instanceof CalcError)\n                    return $significance;\n                return new CalcError(err);\n            }\n            xargs.push($significance);\n        }\n        {\n            if (!($significance >= 0 || $number < 0 ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $number = this._arrayArg(args[i]);\n        if ($number) {\n            xargs.push($number);\n            width = Math.max(width, $number.width);\n            height = Math.max(height, $number.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $significance = this._arrayArg(args[i]);\n        if ($significance) {\n            xargs.push($significance);\n            width = Math.max(width, $significance.width);\n            height = Math.max(height, $significance.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (num, s) {\n    return s ? s * Math.floor(num / s) : 0;\n});\n\ndefineBuiltinFunction('floor.precise', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $number = args[i++];\n            if ($number instanceof CalcError)\n                return $number;\n            if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                if ($number instanceof CalcError)\n                    return $number;\n                return new CalcError(err);\n            }\n            xargs.push($number);\n        }\n        {\n            var $significance = args[i++];\n            if ($significance instanceof CalcError)\n                return $significance;\n            if (!((typeof ($significance = this.force($significance)) == 'number' ? ($significance = limitPrecision($significance), true) : false) || (typeof $significance == 'boolean' ? ($significance = +$significance, true) : false) || (typeof $significance == 'string' && !/^(?:=|true|false)/i.test($significance) ? (tmp = calc.parse(0, 0, 0, $significance), /^date|number|percent$/.test(tmp.type) ? ($significance = +tmp.value, true) : false) : false) || ($significance == null ? ($significance = 1, true) : false))) {\n                if ($significance instanceof CalcError)\n                    return $significance;\n                return new CalcError(err);\n            }\n            xargs.push($significance);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $number = this._arrayArg(args[i]);\n        if ($number) {\n            xargs.push($number);\n            width = Math.max(width, $number.width);\n            height = Math.max(height, $number.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $significance = this._arrayArg(args[i]);\n        if ($significance) {\n            xargs.push($significance);\n            width = Math.max(width, $significance.width);\n            height = Math.max(height, $significance.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (num, s) {\n    s = Math.abs(s);\n    return s ? s * Math.floor(num / s) : 0;\n});\n\n// XXX: check this\ndefineBuiltinFunction('floor.math', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $number = args[i++];\n            if ($number instanceof CalcError)\n                return $number;\n            if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                if ($number instanceof CalcError)\n                    return $number;\n                return new CalcError(err);\n            }\n            xargs.push($number);\n        }\n        {\n            var $significance = args[i++];\n            if ($significance instanceof CalcError)\n                return $significance;\n            if (!((typeof ($significance = this.force($significance)) == 'number' ? ($significance = limitPrecision($significance), true) : false) || (typeof $significance == 'boolean' ? ($significance = +$significance, true) : false) || (typeof $significance == 'string' && !/^(?:=|true|false)/i.test($significance) ? (tmp = calc.parse(0, 0, 0, $significance), /^date|number|percent$/.test(tmp.type) ? ($significance = +tmp.value, true) : false) : false) || ($significance == null ? ($significance = $number < 0 ? -1 : 1, true) : false))) {\n                if ($significance instanceof CalcError)\n                    return $significance;\n                return new CalcError(err);\n            }\n            xargs.push($significance);\n        }\n        {\n            var $mode = args[i++];\n            if ($mode instanceof CalcError)\n                return $mode;\n            if (!(typeof ($mode = this.force($mode)) == 'boolean' || (typeof $mode == 'number' ? ($mode = !!$mode, true) : false) || ($mode == null ? ($mode = 0, true) : false))) {\n                if ($mode instanceof CalcError)\n                    return $mode;\n                return new CalcError(err);\n            }\n            xargs.push($mode);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $number = this._arrayArg(args[i]);\n        if ($number) {\n            xargs.push($number);\n            width = Math.max(width, $number.width);\n            height = Math.max(height, $number.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $significance = this._arrayArg(args[i]);\n        if ($significance) {\n            xargs.push($significance);\n            width = Math.max(width, $significance.width);\n            height = Math.max(height, $significance.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $mode = this._arrayArg(args[i]);\n        if ($mode) {\n            xargs.push($mode);\n            width = Math.max(width, $mode.width);\n            height = Math.max(height, $mode.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (num, s, mode) {\n    if (!s || !num) {\n        return 0;\n    }\n    if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n        s = -s;\n    }\n    return s ? s * Math.floor(num / s) : 0;\n});\n\ndefineBuiltinFunction('int', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $number = args[i++];\n            if ($number instanceof CalcError)\n                return $number;\n            if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                if ($number instanceof CalcError)\n                    return $number;\n                return new CalcError(err);\n            }\n            xargs.push($number);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $number = this._arrayArg(args[i]);\n        if ($number) {\n            xargs.push($number);\n            width = Math.max(width, $number.width);\n            height = Math.max(height, $number.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), Math.floor);\n\ndefineBuiltinFunction('mround', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $number = args[i++];\n            if ($number instanceof CalcError)\n                return $number;\n            if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                if ($number instanceof CalcError)\n                    return $number;\n                return new CalcError(err);\n            }\n            xargs.push($number);\n        }\n        {\n            var $multiple = args[i++];\n            if ($multiple instanceof CalcError)\n                return $multiple;\n            if (!((typeof ($multiple = this.force($multiple)) == 'number' ? ($multiple = limitPrecision($multiple), true) : false) || (typeof $multiple == 'boolean' ? ($multiple = +$multiple, true) : false) || (typeof $multiple == 'string' && !/^(?:=|true|false)/i.test($multiple) ? (tmp = calc.parse(0, 0, 0, $multiple), /^date|number|percent$/.test(tmp.type) ? ($multiple = +tmp.value, true) : false) : false))) {\n                if ($multiple instanceof CalcError)\n                    return $multiple;\n                return new CalcError(err);\n            }\n            xargs.push($multiple);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $number = this._arrayArg(args[i]);\n        if ($number) {\n            xargs.push($number);\n            width = Math.max(width, $number.width);\n            height = Math.max(height, $number.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $multiple = this._arrayArg(args[i]);\n        if ($multiple) {\n            xargs.push($multiple);\n            width = Math.max(width, $multiple.width);\n            height = Math.max(height, $multiple.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (num, mult) {\n    return mult ? mult * Math.round(num / mult) : 0;\n});\n\ndefineBuiltinFunction('round', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $number = args[i++];\n            if ($number instanceof CalcError)\n                return $number;\n            if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                if ($number instanceof CalcError)\n                    return $number;\n                return new CalcError(err);\n            }\n            xargs.push($number);\n        }\n        {\n            var $digits = args[i++];\n            if ($digits instanceof CalcError)\n                return $digits;\n            if (!((typeof ($digits = this.force($digits)) == 'number' ? ($digits = limitPrecision($digits), true) : false) || (typeof $digits == 'boolean' ? ($digits = +$digits, true) : false) || (typeof $digits == 'string' && !/^(?:=|true|false)/i.test($digits) ? (tmp = calc.parse(0, 0, 0, $digits), /^date|number|percent$/.test(tmp.type) ? ($digits = +tmp.value, true) : false) : false))) {\n                if ($digits instanceof CalcError)\n                    return $digits;\n                return new CalcError(err);\n            }\n            xargs.push($digits);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $number = this._arrayArg(args[i]);\n        if ($number) {\n            xargs.push($number);\n            width = Math.max(width, $number.width);\n            height = Math.max(height, $number.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $digits = this._arrayArg(args[i]);\n        if ($digits) {\n            xargs.push($digits);\n            width = Math.max(width, $digits.width);\n            height = Math.max(height, $digits.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (num, digits) {\n    var sign = num < 0 ? -1 : 1;\n    if (sign < 0) {\n        num = -num;\n    }\n    digits = Math.pow(10, digits);\n    num = limitPrecision(num * digits);\n    num = Math.round(num);\n    return sign * num / digits;\n});\n\ndefineBuiltinFunction('roundup', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $number = args[i++];\n            if ($number instanceof CalcError)\n                return $number;\n            if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                if ($number instanceof CalcError)\n                    return $number;\n                return new CalcError(err);\n            }\n            xargs.push($number);\n        }\n        {\n            var $digits = args[i++];\n            if ($digits instanceof CalcError)\n                return $digits;\n            if (!((typeof ($digits = this.force($digits)) == 'number' ? ($digits = limitPrecision($digits), true) : false) || (typeof $digits == 'boolean' ? ($digits = +$digits, true) : false) || (typeof $digits == 'string' && !/^(?:=|true|false)/i.test($digits) ? (tmp = calc.parse(0, 0, 0, $digits), /^date|number|percent$/.test(tmp.type) ? ($digits = +tmp.value, true) : false) : false))) {\n                if ($digits instanceof CalcError)\n                    return $digits;\n                return new CalcError(err);\n            }\n            xargs.push($digits);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $number = this._arrayArg(args[i]);\n        if ($number) {\n            xargs.push($number);\n            width = Math.max(width, $number.width);\n            height = Math.max(height, $number.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $digits = this._arrayArg(args[i]);\n        if ($digits) {\n            xargs.push($digits);\n            width = Math.max(width, $digits.width);\n            height = Math.max(height, $digits.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (num, digits) {\n    digits = Math.pow(10, digits);\n    num = limitPrecision(num * digits);\n    num = num < 0 ? Math.floor(num) : Math.ceil(num);\n    return num / digits;\n});\n\ndefineBuiltinFunction('rounddown', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $number = args[i++];\n            if ($number instanceof CalcError)\n                return $number;\n            if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                if ($number instanceof CalcError)\n                    return $number;\n                return new CalcError(err);\n            }\n            xargs.push($number);\n        }\n        {\n            var $digits = args[i++];\n            if ($digits instanceof CalcError)\n                return $digits;\n            if (!((typeof ($digits = this.force($digits)) == 'number' ? ($digits = limitPrecision($digits), true) : false) || (typeof $digits == 'boolean' ? ($digits = +$digits, true) : false) || (typeof $digits == 'string' && !/^(?:=|true|false)/i.test($digits) ? (tmp = calc.parse(0, 0, 0, $digits), /^date|number|percent$/.test(tmp.type) ? ($digits = +tmp.value, true) : false) : false))) {\n                if ($digits instanceof CalcError)\n                    return $digits;\n                return new CalcError(err);\n            }\n            xargs.push($digits);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $number = this._arrayArg(args[i]);\n        if ($number) {\n            xargs.push($number);\n            width = Math.max(width, $number.width);\n            height = Math.max(height, $number.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $digits = this._arrayArg(args[i]);\n        if ($digits) {\n            xargs.push($digits);\n            width = Math.max(width, $digits.width);\n            height = Math.max(height, $digits.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (num, digits) {\n    digits = Math.pow(10, digits);\n    num = limitPrecision(num * digits);\n    num = num < 0 ? Math.ceil(num) : Math.floor(num);\n    return num / digits;\n});\n\ndefineBuiltinFunction('even', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $number = args[i++];\n            if ($number instanceof CalcError)\n                return $number;\n            if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                if ($number instanceof CalcError)\n                    return $number;\n                return new CalcError(err);\n            }\n            xargs.push($number);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $number = this._arrayArg(args[i]);\n        if ($number) {\n            xargs.push($number);\n            width = Math.max(width, $number.width);\n            height = Math.max(height, $number.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (num) {\n    var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n    return n % 2 ? n + (n < 0 ? -1 : 1) : n;\n});\n\ndefineBuiltinFunction('odd', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $number = args[i++];\n            if ($number instanceof CalcError)\n                return $number;\n            if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                if ($number instanceof CalcError)\n                    return $number;\n                return new CalcError(err);\n            }\n            xargs.push($number);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $number = this._arrayArg(args[i]);\n        if ($number) {\n            xargs.push($number);\n            width = Math.max(width, $number.width);\n            height = Math.max(height, $number.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (num) {\n    var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n    return n % 2 ? n : n + (n < 0 ? -1 : 1);\n});\n\ndefineBuiltinFunction('sign', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $number = args[i++];\n            if ($number instanceof CalcError)\n                return $number;\n            if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                if ($number instanceof CalcError)\n                    return $number;\n                return new CalcError(err);\n            }\n            xargs.push($number);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $number = this._arrayArg(args[i]);\n        if ($number) {\n            xargs.push($number);\n            width = Math.max(width, $number.width);\n            height = Math.max(height, $number.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (num) {\n    return num < 0 ? -1 : num > 0 ? 1 : 0;\n});\n\nfunction _gcd(a, b) {\n    while (b) {\n        var r = a % b;\n        a = b;\n        b = r;\n    }\n    return a;\n}\n\nfunction _lcm(a, b) {\n    return Math.abs(a * b) / _gcd(a, b);\n}\n\ndefineBuiltinFunction('gcd', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0;\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (args) {\n    var a = args[0];\n    for (var i = 1; i < args.length; ++i) {\n        a = _gcd(a, args[i]);\n    }\n    return a;\n});\n\ndefineBuiltinFunction('lcm', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0;\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (args) {\n    var a = args[0];\n    for (var i = 1; i < args.length; ++i) {\n        a = _lcm(a, args[i]);\n    }\n    return a;\n});\n\ndefineBuiltinFunction('sum', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0;\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers) {\n    return numbers.reduce(function (sum, num) {\n        return sum + num;\n    }, 0);\n});\n\ndefineBuiltinFunction('product', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0;\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers) {\n    return numbers.reduce(function (prod, num) {\n        return prod * num;\n    }, 1);\n});\n\ndefineBuiltinFunction('sumproduct', false, function () {\n    function check(args) {\n        var stack = [], tmp, xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $a1 = args[i++];\n            if ($a1 instanceof CalcError)\n                return $a1;\n            if (!((m = this.asMatrix($a1)) ? $a1 = m : false)) {\n                if ($a1 instanceof CalcError)\n                    return $a1;\n                return new CalcError(err);\n            }\n            xargs.push($a1);\n        }\n        {\n            if (i >= args.length)\n                return new CalcError('N/A');\n            xargs.push(tmp = []);\n            stack.push(xargs);\n            xargs = tmp;\n            do {\n                {\n                    var $a2 = args[i++];\n                    if ($a2 instanceof CalcError)\n                        return $a2;\n                    if (!(((m = this.asMatrix($a2)) ? $a2 = m : false) && ($a2.width == $a1.width ? true : (err = 'N/A', false)) && ($a2.height == $a1.height ? true : (err = 'N/A', false)))) {\n                        if ($a2 instanceof CalcError)\n                            return $a2;\n                        return new CalcError(err);\n                    }\n                    xargs.push($a2);\n                }\n            } while (i < args.length);\n            xargs = stack.pop();\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        while (i < args.length) {\n            toResolve.push(args[i++]);\n        }\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (first, rest) {\n    var sum = 0;\n    first.each(function (p, row, col) {\n        if (typeof p == 'number') {\n            for (var i = 0; i < rest.length; ++i) {\n                var v = rest[i].get(row, col);\n                if (typeof v != 'number') {\n                    return;\n                }\n                p *= v;\n            }\n            sum += p;\n        }\n    });\n    return sum;\n});\n\ndefineBuiltinFunction('sumsq', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0;\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers) {\n    return numbers.reduce(function (sum, num) {\n        return sum + num * num;\n    }, 0);\n});\n\ndefineBuiltinFunction('sumx2my2', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!((m = this.asMatrix($a)) ? $a = m : false)) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!(((m = this.asMatrix($b)) ? $b = m : false) && ($b.width == $a.width ? true : (err = 'N/A', false)) && ($b.height == $a.height ? true : (err = 'N/A', false)))) {\n                if ($b instanceof CalcError)\n                    return $b;\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (a, b) {\n    var sum = 0;\n    a.each(function (x, row, col) {\n        var y = b.get(row, col);\n        if (typeof x == 'number' && typeof y == 'number') {\n            sum += x * x - y * y;\n        }\n    });\n    return sum;\n});\n\ndefineBuiltinFunction('sumx2py2', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!((m = this.asMatrix($a)) ? $a = m : false)) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!(((m = this.asMatrix($b)) ? $b = m : false) && ($b.width == $a.width ? true : (err = 'N/A', false)) && ($b.height == $a.height ? true : (err = 'N/A', false)))) {\n                if ($b instanceof CalcError)\n                    return $b;\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (a, b) {\n    var sum = 0;\n    a.each(function (x, row, col) {\n        var y = b.get(row, col);\n        if (typeof x == 'number' && typeof y == 'number') {\n            sum += x * x + y * y;\n        }\n    });\n    return sum;\n});\n\ndefineBuiltinFunction('sumxmy2', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!((m = this.asMatrix($a)) ? $a = m : false)) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!(((m = this.asMatrix($b)) ? $b = m : false) && ($b.width == $a.width ? true : (err = 'N/A', false)) && ($b.height == $a.height ? true : (err = 'N/A', false)))) {\n                if ($b instanceof CalcError)\n                    return $b;\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (a, b) {\n    var sum = 0;\n    a.each(function (x, row, col) {\n        var y = b.get(row, col);\n        if (typeof x == 'number' && typeof y == 'number') {\n            sum += (x - y) * (x - y);\n        }\n    });\n    return sum;\n});\n\ndefineBuiltinFunction('seriessum', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        {\n            var $y = args[i++];\n            if ($y instanceof CalcError)\n                return $y;\n            if (!((typeof ($y = this.force($y)) == 'number' ? ($y = limitPrecision($y), true) : false) || (typeof $y == 'boolean' ? ($y = +$y, true) : false) || (typeof $y == 'string' && !/^(?:=|true|false)/i.test($y) ? (tmp = calc.parse(0, 0, 0, $y), /^date|number|percent$/.test(tmp.type) ? ($y = +tmp.value, true) : false) : false))) {\n                if ($y instanceof CalcError)\n                    return $y;\n                return new CalcError(err);\n            }\n            xargs.push($y);\n        }\n        {\n            var $m = args[i++];\n            if ($m instanceof CalcError)\n                return $m;\n            if (!((typeof ($m = this.force($m)) == 'number' ? ($m = limitPrecision($m), true) : false) || (typeof $m == 'boolean' ? ($m = +$m, true) : false) || (typeof $m == 'string' && !/^(?:=|true|false)/i.test($m) ? (tmp = calc.parse(0, 0, 0, $m), /^date|number|percent$/.test(tmp.type) ? ($m = +tmp.value, true) : false) : false))) {\n                if ($m instanceof CalcError)\n                    return $m;\n                return new CalcError(err);\n            }\n            xargs.push($m);\n        }\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!((m = this.asMatrix($a)) ? $a = m : false)) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (x, n, m, a) {\n    var sum = 0;\n    a.each(function (coef) {\n        if (typeof coef != 'number') {\n            throw new CalcError('VALUE');\n        }\n        sum += coef * Math.pow(x, n);\n        n += m;\n    });\n    return sum;\n});\n\ndefineBuiltinFunction('min', false, function () {\n    function check(args) {\n        var xargs = [], i = 0;\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if (typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false)\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers) {\n    return numbers.length ? Math.min.apply(Math, numbers) : 0;\n});\n\ndefineBuiltinFunction('max', false, function () {\n    function check(args) {\n        var xargs = [], i = 0;\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if (typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false)\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers) {\n    return numbers.length ? Math.max.apply(Math, numbers) : 0;\n});\n\ndefineBuiltinFunction('counta', false, function () {\n    function check(args) {\n        var xargs = [], i = 0;\n        {\n            try {\n                var $values = this.cellValues(args.slice(i)).reduce(function (ret, $values) {\n                    if ($values != null && i <= args.length)\n                        ret.push($values);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($values);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (values) {\n    return values.length;\n});\n\ndefineBuiltinFunction('count', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0;\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers) {\n    return numbers.length;\n});\n\ndefineBuiltinFunction('countunique', false, function () {\n    function check(args) {\n        var xargs = [], i = 0;\n        {\n            try {\n                var $values = this.cellValues(args.slice(i)).reduce(function (ret, $values) {\n                    if ($values != null && i <= args.length)\n                        ret.push($values);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($values);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (values) {\n    var count = 0, seen = [];\n    values.forEach(function (val) {\n        if (seen.indexOf(val) < 0) {\n            count++;\n            seen.push(val);\n        }\n    });\n    return count;\n});\n\ndefineBuiltinFunction('countblank', false, function () {\n    function check(args) {\n        var stack = [], tmp, xargs = [], i = 0, m, err = 'VALUE';\n        {\n            if (i >= args.length)\n                return new CalcError('N/A');\n            xargs.push(tmp = []);\n            stack.push(xargs);\n            xargs = tmp;\n            do {\n                {\n                    var $args = args[i++];\n                    if ($args instanceof CalcError)\n                        return $args;\n                    if (!(((m = this.asMatrix($args)) ? $args = m : false) || $args != null && i <= args.length)) {\n                        if ($args instanceof CalcError)\n                            return $args;\n                        return new CalcError(err);\n                    }\n                    xargs.push($args);\n                }\n            } while (i < args.length);\n            xargs = stack.pop();\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        while (i < args.length) {\n            toResolve.push(args[i++]);\n        }\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (a) {\n    var count = 0;\n    function add(val) {\n        if (val == null || val === '') {\n            count++;\n        }\n    }\n    function loop(args) {\n        for (var i = 0; i < args.length; ++i) {\n            var x = args[i];\n            if (x instanceof Matrix) {\n                x.each(add, true);\n            } else {\n                add(x);\n            }\n        }\n    }\n    loop(a);\n    return count;\n});\n\ndefineBuiltinFunction('iseven', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $number = args[i++];\n            if ($number instanceof CalcError)\n                return $number;\n            if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                if ($number instanceof CalcError)\n                    return $number;\n                return new CalcError(err);\n            }\n            xargs.push($number);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $number = this._arrayArg(args[i]);\n        if ($number) {\n            xargs.push($number);\n            width = Math.max(width, $number.width);\n            height = Math.max(height, $number.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (num) {\n    return num % 2 === 0;\n});\n\ndefineBuiltinFunction('isodd', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $number = args[i++];\n            if ($number instanceof CalcError)\n                return $number;\n            if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                if ($number instanceof CalcError)\n                    return $number;\n                return new CalcError(err);\n            }\n            xargs.push($number);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $number = this._arrayArg(args[i]);\n        if ($number) {\n            xargs.push($number);\n            width = Math.max(width, $number.width);\n            height = Math.max(height, $number.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (num) {\n    return num % 2 !== 0;\n});\n\ndefineBuiltinFunction('n', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $value = args[i++];\n            if ($value instanceof CalcError)\n                return $value;\n            if (!(($value = this.force($value)) != null && i <= args.length)) {\n                if ($value instanceof CalcError)\n                    return $value;\n                return new CalcError(err);\n            }\n            xargs.push($value);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $value = this._arrayArg(args[i]);\n        if ($value) {\n            xargs.push($value);\n            width = Math.max(width, $value.width);\n            height = Math.max(height, $value.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (val) {\n    if (typeof val == 'boolean') {\n        return val ? 1 : 0;\n    }\n    if (typeof val == 'number') {\n        return val;\n    }\n    return 0;\n});\n\ndefineBuiltinFunction('na', false, function () {\n    function check(args) {\n        var xargs = [], i = 0;\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    return { check: check };\n}(), function () {\n    return new CalcError('N/A');\n});\n\n/* -----[ the \"*IFS\" functions ]----- */\n\n// helper function: take `args` like COUNTIFS (see Excel docs) and\n// calls `f` for each cell matching all criteria.  `f` receives\n// `chunks` (parsed args containing matrix and predicate) and\n// row,col of matching cells.\nfunction forIFS(args, f) {\n    var chunks = [], i = 0, matrix = args[0];\n    while (i < args.length) {\n        chunks.push({\n            matrix: args[i++],\n            pred: parseCriteria(args[i++])\n        });\n    }\n    for (var row = 0; row < matrix.height; ++row) {\n        COL: for (var col = 0; col < matrix.width; ++col) {\n            for (i = 0; i < chunks.length; ++i) {\n                var val = chunks[i].matrix.get(row, col);\n                if (!chunks[i].pred(val == null || val === \"\" ? 0 : val)) {\n                    continue COL;\n                }\n            }\n            f(row, col);\n        }\n    }\n}\n\ndefineBuiltinFunction('countifs', false, function () {\n    function check(args) {\n        var stack = [], tmp, xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $m1 = args[i++];\n            if ($m1 instanceof CalcError)\n                return $m1;\n            if (!((m = this.asMatrix($m1)) ? $m1 = m : false)) {\n                if ($m1 instanceof CalcError)\n                    return $m1;\n                return new CalcError(err);\n            }\n            xargs.push($m1);\n        }\n        {\n            var $c1 = args[i++];\n            if ($c1 instanceof CalcError)\n                return $c1;\n            if (!(($c1 = this.force($c1)) != null && i <= args.length)) {\n                if ($c1 instanceof CalcError)\n                    return $c1;\n                return new CalcError(err);\n            }\n            xargs.push($c1);\n        }\n        {\n            xargs.push(tmp = []);\n            stack.push(xargs);\n            xargs = tmp;\n            while (i < args.length) {\n                {\n                    var $m2 = args[i++];\n                    if ($m2 instanceof CalcError)\n                        return $m2;\n                    if (!((m = this.asMatrix($m2)) ? $m2 = m : false)) {\n                        if ($m2 instanceof CalcError)\n                            return $m2;\n                        return new CalcError(err);\n                    }\n                    xargs.push($m2);\n                }\n                {\n                    var $c2 = args[i++];\n                    if ($c2 instanceof CalcError)\n                        return $c2;\n                    if (!(($c2 = this.force($c2)) != null && i <= args.length)) {\n                        if ($c2 instanceof CalcError)\n                            return $c2;\n                        return new CalcError(err);\n                    }\n                    xargs.push($c2);\n                }\n            }\n            xargs = stack.pop();\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        while (i < args.length) {\n            toResolve.push(args[i++]);\n            toResolve.push(args[i++]);\n        }\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (m1, c1, rest) {\n    var count = 0;\n    rest.unshift(m1, c1);\n    forIFS(rest, function () {\n        count++;\n    });\n    return count;\n});\n\ndefineBuiltinFunction('sumifs', false, function () {\n    function check(args) {\n        var stack = [], tmp, xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $range = args[i++];\n            if ($range instanceof CalcError)\n                return $range;\n            if (!((m = this.asMatrix($range)) ? $range = m : false)) {\n                if ($range instanceof CalcError)\n                    return $range;\n                return new CalcError(err);\n            }\n            xargs.push($range);\n        }\n        {\n            var $m1 = args[i++];\n            if ($m1 instanceof CalcError)\n                return $m1;\n            if (!((m = this.asMatrix($m1)) ? $m1 = m : false)) {\n                if ($m1 instanceof CalcError)\n                    return $m1;\n                return new CalcError(err);\n            }\n            xargs.push($m1);\n        }\n        {\n            var $c1 = args[i++];\n            if ($c1 instanceof CalcError)\n                return $c1;\n            if (!(($c1 = this.force($c1)) != null && i <= args.length)) {\n                if ($c1 instanceof CalcError)\n                    return $c1;\n                return new CalcError(err);\n            }\n            xargs.push($c1);\n        }\n        {\n            xargs.push(tmp = []);\n            stack.push(xargs);\n            xargs = tmp;\n            while (i < args.length) {\n                {\n                    var $m2 = args[i++];\n                    if ($m2 instanceof CalcError)\n                        return $m2;\n                    if (!((m = this.asMatrix($m2)) ? $m2 = m : false)) {\n                        if ($m2 instanceof CalcError)\n                            return $m2;\n                        return new CalcError(err);\n                    }\n                    xargs.push($m2);\n                }\n                {\n                    var $c2 = args[i++];\n                    if ($c2 instanceof CalcError)\n                        return $c2;\n                    if (!(($c2 = this.force($c2)) != null && i <= args.length)) {\n                        if ($c2 instanceof CalcError)\n                            return $c2;\n                        return new CalcError(err);\n                    }\n                    xargs.push($c2);\n                }\n            }\n            xargs = stack.pop();\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        while (i < args.length) {\n            toResolve.push(args[i++]);\n            toResolve.push(args[i++]);\n        }\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (range, m1, c1, args) {\n    args.unshift(range, numericPredicate, m1, c1);\n    var sum = 0;\n    forIFS(args, function (row, col) {\n        var val = range.get(row, col);\n        if (val) {\n            sum += val;\n        }\n    });\n    return sum;\n});\n\n// similar to sumifs, but compute average of matching cells\ndefineBuiltinFunction('averageifs', false, function () {\n    function check(args) {\n        var stack = [], tmp, xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $range = args[i++];\n            if ($range instanceof CalcError)\n                return $range;\n            if (!((m = this.asMatrix($range)) ? $range = m : false)) {\n                if ($range instanceof CalcError)\n                    return $range;\n                return new CalcError(err);\n            }\n            xargs.push($range);\n        }\n        {\n            var $m1 = args[i++];\n            if ($m1 instanceof CalcError)\n                return $m1;\n            if (!((m = this.asMatrix($m1)) ? $m1 = m : false)) {\n                if ($m1 instanceof CalcError)\n                    return $m1;\n                return new CalcError(err);\n            }\n            xargs.push($m1);\n        }\n        {\n            var $c1 = args[i++];\n            if ($c1 instanceof CalcError)\n                return $c1;\n            if (!(($c1 = this.force($c1)) != null && i <= args.length)) {\n                if ($c1 instanceof CalcError)\n                    return $c1;\n                return new CalcError(err);\n            }\n            xargs.push($c1);\n        }\n        {\n            xargs.push(tmp = []);\n            stack.push(xargs);\n            xargs = tmp;\n            while (i < args.length) {\n                {\n                    var $m2 = args[i++];\n                    if ($m2 instanceof CalcError)\n                        return $m2;\n                    if (!((m = this.asMatrix($m2)) ? $m2 = m : false)) {\n                        if ($m2 instanceof CalcError)\n                            return $m2;\n                        return new CalcError(err);\n                    }\n                    xargs.push($m2);\n                }\n                {\n                    var $c2 = args[i++];\n                    if ($c2 instanceof CalcError)\n                        return $c2;\n                    if (!(($c2 = this.force($c2)) != null && i <= args.length)) {\n                        if ($c2 instanceof CalcError)\n                            return $c2;\n                        return new CalcError(err);\n                    }\n                    xargs.push($c2);\n                }\n            }\n            xargs = stack.pop();\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        while (i < args.length) {\n            toResolve.push(args[i++]);\n            toResolve.push(args[i++]);\n        }\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (range, m1, c1, args) {\n    args.unshift(range, numericPredicate, m1, c1);\n    var sum = 0, count = 0;\n    forIFS(args, function (row, col) {\n        var val = range.get(row, col);\n        if (val == null || val === '') {\n            val = 0;\n        }\n        sum += val;\n        count++;\n    });\n    return count ? sum / count : new CalcError('DIV/0');\n});\n\ndefineBuiltinFunction('countif', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $range = args[i++];\n            if ($range instanceof CalcError)\n                return $range;\n            if (!((m = this.asMatrix($range)) ? $range = m : false)) {\n                if ($range instanceof CalcError)\n                    return $range;\n                return new CalcError(err);\n            }\n            xargs.push($range);\n        }\n        {\n            var $criteria = args[i++];\n            if ($criteria instanceof CalcError)\n                return $criteria;\n            if (!(($criteria = this.force($criteria)) != null && i <= args.length)) {\n                if ($criteria instanceof CalcError)\n                    return $criteria;\n                return new CalcError(err);\n            }\n            xargs.push($criteria);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        xargs.push(args[i++]);\n        arrays.push(false);\n        var $criteria = this._arrayArg(args[i]);\n        if ($criteria) {\n            xargs.push($criteria);\n            width = Math.max(width, $criteria.width);\n            height = Math.max(height, $criteria.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (matrix, criteria) {\n    criteria = parseCriteria(criteria);\n    var count = 0;\n    matrix.each(function (val) {\n        if (criteria(val)) {\n            count++;\n        }\n    });\n    return count;\n});\n\nfunction fetchSumRange(continuation) {\n    return function(callback, range, criteria, sumRange) {\n        var self = this;\n        if (sumRange instanceof Ref) {\n            // make sure it covers the same area as `range`, as the “spec” mentions:\n            //\n            //     The sum_range argument does not have to be the same size and shape as the\n            //     range argument. The actual cells that are added are determined by using the\n            //     upper leftmost cell in the sum_range argument as the beginning cell, and then\n            //     including cells that correspond in size and shape to the range argument.\n            //\n            // It does make one wonder, since only the top-left cell in `sumRange` matters, why\n            // should it be a range at all?  Oh well, Excel.\n            var r = sumRange.clone().toRangeRef();\n            if (r.width() != range.width || r.height() != range.height) {\n                if (!isFinite(r.topLeft.row)) {\n                    r.topLeft.row = 0;\n                }\n                if (!isFinite(r.topLeft.col)) {\n                    r.topLeft.col = 0;\n                }\n                r.bottomRight.row = r.topLeft.row + range.height - 1;\n                r.bottomRight.col = r.topLeft.col + range.width - 1;\n                return self.resolveCells([ r ], function(){\n                    callback(continuation(range, criteria, self.asMatrix(r)));\n                });\n            }\n        }\n        callback(continuation(range, criteria, self.asMatrix(sumRange)));\n    };\n}\n\ndefineBuiltinFunction('sumif', true, function () {\n    function check(args) {\n        var xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $range = args[i++];\n            if ($range instanceof CalcError)\n                return $range;\n            if (!((m = this.asMatrix($range)) ? $range = m : false)) {\n                if ($range instanceof CalcError)\n                    return $range;\n                return new CalcError(err);\n            }\n            xargs.push($range);\n        }\n        {\n            var $criteria = args[i++];\n            if ($criteria instanceof CalcError)\n                return $criteria;\n            if (!(($criteria = this.force($criteria)) != null && i <= args.length)) {\n                if ($criteria instanceof CalcError)\n                    return $criteria;\n                return new CalcError(err);\n            }\n            xargs.push($criteria);\n        }\n        {\n            var $sumRange = args[i++];\n            if ($sumRange instanceof CalcError)\n                return $sumRange;\n            if (!($sumRange instanceof CellRef || $sumRange instanceof RangeRef || ((m = this.asMatrix($sumRange)) ? $sumRange = m : false) || (($sumRange = this.force($sumRange)) == null ? ($sumRange = $range, true) : false))) {\n                if ($sumRange instanceof CalcError)\n                    return $sumRange;\n                return new CalcError(err);\n            }\n            xargs.push($sumRange);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        xargs.push(args[i++]);\n        arrays.push(false);\n        var $criteria = this._arrayArg(args[i]);\n        if ($criteria) {\n            xargs.push($criteria);\n            width = Math.max(width, $criteria.width);\n            height = Math.max(height, $criteria.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        xargs.push(args[i++]);\n        arrays.push(false);\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), fetchSumRange(function (range, criteria, sumRange) {\n    var sum = 0;\n    criteria = parseCriteria(criteria);\n    range.each(function (val, row, col) {\n        if (criteria(val)) {\n            var v = sumRange.get(row, col);\n            if (numericPredicate(v)) {\n                sum += v || 0;\n            }\n        }\n    });\n    return sum;\n}));\n\ndefineBuiltinFunction('averageif', true, function () {\n    function check(args) {\n        var xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $range = args[i++];\n            if ($range instanceof CalcError)\n                return $range;\n            if (!((m = this.asMatrix($range)) ? $range = m : false)) {\n                if ($range instanceof CalcError)\n                    return $range;\n                return new CalcError(err);\n            }\n            xargs.push($range);\n        }\n        {\n            var $criteria = args[i++];\n            if ($criteria instanceof CalcError)\n                return $criteria;\n            if (!(($criteria = this.force($criteria)) != null && i <= args.length)) {\n                if ($criteria instanceof CalcError)\n                    return $criteria;\n                return new CalcError(err);\n            }\n            xargs.push($criteria);\n        }\n        {\n            var $sumRange = args[i++];\n            if ($sumRange instanceof CalcError)\n                return $sumRange;\n            if (!($sumRange instanceof CellRef || $sumRange instanceof RangeRef || ((m = this.asMatrix($sumRange)) ? $sumRange = m : false) || (($sumRange = this.force($sumRange)) == null ? ($sumRange = $range, true) : false))) {\n                if ($sumRange instanceof CalcError)\n                    return $sumRange;\n                return new CalcError(err);\n            }\n            xargs.push($sumRange);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        xargs.push(args[i++]);\n        arrays.push(false);\n        var $criteria = this._arrayArg(args[i]);\n        if ($criteria) {\n            xargs.push($criteria);\n            width = Math.max(width, $criteria.width);\n            height = Math.max(height, $criteria.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        xargs.push(args[i++]);\n        arrays.push(false);\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), fetchSumRange(function (range, criteria, sumRange) {\n    var sum = 0, count = 0;\n    criteria = parseCriteria(criteria);\n    range.each(function (val, row, col) {\n        if (criteria(val)) {\n            var v = sumRange.get(row, col);\n            if (numericPredicate(v)) {\n                sum += v || 0;\n                count++;\n            }\n        }\n    });\n    return count ? sum / count : new CalcError('DIV/0');\n}));\n\nfunction _extreme(matrix, nth, order){\n    var numbers = [];\n    var error = matrix.each(function(val){\n        if (val instanceof CalcError) {\n            return val;\n        }\n        if (typeof val == \"number\") {\n            numbers.push(val);\n        }\n    });\n    if (error) {\n        return error;\n    }\n    if (nth > numbers.length) {\n        return new CalcError(\"NUM\");\n    }\n    return numbers.sort(order)[nth - 1];\n}\n\ndefineBuiltinFunction('large', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $array = args[i++];\n            if ($array instanceof CalcError)\n                return $array;\n            if (!((m = this.asMatrix($array)) ? $array = m : false)) {\n                if ($array instanceof CalcError)\n                    return $array;\n                return new CalcError(err);\n            }\n            xargs.push($array);\n        }\n        {\n            var $nth = args[i++];\n            if ($nth instanceof CalcError)\n                return $nth;\n            if (!(((typeof ($nth = this.force($nth)) == 'number' ? ($nth = limitPrecision($nth), true) : false) || (typeof $nth == 'boolean' ? ($nth = +$nth, true) : false) || (typeof $nth == 'string' && !/^(?:=|true|false)/i.test($nth) ? (tmp = calc.parse(0, 0, 0, $nth), /^date|number|percent$/.test(tmp.type) ? ($nth = +tmp.value, true) : false) : false)) && ($nth > 0 ? true : (err = 'NUM', false)))) {\n                if ($nth instanceof CalcError)\n                    return $nth;\n                return new CalcError(err);\n            }\n            xargs.push($nth);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        xargs.push(args[i++]);\n        arrays.push(false);\n        var $nth = this._arrayArg(args[i]);\n        if ($nth) {\n            xargs.push($nth);\n            width = Math.max(width, $nth.width);\n            height = Math.max(height, $nth.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (matrix, nth) {\n    return _extreme(matrix, nth, descending);\n});\n\ndefineBuiltinFunction('small', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $array = args[i++];\n            if ($array instanceof CalcError)\n                return $array;\n            if (!((m = this.asMatrix($array)) ? $array = m : false)) {\n                if ($array instanceof CalcError)\n                    return $array;\n                return new CalcError(err);\n            }\n            xargs.push($array);\n        }\n        {\n            var $nth = args[i++];\n            if ($nth instanceof CalcError)\n                return $nth;\n            if (!(((typeof ($nth = this.force($nth)) == 'number' ? ($nth = limitPrecision($nth), true) : false) || (typeof $nth == 'boolean' ? ($nth = +$nth, true) : false) || (typeof $nth == 'string' && !/^(?:=|true|false)/i.test($nth) ? (tmp = calc.parse(0, 0, 0, $nth), /^date|number|percent$/.test(tmp.type) ? ($nth = +tmp.value, true) : false) : false)) && ($nth > 0 ? true : (err = 'NUM', false)))) {\n                if ($nth instanceof CalcError)\n                    return $nth;\n                return new CalcError(err);\n            }\n            xargs.push($nth);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        xargs.push(args[i++]);\n        arrays.push(false);\n        var $nth = this._arrayArg(args[i]);\n        if ($nth) {\n            xargs.push($nth);\n            width = Math.max(width, $nth.width);\n            height = Math.max(height, $nth.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (matrix, nth) {\n    return _extreme(matrix, nth, ascending);\n});\n\nfunction _avg(numbers) {\n    return numbers.reduce(function(sum, num){\n        return sum + num;\n    }, 0) / numbers.length;\n}\n\nfunction _var_sp(numbers, divisor, avg) {\n    if (avg == null) {\n        avg = _avg(numbers);\n    }\n    return numbers.reduce(function(sum, num){\n        return sum + Math.pow(num - avg, 2);\n    }, 0) / divisor;\n}\n\nfunction _stdev_sp(numbers, divisor) {\n    return Math.sqrt(_var_sp(numbers, divisor));\n}\n\n// https://support.office.com/en-sg/article/STDEV-S-function-7d69cf97-0c1f-4acf-be27-f3e83904cc23\ndefineBuiltinFunction('stdev.s', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            if (!($numbers.length >= 2 ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers) {\n    return _stdev_sp(numbers, numbers.length - 1);\n});\n\n// https://support.office.com/en-sg/article/STDEV-P-function-6e917c05-31a0-496f-ade7-4f4e7462f285\ndefineBuiltinFunction('stdev.p', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if (typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false)\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            if (!($numbers.length >= 1 ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers) {\n    return _stdev_sp(numbers, numbers.length);\n});\n\ndefineBuiltinFunction('var.s', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            if (!($numbers.length >= 2 ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers) {\n    return _var_sp(numbers, numbers.length - 1);\n});\n\ndefineBuiltinFunction('var.p', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            if (!($numbers.length >= 2 ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers) {\n    return _var_sp(numbers, numbers.length);\n});\n\ndefineBuiltinFunction('median', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            if (!($numbers.length > 0 ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers) {\n    var n = numbers.length;\n    numbers.sort(ascending);\n    if (n % 2) {\n        return numbers[n >> 1];\n    }\n    return (numbers[n >>= 1] + numbers[n - 1]) / 2;\n});\n\ndefineBuiltinFunction('mode.sngl', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0;\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers) {\n    numbers.sort(ascending);\n    var prev = null, count = 0, max = 1, mode = null;\n    for (var i = 0; i < numbers.length; ++i) {\n        var n = numbers[i];\n        if (n != prev) {\n            count = 1;\n            prev = n;\n        } else {\n            count++;\n        }\n        if (count > max) {\n            max = count;\n            mode = n;\n        }\n    }\n    return mode == null ? new CalcError('N/A') : mode;\n});\n\ndefineBuiltinFunction('mode.mult', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0;\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers) {\n    var seen = Object.create(null), max = 2, res = [];\n    numbers.forEach(function (num) {\n        var s = seen[num] || 0;\n        seen[num] = ++s;\n        if (s == max) {\n            res.push(num);\n        } else if (s > max) {\n            max = s;\n            res = [num];\n        }\n    });\n    var m = new Matrix(this);\n    res.forEach(function (num, i) {\n        m.set(i, 0, num);\n    });\n    return m;\n});\n\ndefineBuiltinFunction('geomean', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            if (!($numbers.length > 0 ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers) {\n    var n = numbers.length;\n    var p = numbers.reduce(function (p, num) {\n        if (num < 0) {\n            throw new CalcError('NUM');\n        }\n        return p * num;\n    }, 1);\n    return Math.pow(p, 1 / n);\n});\n\ndefineBuiltinFunction('harmean', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            if (!($numbers.length > 0 ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers) {\n    var n = numbers.length;\n    var s = numbers.reduce(function (s, num) {\n        if (!num) {\n            throw new CalcError('DIV/0');\n        }\n        return s + 1 / num;\n    }, 0);\n    return n / s;\n});\n\ndefineBuiltinFunction('trimmean', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            var $percent = args[i++];\n            if ($percent instanceof CalcError)\n                return $percent;\n            if (!(((typeof ($percent = this.force($percent)) == 'number' ? ($percent = limitPrecision($percent), true) : false) || (typeof $percent == 'boolean' ? ($percent = +$percent, true) : false) || (typeof $percent == 'string' && !/^(?:=|true|false)/i.test($percent) ? (tmp = calc.parse(0, 0, 0, $percent), /^date|number|percent$/.test(tmp.type) ? ($percent = +tmp.value, true) : false) : false)) && ($percent >= 0 && $percent < 1 ? true : (err = 'NUM', false)))) {\n                if ($percent instanceof CalcError)\n                    return $percent;\n                return new CalcError(err);\n            }\n            xargs.push($percent);\n        }\n        {\n            if (!($numbers.length > 0 ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers, p) {\n    var n = numbers.length;\n    numbers.sort(ascending);\n    var discard = Math.floor(n * p);\n    if (discard % 2) {\n        --discard;\n    }\n    discard /= 2;\n    var sum = 0;\n    for (var i = discard; i < n - discard; ++i) {\n        sum += numbers[i];\n    }\n    return sum / (n - discard * 2);\n});\n\ndefineBuiltinFunction('frequency', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0;\n        {\n            try {\n                var $data = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $data) {\n                    if ($data instanceof CalcError)\n                        throw $data;\n                    if ((typeof $data == 'number' ? ($data = limitPrecision($data), true) : false) || (typeof $data == 'boolean' ? ($data = +$data, true) : false) || (typeof $data == 'string' && !/^(?:=|true|false)/i.test($data) ? (tmp = calc.parse(0, 0, 0, $data), /^date|number|percent$/.test(tmp.type) ? ($data = +tmp.value, true) : false) : false))\n                        ret.push($data);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($data);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            try {\n                var $bins = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $bins) {\n                    if ($bins instanceof CalcError)\n                        throw $bins;\n                    if ((typeof $bins == 'number' ? ($bins = limitPrecision($bins), true) : false) || (typeof $bins == 'boolean' ? ($bins = +$bins, true) : false) || (typeof $bins == 'string' && !/^(?:=|true|false)/i.test($bins) ? (tmp = calc.parse(0, 0, 0, $bins), /^date|number|percent$/.test(tmp.type) ? ($bins = +tmp.value, true) : false) : false))\n                        ret.push($bins);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($bins);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (data, bins) {\n    data.sort(ascending);\n    bins.sort(ascending);\n    var prev = -Infinity;\n    var i = 0;\n    function count(max) {\n        var n = 0;\n        while (i < data.length && data[i] > prev && data[i] <= max) {\n            ++n;\n            ++i;\n        }\n        return n;\n    }\n    var m = new Matrix(this);\n    bins.forEach(function (val, i) {\n        var n = count(val);\n        prev = val;\n        m.set(i, 0, n);\n    });\n    m.set(m.height, 0, data.length - i);\n    return m;\n});\n\ndefineBuiltinFunction('rank.eq', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $value = args[i++];\n            if ($value instanceof CalcError)\n                return $value;\n            if (!((typeof ($value = this.force($value)) == 'number' ? ($value = limitPrecision($value), true) : false) || (typeof $value == 'boolean' ? ($value = +$value, true) : false) || (typeof $value == 'string' && !/^(?:=|true|false)/i.test($value) ? (tmp = calc.parse(0, 0, 0, $value), /^date|number|percent$/.test(tmp.type) ? ($value = +tmp.value, true) : false) : false))) {\n                if ($value instanceof CalcError)\n                    return $value;\n                return new CalcError(err);\n            }\n            xargs.push($value);\n        }\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            var $order = args[i++];\n            if ($order instanceof CalcError)\n                return $order;\n            if (!(typeof ($order = this.force($order)) == 'boolean' || (typeof $order == 'number' ? ($order = !!$order, true) : false) || ($order == null ? ($order = false, true) : false))) {\n                if ($order instanceof CalcError)\n                    return $order;\n                return new CalcError(err);\n            }\n            xargs.push($order);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (val, numbers, asc) {\n    numbers.sort(asc ? ascending : descending);\n    var pos = numbers.indexOf(val);\n    return pos < 0 ? new CalcError('N/A') : pos + 1;\n});\n\ncalc.runtime.defineAlias(\"rank\", \"rank.eq\");\n\ndefineBuiltinFunction('rank.avg', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $value = args[i++];\n            if ($value instanceof CalcError)\n                return $value;\n            if (!((typeof ($value = this.force($value)) == 'number' ? ($value = limitPrecision($value), true) : false) || (typeof $value == 'boolean' ? ($value = +$value, true) : false) || (typeof $value == 'string' && !/^(?:=|true|false)/i.test($value) ? (tmp = calc.parse(0, 0, 0, $value), /^date|number|percent$/.test(tmp.type) ? ($value = +tmp.value, true) : false) : false))) {\n                if ($value instanceof CalcError)\n                    return $value;\n                return new CalcError(err);\n            }\n            xargs.push($value);\n        }\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            var $order = args[i++];\n            if ($order instanceof CalcError)\n                return $order;\n            if (!(typeof ($order = this.force($order)) == 'boolean' || (typeof $order == 'number' ? ($order = !!$order, true) : false) || ($order == null ? ($order = false, true) : false))) {\n                if ($order instanceof CalcError)\n                    return $order;\n                return new CalcError(err);\n            }\n            xargs.push($order);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (val, numbers, asc) {\n    numbers.sort(asc ? ascending : descending);\n    var pos = numbers.indexOf(val);\n    if (pos < 0) {\n        return new CalcError('N/A');\n    }\n    for (var i = pos; numbers[i] == val; ++i);\n    return (pos + i + 1) / 2;\n});\n\n// formula available at https://support.office.microsoft.com/en-us/article/KURT-function-cbbc2312-dfa6-4cc4-b5c0-1b3c59cc9377\ndefineBuiltinFunction('kurt', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            if (!($numbers.length >= 4 ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers) {\n    var n = numbers.length;\n    var avg = _avg(numbers);\n    var variance = _var_sp(numbers, n - 1, avg);\n    var stddev = Math.sqrt(variance);\n    var sum = numbers.reduce(function (sum, num) {\n        return sum + Math.pow((num - avg) / stddev, 4);\n    }, 0);\n    return n * (n + 1) / ((n - 1) * (n - 2) * (n - 3)) * sum - 3 * Math.pow(n - 1, 2) / ((n - 2) * (n - 3));\n});\n\nfunction _percentrank(numbers, x, exc) {\n    var nlt = 0, ngt = 0, left = null, right = null, found = false;\n    numbers.forEach(function(num){\n        if (num < x) {\n            nlt++;\n            left = left == null ? num : Math.max(left, num);\n        } else if (num > x) {\n            ngt++;\n            right = right == null ? num : Math.min(right, num);\n        } else {\n            found = true;\n        }\n    });\n    if (!nlt && !ngt) {\n        return new CalcError(\"N/A\");\n    }\n    if (found) {\n        if (exc) {\n            return (nlt + 1) / (numbers.length + 1);\n        }\n        return nlt / (nlt + ngt);\n    }\n    return ((right - x) * _percentrank(numbers, left, exc) +\n            (x - left) * _percentrank(numbers, right, exc)) / (right - left);\n}\n\ndefineBuiltinFunction('percentrank.inc', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $array = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $array) {\n                    if ($array instanceof CalcError)\n                        throw $array;\n                    if ((typeof $array == 'number' ? ($array = limitPrecision($array), true) : false) || (typeof $array == 'boolean' ? ($array = +$array, true) : false) || (typeof $array == 'string' && !/^(?:=|true|false)/i.test($array) ? (tmp = calc.parse(0, 0, 0, $array), /^date|number|percent$/.test(tmp.type) ? ($array = +tmp.value, true) : false) : false))\n                        ret.push($array);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($array);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        {\n            var $significance = args[i++];\n            if ($significance instanceof CalcError)\n                return $significance;\n            if (!((($significance = this.force($significance)) == null ? ($significance = 3, true) : false) || (typeof $significance == 'number' || (typeof $significance == 'boolean' ? ($significance = +$significance, true) : false) || (typeof $significance == 'string' && !/^(?:=|true|false)/i.test($significance) ? (tmp = calc.parse(0, 0, 0, $significance), /^date|number|percent$/.test(tmp.type) ? ($significance = +tmp.value, true) : false) : false)) && (($significance |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($significance instanceof CalcError)\n                    return $significance;\n                return new CalcError(err);\n            }\n            xargs.push($significance);\n        }\n        {\n            if (!($array.length > 0 ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers, x, significance) {\n    var p = _percentrank(numbers, x, 0);\n    p = p.toFixed(significance + 1);\n    return parseFloat(p.substr(0, p.length - 1));\n});\n\ndefineBuiltinFunction('percentrank.exc', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $array = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $array) {\n                    if ($array instanceof CalcError)\n                        throw $array;\n                    if ((typeof $array == 'number' ? ($array = limitPrecision($array), true) : false) || (typeof $array == 'boolean' ? ($array = +$array, true) : false) || (typeof $array == 'string' && !/^(?:=|true|false)/i.test($array) ? (tmp = calc.parse(0, 0, 0, $array), /^date|number|percent$/.test(tmp.type) ? ($array = +tmp.value, true) : false) : false))\n                        ret.push($array);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($array);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        {\n            var $significance = args[i++];\n            if ($significance instanceof CalcError)\n                return $significance;\n            if (!((($significance = this.force($significance)) == null ? ($significance = 3, true) : false) || (typeof $significance == 'number' || (typeof $significance == 'boolean' ? ($significance = +$significance, true) : false) || (typeof $significance == 'string' && !/^(?:=|true|false)/i.test($significance) ? (tmp = calc.parse(0, 0, 0, $significance), /^date|number|percent$/.test(tmp.type) ? ($significance = +tmp.value, true) : false) : false)) && (($significance |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($significance instanceof CalcError)\n                    return $significance;\n                return new CalcError(err);\n            }\n            xargs.push($significance);\n        }\n        {\n            if (!($array.length > 0 ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers, x, significance) {\n    var p = _percentrank(numbers, x, 1);\n    p = p.toFixed(significance + 1);\n    return parseFloat(p.substr(0, p.length - 1));\n});\n\ncalc.runtime.defineAlias(\"percentrank\", \"percentrank.inc\");\n\nfunction _covariance(x, y, divisor) {\n    var sum = 0;\n    var ax = _avg(x);\n    var ay = _avg(y);\n    var n = x.length;\n    for (var i = 0; i < n; ++i) {\n        sum += (x[i] - ax) * (y[i] - ay);\n    }\n    return sum / divisor;\n}\n\ndefineBuiltinFunction('covariance.p', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $array1 = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $array1) {\n                    if ($array1 instanceof CalcError)\n                        throw $array1;\n                    if ((typeof $array1 == 'number' ? ($array1 = limitPrecision($array1), true) : false) || (typeof $array1 == 'boolean' ? ($array1 = +$array1, true) : false) || (typeof $array1 == 'string' && !/^(?:=|true|false)/i.test($array1) ? (tmp = calc.parse(0, 0, 0, $array1), /^date|number|percent$/.test(tmp.type) ? ($array1 = +tmp.value, true) : false) : false))\n                        ret.push($array1);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($array1);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            try {\n                var $array2 = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $array2) {\n                    if ($array2 instanceof CalcError)\n                        throw $array2;\n                    if ((typeof $array2 == 'number' ? ($array2 = limitPrecision($array2), true) : false) || (typeof $array2 == 'boolean' ? ($array2 = +$array2, true) : false) || (typeof $array2 == 'string' && !/^(?:=|true|false)/i.test($array2) ? (tmp = calc.parse(0, 0, 0, $array2), /^date|number|percent$/.test(tmp.type) ? ($array2 = +tmp.value, true) : false) : false))\n                        ret.push($array2);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($array2);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            if (!($array1.length == $array2.length ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        {\n            if (!($array1.length > 0 ? true : (err = 'DIV/0', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (x, y) {\n    return _covariance(x, y, x.length);\n});\n\ndefineBuiltinFunction('covariance.s', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $array1 = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $array1) {\n                    if ($array1 instanceof CalcError)\n                        throw $array1;\n                    if ((typeof $array1 == 'number' ? ($array1 = limitPrecision($array1), true) : false) || (typeof $array1 == 'boolean' ? ($array1 = +$array1, true) : false) || (typeof $array1 == 'string' && !/^(?:=|true|false)/i.test($array1) ? (tmp = calc.parse(0, 0, 0, $array1), /^date|number|percent$/.test(tmp.type) ? ($array1 = +tmp.value, true) : false) : false))\n                        ret.push($array1);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($array1);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            try {\n                var $array2 = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $array2) {\n                    if ($array2 instanceof CalcError)\n                        throw $array2;\n                    if ((typeof $array2 == 'number' ? ($array2 = limitPrecision($array2), true) : false) || (typeof $array2 == 'boolean' ? ($array2 = +$array2, true) : false) || (typeof $array2 == 'string' && !/^(?:=|true|false)/i.test($array2) ? (tmp = calc.parse(0, 0, 0, $array2), /^date|number|percent$/.test(tmp.type) ? ($array2 = +tmp.value, true) : false) : false))\n                        ret.push($array2);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($array2);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            if (!($array1.length == $array2.length ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        {\n            if (!($array1.length > 1 ? true : (err = 'DIV/0', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (x, y) {\n    return _covariance(x, y, x.length - 1);\n});\n\ncalc.runtime.defineAlias(\"covar\", \"covariance.p\");\n\n/* -----[ Factorials ]----- */\n\nvar _fact = memoize(function(n){\n    for (var i = 2, fact = 1; i <= n; ++i) {\n        fact *= i;\n    }\n    return fact;\n});\n\ndefineBuiltinFunction('fact', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $n = args[i++];\n            if ($n instanceof CalcError)\n                return $n;\n            if (!((typeof ($n = this.force($n)) == 'number' || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false)) && (($n |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                if ($n instanceof CalcError)\n                    return $n;\n                return new CalcError(err);\n            }\n            xargs.push($n);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $n = this._arrayArg(args[i]);\n        if ($n) {\n            xargs.push($n);\n            width = Math.max(width, $n.width);\n            height = Math.max(height, $n.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), _fact);\n\ndefineBuiltinFunction('factdouble', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $n = args[i++];\n            if ($n instanceof CalcError)\n                return $n;\n            if (!((typeof ($n = this.force($n)) == 'number' || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false)) && (($n |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                if ($n instanceof CalcError)\n                    return $n;\n                return new CalcError(err);\n            }\n            xargs.push($n);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $n = this._arrayArg(args[i]);\n        if ($n) {\n            xargs.push($n);\n            width = Math.max(width, $n.width);\n            height = Math.max(height, $n.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (n) {\n    for (var i = 2 + (n & 1), fact = 1; i <= n; i += 2) {\n        fact *= i;\n    }\n    return fact;\n});\n\ndefineBuiltinFunction('multinomial', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0;\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers) {\n    var div = 1, sum = 0;\n    numbers.forEach(function (n) {\n        if (n < 0) {\n            throw new CalcError('NUM');\n        }\n        sum += n;\n        div *= _fact(n);\n    });\n    return _fact(sum) / div;\n});\n\nvar _combinations = memoize(function(n, k){\n    for (var f1 = k + 1, f2 = 1, p1 = 1, p2 = 1; f2 <= n - k; ++f1, ++f2) {\n        p1 *= f1;\n        p2 *= f2;\n    }\n    return p1/p2;\n});\n\ndefineBuiltinFunction('combin', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $n = args[i++];\n            if ($n instanceof CalcError)\n                return $n;\n            if (!((typeof ($n = this.force($n)) == 'number' || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false)) && (($n |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($n instanceof CalcError)\n                    return $n;\n                return new CalcError(err);\n            }\n            xargs.push($n);\n        }\n        {\n            var $k = args[i++];\n            if ($k instanceof CalcError)\n                return $k;\n            if (!((typeof ($k = this.force($k)) == 'number' || (typeof $k == 'boolean' ? ($k = +$k, true) : false) || (typeof $k == 'string' && !/^(?:=|true|false)/i.test($k) ? (tmp = calc.parse(0, 0, 0, $k), /^date|number|percent$/.test(tmp.type) ? ($k = +tmp.value, true) : false) : false)) && ($k |= 0, true) && ($k >= 0 && $k <= $n ? true : (err = 'NUM', false)))) {\n                if ($k instanceof CalcError)\n                    return $k;\n                return new CalcError(err);\n            }\n            xargs.push($k);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $n = this._arrayArg(args[i]);\n        if ($n) {\n            xargs.push($n);\n            width = Math.max(width, $n.width);\n            height = Math.max(height, $n.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $k = this._arrayArg(args[i]);\n        if ($k) {\n            xargs.push($k);\n            width = Math.max(width, $k.width);\n            height = Math.max(height, $k.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), _combinations);\n\ndefineBuiltinFunction('combina', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $n = args[i++];\n            if ($n instanceof CalcError)\n                return $n;\n            if (!((typeof ($n = this.force($n)) == 'number' || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false)) && (($n |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($n instanceof CalcError)\n                    return $n;\n                return new CalcError(err);\n            }\n            xargs.push($n);\n        }\n        {\n            var $k = args[i++];\n            if ($k instanceof CalcError)\n                return $k;\n            if (!((typeof ($k = this.force($k)) == 'number' || (typeof $k == 'boolean' ? ($k = +$k, true) : false) || (typeof $k == 'string' && !/^(?:=|true|false)/i.test($k) ? (tmp = calc.parse(0, 0, 0, $k), /^date|number|percent$/.test(tmp.type) ? ($k = +tmp.value, true) : false) : false)) && ($k |= 0, true) && ($k >= 1 && $k <= $n ? true : (err = 'NUM', false)))) {\n                if ($k instanceof CalcError)\n                    return $k;\n                return new CalcError(err);\n            }\n            xargs.push($k);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $n = this._arrayArg(args[i]);\n        if ($n) {\n            xargs.push($n);\n            width = Math.max(width, $n.width);\n            height = Math.max(height, $n.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $k = this._arrayArg(args[i]);\n        if ($k) {\n            xargs.push($k);\n            width = Math.max(width, $k.width);\n            height = Math.max(height, $k.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (n, k) {\n    return _combinations(n + k - 1, n - 1);\n});\n\n/* -----[ Statistical functions ]----- */\n\ndefineBuiltinFunction('average', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if (typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false)\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            if (!($numbers.length > 0 ? true : (err = 'DIV/0', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers) {\n    var sum = numbers.reduce(function (sum, num) {\n        return sum + num;\n    }, 0);\n    return sum / numbers.length;\n});\n\ndefineBuiltinFunction('averagea', false, function () {\n    function check(args) {\n        var xargs = [], i = 0;\n        {\n            try {\n                var $values = this.cellValues(args.slice(i)).reduce(function (ret, $values) {\n                    if ($values instanceof CalcError)\n                        throw $values;\n                    if ($values != null && i <= args.length)\n                        ret.push($values);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($values);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (values) {\n    var sum = 0, count = 0;\n    values.forEach(function (num) {\n        if (typeof num != 'string') {\n            sum += num;\n        }\n        ++count;\n    });\n    return count ? sum / count : new CalcError('DIV/0');\n});\n\nfunction _percentile(numbers, rank) {\n    numbers.sort(ascending);\n    var n = numbers.length;\n    var k = rank | 0, d = rank - k;\n    if (k === 0) {\n        return numbers[0];\n    }\n    if (k >= n) {\n        return numbers[n - 1];\n    }\n    --k;\n    return numbers[k] + d * (numbers[k + 1] - numbers[k]);\n}\n\nfunction _percentile_inc(numbers, p){\n    // algorithm from https://en.wikipedia.org/wiki/Percentile#Microsoft_Excel_method\n    var rank = p * (numbers.length - 1) + 1;\n    return _percentile(numbers, rank);\n}\n\nfunction _percentile_exc(numbers, p){\n    // https://en.wikipedia.org/wiki/Percentile#NIST_method\n    var rank = p * (numbers.length + 1);\n    return _percentile(numbers, rank);\n}\n\ndefineBuiltinFunction('percentile.inc', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            var $p = args[i++];\n            if ($p instanceof CalcError)\n                return $p;\n            if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p >= 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                if ($p instanceof CalcError)\n                    return $p;\n                return new CalcError(err);\n            }\n            xargs.push($p);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), _percentile_inc);\n\ndefineBuiltinFunction('percentile.exc', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            var $p = args[i++];\n            if ($p instanceof CalcError)\n                return $p;\n            if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p > 0 && $p < 1 ? true : (err = 'NUM', false)))) {\n                if ($p instanceof CalcError)\n                    return $p;\n                return new CalcError(err);\n            }\n            xargs.push($p);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), _percentile_exc);\n\ndefineBuiltinFunction('quartile.inc', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            var $quarter = args[i++];\n            if ($quarter instanceof CalcError)\n                return $quarter;\n            if (!(($quarter = this.force($quarter)) === 0 || $quarter === 1 || $quarter === 2 || $quarter === 3 || $quarter === 4)) {\n                if ($quarter instanceof CalcError)\n                    return $quarter;\n                return new CalcError(err);\n            }\n            xargs.push($quarter);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers, quarter) {\n    return _percentile_inc(numbers, quarter / 4);\n});\n\ndefineBuiltinFunction('quartile.exc', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            var $quarter = args[i++];\n            if ($quarter instanceof CalcError)\n                return $quarter;\n            if (!(($quarter = this.force($quarter)) === 0 || $quarter === 1 || $quarter === 2 || $quarter === 3 || $quarter === 4)) {\n                if ($quarter instanceof CalcError)\n                    return $quarter;\n                return new CalcError(err);\n            }\n            xargs.push($quarter);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers, quarter) {\n    return _percentile_exc(numbers, quarter / 4);\n});\n\ncalc.runtime.defineAlias(\"quartile\", \"quartile.inc\");\ncalc.runtime.defineAlias(\"percentile\", \"percentile.inc\");\n\nvar AGGREGATE_FUNCS = [\n    \"AVERAGE\", \"COUNT\", \"COUNTA\", \"MAX\", \"MIN\", \"PRODUCT\",\n    \"STDEV.S\", \"STDEV.P\", \"SUM\", \"VAR.S\", \"VAR.P\", \"MEDIAN\",\n    \"MODE.SNGL\", \"LARGE\", \"SMALL\", \"PERCENTILE.INC\",\n    \"QUARTILE.INC\", \"PERCENTILE.EXC\", \"QUARTILE.EXC\"\n];\n\nfunction fetchValuesForAggregate(self, args, options) {\n    var values = [];\n    var opt_ignore_hidden_rows = 1;\n    var opt_ignore_errors = 2;\n    var opt_use_aggregates = 4;\n    (function fetchValues(args) {\n        if (args instanceof Ref) {\n            self.getRefCells(args, true).forEach(function(cell){\n                var value = cell.value;\n                if ((options & opt_ignore_hidden_rows) && cell.hidden) {\n                    return;\n                }\n                if (cell.formula) {\n                    // XXX: formula.print is fast, but still, can't we do any better here?\n                    //      perhaps access the input string directly somehow?\n                    var str = cell.formula.print(cell.row, cell.col);\n                    if (/^\\s*(?:aggregate|subtotal)\\s*\\(/i.test(str)) {\n                        if (!(options & opt_use_aggregates)) {\n                            return;\n                        }\n                    }\n                }\n                if ((options & opt_ignore_errors) && value instanceof CalcError) {\n                    return;\n                }\n                if (typeof value == \"number\" || value instanceof CalcError) {\n                    values.push(value);\n                }\n            });\n        } else if (Array.isArray(args)) {\n            for (var i = 0; i < args.length; ++i) {\n                fetchValues(args[i]);\n            }\n        } else if (args instanceof Matrix) {\n            args.each(fetchValues);\n        } else if (typeof args == \"number\") {\n            values.push(args);\n        } else if (args instanceof CalcError && !(options & opt_ignore_errors)) {\n            values.push(args);\n        }\n    })(args);\n    return values;\n}\n\n// AGGREGATE function\n//\n// https://support.office.com/en-SG/article/aggregate-function-c8caed56-07df-4aeb-9741-23693ffbe525\n//\n// we can only partially type-check this function.  also, we need to use the async version in\n// order to resolve references and delegate values to the function to aggregate.\ndefineBuiltinFunction('aggregate', true, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $funcId = args[i++];\n            if ($funcId instanceof CalcError)\n                return $funcId;\n            if (!(($funcId = this.force($funcId)) === 1 || $funcId === 2 || $funcId === 3 || $funcId === 4 || $funcId === 5 || $funcId === 6 || $funcId === 7 || $funcId === 8 || $funcId === 9 || $funcId === 10 || $funcId === 11 || $funcId === 12 || $funcId === 13 || $funcId === 14 || $funcId === 15 || $funcId === 16 || $funcId === 17 || $funcId === 18 || $funcId === 19)) {\n                if ($funcId instanceof CalcError)\n                    return $funcId;\n                return new CalcError(err);\n            }\n            xargs.push($funcId);\n        }\n        {\n            var $options = args[i++];\n            if ($options instanceof CalcError)\n                return $options;\n            if (!((($options = this.force($options)) == null ? ($options = 0, true) : false) || ($options === 0 || $options === 1 || $options === 2 || $options === 3 || $options === 4 || $options === 5 || $options === 6 || $options === 7))) {\n                if ($options instanceof CalcError)\n                    return $options;\n                return new CalcError(err);\n            }\n            xargs.push($options);\n        }\n        {\n            xargs.push(args.slice(i));\n            i = args.length;\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (callback, funcId, options, args) {\n    var self = this;\n    self.resolveCells(args, function () {\n        var values;\n        if (funcId > 12) {\n            values = fetchValuesForAggregate(self, args[0], options);\n            var k = args[1];\n            if (k instanceof CellRef) {\n                k = self.getRefData(k);\n            }\n            if (typeof k != 'number') {\n                return callback(new CalcError('VALUE'));\n            }\n        } else {\n            values = fetchValuesForAggregate(self, args, options);\n        }\n        self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n    });\n});\n\ndefineBuiltinFunction('subtotal', true, function () {\n    function check(args) {\n        var stack = [], tmp, xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $funcId = args[i++];\n            if ($funcId instanceof CalcError)\n                return $funcId;\n            if (!(($funcId = this.force($funcId)) === 1 || $funcId === 2 || $funcId === 3 || $funcId === 4 || $funcId === 5 || $funcId === 6 || $funcId === 7 || $funcId === 8 || $funcId === 9 || $funcId === 10 || $funcId === 11 || $funcId === 101 || $funcId === 102 || $funcId === 103 || $funcId === 104 || $funcId === 105 || $funcId === 106 || $funcId === 107 || $funcId === 108 || $funcId === 109 || $funcId === 110 || $funcId === 111)) {\n                if ($funcId instanceof CalcError)\n                    return $funcId;\n                return new CalcError(err);\n            }\n            xargs.push($funcId);\n        }\n        {\n            if (i >= args.length)\n                return new CalcError('N/A');\n            xargs.push(tmp = []);\n            stack.push(xargs);\n            xargs = tmp;\n            do {\n                {\n                    var $ref = args[i++];\n                    if ($ref instanceof CalcError)\n                        return $ref;\n                    if (!($ref instanceof Ref || ((m = this.asMatrix($ref)) ? $ref = m : false))) {\n                        return new CalcError(err);\n                    }\n                    xargs.push($ref);\n                }\n            } while (i < args.length);\n            xargs = stack.pop();\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        while (i < args.length) {\n            i++;\n        }\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (callback, funcId) {\n    var self = this;\n    var ignoreHidden = funcId > 100;\n    if (ignoreHidden) {\n        funcId -= 100;\n    }\n    var args = [];\n    for (var i = 2; i < arguments.length; ++i) {\n        args.push(arguments[i]);\n    }\n    self.resolveCells(args, function () {\n        var values = fetchValuesForAggregate(self, args, ignoreHidden ? 1 : 0);\n        self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n    });\n});\n\n// https://support.office.com/en-sg/article/AVEDEV-function-ec78fa01-4755-466c-9a2b-0c4f9eacaf6d\ndefineBuiltinFunction('avedev', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                    if ($numbers instanceof CalcError)\n                        throw $numbers;\n                    if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                        ret.push($numbers);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($numbers);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            if (!($numbers.length >= 2 ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (numbers) {\n    var avg = numbers.reduce(function (sum, num) {\n        return sum + num;\n    }, 0) / numbers.length;\n    return numbers.reduce(function (sum, num) {\n        return sum + Math.abs(num - avg);\n    }, 0) / numbers.length;\n});\n\nfunction _binom_dist(x, n, p, cumulative) {\n    if (!cumulative) {\n        return _combinations(n, x) * Math.pow(p, x) * Math.pow(1-p, n-x);\n    } else {\n        var sum = 0;\n        for (var j = 0; j <= x; ++j) {\n            sum += _combinations(n, j) * Math.pow(p, j) * Math.pow(1-p, n-j);\n        }\n        return sum;\n    }\n}\n\ndefineBuiltinFunction('binom.dist', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $successes = args[i++];\n            if ($successes instanceof CalcError)\n                return $successes;\n            if (!((typeof ($successes = this.force($successes)) == 'number' || (typeof $successes == 'boolean' ? ($successes = +$successes, true) : false) || (typeof $successes == 'string' && !/^(?:=|true|false)/i.test($successes) ? (tmp = calc.parse(0, 0, 0, $successes), /^date|number|percent$/.test(tmp.type) ? ($successes = +tmp.value, true) : false) : false)) && (($successes |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                if ($successes instanceof CalcError)\n                    return $successes;\n                return new CalcError(err);\n            }\n            xargs.push($successes);\n        }\n        {\n            var $trials = args[i++];\n            if ($trials instanceof CalcError)\n                return $trials;\n            if (!((typeof ($trials = this.force($trials)) == 'number' || (typeof $trials == 'boolean' ? ($trials = +$trials, true) : false) || (typeof $trials == 'string' && !/^(?:=|true|false)/i.test($trials) ? (tmp = calc.parse(0, 0, 0, $trials), /^date|number|percent$/.test(tmp.type) ? ($trials = +tmp.value, true) : false) : false)) && ($trials |= 0, true) && ($trials >= $successes ? true : (err = 'N/A', false)))) {\n                if ($trials instanceof CalcError)\n                    return $trials;\n                return new CalcError(err);\n            }\n            xargs.push($trials);\n        }\n        {\n            var $probability = args[i++];\n            if ($probability instanceof CalcError)\n                return $probability;\n            if (!(((typeof ($probability = this.force($probability)) == 'number' ? ($probability = limitPrecision($probability), true) : false) || (typeof $probability == 'boolean' ? ($probability = +$probability, true) : false) || (typeof $probability == 'string' && !/^(?:=|true|false)/i.test($probability) ? (tmp = calc.parse(0, 0, 0, $probability), /^date|number|percent$/.test(tmp.type) ? ($probability = +tmp.value, true) : false) : false)) && ($probability >= 0 && $probability <= 1 ? true : (err = 'NUM', false)))) {\n                if ($probability instanceof CalcError)\n                    return $probability;\n                return new CalcError(err);\n            }\n            xargs.push($probability);\n        }\n        {\n            var $cumulative = args[i++];\n            if ($cumulative instanceof CalcError)\n                return $cumulative;\n            if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                if ($cumulative instanceof CalcError)\n                    return $cumulative;\n                return new CalcError(err);\n            }\n            xargs.push($cumulative);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), _binom_dist);\n\ncalc.runtime.defineAlias(\"binomdist\", \"binom.dist\");\n\ndefineBuiltinFunction('binom.inv', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $trials = args[i++];\n            if ($trials instanceof CalcError)\n                return $trials;\n            if (!((typeof ($trials = this.force($trials)) == 'number' || (typeof $trials == 'boolean' ? ($trials = +$trials, true) : false) || (typeof $trials == 'string' && !/^(?:=|true|false)/i.test($trials) ? (tmp = calc.parse(0, 0, 0, $trials), /^date|number|percent$/.test(tmp.type) ? ($trials = +tmp.value, true) : false) : false)) && (($trials |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                if ($trials instanceof CalcError)\n                    return $trials;\n                return new CalcError(err);\n            }\n            xargs.push($trials);\n        }\n        {\n            var $probability = args[i++];\n            if ($probability instanceof CalcError)\n                return $probability;\n            if (!(((typeof ($probability = this.force($probability)) == 'number' ? ($probability = limitPrecision($probability), true) : false) || (typeof $probability == 'boolean' ? ($probability = +$probability, true) : false) || (typeof $probability == 'string' && !/^(?:=|true|false)/i.test($probability) ? (tmp = calc.parse(0, 0, 0, $probability), /^date|number|percent$/.test(tmp.type) ? ($probability = +tmp.value, true) : false) : false)) && ($probability >= 0 && $probability <= 1 ? true : (err = 'NUM', false)))) {\n                if ($probability instanceof CalcError)\n                    return $probability;\n                return new CalcError(err);\n            }\n            xargs.push($probability);\n        }\n        {\n            var $alpha = args[i++];\n            if ($alpha instanceof CalcError)\n                return $alpha;\n            if (!(((typeof ($alpha = this.force($alpha)) == 'number' ? ($alpha = limitPrecision($alpha), true) : false) || (typeof $alpha == 'boolean' ? ($alpha = +$alpha, true) : false) || (typeof $alpha == 'string' && !/^(?:=|true|false)/i.test($alpha) ? (tmp = calc.parse(0, 0, 0, $alpha), /^date|number|percent$/.test(tmp.type) ? ($alpha = +tmp.value, true) : false) : false)) && ($alpha >= 0 && $alpha <= 1 ? true : (err = 'NUM', false)))) {\n                if ($alpha instanceof CalcError)\n                    return $alpha;\n                return new CalcError(err);\n            }\n            xargs.push($alpha);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (n, p, alpha) {\n    for (var x = 0; x <= n; ++x) {\n        if (_binom_dist(x, n, p, true) >= alpha) {\n            return x;\n        }\n    }\n    return new CalcError('N/A');\n});\n\ncalc.runtime.defineAlias(\"critbinom\", \"binom.inv\");\n\ndefineBuiltinFunction('binom.dist.range', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $trials = args[i++];\n            if ($trials instanceof CalcError)\n                return $trials;\n            if (!((typeof ($trials = this.force($trials)) == 'number' || (typeof $trials == 'boolean' ? ($trials = +$trials, true) : false) || (typeof $trials == 'string' && !/^(?:=|true|false)/i.test($trials) ? (tmp = calc.parse(0, 0, 0, $trials), /^date|number|percent$/.test(tmp.type) ? ($trials = +tmp.value, true) : false) : false)) && (($trials |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                if ($trials instanceof CalcError)\n                    return $trials;\n                return new CalcError(err);\n            }\n            xargs.push($trials);\n        }\n        {\n            var $probability = args[i++];\n            if ($probability instanceof CalcError)\n                return $probability;\n            if (!(((typeof ($probability = this.force($probability)) == 'number' ? ($probability = limitPrecision($probability), true) : false) || (typeof $probability == 'boolean' ? ($probability = +$probability, true) : false) || (typeof $probability == 'string' && !/^(?:=|true|false)/i.test($probability) ? (tmp = calc.parse(0, 0, 0, $probability), /^date|number|percent$/.test(tmp.type) ? ($probability = +tmp.value, true) : false) : false)) && ($probability >= 0 && $probability <= 1 ? true : (err = 'NUM', false)))) {\n                if ($probability instanceof CalcError)\n                    return $probability;\n                return new CalcError(err);\n            }\n            xargs.push($probability);\n        }\n        {\n            var $successes_min = args[i++];\n            if ($successes_min instanceof CalcError)\n                return $successes_min;\n            if (!((typeof ($successes_min = this.force($successes_min)) == 'number' || (typeof $successes_min == 'boolean' ? ($successes_min = +$successes_min, true) : false) || (typeof $successes_min == 'string' && !/^(?:=|true|false)/i.test($successes_min) ? (tmp = calc.parse(0, 0, 0, $successes_min), /^date|number|percent$/.test(tmp.type) ? ($successes_min = +tmp.value, true) : false) : false)) && ($successes_min |= 0, true) && ($successes_min >= 0 && $successes_min <= $trials ? true : (err = 'NUM', false)))) {\n                if ($successes_min instanceof CalcError)\n                    return $successes_min;\n                return new CalcError(err);\n            }\n            xargs.push($successes_min);\n        }\n        {\n            var $successes_max = args[i++];\n            if ($successes_max instanceof CalcError)\n                return $successes_max;\n            if (!((typeof ($successes_max = this.force($successes_max)) == 'number' || (typeof $successes_max == 'boolean' ? ($successes_max = +$successes_max, true) : false) || (typeof $successes_max == 'string' && !/^(?:=|true|false)/i.test($successes_max) ? (tmp = calc.parse(0, 0, 0, $successes_max), /^date|number|percent$/.test(tmp.type) ? ($successes_max = +tmp.value, true) : false) : false)) && ($successes_max |= 0, true) && ($successes_max >= $successes_min && $successes_max <= $trials ? true : (err = 'NUM', false)) || ($successes_max == null ? ($successes_max = $successes_min, true) : false))) {\n                if ($successes_max instanceof CalcError)\n                    return $successes_max;\n                return new CalcError(err);\n            }\n            xargs.push($successes_max);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (n, p, s, s2) {\n    var sum = 0;\n    for (var k = s; k <= s2; ++k) {\n        sum += _combinations(n, k) * Math.pow(p, k) * Math.pow(1 - p, n - k);\n    }\n    return sum;\n});\n\ndefineBuiltinFunction('negbinom.dist', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $number_f = args[i++];\n            if ($number_f instanceof CalcError)\n                return $number_f;\n            if (!((typeof ($number_f = this.force($number_f)) == 'number' || (typeof $number_f == 'boolean' ? ($number_f = +$number_f, true) : false) || (typeof $number_f == 'string' && !/^(?:=|true|false)/i.test($number_f) ? (tmp = calc.parse(0, 0, 0, $number_f), /^date|number|percent$/.test(tmp.type) ? ($number_f = +tmp.value, true) : false) : false)) && (($number_f |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                if ($number_f instanceof CalcError)\n                    return $number_f;\n                return new CalcError(err);\n            }\n            xargs.push($number_f);\n        }\n        {\n            var $number_s = args[i++];\n            if ($number_s instanceof CalcError)\n                return $number_s;\n            if (!((typeof ($number_s = this.force($number_s)) == 'number' || (typeof $number_s == 'boolean' ? ($number_s = +$number_s, true) : false) || (typeof $number_s == 'string' && !/^(?:=|true|false)/i.test($number_s) ? (tmp = calc.parse(0, 0, 0, $number_s), /^date|number|percent$/.test(tmp.type) ? ($number_s = +tmp.value, true) : false) : false)) && (($number_s |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                if ($number_s instanceof CalcError)\n                    return $number_s;\n                return new CalcError(err);\n            }\n            xargs.push($number_s);\n        }\n        {\n            var $probability_s = args[i++];\n            if ($probability_s instanceof CalcError)\n                return $probability_s;\n            if (!(((typeof ($probability_s = this.force($probability_s)) == 'number' ? ($probability_s = limitPrecision($probability_s), true) : false) || (typeof $probability_s == 'boolean' ? ($probability_s = +$probability_s, true) : false) || (typeof $probability_s == 'string' && !/^(?:=|true|false)/i.test($probability_s) ? (tmp = calc.parse(0, 0, 0, $probability_s), /^date|number|percent$/.test(tmp.type) ? ($probability_s = +tmp.value, true) : false) : false)) && ($probability_s >= 0 && $probability_s <= 1 ? true : (err = 'NUM', false)))) {\n                if ($probability_s instanceof CalcError)\n                    return $probability_s;\n                return new CalcError(err);\n            }\n            xargs.push($probability_s);\n        }\n        {\n            var $cumulative = args[i++];\n            if ($cumulative instanceof CalcError)\n                return $cumulative;\n            if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                if ($cumulative instanceof CalcError)\n                    return $cumulative;\n                return new CalcError(err);\n            }\n            xargs.push($cumulative);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (x, k, p, cumulative) {\n    if (cumulative) {\n        var sum = 0;\n        while (x >= 0) {\n            sum += _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n            x--;\n        }\n        return sum;\n    }\n    return _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n});\n\ncalc.runtime.defineAlias(\"negbinomdist\", \"negbinom.dist\");\n\n/* -----[ lookup functions ]----- */\n\ndefineBuiltinFunction('address', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $row = args[i++];\n            if ($row instanceof CalcError)\n                return $row;\n            if (!((typeof ($row = this.force($row)) == 'number' || (typeof $row == 'boolean' ? ($row = +$row, true) : false) || (typeof $row == 'string' && !/^(?:=|true|false)/i.test($row) ? (tmp = calc.parse(0, 0, 0, $row), /^date|number|percent$/.test(tmp.type) ? ($row = +tmp.value, true) : false) : false)) && (($row |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($row instanceof CalcError)\n                    return $row;\n                return new CalcError(err);\n            }\n            xargs.push($row);\n        }\n        {\n            var $col = args[i++];\n            if ($col instanceof CalcError)\n                return $col;\n            if (!((typeof ($col = this.force($col)) == 'number' || (typeof $col == 'boolean' ? ($col = +$col, true) : false) || (typeof $col == 'string' && !/^(?:=|true|false)/i.test($col) ? (tmp = calc.parse(0, 0, 0, $col), /^date|number|percent$/.test(tmp.type) ? ($col = +tmp.value, true) : false) : false)) && (($col |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($col instanceof CalcError)\n                    return $col;\n                return new CalcError(err);\n            }\n            xargs.push($col);\n        }\n        {\n            var $abs = args[i++];\n            if ($abs instanceof CalcError)\n                return $abs;\n            if (!((($abs = this.force($abs)) == null ? ($abs = 1, true) : false) || ($abs === 1 || $abs === 2 || $abs === 3 || $abs === 4))) {\n                if ($abs instanceof CalcError)\n                    return $abs;\n                return new CalcError(err);\n            }\n            xargs.push($abs);\n        }\n        {\n            var $a1 = args[i++];\n            if ($a1 instanceof CalcError)\n                return $a1;\n            if (!((($a1 = this.force($a1)) == null ? ($a1 = true, true) : false) || (typeof $a1 == 'boolean' || (typeof $a1 == 'number' ? ($a1 = !!$a1, true) : false)))) {\n                if ($a1 instanceof CalcError)\n                    return $a1;\n                return new CalcError(err);\n            }\n            xargs.push($a1);\n        }\n        {\n            var $sheet = args[i++];\n            if ($sheet instanceof CalcError)\n                return $sheet;\n            if (!(($sheet = this.force($sheet)) == null || (typeof $sheet == 'string' || typeof $sheet == 'boolean' || typeof $sheet == 'number' ? ($sheet += '', true) : $sheet === undefined ? ($sheet = '', true) : false))) {\n                if ($sheet instanceof CalcError)\n                    return $sheet;\n                return new CalcError(err);\n            }\n            xargs.push($sheet);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (row, col, abs, a1, sheet) {\n    var cell = new CellRef(row - 1, col - 1, abs - 1);\n    if (sheet) {\n        cell.setSheet(sheet, true);\n    }\n    return a1 ? cell.print(0, 0) : cell.print();\n});\n\ndefineBuiltinFunction('areas', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $ref = args[i++];\n            if ($ref instanceof CalcError)\n                return $ref;\n            if (!($ref instanceof Ref)) {\n                return new CalcError(err);\n            }\n            xargs.push($ref);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    return { check: check };\n}(), function (ref) {\n    var count = 0;\n    (function loop(x) {\n        if (x instanceof CellRef || x instanceof RangeRef) {\n            count++;\n        } else if (x instanceof UnionRef) {\n            x.refs.forEach(loop);\n        }\n    }(ref));\n    return count;\n});\n\ndefineBuiltinFunction('choose', false, function () {\n    function check(args) {\n        var stack = [], tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $index = args[i++];\n            if ($index instanceof CalcError)\n                return $index;\n            if (!((typeof ($index = this.force($index)) == 'number' || (typeof $index == 'boolean' ? ($index = +$index, true) : false) || (typeof $index == 'string' && !/^(?:=|true|false)/i.test($index) ? (tmp = calc.parse(0, 0, 0, $index), /^date|number|percent$/.test(tmp.type) ? ($index = +tmp.value, true) : false) : false)) && ($index |= 0, true))) {\n                if ($index instanceof CalcError)\n                    return $index;\n                return new CalcError(err);\n            }\n            xargs.push($index);\n        }\n        {\n            if (i >= args.length)\n                return new CalcError('N/A');\n            xargs.push(tmp = []);\n            stack.push(xargs);\n            xargs = tmp;\n            do {\n                {\n                    var $value = args[i++];\n                    if ($value instanceof CalcError)\n                        return $value;\n                    if (!(i <= args.length)) {\n                        return new CalcError(err);\n                    }\n                    xargs.push($value);\n                }\n            } while (i < args.length);\n            xargs = stack.pop();\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        while (i < args.length) {\n            i++;\n        }\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $index = this._arrayArg(args[i]);\n        if ($index) {\n            xargs.push($index);\n            width = Math.max(width, $index.width);\n            height = Math.max(height, $index.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        while (i < args.length) {\n            xargs.push(args[i++]);\n            arrays.push(false);\n        }\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (index, args) {\n    if (index > args.length) {\n        return new CalcError('N/A');\n    } else {\n        return args[index - 1];\n    }\n});\n\ndefineBuiltinFunction('column', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $ref = args[i++];\n            if ($ref instanceof CalcError)\n                return $ref;\n            if (!($ref instanceof CellRef || $ref instanceof RangeRef || ($ref = this.force($ref)) == null)) {\n                if ($ref instanceof CalcError)\n                    return $ref;\n                return new CalcError(err);\n            }\n            xargs.push($ref);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (ref) {\n    if (!ref) {\n        return this.formula.col + 1;\n    }\n    if (ref instanceof CellRef) {\n        return ref.col + 1;\n    }\n    return this.asMatrix(ref).mapCol(function (col) {\n        return col + ref.topLeft.col + 1;\n    });\n});\n\ndefineBuiltinFunction('columns', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $ref = args[i++];\n            if ($ref instanceof CalcError)\n                return $ref;\n            if (!($ref instanceof CellRef || $ref instanceof RangeRef || ((m = this.asMatrix($ref)) ? $ref = m : false))) {\n                return new CalcError(err);\n            }\n            xargs.push($ref);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    return { check: check };\n}(), function (m) {\n    return m instanceof Ref ? m.width() : m.width;\n});\n\ndefineBuiltinFunction('formulatext', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $ref = args[i++];\n            if ($ref instanceof CalcError)\n                return $ref;\n            if (!($ref instanceof Ref)) {\n                return new CalcError(err);\n            }\n            xargs.push($ref);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    return { check: check };\n}(), function (ref) {\n    var cell = this.getRefCells(ref)[0];\n    if (!cell.formula) {\n        return new CalcError('N/A');\n    }\n    return cell.formula.print(cell.row, cell.col);\n});\n\ndefineBuiltinFunction('hlookup', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $value = args[i++];\n            if ($value instanceof CalcError)\n                return $value;\n            if (!(($value = this.force($value)) != null && i <= args.length)) {\n                if ($value instanceof CalcError)\n                    return $value;\n                return new CalcError(err);\n            }\n            xargs.push($value);\n        }\n        {\n            var $range = args[i++];\n            if ($range instanceof CalcError)\n                return $range;\n            if (!((m = this.asMatrix($range)) ? $range = m : false)) {\n                if ($range instanceof CalcError)\n                    return $range;\n                return new CalcError(err);\n            }\n            xargs.push($range);\n        }\n        {\n            var $row = args[i++];\n            if ($row instanceof CalcError)\n                return $row;\n            if (!((typeof ($row = this.force($row)) == 'number' || (typeof $row == 'boolean' ? ($row = +$row, true) : false) || (typeof $row == 'string' && !/^(?:=|true|false)/i.test($row) ? (tmp = calc.parse(0, 0, 0, $row), /^date|number|percent$/.test(tmp.type) ? ($row = +tmp.value, true) : false) : false)) && (($row |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($row instanceof CalcError)\n                    return $row;\n                return new CalcError(err);\n            }\n            xargs.push($row);\n        }\n        {\n            var $approx = args[i++];\n            if ($approx instanceof CalcError)\n                return $approx;\n            if (!(typeof ($approx = this.force($approx)) == 'boolean' || (typeof $approx == 'number' ? ($approx = !!$approx, true) : false) || ($approx == null ? ($approx = true, true) : false))) {\n                if ($approx instanceof CalcError)\n                    return $approx;\n                return new CalcError(err);\n            }\n            xargs.push($approx);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (value, m, row, approx) {\n    var resultCol = null;\n    m.eachCol(function (col) {\n        var data = m.get(0, col);\n        if (approx) {\n            if (data > value) {\n                return true;\n            }\n            resultCol = col;\n        } else if (data === value) {\n            resultCol = col;\n            return true;\n        }\n    });\n    if (resultCol == null) {\n        return new CalcError('N/A');\n    }\n    return m.get(row - 1, resultCol);\n});\n\ndefineBuiltinFunction('index', true, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $range = args[i++];\n            if ($range instanceof CalcError)\n                return $range;\n            if (!($range instanceof Ref || ((m = this.asMatrix($range)) ? $range = m : false))) {\n                if ($range instanceof CalcError)\n                    return $range;\n                return new CalcError(err);\n            }\n            xargs.push($range);\n        }\n        {\n            var $row = args[i++];\n            if ($row instanceof CalcError)\n                return $row;\n            if (!((typeof ($row = this.force($row)) == 'number' || (typeof $row == 'boolean' ? ($row = +$row, true) : false) || (typeof $row == 'string' && !/^(?:=|true|false)/i.test($row) ? (tmp = calc.parse(0, 0, 0, $row), /^date|number|percent$/.test(tmp.type) ? ($row = +tmp.value, true) : false) : false)) && (($row |= 0) >= 0 ? true : (err = 'NUM', false)) || $row == null)) {\n                if ($row instanceof CalcError)\n                    return $row;\n                return new CalcError(err);\n            }\n            xargs.push($row);\n        }\n        {\n            var $col = args[i++];\n            if ($col instanceof CalcError)\n                return $col;\n            if (!((typeof ($col = this.force($col)) == 'number' || (typeof $col == 'boolean' ? ($col = +$col, true) : false) || (typeof $col == 'string' && !/^(?:=|true|false)/i.test($col) ? (tmp = calc.parse(0, 0, 0, $col), /^date|number|percent$/.test(tmp.type) ? ($col = +tmp.value, true) : false) : false)) && (($col |= 0) >= 0 ? true : (err = 'NUM', false)) || $col == null)) {\n                if ($col instanceof CalcError)\n                    return $col;\n                return new CalcError(err);\n            }\n            xargs.push($col);\n        }\n        {\n            var $areanum = args[i++];\n            if ($areanum instanceof CalcError)\n                return $areanum;\n            if (!((typeof ($areanum = this.force($areanum)) == 'number' || (typeof $areanum == 'boolean' ? ($areanum = +$areanum, true) : false) || (typeof $areanum == 'string' && !/^(?:=|true|false)/i.test($areanum) ? (tmp = calc.parse(0, 0, 0, $areanum), /^date|number|percent$/.test(tmp.type) ? ($areanum = +tmp.value, true) : false) : false)) && (($areanum |= 0) > 0 ? true : (err = 'NUM', false)) || ($areanum == null ? ($areanum = 1, true) : false))) {\n                if ($areanum instanceof CalcError)\n                    return $areanum;\n                return new CalcError(err);\n            }\n            xargs.push($areanum);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (callback, ref, row, col, areanum) {\n    var self = this;\n    if (ref instanceof UnionRef) {\n        ref = ref.refs[areanum - 1];\n    }\n    if (!row && !col || !ref) {\n        return callback(new CalcError('N/A'));\n    }\n    if (ref instanceof CellRef) {\n        ref = ref.toRangeRef();\n    }\n    if (ref instanceof RangeRef) {\n        if (row && col) {\n            if (col > ref.width() || row > ref.height()) {\n                return callback(new CalcError('REF'));\n            }\n            var cell = ref.toCell(row - 1, col - 1);\n            self.resolveCells([cell], function () {\n                callback(self.getRefData(cell));\n            });\n            return;\n        }\n        if (!row) {\n            var colRange = ref.toColumn(col - 1);\n            self.resolveCells([colRange], function () {\n                callback(self.asMatrix(colRange));\n            });\n            return;\n        }\n        if (!col) {\n            var rowRange = ref.toRow(row - 1);\n            self.resolveCells([rowRange], function () {\n                callback(self.asMatrix(rowRange));\n            });\n            return;\n        }\n    } else if (ref instanceof Matrix) {\n        if (ref.width > 1 && ref.height > 1) {\n            if (row && col) {\n                return callback(ref.get(row - 1, col - 1));\n            }\n            if (!row) {\n                return callback(ref.mapRow(function (row) {\n                    return ref.get(row, col - 1);\n                }));\n            }\n            if (!col) {\n                return callback(ref.mapCol(function (col) {\n                    return ref.get(row - 1, col);\n                }));\n            }\n        }\n        if (ref.width == 1) {\n            return callback(ref.get((row || 1) - 1, 0));\n        }\n        if (ref.height == 1) {\n            return callback(ref.get(0, (col || 1) - 1));\n        }\n    } else {\n        callback(new CalcError('REF'));\n    }\n});\n\ndefineBuiltinFunction('indirect', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $thing = args[i++];\n            if ($thing instanceof CalcError)\n                return $thing;\n            if (!(typeof ($thing = this.force($thing)) == 'string' || typeof $thing == 'boolean' || typeof $thing == 'number' ? ($thing += '', true) : $thing === undefined ? ($thing = '', true) : false)) {\n                if ($thing instanceof CalcError)\n                    return $thing;\n                return new CalcError(err);\n            }\n            xargs.push($thing);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (thing) {\n    try {\n        var f = this.formula;\n        var exp = calc.parseFormula(f.sheet, f.row, f.col, thing);\n        var ref = exp.ast;\n        if (ref instanceof NameRef) {\n            ref = this.ss.nameValue(ref, f.sheet, f.row, f.col);\n        }\n        if (!(ref instanceof Ref)) {\n            throw 1;\n        }\n        return ref.absolute(f.row, f.col);\n    } catch (ex) {\n        return new CalcError('REF');\n    }\n});\n\n// XXX: LOOKUP.  seems to be deprecated in favor of HLOOKUP/VLOOKUP\n\n// XXX: double-check this one.\ndefineBuiltinFunction('match', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $value = args[i++];\n            if ($value instanceof CalcError)\n                return $value;\n            if (!(($value = this.force($value)) != null && i <= args.length)) {\n                if ($value instanceof CalcError)\n                    return $value;\n                return new CalcError(err);\n            }\n            xargs.push($value);\n        }\n        {\n            var $range = args[i++];\n            if ($range instanceof CalcError)\n                return $range;\n            if (!((m = this.asMatrix($range)) ? $range = m : false)) {\n                if ($range instanceof CalcError)\n                    return $range;\n                return new CalcError(err);\n            }\n            xargs.push($range);\n        }\n        {\n            var $type = args[i++];\n            if ($type instanceof CalcError)\n                return $type;\n            if (!(($type = this.force($type)) === -1 || $type === 0 || $type === 1 || ($type == null ? ($type = 1, true) : false))) {\n                if ($type instanceof CalcError)\n                    return $type;\n                return new CalcError(err);\n            }\n            xargs.push($type);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (val, m, type) {\n    var index = 1, cmp;\n    if (type === 0) {\n        cmp = parseCriteria(val);\n    } else if (type === -1) {\n        cmp = parseCriteria('<=' + val);\n    } else if (type === 1) {\n        cmp = parseCriteria('>=' + val);\n    }\n    if (m.each(function (el) {\n            if (el != null && cmp(el)) {\n                if (type !== 0 && val != el) {\n                    --index;\n                }\n                return true;\n            }\n            index++;\n        }, true) && index > 0) {\n        return index;\n    } else {\n        return new CalcError('N/A');\n    }\n});\n\ndefineBuiltinFunction('offset', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $ref = args[i++];\n            if ($ref instanceof CalcError)\n                return $ref;\n            if (!($ref instanceof CellRef || $ref instanceof RangeRef)) {\n                return new CalcError(err);\n            }\n            xargs.push($ref);\n        }\n        {\n            var $rows = args[i++];\n            if ($rows instanceof CalcError)\n                return $rows;\n            if (!((typeof ($rows = this.force($rows)) == 'number' || (typeof $rows == 'boolean' ? ($rows = +$rows, true) : false) || (typeof $rows == 'string' && !/^(?:=|true|false)/i.test($rows) ? (tmp = calc.parse(0, 0, 0, $rows), /^date|number|percent$/.test(tmp.type) ? ($rows = +tmp.value, true) : false) : false)) && ($rows |= 0, true))) {\n                if ($rows instanceof CalcError)\n                    return $rows;\n                return new CalcError(err);\n            }\n            xargs.push($rows);\n        }\n        {\n            var $cols = args[i++];\n            if ($cols instanceof CalcError)\n                return $cols;\n            if (!((typeof ($cols = this.force($cols)) == 'number' || (typeof $cols == 'boolean' ? ($cols = +$cols, true) : false) || (typeof $cols == 'string' && !/^(?:=|true|false)/i.test($cols) ? (tmp = calc.parse(0, 0, 0, $cols), /^date|number|percent$/.test(tmp.type) ? ($cols = +tmp.value, true) : false) : false)) && ($cols |= 0, true))) {\n                if ($cols instanceof CalcError)\n                    return $cols;\n                return new CalcError(err);\n            }\n            xargs.push($cols);\n        }\n        {\n            var $height = args[i++];\n            if ($height instanceof CalcError)\n                return $height;\n            if (!((typeof ($height = this.force($height)) == 'number' || (typeof $height == 'boolean' ? ($height = +$height, true) : false) || (typeof $height == 'string' && !/^(?:=|true|false)/i.test($height) ? (tmp = calc.parse(0, 0, 0, $height), /^date|number|percent$/.test(tmp.type) ? ($height = +tmp.value, true) : false) : false)) && (($height |= 0) > 0 ? true : (err = 'NUM', false)) || ($height == null ? ($height = $ref.height(), true) : false))) {\n                if ($height instanceof CalcError)\n                    return $height;\n                return new CalcError(err);\n            }\n            xargs.push($height);\n        }\n        {\n            var $width = args[i++];\n            if ($width instanceof CalcError)\n                return $width;\n            if (!((typeof ($width = this.force($width)) == 'number' || (typeof $width == 'boolean' ? ($width = +$width, true) : false) || (typeof $width == 'string' && !/^(?:=|true|false)/i.test($width) ? (tmp = calc.parse(0, 0, 0, $width), /^date|number|percent$/.test(tmp.type) ? ($width = +tmp.value, true) : false) : false)) && (($width |= 0) > 0 ? true : (err = 'NUM', false)) || ($width == null ? ($width = $ref.width(), true) : false))) {\n                if ($width instanceof CalcError)\n                    return $width;\n                return new CalcError(err);\n            }\n            xargs.push($width);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        i++;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        xargs.push(args[i++]);\n        arrays.push(false);\n        var $rows = this._arrayArg(args[i]);\n        if ($rows) {\n            xargs.push($rows);\n            width = Math.max(width, $rows.width);\n            height = Math.max(height, $rows.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $cols = this._arrayArg(args[i]);\n        if ($cols) {\n            xargs.push($cols);\n            width = Math.max(width, $cols.width);\n            height = Math.max(height, $cols.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $height = this._arrayArg(args[i]);\n        if ($height) {\n            xargs.push($height);\n            width = Math.max(width, $height.width);\n            height = Math.max(height, $height.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $width = this._arrayArg(args[i]);\n        if ($width) {\n            xargs.push($width);\n            width = Math.max(width, $width.width);\n            height = Math.max(height, $width.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (ref, rows, cols, height, width) {\n    var topLeft = (ref instanceof CellRef ? ref : ref.topLeft).clone();\n    topLeft.row += rows;\n    topLeft.col += cols;\n    if (topLeft.row < 0 || topLeft.col < 0) {\n        return new CalcError('VALUE');\n    }\n    if (height > 1 || width > 1) {\n        return new RangeRef(topLeft, new CellRef(topLeft.row + height - 1, topLeft.col + width - 1)).setSheet(ref.sheet, ref.hasSheet());\n    }\n    return topLeft;\n});\n\ndefineBuiltinFunction('row', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $ref = args[i++];\n            if ($ref instanceof CalcError)\n                return $ref;\n            if (!($ref instanceof CellRef || $ref instanceof RangeRef || ($ref = this.force($ref)) == null)) {\n                if ($ref instanceof CalcError)\n                    return $ref;\n                return new CalcError(err);\n            }\n            xargs.push($ref);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (ref) {\n    if (!ref) {\n        return this.formula.row + 1;\n    }\n    if (ref instanceof CellRef) {\n        return ref.row + 1;\n    }\n    return this.asMatrix(ref).mapRow(function (row) {\n        return row + ref.topLeft.row + 1;\n    });\n});\n\ndefineBuiltinFunction('rows', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $ref = args[i++];\n            if ($ref instanceof CalcError)\n                return $ref;\n            if (!($ref instanceof CellRef || $ref instanceof RangeRef || ((m = this.asMatrix($ref)) ? $ref = m : false))) {\n                return new CalcError(err);\n            }\n            xargs.push($ref);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    return { check: check };\n}(), function (m) {\n    return m instanceof Ref ? m.height() : m.height;\n});\n\ndefineBuiltinFunction('vlookup', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $value = args[i++];\n            if ($value instanceof CalcError)\n                return $value;\n            if (!(($value = this.force($value)) != null && i <= args.length)) {\n                if ($value instanceof CalcError)\n                    return $value;\n                return new CalcError(err);\n            }\n            xargs.push($value);\n        }\n        {\n            var $range = args[i++];\n            if ($range instanceof CalcError)\n                return $range;\n            if (!((m = this.asMatrix($range)) ? $range = m : false)) {\n                if ($range instanceof CalcError)\n                    return $range;\n                return new CalcError(err);\n            }\n            xargs.push($range);\n        }\n        {\n            var $col = args[i++];\n            if ($col instanceof CalcError)\n                return $col;\n            if (!((typeof ($col = this.force($col)) == 'number' || (typeof $col == 'boolean' ? ($col = +$col, true) : false) || (typeof $col == 'string' && !/^(?:=|true|false)/i.test($col) ? (tmp = calc.parse(0, 0, 0, $col), /^date|number|percent$/.test(tmp.type) ? ($col = +tmp.value, true) : false) : false)) && (($col |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($col instanceof CalcError)\n                    return $col;\n                return new CalcError(err);\n            }\n            xargs.push($col);\n        }\n        {\n            var $approx = args[i++];\n            if ($approx instanceof CalcError)\n                return $approx;\n            if (!(typeof ($approx = this.force($approx)) == 'boolean' || (typeof $approx == 'number' ? ($approx = !!$approx, true) : false) || ($approx == null ? ($approx = true, true) : false))) {\n                if ($approx instanceof CalcError)\n                    return $approx;\n                return new CalcError(err);\n            }\n            xargs.push($approx);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (value, m, col, approx) {\n    var resultRow = null;\n    if (typeof value != 'number') {\n        approx = false;\n    }\n    if (typeof value == 'string') {\n        value = value.toLowerCase();\n    }\n    m.eachRow(function (row) {\n        var data = m.get(row, 0);\n        if (approx) {\n            if (data > value) {\n                return true;\n            }\n            resultRow = row;\n        } else {\n            if (typeof data == 'string') {\n                data = data.toLowerCase();\n            }\n            if (data === value) {\n                resultRow = row;\n                return true;\n            }\n        }\n    });\n    if (resultRow == null) {\n        return new CalcError('N/A');\n    }\n    return m.get(resultRow, col - 1);\n});\n\n/* -----[ Date and time functions ]----- */\n\ndefineBuiltinFunction('date', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $year = args[i++];\n            if ($year instanceof CalcError)\n                return $year;\n            if (!((typeof ($year = this.force($year)) == 'number' || (typeof $year == 'boolean' ? ($year = +$year, true) : false) || (typeof $year == 'string' && !/^(?:=|true|false)/i.test($year) ? (tmp = calc.parse(0, 0, 0, $year), /^date|number|percent$/.test(tmp.type) ? ($year = +tmp.value, true) : false) : false)) && ($year |= 0, true))) {\n                if ($year instanceof CalcError)\n                    return $year;\n                return new CalcError(err);\n            }\n            xargs.push($year);\n        }\n        {\n            var $month = args[i++];\n            if ($month instanceof CalcError)\n                return $month;\n            if (!((typeof ($month = this.force($month)) == 'number' || (typeof $month == 'boolean' ? ($month = +$month, true) : false) || (typeof $month == 'string' && !/^(?:=|true|false)/i.test($month) ? (tmp = calc.parse(0, 0, 0, $month), /^date|number|percent$/.test(tmp.type) ? ($month = +tmp.value, true) : false) : false)) && ($month |= 0, true))) {\n                if ($month instanceof CalcError)\n                    return $month;\n                return new CalcError(err);\n            }\n            xargs.push($month);\n        }\n        {\n            var $date = args[i++];\n            if ($date instanceof CalcError)\n                return $date;\n            if (!((typeof ($date = this.force($date)) == 'number' || (typeof $date == 'boolean' ? ($date = +$date, true) : false) || (typeof $date == 'string' && !/^(?:=|true|false)/i.test($date) ? (tmp = calc.parse(0, 0, 0, $date), /^date|number|percent$/.test(tmp.type) ? ($date = +tmp.value, true) : false) : false)) && ($date |= 0, true))) {\n                if ($date instanceof CalcError)\n                    return $date;\n                return new CalcError(err);\n            }\n            xargs.push($date);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $year = this._arrayArg(args[i]);\n        if ($year) {\n            xargs.push($year);\n            width = Math.max(width, $year.width);\n            height = Math.max(height, $year.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $month = this._arrayArg(args[i]);\n        if ($month) {\n            xargs.push($month);\n            width = Math.max(width, $month.width);\n            height = Math.max(height, $month.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $date = this._arrayArg(args[i]);\n        if ($date) {\n            xargs.push($date);\n            width = Math.max(width, $date.width);\n            height = Math.max(height, $date.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (year, month, date) {\n    return packDate$1(year, month - 1, date);\n});\n\ndefineBuiltinFunction('day', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $date = args[i++];\n            if ($date instanceof CalcError)\n                return $date;\n            if (!((typeof ($date = this.force($date)) == 'number' || (typeof $date == 'boolean' ? ($date = +$date, true) : false) || (typeof $date == 'string' && !/^(?:=|true|false)/i.test($date) ? (tmp = calc.parse(0, 0, 0, $date), /^date|number|percent$/.test(tmp.type) ? ($date = +tmp.value, true) : false) : false)) && ($date |= 0, true))) {\n                if ($date instanceof CalcError)\n                    return $date;\n                return new CalcError(err);\n            }\n            xargs.push($date);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $date = this._arrayArg(args[i]);\n        if ($date) {\n            xargs.push($date);\n            width = Math.max(width, $date.width);\n            height = Math.max(height, $date.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (date) {\n    return unpackDate$1(date).date;\n});\n\ndefineBuiltinFunction('month', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $date = args[i++];\n            if ($date instanceof CalcError)\n                return $date;\n            if (!((typeof ($date = this.force($date)) == 'number' || (typeof $date == 'boolean' ? ($date = +$date, true) : false) || (typeof $date == 'string' && !/^(?:=|true|false)/i.test($date) ? (tmp = calc.parse(0, 0, 0, $date), /^date|number|percent$/.test(tmp.type) ? ($date = +tmp.value, true) : false) : false)) && ($date |= 0, true))) {\n                if ($date instanceof CalcError)\n                    return $date;\n                return new CalcError(err);\n            }\n            xargs.push($date);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $date = this._arrayArg(args[i]);\n        if ($date) {\n            xargs.push($date);\n            width = Math.max(width, $date.width);\n            height = Math.max(height, $date.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (date) {\n    return unpackDate$1(date).month + 1;\n});\n\ndefineBuiltinFunction('year', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $date = args[i++];\n            if ($date instanceof CalcError)\n                return $date;\n            if (!((typeof ($date = this.force($date)) == 'number' || (typeof $date == 'boolean' ? ($date = +$date, true) : false) || (typeof $date == 'string' && !/^(?:=|true|false)/i.test($date) ? (tmp = calc.parse(0, 0, 0, $date), /^date|number|percent$/.test(tmp.type) ? ($date = +tmp.value, true) : false) : false)) && ($date |= 0, true))) {\n                if ($date instanceof CalcError)\n                    return $date;\n                return new CalcError(err);\n            }\n            xargs.push($date);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $date = this._arrayArg(args[i]);\n        if ($date) {\n            xargs.push($date);\n            width = Math.max(width, $date.width);\n            height = Math.max(height, $date.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (date) {\n    return unpackDate$1(date).year;\n});\n\ndefineBuiltinFunction('weekday', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $date = args[i++];\n            if ($date instanceof CalcError)\n                return $date;\n            if (!((typeof ($date = this.force($date)) == 'number' || (typeof $date == 'boolean' ? ($date = +$date, true) : false) || (typeof $date == 'string' && !/^(?:=|true|false)/i.test($date) ? (tmp = calc.parse(0, 0, 0, $date), /^date|number|percent$/.test(tmp.type) ? ($date = +tmp.value, true) : false) : false)) && ($date |= 0, true))) {\n                if ($date instanceof CalcError)\n                    return $date;\n                return new CalcError(err);\n            }\n            xargs.push($date);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $date = this._arrayArg(args[i]);\n        if ($date) {\n            xargs.push($date);\n            width = Math.max(width, $date.width);\n            height = Math.max(height, $date.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (date) {\n    return unpackDate$1(date).day + 1;\n});\n\n// https://support.office.com/en-GB/article/WEEKNUM-function-e5c43a03-b4ab-426c-b411-b18c13c75340\n// XXX: this is a mess.\ndefineBuiltinFunction('weeknum', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $date = args[i++];\n            if ($date instanceof CalcError)\n                return $date;\n            if (!((typeof ($date = this.force($date)) == 'number' || (typeof $date == 'boolean' ? ($date = +$date, true) : false) || (typeof $date == 'string' && !/^(?:=|true|false)/i.test($date) ? (tmp = calc.parse(0, 0, 0, $date), /^date|number|percent$/.test(tmp.type) ? ($date = +tmp.value, true) : false) : false)) && ($date |= 0, true))) {\n                if ($date instanceof CalcError)\n                    return $date;\n                return new CalcError(err);\n            }\n            xargs.push($date);\n        }\n        {\n            var $type = args[i++];\n            if ($type instanceof CalcError)\n                return $type;\n            if (!((($type = this.force($type)) == null ? ($type = 1, true) : false) || ($type === 1 || $type === 2 || $type === 11 || $type === 12 || $type === 13 || $type === 14 || $type === 15 || $type === 16 || $type === 17 || $type === 21))) {\n                if ($type instanceof CalcError)\n                    return $type;\n                return new CalcError(err);\n            }\n            xargs.push($type);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $date = this._arrayArg(args[i]);\n        if ($date) {\n            xargs.push($date);\n            width = Math.max(width, $date.width);\n            height = Math.max(height, $date.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $type = this._arrayArg(args[i]);\n        if ($type) {\n            xargs.push($type);\n            width = Math.max(width, $type.width);\n            height = Math.max(height, $type.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (date, type) {\n    var fw = packDate$1(unpackDate$1(date).year, 0, 1);\n    var sy = unpackDate$1(fw);\n    var diff;\n    if (type == 21) {\n        diff = 3 - (sy.day + 6) % 7;\n        if (diff < 0) {\n            diff += 7;\n        }\n        fw += diff;\n        sy.date += diff;\n        sy.day = 4;\n        type = 1;\n    } else {\n        if (type == 1) {\n            type = 0;\n        } else if (type == 2) {\n            type = 1;\n        } else {\n            type = (type - 10) % 7;\n        }\n    }\n    diff = sy.day - type;\n    if (diff < 0) {\n        diff += 7;\n    }\n    fw -= diff;\n    return Math.ceil((date + 1 - fw) / 7);\n});\n\nfunction weeksInYear(year) {\n    var d = unpackDate$1(packDate$1(year, 0, 1));\n    if ((d.day == 4) || (d.day == 3 && calc.runtime.isLeapYear(year))) {\n        // long year\n        return 53;\n    }\n    return 52;\n}\n\ndefineBuiltinFunction('isoweeknum', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $date = args[i++];\n            if ($date instanceof CalcError)\n                return $date;\n            if (!((typeof ($date = this.force($date)) == 'number' || (typeof $date == 'boolean' ? ($date = +$date, true) : false) || (typeof $date == 'string' && !/^(?:=|true|false)/i.test($date) ? (tmp = calc.parse(0, 0, 0, $date), /^date|number|percent$/.test(tmp.type) ? ($date = +tmp.value, true) : false) : false)) && ($date |= 0, true))) {\n                if ($date instanceof CalcError)\n                    return $date;\n                return new CalcError(err);\n            }\n            xargs.push($date);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $date = this._arrayArg(args[i]);\n        if ($date) {\n            xargs.push($date);\n            width = Math.max(width, $date.width);\n            height = Math.max(height, $date.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function isoweeknum(date) {\n    var d = unpackDate$1(date);\n    var dow = d.day || 7;\n    var wk = Math.floor((d.ord - dow + 10) / 7);\n    if (wk < 1) {\n        return weeksInYear(d.year - 1);\n    } else if (wk == 53 && wk > weeksInYear(d.year)) {\n        return 1;\n    }\n    return wk;\n});\n\ndefineBuiltinFunction('now', false, function () {\n    function check(args) {\n        var xargs = [], i = 0;\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    return { check: check };\n}(), function () {\n    return calc.runtime.dateToSerial(new Date());\n});\n\ndefineBuiltinFunction('today', false, function () {\n    function check(args) {\n        var xargs = [], i = 0;\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    return { check: check };\n}(), function () {\n    return calc.runtime.dateToSerial(new Date()) | 0;\n});\n\ndefineBuiltinFunction('time', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $hours = args[i++];\n            if ($hours instanceof CalcError)\n                return $hours;\n            if (!((typeof ($hours = this.force($hours)) == 'number' || (typeof $hours == 'boolean' ? ($hours = +$hours, true) : false) || (typeof $hours == 'string' && !/^(?:=|true|false)/i.test($hours) ? (tmp = calc.parse(0, 0, 0, $hours), /^date|number|percent$/.test(tmp.type) ? ($hours = +tmp.value, true) : false) : false)) && ($hours |= 0, true))) {\n                if ($hours instanceof CalcError)\n                    return $hours;\n                return new CalcError(err);\n            }\n            xargs.push($hours);\n        }\n        {\n            var $minutes = args[i++];\n            if ($minutes instanceof CalcError)\n                return $minutes;\n            if (!((typeof ($minutes = this.force($minutes)) == 'number' || (typeof $minutes == 'boolean' ? ($minutes = +$minutes, true) : false) || (typeof $minutes == 'string' && !/^(?:=|true|false)/i.test($minutes) ? (tmp = calc.parse(0, 0, 0, $minutes), /^date|number|percent$/.test(tmp.type) ? ($minutes = +tmp.value, true) : false) : false)) && ($minutes |= 0, true))) {\n                if ($minutes instanceof CalcError)\n                    return $minutes;\n                return new CalcError(err);\n            }\n            xargs.push($minutes);\n        }\n        {\n            var $seconds = args[i++];\n            if ($seconds instanceof CalcError)\n                return $seconds;\n            if (!((typeof ($seconds = this.force($seconds)) == 'number' || (typeof $seconds == 'boolean' ? ($seconds = +$seconds, true) : false) || (typeof $seconds == 'string' && !/^(?:=|true|false)/i.test($seconds) ? (tmp = calc.parse(0, 0, 0, $seconds), /^date|number|percent$/.test(tmp.type) ? ($seconds = +tmp.value, true) : false) : false)) && ($seconds |= 0, true))) {\n                if ($seconds instanceof CalcError)\n                    return $seconds;\n                return new CalcError(err);\n            }\n            xargs.push($seconds);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $hours = this._arrayArg(args[i]);\n        if ($hours) {\n            xargs.push($hours);\n            width = Math.max(width, $hours.width);\n            height = Math.max(height, $hours.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $minutes = this._arrayArg(args[i]);\n        if ($minutes) {\n            xargs.push($minutes);\n            width = Math.max(width, $minutes.width);\n            height = Math.max(height, $minutes.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $seconds = this._arrayArg(args[i]);\n        if ($seconds) {\n            xargs.push($seconds);\n            width = Math.max(width, $seconds.width);\n            height = Math.max(height, $seconds.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (hh, mm, ss) {\n    return calc.runtime.packTime(hh, mm, ss, 0);\n});\n\ndefineBuiltinFunction('hour', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $time = args[i++];\n            if ($time instanceof CalcError)\n                return $time;\n            if (!((typeof ($time = this.force($time)) == 'number' ? ($time = limitPrecision($time), true) : false) || (typeof $time == 'boolean' ? ($time = +$time, true) : false) || (typeof $time == 'string' && !/^(?:=|true|false)/i.test($time) ? (tmp = calc.parse(0, 0, 0, $time), /^date|number|percent$/.test(tmp.type) ? ($time = +tmp.value, true) : false) : false))) {\n                if ($time instanceof CalcError)\n                    return $time;\n                return new CalcError(err);\n            }\n            xargs.push($time);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $time = this._arrayArg(args[i]);\n        if ($time) {\n            xargs.push($time);\n            width = Math.max(width, $time.width);\n            height = Math.max(height, $time.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (time) {\n    return calc.runtime.unpackTime(time).hours;\n});\n\ndefineBuiltinFunction('minute', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $time = args[i++];\n            if ($time instanceof CalcError)\n                return $time;\n            if (!((typeof ($time = this.force($time)) == 'number' ? ($time = limitPrecision($time), true) : false) || (typeof $time == 'boolean' ? ($time = +$time, true) : false) || (typeof $time == 'string' && !/^(?:=|true|false)/i.test($time) ? (tmp = calc.parse(0, 0, 0, $time), /^date|number|percent$/.test(tmp.type) ? ($time = +tmp.value, true) : false) : false))) {\n                if ($time instanceof CalcError)\n                    return $time;\n                return new CalcError(err);\n            }\n            xargs.push($time);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $time = this._arrayArg(args[i]);\n        if ($time) {\n            xargs.push($time);\n            width = Math.max(width, $time.width);\n            height = Math.max(height, $time.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (time) {\n    return calc.runtime.unpackTime(time).minutes;\n});\n\ndefineBuiltinFunction('second', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $time = args[i++];\n            if ($time instanceof CalcError)\n                return $time;\n            if (!((typeof ($time = this.force($time)) == 'number' ? ($time = limitPrecision($time), true) : false) || (typeof $time == 'boolean' ? ($time = +$time, true) : false) || (typeof $time == 'string' && !/^(?:=|true|false)/i.test($time) ? (tmp = calc.parse(0, 0, 0, $time), /^date|number|percent$/.test(tmp.type) ? ($time = +tmp.value, true) : false) : false))) {\n                if ($time instanceof CalcError)\n                    return $time;\n                return new CalcError(err);\n            }\n            xargs.push($time);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $time = this._arrayArg(args[i]);\n        if ($time) {\n            xargs.push($time);\n            width = Math.max(width, $time.width);\n            height = Math.max(height, $time.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (time) {\n    return calc.runtime.unpackTime(time).seconds;\n});\n\ndefineBuiltinFunction('edate', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $start_date = args[i++];\n            if ($start_date instanceof CalcError)\n                return $start_date;\n            if (!((typeof ($start_date = this.force($start_date)) == 'number' || (typeof $start_date == 'boolean' ? ($start_date = +$start_date, true) : false) || (typeof $start_date == 'string' && !/^(?:=|true|false)/i.test($start_date) ? (tmp = calc.parse(0, 0, 0, $start_date), /^date|number|percent$/.test(tmp.type) ? ($start_date = +tmp.value, true) : false) : false)) && ($start_date |= 0, true))) {\n                if ($start_date instanceof CalcError)\n                    return $start_date;\n                return new CalcError(err);\n            }\n            xargs.push($start_date);\n        }\n        {\n            var $months = args[i++];\n            if ($months instanceof CalcError)\n                return $months;\n            if (!((typeof ($months = this.force($months)) == 'number' || (typeof $months == 'boolean' ? ($months = +$months, true) : false) || (typeof $months == 'string' && !/^(?:=|true|false)/i.test($months) ? (tmp = calc.parse(0, 0, 0, $months), /^date|number|percent$/.test(tmp.type) ? ($months = +tmp.value, true) : false) : false)) && ($months |= 0, true))) {\n                if ($months instanceof CalcError)\n                    return $months;\n                return new CalcError(err);\n            }\n            xargs.push($months);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $start_date = this._arrayArg(args[i]);\n        if ($start_date) {\n            xargs.push($start_date);\n            width = Math.max(width, $start_date.width);\n            height = Math.max(height, $start_date.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $months = this._arrayArg(args[i]);\n        if ($months) {\n            xargs.push($months);\n            width = Math.max(width, $months.width);\n            height = Math.max(height, $months.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (base, months) {\n    var d = unpackDate$1(base);\n    var m = d.month + months;\n    var y = d.year + Math.floor(m / 12);\n    m %= 12;\n    if (m < 0) {\n        m += 12;\n    }\n    d = Math.min(d.date, daysInMonth(y, m));\n    return packDate$1(y, m, d);\n});\n\ndefineBuiltinFunction('eomonth', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $start_date = args[i++];\n            if ($start_date instanceof CalcError)\n                return $start_date;\n            if (!((typeof ($start_date = this.force($start_date)) == 'number' || (typeof $start_date == 'boolean' ? ($start_date = +$start_date, true) : false) || (typeof $start_date == 'string' && !/^(?:=|true|false)/i.test($start_date) ? (tmp = calc.parse(0, 0, 0, $start_date), /^date|number|percent$/.test(tmp.type) ? ($start_date = +tmp.value, true) : false) : false)) && ($start_date |= 0, true))) {\n                if ($start_date instanceof CalcError)\n                    return $start_date;\n                return new CalcError(err);\n            }\n            xargs.push($start_date);\n        }\n        {\n            var $months = args[i++];\n            if ($months instanceof CalcError)\n                return $months;\n            if (!((typeof ($months = this.force($months)) == 'number' || (typeof $months == 'boolean' ? ($months = +$months, true) : false) || (typeof $months == 'string' && !/^(?:=|true|false)/i.test($months) ? (tmp = calc.parse(0, 0, 0, $months), /^date|number|percent$/.test(tmp.type) ? ($months = +tmp.value, true) : false) : false)) && ($months |= 0, true))) {\n                if ($months instanceof CalcError)\n                    return $months;\n                return new CalcError(err);\n            }\n            xargs.push($months);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $start_date = this._arrayArg(args[i]);\n        if ($start_date) {\n            xargs.push($start_date);\n            width = Math.max(width, $start_date.width);\n            height = Math.max(height, $start_date.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $months = this._arrayArg(args[i]);\n        if ($months) {\n            xargs.push($months);\n            width = Math.max(width, $months.width);\n            height = Math.max(height, $months.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (base, months) {\n    var d = unpackDate$1(base);\n    var m = d.month + months;\n    var y = d.year + Math.floor(m / 12);\n    m %= 12;\n    if (m < 0) {\n        m += 12;\n    }\n    d = daysInMonth(y, m);\n    return packDate$1(y, m, d);\n});\n\ndefineBuiltinFunction('workday', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $start_date = args[i++];\n            if ($start_date instanceof CalcError)\n                return $start_date;\n            if (!((typeof ($start_date = this.force($start_date)) == 'number' || (typeof $start_date == 'boolean' ? ($start_date = +$start_date, true) : false) || (typeof $start_date == 'string' && !/^(?:=|true|false)/i.test($start_date) ? (tmp = calc.parse(0, 0, 0, $start_date), /^date|number|percent$/.test(tmp.type) ? ($start_date = +tmp.value, true) : false) : false)) && ($start_date |= 0, true))) {\n                if ($start_date instanceof CalcError)\n                    return $start_date;\n                return new CalcError(err);\n            }\n            xargs.push($start_date);\n        }\n        {\n            var $days = args[i++];\n            if ($days instanceof CalcError)\n                return $days;\n            if (!((typeof ($days = this.force($days)) == 'number' || (typeof $days == 'boolean' ? ($days = +$days, true) : false) || (typeof $days == 'string' && !/^(?:=|true|false)/i.test($days) ? (tmp = calc.parse(0, 0, 0, $days), /^date|number|percent$/.test(tmp.type) ? ($days = +tmp.value, true) : false) : false)) && ($days |= 0, true))) {\n                if ($days instanceof CalcError)\n                    return $days;\n                return new CalcError(err);\n            }\n            xargs.push($days);\n        }\n        {\n            try {\n                var $holidays = this.cellValues(args.slice(i)).reduce(function (ret, $holidays) {\n                    if ($holidays instanceof CalcError)\n                        throw $holidays;\n                    if ((typeof $holidays == 'number' || (typeof $holidays == 'boolean' ? ($holidays = +$holidays, true) : false) || (typeof $holidays == 'string' && !/^(?:=|true|false)/i.test($holidays) ? (tmp = calc.parse(0, 0, 0, $holidays), /^date|number|percent$/.test(tmp.type) ? ($holidays = +tmp.value, true) : false) : false)) && ($holidays |= 0, true))\n                        ret.push($holidays);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($holidays);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (date, n, holidays) {\n    var inc = n > 0 ? 1 : -1;\n    n = Math.abs(n);\n    var dow = unpackDate$1(date).day;\n    while (n > 0) {\n        date += inc;\n        dow = (dow + inc) % 7;\n        if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n            --n;\n        }\n    }\n    return date;\n});\n\ndefineBuiltinFunction('networkdays', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $start_date = args[i++];\n            if ($start_date instanceof CalcError)\n                return $start_date;\n            if (!((typeof ($start_date = this.force($start_date)) == 'number' || (typeof $start_date == 'boolean' ? ($start_date = +$start_date, true) : false) || (typeof $start_date == 'string' && !/^(?:=|true|false)/i.test($start_date) ? (tmp = calc.parse(0, 0, 0, $start_date), /^date|number|percent$/.test(tmp.type) ? ($start_date = +tmp.value, true) : false) : false)) && ($start_date |= 0, true))) {\n                if ($start_date instanceof CalcError)\n                    return $start_date;\n                return new CalcError(err);\n            }\n            xargs.push($start_date);\n        }\n        {\n            var $end_date = args[i++];\n            if ($end_date instanceof CalcError)\n                return $end_date;\n            if (!((typeof ($end_date = this.force($end_date)) == 'number' || (typeof $end_date == 'boolean' ? ($end_date = +$end_date, true) : false) || (typeof $end_date == 'string' && !/^(?:=|true|false)/i.test($end_date) ? (tmp = calc.parse(0, 0, 0, $end_date), /^date|number|percent$/.test(tmp.type) ? ($end_date = +tmp.value, true) : false) : false)) && ($end_date |= 0, true))) {\n                if ($end_date instanceof CalcError)\n                    return $end_date;\n                return new CalcError(err);\n            }\n            xargs.push($end_date);\n        }\n        {\n            try {\n                var $holidays = this.cellValues(args.slice(i)).reduce(function (ret, $holidays) {\n                    if ($holidays instanceof CalcError)\n                        throw $holidays;\n                    if ((typeof $holidays == 'number' || (typeof $holidays == 'boolean' ? ($holidays = +$holidays, true) : false) || (typeof $holidays == 'string' && !/^(?:=|true|false)/i.test($holidays) ? (tmp = calc.parse(0, 0, 0, $holidays), /^date|number|percent$/.test(tmp.type) ? ($holidays = +tmp.value, true) : false) : false)) && ($holidays |= 0, true))\n                        ret.push($holidays);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($holidays);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (date, end, holidays) {\n    if (date > end) {\n        var tmp = date;\n        date = end;\n        end = tmp;\n    }\n    var count = 0;\n    var dow = unpackDate$1(date).day;\n    while (date <= end) {\n        if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n            count++;\n        }\n        date++;\n        dow = (dow + 1) % 7;\n    }\n    return count;\n});\n\ndefineBuiltinFunction('days', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $start_date = args[i++];\n            if ($start_date instanceof CalcError)\n                return $start_date;\n            if (!((typeof ($start_date = this.force($start_date)) == 'number' || (typeof $start_date == 'boolean' ? ($start_date = +$start_date, true) : false) || (typeof $start_date == 'string' && !/^(?:=|true|false)/i.test($start_date) ? (tmp = calc.parse(0, 0, 0, $start_date), /^date|number|percent$/.test(tmp.type) ? ($start_date = +tmp.value, true) : false) : false)) && ($start_date |= 0, true))) {\n                if ($start_date instanceof CalcError)\n                    return $start_date;\n                return new CalcError(err);\n            }\n            xargs.push($start_date);\n        }\n        {\n            var $end_date = args[i++];\n            if ($end_date instanceof CalcError)\n                return $end_date;\n            if (!((typeof ($end_date = this.force($end_date)) == 'number' || (typeof $end_date == 'boolean' ? ($end_date = +$end_date, true) : false) || (typeof $end_date == 'string' && !/^(?:=|true|false)/i.test($end_date) ? (tmp = calc.parse(0, 0, 0, $end_date), /^date|number|percent$/.test(tmp.type) ? ($end_date = +tmp.value, true) : false) : false)) && ($end_date |= 0, true))) {\n                if ($end_date instanceof CalcError)\n                    return $end_date;\n                return new CalcError(err);\n            }\n            xargs.push($end_date);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $start_date = this._arrayArg(args[i]);\n        if ($start_date) {\n            xargs.push($start_date);\n            width = Math.max(width, $start_date.width);\n            height = Math.max(height, $start_date.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $end_date = this._arrayArg(args[i]);\n        if ($end_date) {\n            xargs.push($end_date);\n            width = Math.max(width, $end_date.width);\n            height = Math.max(height, $end_date.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (end, start) {\n    return end - start;\n});\n\nfunction _days_360(start, end, method) {\n    var d1 = unpackDate$1(start);\n    var d2 = unpackDate$1(end);\n\n    // https://en.wikipedia.org/wiki/360-day_calendar\n    // humanity is a mess.\n    if (method) {\n        // EU method\n        if (d1.date == 31) {\n            d1.date = 30;\n        }\n        if (d2.date == 31) {\n            d2.date = 30;\n        }\n    } else {\n        // US method\n        if (d1.month == 1 && d2.month == 1\n            && d1.date == daysInMonth(d1.year, 1)\n            && d2.date == daysInMonth(d2.year, 1)) {\n            d2.date = 30;\n        }\n        if (d1.date == daysInMonth(d1.year, d1.month)) {\n            d1.date = 30;\n            if (d2.date == 31) {\n                d2.date = 30;\n            }\n        } else {\n            if (d1.date == 30 && d2.date == 31) {\n                d2.date = 30;\n            }\n        }\n    }\n\n    return (360 * (d2.year - d1.year)\n            + 30 * (d2.month - d1.month)\n            + (d2.date - d1.date));\n}\n\ncalc.runtime._days_360 = _days_360;\n\ndefineBuiltinFunction('days360', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $start_date = args[i++];\n            if ($start_date instanceof CalcError)\n                return $start_date;\n            if (!((typeof ($start_date = this.force($start_date)) == 'number' || (typeof $start_date == 'boolean' ? ($start_date = +$start_date, true) : false) || (typeof $start_date == 'string' && !/^(?:=|true|false)/i.test($start_date) ? (tmp = calc.parse(0, 0, 0, $start_date), /^date|number|percent$/.test(tmp.type) ? ($start_date = +tmp.value, true) : false) : false)) && ($start_date |= 0, true))) {\n                if ($start_date instanceof CalcError)\n                    return $start_date;\n                return new CalcError(err);\n            }\n            xargs.push($start_date);\n        }\n        {\n            var $end_date = args[i++];\n            if ($end_date instanceof CalcError)\n                return $end_date;\n            if (!((typeof ($end_date = this.force($end_date)) == 'number' || (typeof $end_date == 'boolean' ? ($end_date = +$end_date, true) : false) || (typeof $end_date == 'string' && !/^(?:=|true|false)/i.test($end_date) ? (tmp = calc.parse(0, 0, 0, $end_date), /^date|number|percent$/.test(tmp.type) ? ($end_date = +tmp.value, true) : false) : false)) && ($end_date |= 0, true))) {\n                if ($end_date instanceof CalcError)\n                    return $end_date;\n                return new CalcError(err);\n            }\n            xargs.push($end_date);\n        }\n        {\n            var $method = args[i++];\n            if ($method instanceof CalcError)\n                return $method;\n            if (!(typeof ($method = this.force($method)) == 'boolean' || (typeof $method == 'number' ? ($method = !!$method, true) : false) || ($method == null ? ($method = false, true) : false))) {\n                if ($method instanceof CalcError)\n                    return $method;\n                return new CalcError(err);\n            }\n            xargs.push($method);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $start_date = this._arrayArg(args[i]);\n        if ($start_date) {\n            xargs.push($start_date);\n            width = Math.max(width, $start_date.width);\n            height = Math.max(height, $start_date.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $end_date = this._arrayArg(args[i]);\n        if ($end_date) {\n            xargs.push($end_date);\n            width = Math.max(width, $end_date.width);\n            height = Math.max(height, $end_date.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $method = this._arrayArg(args[i]);\n        if ($method) {\n            xargs.push($method);\n            width = Math.max(width, $method.width);\n            height = Math.max(height, $method.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), _days_360);\n\ndefineBuiltinFunction('yearfrac', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $start_date = args[i++];\n            if ($start_date instanceof CalcError)\n                return $start_date;\n            if (!((typeof ($start_date = this.force($start_date)) == 'number' || (typeof $start_date == 'boolean' ? ($start_date = +$start_date, true) : false) || (typeof $start_date == 'string' && !/^(?:=|true|false)/i.test($start_date) ? (tmp = calc.parse(0, 0, 0, $start_date), /^date|number|percent$/.test(tmp.type) ? ($start_date = +tmp.value, true) : false) : false)) && ($start_date |= 0, true))) {\n                if ($start_date instanceof CalcError)\n                    return $start_date;\n                return new CalcError(err);\n            }\n            xargs.push($start_date);\n        }\n        {\n            var $end_date = args[i++];\n            if ($end_date instanceof CalcError)\n                return $end_date;\n            if (!((typeof ($end_date = this.force($end_date)) == 'number' || (typeof $end_date == 'boolean' ? ($end_date = +$end_date, true) : false) || (typeof $end_date == 'string' && !/^(?:=|true|false)/i.test($end_date) ? (tmp = calc.parse(0, 0, 0, $end_date), /^date|number|percent$/.test(tmp.type) ? ($end_date = +tmp.value, true) : false) : false)) && ($end_date |= 0, true))) {\n                if ($end_date instanceof CalcError)\n                    return $end_date;\n                return new CalcError(err);\n            }\n            xargs.push($end_date);\n        }\n        {\n            var $method = args[i++];\n            if ($method instanceof CalcError)\n                return $method;\n            if (!((($method = this.force($method)) == null ? ($method = 0, true) : false) || ($method === 0 || $method === 1 || $method === 2 || $method === 3 || $method === 4))) {\n                if ($method instanceof CalcError)\n                    return $method;\n                return new CalcError(err);\n            }\n            xargs.push($method);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $start_date = this._arrayArg(args[i]);\n        if ($start_date) {\n            xargs.push($start_date);\n            width = Math.max(width, $start_date.width);\n            height = Math.max(height, $start_date.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $end_date = this._arrayArg(args[i]);\n        if ($end_date) {\n            xargs.push($end_date);\n            width = Math.max(width, $end_date.width);\n            height = Math.max(height, $end_date.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $method = this._arrayArg(args[i]);\n        if ($method) {\n            xargs.push($method);\n            width = Math.max(width, $method.width);\n            height = Math.max(height, $method.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (start, end, method) {\n    switch (method) {\n    case 0:\n        return _days_360(start, end, false) / 360;\n    case 1:\n        return (end - start) / daysInYear(unpackDate$1(start).year);\n    case 2:\n        return (end - start) / 360;\n    case 3:\n        return (end - start) / 365;\n    case 4:\n        return _days_360(start, end, true) / 360;\n    }\n});\n\ndefineBuiltinFunction('datevalue', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $text = args[i++];\n            if ($text instanceof CalcError)\n                return $text;\n            if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                if ($text instanceof CalcError)\n                    return $text;\n                return new CalcError(err);\n            }\n            xargs.push($text);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $text = this._arrayArg(args[i]);\n        if ($text) {\n            xargs.push($text);\n            width = Math.max(width, $text.width);\n            height = Math.max(height, $text.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (text) {\n    var date = calc.runtime.parseDate(text);\n    if (date) {\n        return calc.runtime.dateToSerial(date);\n    }\n    return new CalcError('VALUE');\n});\n\ndefineBuiltinFunction('timevalue', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $text = args[i++];\n            if ($text instanceof CalcError)\n                return $text;\n            if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                if ($text instanceof CalcError)\n                    return $text;\n                return new CalcError(err);\n            }\n            xargs.push($text);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $text = this._arrayArg(args[i]);\n        if ($text) {\n            xargs.push($text);\n            width = Math.max(width, $text.width);\n            height = Math.max(height, $text.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (text) {\n    var m = text.toLowerCase().match(/(\\d+):(\\d+)(:(\\d+)(\\.(\\d+))?)?\\s*(am?|pm?)?/);\n    if (m) {\n        var hh = parseFloat(m[1]);\n        var mm = parseFloat(m[2]);\n        var ss = m[3] ? parseFloat(m[4]) : 0;\n        var ampm = m[7];\n        if (ampm && (hh > 12 || hh < 1)) {\n            return new CalcError('VALUE');\n        }\n        if (/^p/.test(ampm)) {\n            hh += 12;\n        }\n        return calc.runtime.packTime(hh, mm, ss, 0);\n    }\n    return new CalcError('VALUE');\n});\n\n/* -----[ Matrix functions ]----- */\n\ndefineBuiltinFunction('mdeterm', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $m = args[i++];\n            if ($m instanceof CalcError)\n                return $m;\n            if (!(((m = this.asMatrix($m)) ? $m = m : false) && ($m.width == $m.height ? true : (err = 'N/A', false)))) {\n                if ($m instanceof CalcError)\n                    return $m;\n                return new CalcError(err);\n            }\n            xargs.push($m);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (m) {\n    var error = m.each(function (val) {\n        if (typeof val != 'number') {\n            return new CalcError('VALUE');\n        }\n    }, true);\n    return error || m.determinant();\n});\n\ndefineBuiltinFunction('transpose', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $range = args[i++];\n            if ($range instanceof CalcError)\n                return $range;\n            if (!((m = this.asMatrix($range)) ? $range = m : false)) {\n                if ($range instanceof CalcError)\n                    return $range;\n                return new CalcError(err);\n            }\n            xargs.push($range);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (m) {\n    return m.transpose();\n});\n\ndefineBuiltinFunction('mmult', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $a = args[i++];\n            if ($a instanceof CalcError)\n                return $a;\n            if (!((m = this.asMatrix($a)) ? $a = m : false)) {\n                if ($a instanceof CalcError)\n                    return $a;\n                return new CalcError(err);\n            }\n            xargs.push($a);\n        }\n        {\n            var $b = args[i++];\n            if ($b instanceof CalcError)\n                return $b;\n            if (!(((m = this.asMatrix($b)) ? $b = m : false) && ($b.height == $a.width ? true : (err = 'N/A', false)))) {\n                if ($b instanceof CalcError)\n                    return $b;\n                return new CalcError(err);\n            }\n            xargs.push($b);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (a, b) {\n    return a.multiply(b);\n});\n\ndefineBuiltinFunction('munit', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $n = args[i++];\n            if ($n instanceof CalcError)\n                return $n;\n            if (!((typeof ($n = this.force($n)) == 'number' || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false)) && (($n |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                if ($n instanceof CalcError)\n                    return $n;\n                return new CalcError(err);\n            }\n            xargs.push($n);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (n) {\n    return new Matrix(this).unit(n);\n});\n\ndefineBuiltinFunction('minverse', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $m = args[i++];\n            if ($m instanceof CalcError)\n                return $m;\n            if (!(((m = this.asMatrix($m)) ? $m = m : false) && ($m.width == $m.height ? true : (err = 'N/A', false)))) {\n                if ($m instanceof CalcError)\n                    return $m;\n                return new CalcError(err);\n            }\n            xargs.push($m);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (m) {\n    var error = m.each(function (val) {\n        if (typeof val != 'number') {\n            return new CalcError('VALUE');\n        }\n    }, true);\n    return error || m.inverse() || new CalcError('VALUE');\n});\n\n/* -----[ Other ]----- */\n\ndefineBuiltinFunction('rand', false, function () {\n    function check(args) {\n        var xargs = [], i = 0;\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    return { check: check };\n}(), function () {\n    return Math.random();\n});\n\ndefineBuiltinFunction('randbetween', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $min = args[i++];\n            if ($min instanceof CalcError)\n                return $min;\n            if (!((typeof ($min = this.force($min)) == 'number' || (typeof $min == 'boolean' ? ($min = +$min, true) : false) || (typeof $min == 'string' && !/^(?:=|true|false)/i.test($min) ? (tmp = calc.parse(0, 0, 0, $min), /^date|number|percent$/.test(tmp.type) ? ($min = +tmp.value, true) : false) : false)) && ($min |= 0, true))) {\n                if ($min instanceof CalcError)\n                    return $min;\n                return new CalcError(err);\n            }\n            xargs.push($min);\n        }\n        {\n            var $max = args[i++];\n            if ($max instanceof CalcError)\n                return $max;\n            if (!((typeof ($max = this.force($max)) == 'number' || (typeof $max == 'boolean' ? ($max = +$max, true) : false) || (typeof $max == 'string' && !/^(?:=|true|false)/i.test($max) ? (tmp = calc.parse(0, 0, 0, $max), /^date|number|percent$/.test(tmp.type) ? ($max = +tmp.value, true) : false) : false)) && ($max |= 0, true) && ($max >= $min ? true : (err = 'N/A', false)))) {\n                if ($max instanceof CalcError)\n                    return $max;\n                return new CalcError(err);\n            }\n            xargs.push($max);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (min, max) {\n    return min + Math.floor((max - min + 1) * Math.random());\n});\n\ndefineBuiltinFunction('true', false, function () {\n    function check(args) {\n        var xargs = [], i = 0;\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    return { check: check };\n}(), function () {\n    return true;\n});\n\ndefineBuiltinFunction('false', false, function () {\n    function check(args) {\n        var xargs = [], i = 0;\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    return { check: check };\n}(), function () {\n    return true;\n});\n\ndefineBuiltinFunction('roman', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $number = args[i++];\n            if ($number instanceof CalcError)\n                return $number;\n            if (!((typeof ($number = this.force($number)) == 'number' || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false)) && ($number |= 0, true))) {\n                if ($number instanceof CalcError)\n                    return $number;\n                return new CalcError(err);\n            }\n            xargs.push($number);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $number = this._arrayArg(args[i]);\n        if ($number) {\n            xargs.push($number);\n            width = Math.max(width, $number.width);\n            height = Math.max(height, $number.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (num) {\n    return arabicToRoman(num).toUpperCase();\n});\n\ndefineBuiltinFunction('arabic', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $roman = args[i++];\n            if ($roman instanceof CalcError)\n                return $roman;\n            if (!(typeof ($roman = this.force($roman)) == 'string' || typeof $roman == 'boolean' || typeof $roman == 'number' ? ($roman += '', true) : $roman === undefined ? ($roman = '', true) : false)) {\n                if ($roman instanceof CalcError)\n                    return $roman;\n                return new CalcError(err);\n            }\n            xargs.push($roman);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $roman = this._arrayArg(args[i]);\n        if ($roman) {\n            xargs.push($roman);\n            width = Math.max(width, $roman.width);\n            height = Math.max(height, $roman.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (rom) {\n    var num = romanToArabic(rom);\n    return num == null ? new CalcError('VALUE') : num;\n});\n\ndefineBuiltinFunction('base', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $number = args[i++];\n            if ($number instanceof CalcError)\n                return $number;\n            if (!((typeof ($number = this.force($number)) == 'number' || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false)) && ($number |= 0, true))) {\n                if ($number instanceof CalcError)\n                    return $number;\n                return new CalcError(err);\n            }\n            xargs.push($number);\n        }\n        {\n            var $radix = args[i++];\n            if ($radix instanceof CalcError)\n                return $radix;\n            if (!((typeof ($radix = this.force($radix)) == 'number' || (typeof $radix == 'boolean' ? ($radix = +$radix, true) : false) || (typeof $radix == 'string' && !/^(?:=|true|false)/i.test($radix) ? (tmp = calc.parse(0, 0, 0, $radix), /^date|number|percent$/.test(tmp.type) ? ($radix = +tmp.value, true) : false) : false)) && ($radix |= 0, true) && ($radix >= 2 && $radix <= 36 ? true : (err = 'NUM', false)))) {\n                if ($radix instanceof CalcError)\n                    return $radix;\n                return new CalcError(err);\n            }\n            xargs.push($radix);\n        }\n        {\n            var $minLen = args[i++];\n            if ($minLen instanceof CalcError)\n                return $minLen;\n            if (!((typeof ($minLen = this.force($minLen)) == 'number' || (typeof $minLen == 'boolean' ? ($minLen = +$minLen, true) : false) || (typeof $minLen == 'string' && !/^(?:=|true|false)/i.test($minLen) ? (tmp = calc.parse(0, 0, 0, $minLen), /^date|number|percent$/.test(tmp.type) ? ($minLen = +tmp.value, true) : false) : false)) && (($minLen |= 0) >= 0 ? true : (err = 'NUM', false)) || ($minLen == null ? ($minLen = 0, true) : false))) {\n                if ($minLen instanceof CalcError)\n                    return $minLen;\n                return new CalcError(err);\n            }\n            xargs.push($minLen);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $number = this._arrayArg(args[i]);\n        if ($number) {\n            xargs.push($number);\n            width = Math.max(width, $number.width);\n            height = Math.max(height, $number.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $radix = this._arrayArg(args[i]);\n        if ($radix) {\n            xargs.push($radix);\n            width = Math.max(width, $radix.width);\n            height = Math.max(height, $radix.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $minLen = this._arrayArg(args[i]);\n        if ($minLen) {\n            xargs.push($minLen);\n            width = Math.max(width, $minLen.width);\n            height = Math.max(height, $minLen.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (number, radix, minLen) {\n    var str = number.toString(radix).toUpperCase();\n    while (str.length < minLen) {\n        str = '0' + str;\n    }\n    return str;\n});\n\ndefineBuiltinFunction('decimal', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $text = args[i++];\n            if ($text instanceof CalcError)\n                return $text;\n            if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                if ($text instanceof CalcError)\n                    return $text;\n                return new CalcError(err);\n            }\n            xargs.push($text);\n        }\n        {\n            var $radix = args[i++];\n            if ($radix instanceof CalcError)\n                return $radix;\n            if (!((typeof ($radix = this.force($radix)) == 'number' || (typeof $radix == 'boolean' ? ($radix = +$radix, true) : false) || (typeof $radix == 'string' && !/^(?:=|true|false)/i.test($radix) ? (tmp = calc.parse(0, 0, 0, $radix), /^date|number|percent$/.test(tmp.type) ? ($radix = +tmp.value, true) : false) : false)) && ($radix |= 0, true) && ($radix >= 2 && $radix <= 36 ? true : (err = 'NUM', false)))) {\n                if ($radix instanceof CalcError)\n                    return $radix;\n                return new CalcError(err);\n            }\n            xargs.push($radix);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $text = this._arrayArg(args[i]);\n        if ($text) {\n            xargs.push($text);\n            width = Math.max(width, $text.width);\n            height = Math.max(height, $text.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $radix = this._arrayArg(args[i]);\n        if ($radix) {\n            xargs.push($radix);\n            width = Math.max(width, $radix.width);\n            height = Math.max(height, $radix.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (text, radix) {\n    text = text.toUpperCase();\n    var val = 0;\n    for (var i = 0; i < text.length; ++i) {\n        var d = text.charCodeAt(i);\n        if (d >= 48 && d <= 57) {\n            d -= 48;\n        } else if (d >= 65 && d < 55 + radix) {\n            d -= 55;\n        } else {\n            return new CalcError('VALUE');\n        }\n        val = val * radix + d;\n    }\n    return val;\n});\n\n/* -----[ String functions ]----- */\n\ndefineBuiltinFunction('char', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $code = args[i++];\n            if ($code instanceof CalcError)\n                return $code;\n            if (!((typeof ($code = this.force($code)) == 'number' || (typeof $code == 'boolean' ? ($code = +$code, true) : false) || (typeof $code == 'string' && !/^(?:=|true|false)/i.test($code) ? (tmp = calc.parse(0, 0, 0, $code), /^date|number|percent$/.test(tmp.type) ? ($code = +tmp.value, true) : false) : false)) && (($code |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                if ($code instanceof CalcError)\n                    return $code;\n                return new CalcError(err);\n            }\n            xargs.push($code);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $code = this._arrayArg(args[i]);\n        if ($code) {\n            xargs.push($code);\n            width = Math.max(width, $code.width);\n            height = Math.max(height, $code.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (code) {\n    return String.fromCharCode(code);\n});\n\n// From XRegExp\nvar RX_NON_PRINTABLE = /[\\0-\\x1F\\x7F-\\x9F\\xAD\\u0378\\u0379\\u037F-\\u0383\\u038B\\u038D\\u03A2\\u0528-\\u0530\\u0557\\u0558\\u0560\\u0588\\u058B-\\u058E\\u0590\\u05C8-\\u05CF\\u05EB-\\u05EF\\u05F5-\\u0605\\u061C\\u061D\\u06DD\\u070E\\u070F\\u074B\\u074C\\u07B2-\\u07BF\\u07FB-\\u07FF\\u082E\\u082F\\u083F\\u085C\\u085D\\u085F-\\u089F\\u08A1\\u08AD-\\u08E3\\u08FF\\u0978\\u0980\\u0984\\u098D\\u098E\\u0991\\u0992\\u09A9\\u09B1\\u09B3-\\u09B5\\u09BA\\u09BB\\u09C5\\u09C6\\u09C9\\u09CA\\u09CF-\\u09D6\\u09D8-\\u09DB\\u09DE\\u09E4\\u09E5\\u09FC-\\u0A00\\u0A04\\u0A0B-\\u0A0E\\u0A11\\u0A12\\u0A29\\u0A31\\u0A34\\u0A37\\u0A3A\\u0A3B\\u0A3D\\u0A43-\\u0A46\\u0A49\\u0A4A\\u0A4E-\\u0A50\\u0A52-\\u0A58\\u0A5D\\u0A5F-\\u0A65\\u0A76-\\u0A80\\u0A84\\u0A8E\\u0A92\\u0AA9\\u0AB1\\u0AB4\\u0ABA\\u0ABB\\u0AC6\\u0ACA\\u0ACE\\u0ACF\\u0AD1-\\u0ADF\\u0AE4\\u0AE5\\u0AF2-\\u0B00\\u0B04\\u0B0D\\u0B0E\\u0B11\\u0B12\\u0B29\\u0B31\\u0B34\\u0B3A\\u0B3B\\u0B45\\u0B46\\u0B49\\u0B4A\\u0B4E-\\u0B55\\u0B58-\\u0B5B\\u0B5E\\u0B64\\u0B65\\u0B78-\\u0B81\\u0B84\\u0B8B-\\u0B8D\\u0B91\\u0B96-\\u0B98\\u0B9B\\u0B9D\\u0BA0-\\u0BA2\\u0BA5-\\u0BA7\\u0BAB-\\u0BAD\\u0BBA-\\u0BBD\\u0BC3-\\u0BC5\\u0BC9\\u0BCE\\u0BCF\\u0BD1-\\u0BD6\\u0BD8-\\u0BE5\\u0BFB-\\u0C00\\u0C04\\u0C0D\\u0C11\\u0C29\\u0C34\\u0C3A-\\u0C3C\\u0C45\\u0C49\\u0C4E-\\u0C54\\u0C57\\u0C5A-\\u0C5F\\u0C64\\u0C65\\u0C70-\\u0C77\\u0C80\\u0C81\\u0C84\\u0C8D\\u0C91\\u0CA9\\u0CB4\\u0CBA\\u0CBB\\u0CC5\\u0CC9\\u0CCE-\\u0CD4\\u0CD7-\\u0CDD\\u0CDF\\u0CE4\\u0CE5\\u0CF0\\u0CF3-\\u0D01\\u0D04\\u0D0D\\u0D11\\u0D3B\\u0D3C\\u0D45\\u0D49\\u0D4F-\\u0D56\\u0D58-\\u0D5F\\u0D64\\u0D65\\u0D76-\\u0D78\\u0D80\\u0D81\\u0D84\\u0D97-\\u0D99\\u0DB2\\u0DBC\\u0DBE\\u0DBF\\u0DC7-\\u0DC9\\u0DCB-\\u0DCE\\u0DD5\\u0DD7\\u0DE0-\\u0DF1\\u0DF5-\\u0E00\\u0E3B-\\u0E3E\\u0E5C-\\u0E80\\u0E83\\u0E85\\u0E86\\u0E89\\u0E8B\\u0E8C\\u0E8E-\\u0E93\\u0E98\\u0EA0\\u0EA4\\u0EA6\\u0EA8\\u0EA9\\u0EAC\\u0EBA\\u0EBE\\u0EBF\\u0EC5\\u0EC7\\u0ECE\\u0ECF\\u0EDA\\u0EDB\\u0EE0-\\u0EFF\\u0F48\\u0F6D-\\u0F70\\u0F98\\u0FBD\\u0FCD\\u0FDB-\\u0FFF\\u10C6\\u10C8-\\u10CC\\u10CE\\u10CF\\u1249\\u124E\\u124F\\u1257\\u1259\\u125E\\u125F\\u1289\\u128E\\u128F\\u12B1\\u12B6\\u12B7\\u12BF\\u12C1\\u12C6\\u12C7\\u12D7\\u1311\\u1316\\u1317\\u135B\\u135C\\u137D-\\u137F\\u139A-\\u139F\\u13F5-\\u13FF\\u169D-\\u169F\\u16F1-\\u16FF\\u170D\\u1715-\\u171F\\u1737-\\u173F\\u1754-\\u175F\\u176D\\u1771\\u1774-\\u177F\\u17DE\\u17DF\\u17EA-\\u17EF\\u17FA-\\u17FF\\u180F\\u181A-\\u181F\\u1878-\\u187F\\u18AB-\\u18AF\\u18F6-\\u18FF\\u191D-\\u191F\\u192C-\\u192F\\u193C-\\u193F\\u1941-\\u1943\\u196E\\u196F\\u1975-\\u197F\\u19AC-\\u19AF\\u19CA-\\u19CF\\u19DB-\\u19DD\\u1A1C\\u1A1D\\u1A5F\\u1A7D\\u1A7E\\u1A8A-\\u1A8F\\u1A9A-\\u1A9F\\u1AAE-\\u1AFF\\u1B4C-\\u1B4F\\u1B7D-\\u1B7F\\u1BF4-\\u1BFB\\u1C38-\\u1C3A\\u1C4A-\\u1C4C\\u1C80-\\u1CBF\\u1CC8-\\u1CCF\\u1CF7-\\u1CFF\\u1DE7-\\u1DFB\\u1F16\\u1F17\\u1F1E\\u1F1F\\u1F46\\u1F47\\u1F4E\\u1F4F\\u1F58\\u1F5A\\u1F5C\\u1F5E\\u1F7E\\u1F7F\\u1FB5\\u1FC5\\u1FD4\\u1FD5\\u1FDC\\u1FF0\\u1FF1\\u1FF5\\u1FFF\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u206F\\u2072\\u2073\\u208F\\u209D-\\u209F\\u20BB-\\u20CF\\u20F1-\\u20FF\\u218A-\\u218F\\u23F4-\\u23FF\\u2427-\\u243F\\u244B-\\u245F\\u2700\\u2B4D-\\u2B4F\\u2B5A-\\u2BFF\\u2C2F\\u2C5F\\u2CF4-\\u2CF8\\u2D26\\u2D28-\\u2D2C\\u2D2E\\u2D2F\\u2D68-\\u2D6E\\u2D71-\\u2D7E\\u2D97-\\u2D9F\\u2DA7\\u2DAF\\u2DB7\\u2DBF\\u2DC7\\u2DCF\\u2DD7\\u2DDF\\u2E3C-\\u2E7F\\u2E9A\\u2EF4-\\u2EFF\\u2FD6-\\u2FEF\\u2FFC-\\u2FFF\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312E-\\u3130\\u318F\\u31BB-\\u31BF\\u31E4-\\u31EF\\u321F\\u32FF\\u4DB6-\\u4DBF\\u9FCD-\\u9FFF\\uA48D-\\uA48F\\uA4C7-\\uA4CF\\uA62C-\\uA63F\\uA698-\\uA69E\\uA6F8-\\uA6FF\\uA78F\\uA794-\\uA79F\\uA7AB-\\uA7F7\\uA82C-\\uA82F\\uA83A-\\uA83F\\uA878-\\uA87F\\uA8C5-\\uA8CD\\uA8DA-\\uA8DF\\uA8FC-\\uA8FF\\uA954-\\uA95E\\uA97D-\\uA97F\\uA9CE\\uA9DA-\\uA9DD\\uA9E0-\\uA9FF\\uAA37-\\uAA3F\\uAA4E\\uAA4F\\uAA5A\\uAA5B\\uAA7C-\\uAA7F\\uAAC3-\\uAADA\\uAAF7-\\uAB00\\uAB07\\uAB08\\uAB0F\\uAB10\\uAB17-\\uAB1F\\uAB27\\uAB2F-\\uABBF\\uABEE\\uABEF\\uABFA-\\uABFF\\uD7A4-\\uD7AF\\uD7C7-\\uD7CA\\uD7FC-\\uF8FF\\uFA6E\\uFA6F\\uFADA-\\uFAFF\\uFB07-\\uFB12\\uFB18-\\uFB1C\\uFB37\\uFB3D\\uFB3F\\uFB42\\uFB45\\uFBC2-\\uFBD2\\uFD40-\\uFD4F\\uFD90\\uFD91\\uFDC8-\\uFDEF\\uFDFE\\uFDFF\\uFE1A-\\uFE1F\\uFE27-\\uFE2F\\uFE53\\uFE67\\uFE6C-\\uFE6F\\uFE75\\uFEFD-\\uFF00\\uFFBF-\\uFFC1\\uFFC8\\uFFC9\\uFFD0\\uFFD1\\uFFD8\\uFFD9\\uFFDD-\\uFFDF\\uFFE7\\uFFEF-\\uFFFB\\uFFFE\\uFFFF]/g;\n\ndefineBuiltinFunction('clean', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $text = args[i++];\n            if ($text instanceof CalcError)\n                return $text;\n            if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                if ($text instanceof CalcError)\n                    return $text;\n                return new CalcError(err);\n            }\n            xargs.push($text);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $text = this._arrayArg(args[i]);\n        if ($text) {\n            xargs.push($text);\n            width = Math.max(width, $text.width);\n            height = Math.max(height, $text.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (text) {\n    return text.replace(RX_NON_PRINTABLE, '');\n});\n\ndefineBuiltinFunction('code', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $text = args[i++];\n            if ($text instanceof CalcError)\n                return $text;\n            if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                if ($text instanceof CalcError)\n                    return $text;\n                return new CalcError(err);\n            }\n            xargs.push($text);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $text = this._arrayArg(args[i]);\n        if ($text) {\n            xargs.push($text);\n            width = Math.max(width, $text.width);\n            height = Math.max(height, $text.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (text) {\n    return text.charAt(0);\n});\n\ncalc.runtime.defineAlias(\"unichar\", \"char\");\ncalc.runtime.defineAlias(\"unicode\", \"code\");\n\ndefineBuiltinFunction('concatenate', false, function () {\n    function check(args) {\n        var stack = [], tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            if (i >= args.length)\n                return new CalcError('N/A');\n            xargs.push(tmp = []);\n            stack.push(xargs);\n            xargs = tmp;\n            do {\n                {\n                    var $text = args[i++];\n                    if ($text instanceof CalcError)\n                        return $text;\n                    if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                        if ($text instanceof CalcError)\n                            return $text;\n                        return new CalcError(err);\n                    }\n                    xargs.push($text);\n                }\n            } while (i < args.length);\n            xargs = stack.pop();\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        while (i < args.length) {\n            toResolve.push(args[i++]);\n        }\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        while (i < args.length) {\n            var $text = this._arrayArg(args[i]);\n            if ($text) {\n                xargs.push($text);\n                width = Math.max(width, $text.width);\n                height = Math.max(height, $text.height);\n                arrays.push(true);\n            } else {\n                xargs.push(args[i]);\n                arrays.push(false);\n            }\n            i++;\n        }\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (args) {\n    var out = '';\n    for (var i = 0; i < args.length; ++i) {\n        out += args[i];\n    }\n    return out;\n});\n\ndefineBuiltinFunction('dollar', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $number = args[i++];\n            if ($number instanceof CalcError)\n                return $number;\n            if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                if ($number instanceof CalcError)\n                    return $number;\n                return new CalcError(err);\n            }\n            xargs.push($number);\n        }\n        {\n            var $decimals = args[i++];\n            if ($decimals instanceof CalcError)\n                return $decimals;\n            if (!((typeof ($decimals = this.force($decimals)) == 'number' || (typeof $decimals == 'boolean' ? ($decimals = +$decimals, true) : false) || (typeof $decimals == 'string' && !/^(?:=|true|false)/i.test($decimals) ? (tmp = calc.parse(0, 0, 0, $decimals), /^date|number|percent$/.test(tmp.type) ? ($decimals = +tmp.value, true) : false) : false)) && ($decimals |= 0, true) || ($decimals == null ? ($decimals = 2, true) : false))) {\n                if ($decimals instanceof CalcError)\n                    return $decimals;\n                return new CalcError(err);\n            }\n            xargs.push($decimals);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $number = this._arrayArg(args[i]);\n        if ($number) {\n            xargs.push($number);\n            width = Math.max(width, $number.width);\n            height = Math.max(height, $number.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $decimals = this._arrayArg(args[i]);\n        if ($decimals) {\n            xargs.push($decimals);\n            width = Math.max(width, $decimals.width);\n            height = Math.max(height, $decimals.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (number, decimals) {\n    var format = '$#,##0DECIMALS;($#,##0DECIMALS)';\n    var dec = '';\n    var denomitator = 1;\n    while (decimals-- > 0) {\n        dec += '0';\n    }\n    while (++decimals < 0) {\n        denomitator *= 10;\n    }\n    if (dec !== '') {\n        dec = '.' + dec;\n    } else if (denomitator !== 1) {\n        number = Math.round(number / denomitator) * denomitator;\n    }\n    format = format.replace(/DECIMALS/g, dec);\n    return formatting.text(number, format);\n});\n\ndefineBuiltinFunction('exact', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $text1 = args[i++];\n            if ($text1 instanceof CalcError)\n                return $text1;\n            if (!(typeof ($text1 = this.force($text1)) == 'string' || typeof $text1 == 'boolean' || typeof $text1 == 'number' ? ($text1 += '', true) : $text1 === undefined ? ($text1 = '', true) : false)) {\n                if ($text1 instanceof CalcError)\n                    return $text1;\n                return new CalcError(err);\n            }\n            xargs.push($text1);\n        }\n        {\n            var $text2 = args[i++];\n            if ($text2 instanceof CalcError)\n                return $text2;\n            if (!(typeof ($text2 = this.force($text2)) == 'string' || typeof $text2 == 'boolean' || typeof $text2 == 'number' ? ($text2 += '', true) : $text2 === undefined ? ($text2 = '', true) : false)) {\n                if ($text2 instanceof CalcError)\n                    return $text2;\n                return new CalcError(err);\n            }\n            xargs.push($text2);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $text1 = this._arrayArg(args[i]);\n        if ($text1) {\n            xargs.push($text1);\n            width = Math.max(width, $text1.width);\n            height = Math.max(height, $text1.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $text2 = this._arrayArg(args[i]);\n        if ($text2) {\n            xargs.push($text2);\n            width = Math.max(width, $text2.width);\n            height = Math.max(height, $text2.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (a, b) {\n    return a === b;\n});\n\ndefineBuiltinFunction('find', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $substring = args[i++];\n            if ($substring instanceof CalcError)\n                return $substring;\n            if (!(typeof ($substring = this.force($substring)) == 'string' || typeof $substring == 'boolean' || typeof $substring == 'number' ? ($substring += '', true) : $substring === undefined ? ($substring = '', true) : false)) {\n                if ($substring instanceof CalcError)\n                    return $substring;\n                return new CalcError(err);\n            }\n            xargs.push($substring);\n        }\n        {\n            var $string = args[i++];\n            if ($string instanceof CalcError)\n                return $string;\n            if (!(typeof ($string = this.force($string)) == 'string' || typeof $string == 'boolean' || typeof $string == 'number' ? ($string += '', true) : $string === undefined ? ($string = '', true) : false)) {\n                if ($string instanceof CalcError)\n                    return $string;\n                return new CalcError(err);\n            }\n            xargs.push($string);\n        }\n        {\n            var $start = args[i++];\n            if ($start instanceof CalcError)\n                return $start;\n            if (!((typeof ($start = this.force($start)) == 'number' || (typeof $start == 'boolean' ? ($start = +$start, true) : false) || (typeof $start == 'string' && !/^(?:=|true|false)/i.test($start) ? (tmp = calc.parse(0, 0, 0, $start), /^date|number|percent$/.test(tmp.type) ? ($start = +tmp.value, true) : false) : false)) && (($start |= 0) > 0 ? true : (err = 'NUM', false)) || ($start == null ? ($start = 1, true) : false))) {\n                if ($start instanceof CalcError)\n                    return $start;\n                return new CalcError(err);\n            }\n            xargs.push($start);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $substring = this._arrayArg(args[i]);\n        if ($substring) {\n            xargs.push($substring);\n            width = Math.max(width, $substring.width);\n            height = Math.max(height, $substring.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $string = this._arrayArg(args[i]);\n        if ($string) {\n            xargs.push($string);\n            width = Math.max(width, $string.width);\n            height = Math.max(height, $string.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $start = this._arrayArg(args[i]);\n        if ($start) {\n            xargs.push($start);\n            width = Math.max(width, $start.width);\n            height = Math.max(height, $start.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (substring, string, start) {\n    var pos = string.indexOf(substring, start - 1);\n    return pos < 0 ? new CalcError('VALUE') : pos + 1;\n});\n\ndefineBuiltinFunction('fixed', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $number = args[i++];\n            if ($number instanceof CalcError)\n                return $number;\n            if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                if ($number instanceof CalcError)\n                    return $number;\n                return new CalcError(err);\n            }\n            xargs.push($number);\n        }\n        {\n            var $decimals = args[i++];\n            if ($decimals instanceof CalcError)\n                return $decimals;\n            if (!((typeof ($decimals = this.force($decimals)) == 'number' || (typeof $decimals == 'boolean' ? ($decimals = +$decimals, true) : false) || (typeof $decimals == 'string' && !/^(?:=|true|false)/i.test($decimals) ? (tmp = calc.parse(0, 0, 0, $decimals), /^date|number|percent$/.test(tmp.type) ? ($decimals = +tmp.value, true) : false) : false)) && ($decimals |= 0, true) || ($decimals == null ? ($decimals = 2, true) : false))) {\n                if ($decimals instanceof CalcError)\n                    return $decimals;\n                return new CalcError(err);\n            }\n            xargs.push($decimals);\n        }\n        {\n            var $noCommas = args[i++];\n            if ($noCommas instanceof CalcError)\n                return $noCommas;\n            if (!(typeof ($noCommas = this.force($noCommas)) == 'boolean' || ($noCommas == null ? ($noCommas = false, true) : false))) {\n                if ($noCommas instanceof CalcError)\n                    return $noCommas;\n                return new CalcError(err);\n            }\n            xargs.push($noCommas);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $number = this._arrayArg(args[i]);\n        if ($number) {\n            xargs.push($number);\n            width = Math.max(width, $number.width);\n            height = Math.max(height, $number.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $decimals = this._arrayArg(args[i]);\n        if ($decimals) {\n            xargs.push($decimals);\n            width = Math.max(width, $decimals.width);\n            height = Math.max(height, $decimals.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $noCommas = this._arrayArg(args[i]);\n        if ($noCommas) {\n            xargs.push($noCommas);\n            width = Math.max(width, $noCommas.width);\n            height = Math.max(height, $noCommas.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (number, decimals, noCommas) {\n    var scale = Math.pow(10, decimals);\n    number = Math.round(number * scale) / scale;\n    var format = noCommas ? '0' : '#,##0';\n    if (decimals > 0) {\n        format += '.';\n        while (decimals-- > 0) {\n            format += '0';\n        }\n    }\n    return formatting.text(number, format);\n});\n\ndefineBuiltinFunction('left', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $text = args[i++];\n            if ($text instanceof CalcError)\n                return $text;\n            if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                if ($text instanceof CalcError)\n                    return $text;\n                return new CalcError(err);\n            }\n            xargs.push($text);\n        }\n        {\n            var $length = args[i++];\n            if ($length instanceof CalcError)\n                return $length;\n            if (!((typeof ($length = this.force($length)) == 'number' || (typeof $length == 'boolean' ? ($length = +$length, true) : false) || (typeof $length == 'string' && !/^(?:=|true|false)/i.test($length) ? (tmp = calc.parse(0, 0, 0, $length), /^date|number|percent$/.test(tmp.type) ? ($length = +tmp.value, true) : false) : false)) && (($length |= 0) >= 0 ? true : (err = 'NUM', false)) || ($length == null ? ($length = 1, true) : false))) {\n                if ($length instanceof CalcError)\n                    return $length;\n                return new CalcError(err);\n            }\n            xargs.push($length);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $text = this._arrayArg(args[i]);\n        if ($text) {\n            xargs.push($text);\n            width = Math.max(width, $text.width);\n            height = Math.max(height, $text.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $length = this._arrayArg(args[i]);\n        if ($length) {\n            xargs.push($length);\n            width = Math.max(width, $length.width);\n            height = Math.max(height, $length.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (text, length) {\n    return text.substr(0, length);\n});\n\ndefineBuiltinFunction('right', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $text = args[i++];\n            if ($text instanceof CalcError)\n                return $text;\n            if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                if ($text instanceof CalcError)\n                    return $text;\n                return new CalcError(err);\n            }\n            xargs.push($text);\n        }\n        {\n            var $length = args[i++];\n            if ($length instanceof CalcError)\n                return $length;\n            if (!((typeof ($length = this.force($length)) == 'number' || (typeof $length == 'boolean' ? ($length = +$length, true) : false) || (typeof $length == 'string' && !/^(?:=|true|false)/i.test($length) ? (tmp = calc.parse(0, 0, 0, $length), /^date|number|percent$/.test(tmp.type) ? ($length = +tmp.value, true) : false) : false)) && (($length |= 0) >= 0 ? true : (err = 'NUM', false)) || ($length == null ? ($length = 1, true) : false))) {\n                if ($length instanceof CalcError)\n                    return $length;\n                return new CalcError(err);\n            }\n            xargs.push($length);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $text = this._arrayArg(args[i]);\n        if ($text) {\n            xargs.push($text);\n            width = Math.max(width, $text.width);\n            height = Math.max(height, $text.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $length = this._arrayArg(args[i]);\n        if ($length) {\n            xargs.push($length);\n            width = Math.max(width, $length.width);\n            height = Math.max(height, $length.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (text, length) {\n    return text.substr(-length);\n});\n\ndefineBuiltinFunction('len', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $text = args[i++];\n            if ($text instanceof CalcError)\n                return $text;\n            if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                if ($text instanceof CalcError)\n                    return $text;\n                return new CalcError(err);\n            }\n            xargs.push($text);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $text = this._arrayArg(args[i]);\n        if ($text) {\n            xargs.push($text);\n            width = Math.max(width, $text.width);\n            height = Math.max(height, $text.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (text) {\n    return text.length;\n});\n\ndefineBuiltinFunction('lower', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $text = args[i++];\n            if ($text instanceof CalcError)\n                return $text;\n            if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                if ($text instanceof CalcError)\n                    return $text;\n                return new CalcError(err);\n            }\n            xargs.push($text);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $text = this._arrayArg(args[i]);\n        if ($text) {\n            xargs.push($text);\n            width = Math.max(width, $text.width);\n            height = Math.max(height, $text.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (text) {\n    return text.toLowerCase();\n});\n\ndefineBuiltinFunction('upper', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $text = args[i++];\n            if ($text instanceof CalcError)\n                return $text;\n            if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                if ($text instanceof CalcError)\n                    return $text;\n                return new CalcError(err);\n            }\n            xargs.push($text);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $text = this._arrayArg(args[i]);\n        if ($text) {\n            xargs.push($text);\n            width = Math.max(width, $text.width);\n            height = Math.max(height, $text.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (text) {\n    return text.toUpperCase();\n});\n\ndefineBuiltinFunction('ltrim', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $text = args[i++];\n            if ($text instanceof CalcError)\n                return $text;\n            if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                if ($text instanceof CalcError)\n                    return $text;\n                return new CalcError(err);\n            }\n            xargs.push($text);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $text = this._arrayArg(args[i]);\n        if ($text) {\n            xargs.push($text);\n            width = Math.max(width, $text.width);\n            height = Math.max(height, $text.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (text) {\n    return text.replace(/^\\s+/, '');\n});\n\ndefineBuiltinFunction('rtrim', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $text = args[i++];\n            if ($text instanceof CalcError)\n                return $text;\n            if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                if ($text instanceof CalcError)\n                    return $text;\n                return new CalcError(err);\n            }\n            xargs.push($text);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $text = this._arrayArg(args[i]);\n        if ($text) {\n            xargs.push($text);\n            width = Math.max(width, $text.width);\n            height = Math.max(height, $text.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (text) {\n    return text.replace(/\\s+$/, '');\n});\n\ndefineBuiltinFunction('trim', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $text = args[i++];\n            if ($text instanceof CalcError)\n                return $text;\n            if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                if ($text instanceof CalcError)\n                    return $text;\n                return new CalcError(err);\n            }\n            xargs.push($text);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $text = this._arrayArg(args[i]);\n        if ($text) {\n            xargs.push($text);\n            width = Math.max(width, $text.width);\n            height = Math.max(height, $text.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (text) {\n    return text.replace(/^\\s+|\\s+$/, '');\n});\n\ndefineBuiltinFunction('mid', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $text = args[i++];\n            if ($text instanceof CalcError)\n                return $text;\n            if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                if ($text instanceof CalcError)\n                    return $text;\n                return new CalcError(err);\n            }\n            xargs.push($text);\n        }\n        {\n            var $start = args[i++];\n            if ($start instanceof CalcError)\n                return $start;\n            if (!((typeof ($start = this.force($start)) == 'number' || (typeof $start == 'boolean' ? ($start = +$start, true) : false) || (typeof $start == 'string' && !/^(?:=|true|false)/i.test($start) ? (tmp = calc.parse(0, 0, 0, $start), /^date|number|percent$/.test(tmp.type) ? ($start = +tmp.value, true) : false) : false)) && (($start |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($start instanceof CalcError)\n                    return $start;\n                return new CalcError(err);\n            }\n            xargs.push($start);\n        }\n        {\n            var $length = args[i++];\n            if ($length instanceof CalcError)\n                return $length;\n            if (!((typeof ($length = this.force($length)) == 'number' || (typeof $length == 'boolean' ? ($length = +$length, true) : false) || (typeof $length == 'string' && !/^(?:=|true|false)/i.test($length) ? (tmp = calc.parse(0, 0, 0, $length), /^date|number|percent$/.test(tmp.type) ? ($length = +tmp.value, true) : false) : false)) && (($length |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                if ($length instanceof CalcError)\n                    return $length;\n                return new CalcError(err);\n            }\n            xargs.push($length);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $text = this._arrayArg(args[i]);\n        if ($text) {\n            xargs.push($text);\n            width = Math.max(width, $text.width);\n            height = Math.max(height, $text.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $start = this._arrayArg(args[i]);\n        if ($start) {\n            xargs.push($start);\n            width = Math.max(width, $start.width);\n            height = Math.max(height, $start.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $length = this._arrayArg(args[i]);\n        if ($length) {\n            xargs.push($length);\n            width = Math.max(width, $length.width);\n            height = Math.max(height, $length.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (text, start, length) {\n    return text.substr(start - 1, length);\n});\n\ndefineBuiltinFunction('proper', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $text = args[i++];\n            if ($text instanceof CalcError)\n                return $text;\n            if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                if ($text instanceof CalcError)\n                    return $text;\n                return new CalcError(err);\n            }\n            xargs.push($text);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $text = this._arrayArg(args[i]);\n        if ($text) {\n            xargs.push($text);\n            width = Math.max(width, $text.width);\n            height = Math.max(height, $text.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (text) {\n    return text.toLowerCase().replace(/\\b./g, function (s) {\n        return s.toUpperCase();\n    });\n});\n\ndefineBuiltinFunction('replace', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $text = args[i++];\n            if ($text instanceof CalcError)\n                return $text;\n            if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                if ($text instanceof CalcError)\n                    return $text;\n                return new CalcError(err);\n            }\n            xargs.push($text);\n        }\n        {\n            var $start = args[i++];\n            if ($start instanceof CalcError)\n                return $start;\n            if (!((typeof ($start = this.force($start)) == 'number' || (typeof $start == 'boolean' ? ($start = +$start, true) : false) || (typeof $start == 'string' && !/^(?:=|true|false)/i.test($start) ? (tmp = calc.parse(0, 0, 0, $start), /^date|number|percent$/.test(tmp.type) ? ($start = +tmp.value, true) : false) : false)) && (($start |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($start instanceof CalcError)\n                    return $start;\n                return new CalcError(err);\n            }\n            xargs.push($start);\n        }\n        {\n            var $length = args[i++];\n            if ($length instanceof CalcError)\n                return $length;\n            if (!((typeof ($length = this.force($length)) == 'number' || (typeof $length == 'boolean' ? ($length = +$length, true) : false) || (typeof $length == 'string' && !/^(?:=|true|false)/i.test($length) ? (tmp = calc.parse(0, 0, 0, $length), /^date|number|percent$/.test(tmp.type) ? ($length = +tmp.value, true) : false) : false)) && (($length |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                if ($length instanceof CalcError)\n                    return $length;\n                return new CalcError(err);\n            }\n            xargs.push($length);\n        }\n        {\n            var $newText = args[i++];\n            if ($newText instanceof CalcError)\n                return $newText;\n            if (!(typeof ($newText = this.force($newText)) == 'string' || typeof $newText == 'boolean' || typeof $newText == 'number' ? ($newText += '', true) : $newText === undefined ? ($newText = '', true) : false)) {\n                if ($newText instanceof CalcError)\n                    return $newText;\n                return new CalcError(err);\n            }\n            xargs.push($newText);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $text = this._arrayArg(args[i]);\n        if ($text) {\n            xargs.push($text);\n            width = Math.max(width, $text.width);\n            height = Math.max(height, $text.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $start = this._arrayArg(args[i]);\n        if ($start) {\n            xargs.push($start);\n            width = Math.max(width, $start.width);\n            height = Math.max(height, $start.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $length = this._arrayArg(args[i]);\n        if ($length) {\n            xargs.push($length);\n            width = Math.max(width, $length.width);\n            height = Math.max(height, $length.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $newText = this._arrayArg(args[i]);\n        if ($newText) {\n            xargs.push($newText);\n            width = Math.max(width, $newText.width);\n            height = Math.max(height, $newText.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (text, start, length, newText) {\n    return text.substr(0, --start) + newText + text.substr(start + length);\n});\n\ndefineBuiltinFunction('rept', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $text = args[i++];\n            if ($text instanceof CalcError)\n                return $text;\n            if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                if ($text instanceof CalcError)\n                    return $text;\n                return new CalcError(err);\n            }\n            xargs.push($text);\n        }\n        {\n            var $number = args[i++];\n            if ($number instanceof CalcError)\n                return $number;\n            if (!((typeof ($number = this.force($number)) == 'number' || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false)) && (($number |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                if ($number instanceof CalcError)\n                    return $number;\n                return new CalcError(err);\n            }\n            xargs.push($number);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $text = this._arrayArg(args[i]);\n        if ($text) {\n            xargs.push($text);\n            width = Math.max(width, $text.width);\n            height = Math.max(height, $text.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $number = this._arrayArg(args[i]);\n        if ($number) {\n            xargs.push($number);\n            width = Math.max(width, $number.width);\n            height = Math.max(height, $number.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (text, number) {\n    var out = '';\n    while (number-- > 0) {\n        out += text;\n    }\n    return out;\n});\n\ndefineBuiltinFunction('search', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $substring = args[i++];\n            if ($substring instanceof CalcError)\n                return $substring;\n            if (!(typeof ($substring = this.force($substring)) == 'string' || typeof $substring == 'boolean' || typeof $substring == 'number' ? ($substring += '', true) : $substring === undefined ? ($substring = '', true) : false)) {\n                if ($substring instanceof CalcError)\n                    return $substring;\n                return new CalcError(err);\n            }\n            xargs.push($substring);\n        }\n        {\n            var $string = args[i++];\n            if ($string instanceof CalcError)\n                return $string;\n            if (!(typeof ($string = this.force($string)) == 'string' || typeof $string == 'boolean' || typeof $string == 'number' ? ($string += '', true) : $string === undefined ? ($string = '', true) : false)) {\n                if ($string instanceof CalcError)\n                    return $string;\n                return new CalcError(err);\n            }\n            xargs.push($string);\n        }\n        {\n            var $start = args[i++];\n            if ($start instanceof CalcError)\n                return $start;\n            if (!((typeof ($start = this.force($start)) == 'number' || (typeof $start == 'boolean' ? ($start = +$start, true) : false) || (typeof $start == 'string' && !/^(?:=|true|false)/i.test($start) ? (tmp = calc.parse(0, 0, 0, $start), /^date|number|percent$/.test(tmp.type) ? ($start = +tmp.value, true) : false) : false)) && (($start |= 0) > 0 ? true : (err = 'NUM', false)) || ($start == null ? ($start = 1, true) : false))) {\n                if ($start instanceof CalcError)\n                    return $start;\n                return new CalcError(err);\n            }\n            xargs.push($start);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $substring = this._arrayArg(args[i]);\n        if ($substring) {\n            xargs.push($substring);\n            width = Math.max(width, $substring.width);\n            height = Math.max(height, $substring.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $string = this._arrayArg(args[i]);\n        if ($string) {\n            xargs.push($string);\n            width = Math.max(width, $string.width);\n            height = Math.max(height, $string.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $start = this._arrayArg(args[i]);\n        if ($start) {\n            xargs.push($start);\n            width = Math.max(width, $start.width);\n            height = Math.max(height, $start.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (substring, string, start) {\n    var pos = string.toLowerCase().indexOf(substring.toLowerCase(), start - 1);\n    return pos < 0 ? new CalcError('VALUE') : pos + 1;\n});\n\ndefineBuiltinFunction('substitute', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $text = args[i++];\n            if ($text instanceof CalcError)\n                return $text;\n            if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                if ($text instanceof CalcError)\n                    return $text;\n                return new CalcError(err);\n            }\n            xargs.push($text);\n        }\n        {\n            var $oldText = args[i++];\n            if ($oldText instanceof CalcError)\n                return $oldText;\n            if (!(typeof ($oldText = this.force($oldText)) == 'string' || typeof $oldText == 'boolean' || typeof $oldText == 'number' ? ($oldText += '', true) : $oldText === undefined ? ($oldText = '', true) : false)) {\n                if ($oldText instanceof CalcError)\n                    return $oldText;\n                return new CalcError(err);\n            }\n            xargs.push($oldText);\n        }\n        {\n            var $newText = args[i++];\n            if ($newText instanceof CalcError)\n                return $newText;\n            if (!(typeof ($newText = this.force($newText)) == 'string' || typeof $newText == 'boolean' || typeof $newText == 'number' ? ($newText += '', true) : $newText === undefined ? ($newText = '', true) : false)) {\n                if ($newText instanceof CalcError)\n                    return $newText;\n                return new CalcError(err);\n            }\n            xargs.push($newText);\n        }\n        {\n            var $nth = args[i++];\n            if ($nth instanceof CalcError)\n                return $nth;\n            if (!((typeof ($nth = this.force($nth)) == 'number' || (typeof $nth == 'boolean' ? ($nth = +$nth, true) : false) || (typeof $nth == 'string' && !/^(?:=|true|false)/i.test($nth) ? (tmp = calc.parse(0, 0, 0, $nth), /^date|number|percent$/.test(tmp.type) ? ($nth = +tmp.value, true) : false) : false)) && (($nth |= 0) > 0 ? true : (err = 'NUM', false)) || $nth == null)) {\n                if ($nth instanceof CalcError)\n                    return $nth;\n                return new CalcError(err);\n            }\n            xargs.push($nth);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $text = this._arrayArg(args[i]);\n        if ($text) {\n            xargs.push($text);\n            width = Math.max(width, $text.width);\n            height = Math.max(height, $text.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $oldText = this._arrayArg(args[i]);\n        if ($oldText) {\n            xargs.push($oldText);\n            width = Math.max(width, $oldText.width);\n            height = Math.max(height, $oldText.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $newText = this._arrayArg(args[i]);\n        if ($newText) {\n            xargs.push($newText);\n            width = Math.max(width, $newText.width);\n            height = Math.max(height, $newText.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $nth = this._arrayArg(args[i]);\n        if ($nth) {\n            xargs.push($nth);\n            width = Math.max(width, $nth.width);\n            height = Math.max(height, $nth.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (text, oldText, newText, nth) {\n    if (oldText === newText) {\n        return text;\n    }\n    var a = text.split(oldText);\n    if (nth == null) {\n        return a.join(newText);\n    }\n    text = '';\n    nth--;\n    for (var i = 0; i < a.length; ++i) {\n        text += a[i];\n        if (i < a.length - 1) {\n            if (i === nth) {\n                text += newText;\n            } else {\n                text += oldText;\n            }\n        }\n    }\n    return text;\n});\n\ndefineBuiltinFunction('t', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $value = args[i++];\n            if ($value instanceof CalcError)\n                return $value;\n            if (!(($value = this.force($value)) != null && i <= args.length)) {\n                if ($value instanceof CalcError)\n                    return $value;\n                return new CalcError(err);\n            }\n            xargs.push($value);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $value = this._arrayArg(args[i]);\n        if ($value) {\n            xargs.push($value);\n            width = Math.max(width, $value.width);\n            height = Math.max(height, $value.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (value) {\n    return typeof value == 'string' ? value : '';\n});\n\ndefineBuiltinFunction('text', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $value = args[i++];\n            if ($value instanceof CalcError)\n                return $value;\n            if (!(($value = this.force($value)) != null && i <= args.length)) {\n                if ($value instanceof CalcError)\n                    return $value;\n                return new CalcError(err);\n            }\n            xargs.push($value);\n        }\n        {\n            var $format = args[i++];\n            if ($format instanceof CalcError)\n                return $format;\n            if (!(typeof ($format = this.force($format)) == 'string' || typeof $format == 'boolean' || typeof $format == 'number' ? ($format += '', true) : $format === undefined ? ($format = '', true) : false)) {\n                if ($format instanceof CalcError)\n                    return $format;\n                return new CalcError(err);\n            }\n            xargs.push($format);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $value = this._arrayArg(args[i]);\n        if ($value) {\n            xargs.push($value);\n            width = Math.max(width, $value.width);\n            height = Math.max(height, $value.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $format = this._arrayArg(args[i]);\n        if ($format) {\n            xargs.push($format);\n            width = Math.max(width, $format.width);\n            height = Math.max(height, $format.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (value, format) {\n    return formatting.text(value, format);\n});\n\ndefineBuiltinFunction('value', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $value = args[i++];\n            if ($value instanceof CalcError)\n                return $value;\n            if (!(($value = this.force($value)) != null && i <= args.length)) {\n                if ($value instanceof CalcError)\n                    return $value;\n                return new CalcError(err);\n            }\n            xargs.push($value);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $value = this._arrayArg(args[i]);\n        if ($value) {\n            xargs.push($value);\n            width = Math.max(width, $value.width);\n            height = Math.max(height, $value.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (value) {\n    if (typeof value == 'number') {\n        return value;\n    }\n    if (typeof value == 'boolean') {\n        return +value;\n    }\n    value = (value + '').replace(/[$€,]/g, '');\n    value = parseFloat(value);\n    return isNaN(value) ? new CalcError('VALUE') : value;\n});\n\nfunction Hyperlink(link, text) {\n    this.link = link;\n    this.text = text;\n}\nHyperlink.prototype.toString = function() {\n    return this.text;\n};\n\ndefineBuiltinFunction('hyperlink', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $link = args[i++];\n            if ($link instanceof CalcError)\n                return $link;\n            if (!(typeof ($link = this.force($link)) == 'string' || typeof $link == 'boolean' || typeof $link == 'number' ? ($link += '', true) : $link === undefined ? ($link = '', true) : false)) {\n                if ($link instanceof CalcError)\n                    return $link;\n                return new CalcError(err);\n            }\n            xargs.push($link);\n        }\n        {\n            var $text = args[i++];\n            if ($text instanceof CalcError)\n                return $text;\n            if (!((typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false) || ($text == null ? ($text = $link, true) : false))) {\n                if ($text instanceof CalcError)\n                    return $text;\n                return new CalcError(err);\n            }\n            xargs.push($text);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $link = this._arrayArg(args[i]);\n        if ($link) {\n            xargs.push($link);\n            width = Math.max(width, $link.width);\n            height = Math.max(height, $link.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $text = this._arrayArg(args[i]);\n        if ($text) {\n            xargs.push($text);\n            width = Math.max(width, $text.width);\n            height = Math.max(height, $text.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (link, text) {\n    return new Hyperlink(link, text);\n});\n\n//// other misc functions\n\ndefineBuiltinFunction('iferror', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            var $value = args[i++];\n            if (!($value = this.force($value), i <= args.length)) {\n                return new CalcError(err);\n            }\n            xargs.push($value);\n        }\n        {\n            var $value_if_error = args[i++];\n            if (!(($value_if_error = this.force($value_if_error)) != null && i <= args.length)) {\n                return new CalcError(err);\n            }\n            xargs.push($value_if_error);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    function arrayArgs(args) {\n        var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n        var $value = this._arrayArg(args[i]);\n        if ($value) {\n            xargs.push($value);\n            width = Math.max(width, $value.width);\n            height = Math.max(height, $value.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        var $value_if_error = this._arrayArg(args[i]);\n        if ($value_if_error) {\n            xargs.push($value_if_error);\n            width = Math.max(width, $value_if_error.width);\n            height = Math.max(height, $value_if_error.height);\n            arrays.push(true);\n        } else {\n            xargs.push(args[i]);\n            arrays.push(false);\n        }\n        i++;\n        return {\n            args: xargs,\n            width: width,\n            height: height,\n            arrays: arrays\n        };\n    }\n    return {\n        check: check,\n        resolve: resolve,\n        arrayArgs: arrayArgs\n    };\n}(), function (value, valueIfError) {\n    return value instanceof CalcError ? valueIfError : value;\n});\n\n//// utils\n\nvar parseCriteria = (function(){\n    var RXCACHE = Object.create(null);\n\n    function makeComparator(cmp, x) {\n        if (typeof x == \"string\") {\n            var num = parseFloat(x);\n            if (!isNaN(num) && num == x) {\n                x = num;\n            }\n        }\n        return function(a) {\n            var b = x;\n            if (typeof a == \"string\" && typeof b == \"string\") {\n                a = a.toLowerCase();\n                b = b.toLowerCase();\n            }\n            return cmp(a, b);\n        };\n    }\n\n    function lc(a) {\n        var num, str;\n        if (typeof a == \"string\") {\n            a = a.toLowerCase();\n        }\n        if (/^[0-9.]+%$/.test(a)) {\n            str = a.substr(0, a.length - 1);\n            num = parseFloat(str);\n            if (!isNaN(num) && num == str) {\n                a = num / 100;\n            }\n        } else if (/^[0-9.]+$/.test(a)) {\n            num = parseFloat(a);\n            if (!isNaN(num) && num == a) {\n                a = num;\n            }\n        }\n        return a;\n    }\n\n    function compLT(a, b) { return lc(a) < lc(b); }\n    function compLTE(a, b) { return lc(a) <= lc(b); }\n    function compGT(a, b) { return lc(a) > lc(b); }\n    function compGTE(a, b) { return lc(a) >= lc(b); }\n    function compNE(a, b) { return !compEQ(a, b); }\n    function compEQ(a, b) {\n        if (b instanceof RegExp) {\n            return b.test(a);\n        }\n        if (typeof a == \"string\" || typeof b == \"string\") {\n            // if either one is string, make sure both are strings\n            a = String(a);\n            b = String(b);\n        }\n        return lc(a) == lc(b);\n    }\n\n    return function(cmp) {\n        if (typeof cmp == \"function\") {\n            return cmp;\n        }\n        var m;\n        if ((m = /^=(.*)$/.exec(cmp))) {\n            return makeComparator(compEQ, m[1]);\n        }\n        if ((m = /^<>(.*)$/.exec(cmp))) {\n            return makeComparator(compNE, m[1]);\n        }\n        if ((m = /^<=(.*)$/.exec(cmp))) {\n            return makeComparator(compLTE, m[1]);\n        }\n        if ((m = /^<(.*)$/.exec(cmp))) {\n            return makeComparator(compLT, m[1]);\n        }\n        if ((m = /^>=(.*)$/.exec(cmp))) {\n            return makeComparator(compGTE, m[1]);\n        }\n        if ((m = /^>(.*)$/.exec(cmp))) {\n            return makeComparator(compGT, m[1]);\n        }\n        if (/[?*]/.exec(cmp)) {\n            // has wildchars\n            var rx = RXCACHE[cmp];\n            if (!rx) {\n                rx = cmp.replace(/(~\\?|~\\*|[\\]({\\+\\.\\|\\^\\$\\\\})\\[]|[?*])/g, function(s){\n                    switch (s) {\n                    case \"~?\" : return \"\\\\?\";\n                    case \"~*\" : return \"\\\\*\";\n                    case \"?\" : return \".\";\n                    case \"*\" : return \".*\";\n                    default : return \"\\\\\" + s;\n                    }\n                });\n                rx = RXCACHE[cmp] = new RegExp(\"^\" + rx + \"$\", \"i\");\n            }\n            return makeComparator(compEQ, rx);\n        }\n        return makeComparator(compEQ, cmp);\n    };\n})();\n\nfunction numericPredicate(val) {\n    return typeof val == \"number\"\n        || typeof val == \"boolean\"\n        || val == null\n        || val === \"\";\n}\n\nfunction ascending(a, b) {\n    return a === b ? 0 : a < b ? -1 : 1;\n}\n\nfunction descending(a, b) {\n    return a === b ? 0 : a < b ? 1 : -1;\n}\n\ndefineBuiltinFunction('ERF', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $lower_limit = args[i++];\n            if ($lower_limit instanceof CalcError)\n                return $lower_limit;\n            if (!((typeof ($lower_limit = this.force($lower_limit)) == 'number' ? ($lower_limit = limitPrecision($lower_limit), true) : false) || (typeof $lower_limit == 'boolean' ? ($lower_limit = +$lower_limit, true) : false) || (typeof $lower_limit == 'string' && !/^(?:=|true|false)/i.test($lower_limit) ? (tmp = calc.parse(0, 0, 0, $lower_limit), /^date|number|percent$/.test(tmp.type) ? ($lower_limit = +tmp.value, true) : false) : false))) {\n                if ($lower_limit instanceof CalcError)\n                    return $lower_limit;\n                return new CalcError(err);\n            }\n            xargs.push($lower_limit);\n        }\n        {\n            var $upper_limit = args[i++];\n            if ($upper_limit instanceof CalcError)\n                return $upper_limit;\n            if (!((typeof ($upper_limit = this.force($upper_limit)) == 'number' ? ($upper_limit = limitPrecision($upper_limit), true) : false) || (typeof $upper_limit == 'boolean' ? ($upper_limit = +$upper_limit, true) : false) || (typeof $upper_limit == 'string' && !/^(?:=|true|false)/i.test($upper_limit) ? (tmp = calc.parse(0, 0, 0, $upper_limit), /^date|number|percent$/.test(tmp.type) ? ($upper_limit = +tmp.value, true) : false) : false) || $upper_limit == null)) {\n                if ($upper_limit instanceof CalcError)\n                    return $upper_limit;\n                return new CalcError(err);\n            }\n            xargs.push($upper_limit);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (ll, ul) {\n    if (ul == null) {\n        return ERF(ll);\n    }\n    return ERF(ul) - ERF(ll);\n});\n\ndefineBuiltinFunction('ERFC', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), ERFC);\n\ndefineBuiltinFunction('GAMMALN', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x > 0 ? true : (err = 'NUM', false)))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), GAMMALN);\n\ndefineBuiltinFunction('GAMMA', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), GAMMA);\n\ndefineBuiltinFunction('GAMMA.DIST', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x >= 0 ? true : (err = 'NUM', false)))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        {\n            var $alpha = args[i++];\n            if ($alpha instanceof CalcError)\n                return $alpha;\n            if (!(((typeof ($alpha = this.force($alpha)) == 'number' ? ($alpha = limitPrecision($alpha), true) : false) || (typeof $alpha == 'boolean' ? ($alpha = +$alpha, true) : false) || (typeof $alpha == 'string' && !/^(?:=|true|false)/i.test($alpha) ? (tmp = calc.parse(0, 0, 0, $alpha), /^date|number|percent$/.test(tmp.type) ? ($alpha = +tmp.value, true) : false) : false)) && ($alpha > 0 ? true : (err = 'NUM', false)))) {\n                if ($alpha instanceof CalcError)\n                    return $alpha;\n                return new CalcError(err);\n            }\n            xargs.push($alpha);\n        }\n        {\n            var $beta = args[i++];\n            if ($beta instanceof CalcError)\n                return $beta;\n            if (!(((typeof ($beta = this.force($beta)) == 'number' ? ($beta = limitPrecision($beta), true) : false) || (typeof $beta == 'boolean' ? ($beta = +$beta, true) : false) || (typeof $beta == 'string' && !/^(?:=|true|false)/i.test($beta) ? (tmp = calc.parse(0, 0, 0, $beta), /^date|number|percent$/.test(tmp.type) ? ($beta = +tmp.value, true) : false) : false)) && ($beta > 0 ? true : (err = 'NUM', false)))) {\n                if ($beta instanceof CalcError)\n                    return $beta;\n                return new CalcError(err);\n            }\n            xargs.push($beta);\n        }\n        {\n            var $cumulative = args[i++];\n            if ($cumulative instanceof CalcError)\n                return $cumulative;\n            if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                if ($cumulative instanceof CalcError)\n                    return $cumulative;\n                return new CalcError(err);\n            }\n            xargs.push($cumulative);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), GAMMA_DIST);\n\ndefineBuiltinFunction('GAMMA.INV', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $p = args[i++];\n            if ($p instanceof CalcError)\n                return $p;\n            if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p >= 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                if ($p instanceof CalcError)\n                    return $p;\n                return new CalcError(err);\n            }\n            xargs.push($p);\n        }\n        {\n            var $alpha = args[i++];\n            if ($alpha instanceof CalcError)\n                return $alpha;\n            if (!(((typeof ($alpha = this.force($alpha)) == 'number' ? ($alpha = limitPrecision($alpha), true) : false) || (typeof $alpha == 'boolean' ? ($alpha = +$alpha, true) : false) || (typeof $alpha == 'string' && !/^(?:=|true|false)/i.test($alpha) ? (tmp = calc.parse(0, 0, 0, $alpha), /^date|number|percent$/.test(tmp.type) ? ($alpha = +tmp.value, true) : false) : false)) && ($alpha > 0 ? true : (err = 'NUM', false)))) {\n                if ($alpha instanceof CalcError)\n                    return $alpha;\n                return new CalcError(err);\n            }\n            xargs.push($alpha);\n        }\n        {\n            var $beta = args[i++];\n            if ($beta instanceof CalcError)\n                return $beta;\n            if (!(((typeof ($beta = this.force($beta)) == 'number' ? ($beta = limitPrecision($beta), true) : false) || (typeof $beta == 'boolean' ? ($beta = +$beta, true) : false) || (typeof $beta == 'string' && !/^(?:=|true|false)/i.test($beta) ? (tmp = calc.parse(0, 0, 0, $beta), /^date|number|percent$/.test(tmp.type) ? ($beta = +tmp.value, true) : false) : false)) && ($beta > 0 ? true : (err = 'NUM', false)))) {\n                if ($beta instanceof CalcError)\n                    return $beta;\n                return new CalcError(err);\n            }\n            xargs.push($beta);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), GAMMA_INV);\n\ndefineBuiltinFunction('NORM.S.DIST', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $z = args[i++];\n            if ($z instanceof CalcError)\n                return $z;\n            if (!((typeof ($z = this.force($z)) == 'number' ? ($z = limitPrecision($z), true) : false) || (typeof $z == 'boolean' ? ($z = +$z, true) : false) || (typeof $z == 'string' && !/^(?:=|true|false)/i.test($z) ? (tmp = calc.parse(0, 0, 0, $z), /^date|number|percent$/.test(tmp.type) ? ($z = +tmp.value, true) : false) : false))) {\n                if ($z instanceof CalcError)\n                    return $z;\n                return new CalcError(err);\n            }\n            xargs.push($z);\n        }\n        {\n            var $cumulative = args[i++];\n            if ($cumulative instanceof CalcError)\n                return $cumulative;\n            if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                if ($cumulative instanceof CalcError)\n                    return $cumulative;\n                return new CalcError(err);\n            }\n            xargs.push($cumulative);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), NORM_S_DIST);\n\ndefineBuiltinFunction('NORM.S.INV', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $p = args[i++];\n            if ($p instanceof CalcError)\n                return $p;\n            if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p >= 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                if ($p instanceof CalcError)\n                    return $p;\n                return new CalcError(err);\n            }\n            xargs.push($p);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), NORM_S_INV);\n\ndefineBuiltinFunction('NORM.DIST', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        {\n            var $mean = args[i++];\n            if ($mean instanceof CalcError)\n                return $mean;\n            if (!((typeof ($mean = this.force($mean)) == 'number' ? ($mean = limitPrecision($mean), true) : false) || (typeof $mean == 'boolean' ? ($mean = +$mean, true) : false) || (typeof $mean == 'string' && !/^(?:=|true|false)/i.test($mean) ? (tmp = calc.parse(0, 0, 0, $mean), /^date|number|percent$/.test(tmp.type) ? ($mean = +tmp.value, true) : false) : false))) {\n                if ($mean instanceof CalcError)\n                    return $mean;\n                return new CalcError(err);\n            }\n            xargs.push($mean);\n        }\n        {\n            var $stddev = args[i++];\n            if ($stddev instanceof CalcError)\n                return $stddev;\n            if (!(((typeof ($stddev = this.force($stddev)) == 'number' ? ($stddev = limitPrecision($stddev), true) : false) || (typeof $stddev == 'boolean' ? ($stddev = +$stddev, true) : false) || (typeof $stddev == 'string' && !/^(?:=|true|false)/i.test($stddev) ? (tmp = calc.parse(0, 0, 0, $stddev), /^date|number|percent$/.test(tmp.type) ? ($stddev = +tmp.value, true) : false) : false)) && ($stddev > 0 ? true : (err = 'NUM', false)))) {\n                if ($stddev instanceof CalcError)\n                    return $stddev;\n                return new CalcError(err);\n            }\n            xargs.push($stddev);\n        }\n        {\n            var $cumulative = args[i++];\n            if ($cumulative instanceof CalcError)\n                return $cumulative;\n            if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                if ($cumulative instanceof CalcError)\n                    return $cumulative;\n                return new CalcError(err);\n            }\n            xargs.push($cumulative);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), NORM_DIST);\n\ndefineBuiltinFunction('NORM.INV', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $p = args[i++];\n            if ($p instanceof CalcError)\n                return $p;\n            if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p >= 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                if ($p instanceof CalcError)\n                    return $p;\n                return new CalcError(err);\n            }\n            xargs.push($p);\n        }\n        {\n            var $mean = args[i++];\n            if ($mean instanceof CalcError)\n                return $mean;\n            if (!((typeof ($mean = this.force($mean)) == 'number' ? ($mean = limitPrecision($mean), true) : false) || (typeof $mean == 'boolean' ? ($mean = +$mean, true) : false) || (typeof $mean == 'string' && !/^(?:=|true|false)/i.test($mean) ? (tmp = calc.parse(0, 0, 0, $mean), /^date|number|percent$/.test(tmp.type) ? ($mean = +tmp.value, true) : false) : false))) {\n                if ($mean instanceof CalcError)\n                    return $mean;\n                return new CalcError(err);\n            }\n            xargs.push($mean);\n        }\n        {\n            var $stddev = args[i++];\n            if ($stddev instanceof CalcError)\n                return $stddev;\n            if (!(((typeof ($stddev = this.force($stddev)) == 'number' ? ($stddev = limitPrecision($stddev), true) : false) || (typeof $stddev == 'boolean' ? ($stddev = +$stddev, true) : false) || (typeof $stddev == 'string' && !/^(?:=|true|false)/i.test($stddev) ? (tmp = calc.parse(0, 0, 0, $stddev), /^date|number|percent$/.test(tmp.type) ? ($stddev = +tmp.value, true) : false) : false)) && ($stddev > 0 ? true : (err = 'NUM', false)))) {\n                if ($stddev instanceof CalcError)\n                    return $stddev;\n                return new CalcError(err);\n            }\n            xargs.push($stddev);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), NORM_INV);\n\ndefineBuiltinFunction('BETADIST', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        {\n            var $alpha = args[i++];\n            if ($alpha instanceof CalcError)\n                return $alpha;\n            if (!(((typeof ($alpha = this.force($alpha)) == 'number' ? ($alpha = limitPrecision($alpha), true) : false) || (typeof $alpha == 'boolean' ? ($alpha = +$alpha, true) : false) || (typeof $alpha == 'string' && !/^(?:=|true|false)/i.test($alpha) ? (tmp = calc.parse(0, 0, 0, $alpha), /^date|number|percent$/.test(tmp.type) ? ($alpha = +tmp.value, true) : false) : false)) && ($alpha > 0 ? true : (err = 'NUM', false)))) {\n                if ($alpha instanceof CalcError)\n                    return $alpha;\n                return new CalcError(err);\n            }\n            xargs.push($alpha);\n        }\n        {\n            var $beta = args[i++];\n            if ($beta instanceof CalcError)\n                return $beta;\n            if (!(((typeof ($beta = this.force($beta)) == 'number' ? ($beta = limitPrecision($beta), true) : false) || (typeof $beta == 'boolean' ? ($beta = +$beta, true) : false) || (typeof $beta == 'string' && !/^(?:=|true|false)/i.test($beta) ? (tmp = calc.parse(0, 0, 0, $beta), /^date|number|percent$/.test(tmp.type) ? ($beta = +tmp.value, true) : false) : false)) && ($beta > 0 ? true : (err = 'NUM', false)))) {\n                if ($beta instanceof CalcError)\n                    return $beta;\n                return new CalcError(err);\n            }\n            xargs.push($beta);\n        }\n        {\n            var $A = args[i++];\n            if ($A instanceof CalcError)\n                return $A;\n            if (!((typeof ($A = this.force($A)) == 'number' ? ($A = limitPrecision($A), true) : false) || (typeof $A == 'boolean' ? ($A = +$A, true) : false) || (typeof $A == 'string' && !/^(?:=|true|false)/i.test($A) ? (tmp = calc.parse(0, 0, 0, $A), /^date|number|percent$/.test(tmp.type) ? ($A = +tmp.value, true) : false) : false) || ($A == null ? ($A = 0, true) : false))) {\n                if ($A instanceof CalcError)\n                    return $A;\n                return new CalcError(err);\n            }\n            xargs.push($A);\n        }\n        {\n            var $B = args[i++];\n            if ($B instanceof CalcError)\n                return $B;\n            if (!((typeof ($B = this.force($B)) == 'number' ? ($B = limitPrecision($B), true) : false) || (typeof $B == 'boolean' ? ($B = +$B, true) : false) || (typeof $B == 'string' && !/^(?:=|true|false)/i.test($B) ? (tmp = calc.parse(0, 0, 0, $B), /^date|number|percent$/.test(tmp.type) ? ($B = +tmp.value, true) : false) : false) || ($B == null ? ($B = 1, true) : false))) {\n                if ($B instanceof CalcError)\n                    return $B;\n                return new CalcError(err);\n            }\n            xargs.push($B);\n        }\n        {\n            if (!($x >= $A ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        {\n            if (!($x <= $B ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        {\n            if (!($A < $B ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), BETADIST);\n\ndefineBuiltinFunction('BETA.DIST', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        {\n            var $alpha = args[i++];\n            if ($alpha instanceof CalcError)\n                return $alpha;\n            if (!(((typeof ($alpha = this.force($alpha)) == 'number' ? ($alpha = limitPrecision($alpha), true) : false) || (typeof $alpha == 'boolean' ? ($alpha = +$alpha, true) : false) || (typeof $alpha == 'string' && !/^(?:=|true|false)/i.test($alpha) ? (tmp = calc.parse(0, 0, 0, $alpha), /^date|number|percent$/.test(tmp.type) ? ($alpha = +tmp.value, true) : false) : false)) && ($alpha > 0 ? true : (err = 'NUM', false)))) {\n                if ($alpha instanceof CalcError)\n                    return $alpha;\n                return new CalcError(err);\n            }\n            xargs.push($alpha);\n        }\n        {\n            var $beta = args[i++];\n            if ($beta instanceof CalcError)\n                return $beta;\n            if (!(((typeof ($beta = this.force($beta)) == 'number' ? ($beta = limitPrecision($beta), true) : false) || (typeof $beta == 'boolean' ? ($beta = +$beta, true) : false) || (typeof $beta == 'string' && !/^(?:=|true|false)/i.test($beta) ? (tmp = calc.parse(0, 0, 0, $beta), /^date|number|percent$/.test(tmp.type) ? ($beta = +tmp.value, true) : false) : false)) && ($beta > 0 ? true : (err = 'NUM', false)))) {\n                if ($beta instanceof CalcError)\n                    return $beta;\n                return new CalcError(err);\n            }\n            xargs.push($beta);\n        }\n        {\n            var $cumulative = args[i++];\n            if ($cumulative instanceof CalcError)\n                return $cumulative;\n            if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                if ($cumulative instanceof CalcError)\n                    return $cumulative;\n                return new CalcError(err);\n            }\n            xargs.push($cumulative);\n        }\n        {\n            var $A = args[i++];\n            if ($A instanceof CalcError)\n                return $A;\n            if (!((typeof ($A = this.force($A)) == 'number' ? ($A = limitPrecision($A), true) : false) || (typeof $A == 'boolean' ? ($A = +$A, true) : false) || (typeof $A == 'string' && !/^(?:=|true|false)/i.test($A) ? (tmp = calc.parse(0, 0, 0, $A), /^date|number|percent$/.test(tmp.type) ? ($A = +tmp.value, true) : false) : false) || ($A == null ? ($A = 0, true) : false))) {\n                if ($A instanceof CalcError)\n                    return $A;\n                return new CalcError(err);\n            }\n            xargs.push($A);\n        }\n        {\n            var $B = args[i++];\n            if ($B instanceof CalcError)\n                return $B;\n            if (!((typeof ($B = this.force($B)) == 'number' ? ($B = limitPrecision($B), true) : false) || (typeof $B == 'boolean' ? ($B = +$B, true) : false) || (typeof $B == 'string' && !/^(?:=|true|false)/i.test($B) ? (tmp = calc.parse(0, 0, 0, $B), /^date|number|percent$/.test(tmp.type) ? ($B = +tmp.value, true) : false) : false) || ($B == null ? ($B = 1, true) : false))) {\n                if ($B instanceof CalcError)\n                    return $B;\n                return new CalcError(err);\n            }\n            xargs.push($B);\n        }\n        {\n            if (!($x >= $A ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        {\n            if (!($x <= $B ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        {\n            if (!($A < $B ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), BETA_DIST);\n\ndefineBuiltinFunction('BETA.INV', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $p = args[i++];\n            if ($p instanceof CalcError)\n                return $p;\n            if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p >= 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                if ($p instanceof CalcError)\n                    return $p;\n                return new CalcError(err);\n            }\n            xargs.push($p);\n        }\n        {\n            var $alpha = args[i++];\n            if ($alpha instanceof CalcError)\n                return $alpha;\n            if (!(((typeof ($alpha = this.force($alpha)) == 'number' ? ($alpha = limitPrecision($alpha), true) : false) || (typeof $alpha == 'boolean' ? ($alpha = +$alpha, true) : false) || (typeof $alpha == 'string' && !/^(?:=|true|false)/i.test($alpha) ? (tmp = calc.parse(0, 0, 0, $alpha), /^date|number|percent$/.test(tmp.type) ? ($alpha = +tmp.value, true) : false) : false)) && ($alpha > 0 ? true : (err = 'NUM', false)))) {\n                if ($alpha instanceof CalcError)\n                    return $alpha;\n                return new CalcError(err);\n            }\n            xargs.push($alpha);\n        }\n        {\n            var $beta = args[i++];\n            if ($beta instanceof CalcError)\n                return $beta;\n            if (!(((typeof ($beta = this.force($beta)) == 'number' ? ($beta = limitPrecision($beta), true) : false) || (typeof $beta == 'boolean' ? ($beta = +$beta, true) : false) || (typeof $beta == 'string' && !/^(?:=|true|false)/i.test($beta) ? (tmp = calc.parse(0, 0, 0, $beta), /^date|number|percent$/.test(tmp.type) ? ($beta = +tmp.value, true) : false) : false)) && ($beta > 0 ? true : (err = 'NUM', false)))) {\n                if ($beta instanceof CalcError)\n                    return $beta;\n                return new CalcError(err);\n            }\n            xargs.push($beta);\n        }\n        {\n            var $A = args[i++];\n            if ($A instanceof CalcError)\n                return $A;\n            if (!((typeof ($A = this.force($A)) == 'number' ? ($A = limitPrecision($A), true) : false) || (typeof $A == 'boolean' ? ($A = +$A, true) : false) || (typeof $A == 'string' && !/^(?:=|true|false)/i.test($A) ? (tmp = calc.parse(0, 0, 0, $A), /^date|number|percent$/.test(tmp.type) ? ($A = +tmp.value, true) : false) : false) || ($A == null ? ($A = 0, true) : false))) {\n                if ($A instanceof CalcError)\n                    return $A;\n                return new CalcError(err);\n            }\n            xargs.push($A);\n        }\n        {\n            var $B = args[i++];\n            if ($B instanceof CalcError)\n                return $B;\n            if (!((typeof ($B = this.force($B)) == 'number' ? ($B = limitPrecision($B), true) : false) || (typeof $B == 'boolean' ? ($B = +$B, true) : false) || (typeof $B == 'string' && !/^(?:=|true|false)/i.test($B) ? (tmp = calc.parse(0, 0, 0, $B), /^date|number|percent$/.test(tmp.type) ? ($B = +tmp.value, true) : false) : false) || ($B == null ? ($B = 1, true) : false))) {\n                if ($B instanceof CalcError)\n                    return $B;\n                return new CalcError(err);\n            }\n            xargs.push($B);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), BETA_INV);\n\ndefineBuiltinFunction('CHISQ.DIST', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x >= 0 ? true : (err = 'NUM', false)))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        {\n            var $deg_freedom = args[i++];\n            if ($deg_freedom instanceof CalcError)\n                return $deg_freedom;\n            if (!((typeof ($deg_freedom = this.force($deg_freedom)) == 'number' || (typeof $deg_freedom == 'boolean' ? ($deg_freedom = +$deg_freedom, true) : false) || (typeof $deg_freedom == 'string' && !/^(?:=|true|false)/i.test($deg_freedom) ? (tmp = calc.parse(0, 0, 0, $deg_freedom), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom = +tmp.value, true) : false) : false)) && (($deg_freedom |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($deg_freedom instanceof CalcError)\n                    return $deg_freedom;\n                return new CalcError(err);\n            }\n            xargs.push($deg_freedom);\n        }\n        {\n            var $cumulative = args[i++];\n            if ($cumulative instanceof CalcError)\n                return $cumulative;\n            if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                if ($cumulative instanceof CalcError)\n                    return $cumulative;\n                return new CalcError(err);\n            }\n            xargs.push($cumulative);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), chisq_left);\n\ndefineBuiltinFunction('CHISQ.DIST.RT', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x >= 0 ? true : (err = 'NUM', false)))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        {\n            var $deg_freedom = args[i++];\n            if ($deg_freedom instanceof CalcError)\n                return $deg_freedom;\n            if (!((typeof ($deg_freedom = this.force($deg_freedom)) == 'number' || (typeof $deg_freedom == 'boolean' ? ($deg_freedom = +$deg_freedom, true) : false) || (typeof $deg_freedom == 'string' && !/^(?:=|true|false)/i.test($deg_freedom) ? (tmp = calc.parse(0, 0, 0, $deg_freedom), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom = +tmp.value, true) : false) : false)) && (($deg_freedom |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($deg_freedom instanceof CalcError)\n                    return $deg_freedom;\n                return new CalcError(err);\n            }\n            xargs.push($deg_freedom);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), chisq_right);\n\ndefineBuiltinFunction('CHISQ.INV', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $p = args[i++];\n            if ($p instanceof CalcError)\n                return $p;\n            if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p >= 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                if ($p instanceof CalcError)\n                    return $p;\n                return new CalcError(err);\n            }\n            xargs.push($p);\n        }\n        {\n            var $deg_freedom = args[i++];\n            if ($deg_freedom instanceof CalcError)\n                return $deg_freedom;\n            if (!((typeof ($deg_freedom = this.force($deg_freedom)) == 'number' || (typeof $deg_freedom == 'boolean' ? ($deg_freedom = +$deg_freedom, true) : false) || (typeof $deg_freedom == 'string' && !/^(?:=|true|false)/i.test($deg_freedom) ? (tmp = calc.parse(0, 0, 0, $deg_freedom), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom = +tmp.value, true) : false) : false)) && (($deg_freedom |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($deg_freedom instanceof CalcError)\n                    return $deg_freedom;\n                return new CalcError(err);\n            }\n            xargs.push($deg_freedom);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), chisq_left_inv);\n\ndefineBuiltinFunction('CHISQ.INV.RT', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $p = args[i++];\n            if ($p instanceof CalcError)\n                return $p;\n            if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p >= 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                if ($p instanceof CalcError)\n                    return $p;\n                return new CalcError(err);\n            }\n            xargs.push($p);\n        }\n        {\n            var $deg_freedom = args[i++];\n            if ($deg_freedom instanceof CalcError)\n                return $deg_freedom;\n            if (!((typeof ($deg_freedom = this.force($deg_freedom)) == 'number' || (typeof $deg_freedom == 'boolean' ? ($deg_freedom = +$deg_freedom, true) : false) || (typeof $deg_freedom == 'string' && !/^(?:=|true|false)/i.test($deg_freedom) ? (tmp = calc.parse(0, 0, 0, $deg_freedom), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom = +tmp.value, true) : false) : false)) && (($deg_freedom |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($deg_freedom instanceof CalcError)\n                    return $deg_freedom;\n                return new CalcError(err);\n            }\n            xargs.push($deg_freedom);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), chisq_right_inv);\n\ndefineBuiltinFunction('CHISQ.TEST', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $actual_range = args[i++];\n            if ($actual_range instanceof CalcError)\n                return $actual_range;\n            if (!((m = this.asMatrix($actual_range)) ? $actual_range = m : false)) {\n                if ($actual_range instanceof CalcError)\n                    return $actual_range;\n                return new CalcError(err);\n            }\n            xargs.push($actual_range);\n        }\n        {\n            var $expected_range = args[i++];\n            if ($expected_range instanceof CalcError)\n                return $expected_range;\n            if (!((m = this.asMatrix($expected_range)) ? $expected_range = m : false)) {\n                if ($expected_range instanceof CalcError)\n                    return $expected_range;\n                return new CalcError(err);\n            }\n            xargs.push($expected_range);\n        }\n        {\n            if (!($actual_range.width == $expected_range.width ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        {\n            if (!($actual_range.height == $expected_range.height ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), function (ac, ex) {\n    return chisq_test(ac.data, ex.data);\n});\n\ndefineBuiltinFunction('EXPON.DIST', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x >= 0 ? true : (err = 'NUM', false)))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        {\n            var $lambda = args[i++];\n            if ($lambda instanceof CalcError)\n                return $lambda;\n            if (!(((typeof ($lambda = this.force($lambda)) == 'number' ? ($lambda = limitPrecision($lambda), true) : false) || (typeof $lambda == 'boolean' ? ($lambda = +$lambda, true) : false) || (typeof $lambda == 'string' && !/^(?:=|true|false)/i.test($lambda) ? (tmp = calc.parse(0, 0, 0, $lambda), /^date|number|percent$/.test(tmp.type) ? ($lambda = +tmp.value, true) : false) : false)) && ($lambda > 0 ? true : (err = 'NUM', false)))) {\n                if ($lambda instanceof CalcError)\n                    return $lambda;\n                return new CalcError(err);\n            }\n            xargs.push($lambda);\n        }\n        {\n            var $cumulative = args[i++];\n            if ($cumulative instanceof CalcError)\n                return $cumulative;\n            if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                if ($cumulative instanceof CalcError)\n                    return $cumulative;\n                return new CalcError(err);\n            }\n            xargs.push($cumulative);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), expon);\n\ndefineBuiltinFunction('POISSON.DIST', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!((typeof ($x = this.force($x)) == 'number' || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && (($x |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        {\n            var $mean = args[i++];\n            if ($mean instanceof CalcError)\n                return $mean;\n            if (!(((typeof ($mean = this.force($mean)) == 'number' ? ($mean = limitPrecision($mean), true) : false) || (typeof $mean == 'boolean' ? ($mean = +$mean, true) : false) || (typeof $mean == 'string' && !/^(?:=|true|false)/i.test($mean) ? (tmp = calc.parse(0, 0, 0, $mean), /^date|number|percent$/.test(tmp.type) ? ($mean = +tmp.value, true) : false) : false)) && ($mean >= 0 ? true : (err = 'NUM', false)))) {\n                if ($mean instanceof CalcError)\n                    return $mean;\n                return new CalcError(err);\n            }\n            xargs.push($mean);\n        }\n        {\n            var $cumulative = args[i++];\n            if ($cumulative instanceof CalcError)\n                return $cumulative;\n            if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                if ($cumulative instanceof CalcError)\n                    return $cumulative;\n                return new CalcError(err);\n            }\n            xargs.push($cumulative);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), poisson);\n\ndefineBuiltinFunction('F.DIST', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x >= 0 ? true : (err = 'NUM', false)))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        {\n            var $deg_freedom1 = args[i++];\n            if ($deg_freedom1 instanceof CalcError)\n                return $deg_freedom1;\n            if (!((typeof ($deg_freedom1 = this.force($deg_freedom1)) == 'number' || (typeof $deg_freedom1 == 'boolean' ? ($deg_freedom1 = +$deg_freedom1, true) : false) || (typeof $deg_freedom1 == 'string' && !/^(?:=|true|false)/i.test($deg_freedom1) ? (tmp = calc.parse(0, 0, 0, $deg_freedom1), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom1 = +tmp.value, true) : false) : false)) && (($deg_freedom1 |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($deg_freedom1 instanceof CalcError)\n                    return $deg_freedom1;\n                return new CalcError(err);\n            }\n            xargs.push($deg_freedom1);\n        }\n        {\n            var $deg_freedom2 = args[i++];\n            if ($deg_freedom2 instanceof CalcError)\n                return $deg_freedom2;\n            if (!((typeof ($deg_freedom2 = this.force($deg_freedom2)) == 'number' || (typeof $deg_freedom2 == 'boolean' ? ($deg_freedom2 = +$deg_freedom2, true) : false) || (typeof $deg_freedom2 == 'string' && !/^(?:=|true|false)/i.test($deg_freedom2) ? (tmp = calc.parse(0, 0, 0, $deg_freedom2), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom2 = +tmp.value, true) : false) : false)) && (($deg_freedom2 |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($deg_freedom2 instanceof CalcError)\n                    return $deg_freedom2;\n                return new CalcError(err);\n            }\n            xargs.push($deg_freedom2);\n        }\n        {\n            var $cumulative = args[i++];\n            if ($cumulative instanceof CalcError)\n                return $cumulative;\n            if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                if ($cumulative instanceof CalcError)\n                    return $cumulative;\n                return new CalcError(err);\n            }\n            xargs.push($cumulative);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), Fdist);\n\ndefineBuiltinFunction('F.DIST.RT', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x >= 0 ? true : (err = 'NUM', false)))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        {\n            var $deg_freedom1 = args[i++];\n            if ($deg_freedom1 instanceof CalcError)\n                return $deg_freedom1;\n            if (!((typeof ($deg_freedom1 = this.force($deg_freedom1)) == 'number' || (typeof $deg_freedom1 == 'boolean' ? ($deg_freedom1 = +$deg_freedom1, true) : false) || (typeof $deg_freedom1 == 'string' && !/^(?:=|true|false)/i.test($deg_freedom1) ? (tmp = calc.parse(0, 0, 0, $deg_freedom1), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom1 = +tmp.value, true) : false) : false)) && (($deg_freedom1 |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($deg_freedom1 instanceof CalcError)\n                    return $deg_freedom1;\n                return new CalcError(err);\n            }\n            xargs.push($deg_freedom1);\n        }\n        {\n            var $deg_freedom2 = args[i++];\n            if ($deg_freedom2 instanceof CalcError)\n                return $deg_freedom2;\n            if (!((typeof ($deg_freedom2 = this.force($deg_freedom2)) == 'number' || (typeof $deg_freedom2 == 'boolean' ? ($deg_freedom2 = +$deg_freedom2, true) : false) || (typeof $deg_freedom2 == 'string' && !/^(?:=|true|false)/i.test($deg_freedom2) ? (tmp = calc.parse(0, 0, 0, $deg_freedom2), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom2 = +tmp.value, true) : false) : false)) && (($deg_freedom2 |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($deg_freedom2 instanceof CalcError)\n                    return $deg_freedom2;\n                return new CalcError(err);\n            }\n            xargs.push($deg_freedom2);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), Fdist_right);\n\ndefineBuiltinFunction('F.INV', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $p = args[i++];\n            if ($p instanceof CalcError)\n                return $p;\n            if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p >= 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                if ($p instanceof CalcError)\n                    return $p;\n                return new CalcError(err);\n            }\n            xargs.push($p);\n        }\n        {\n            var $deg_freedom1 = args[i++];\n            if ($deg_freedom1 instanceof CalcError)\n                return $deg_freedom1;\n            if (!((typeof ($deg_freedom1 = this.force($deg_freedom1)) == 'number' || (typeof $deg_freedom1 == 'boolean' ? ($deg_freedom1 = +$deg_freedom1, true) : false) || (typeof $deg_freedom1 == 'string' && !/^(?:=|true|false)/i.test($deg_freedom1) ? (tmp = calc.parse(0, 0, 0, $deg_freedom1), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom1 = +tmp.value, true) : false) : false)) && (($deg_freedom1 |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($deg_freedom1 instanceof CalcError)\n                    return $deg_freedom1;\n                return new CalcError(err);\n            }\n            xargs.push($deg_freedom1);\n        }\n        {\n            var $deg_freedom2 = args[i++];\n            if ($deg_freedom2 instanceof CalcError)\n                return $deg_freedom2;\n            if (!((typeof ($deg_freedom2 = this.force($deg_freedom2)) == 'number' || (typeof $deg_freedom2 == 'boolean' ? ($deg_freedom2 = +$deg_freedom2, true) : false) || (typeof $deg_freedom2 == 'string' && !/^(?:=|true|false)/i.test($deg_freedom2) ? (tmp = calc.parse(0, 0, 0, $deg_freedom2), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom2 = +tmp.value, true) : false) : false)) && (($deg_freedom2 |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($deg_freedom2 instanceof CalcError)\n                    return $deg_freedom2;\n                return new CalcError(err);\n            }\n            xargs.push($deg_freedom2);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), Finv);\n\ndefineBuiltinFunction('F.INV.RT', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $p = args[i++];\n            if ($p instanceof CalcError)\n                return $p;\n            if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p >= 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                if ($p instanceof CalcError)\n                    return $p;\n                return new CalcError(err);\n            }\n            xargs.push($p);\n        }\n        {\n            var $deg_freedom1 = args[i++];\n            if ($deg_freedom1 instanceof CalcError)\n                return $deg_freedom1;\n            if (!((typeof ($deg_freedom1 = this.force($deg_freedom1)) == 'number' || (typeof $deg_freedom1 == 'boolean' ? ($deg_freedom1 = +$deg_freedom1, true) : false) || (typeof $deg_freedom1 == 'string' && !/^(?:=|true|false)/i.test($deg_freedom1) ? (tmp = calc.parse(0, 0, 0, $deg_freedom1), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom1 = +tmp.value, true) : false) : false)) && (($deg_freedom1 |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($deg_freedom1 instanceof CalcError)\n                    return $deg_freedom1;\n                return new CalcError(err);\n            }\n            xargs.push($deg_freedom1);\n        }\n        {\n            var $deg_freedom2 = args[i++];\n            if ($deg_freedom2 instanceof CalcError)\n                return $deg_freedom2;\n            if (!((typeof ($deg_freedom2 = this.force($deg_freedom2)) == 'number' || (typeof $deg_freedom2 == 'boolean' ? ($deg_freedom2 = +$deg_freedom2, true) : false) || (typeof $deg_freedom2 == 'string' && !/^(?:=|true|false)/i.test($deg_freedom2) ? (tmp = calc.parse(0, 0, 0, $deg_freedom2), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom2 = +tmp.value, true) : false) : false)) && (($deg_freedom2 |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($deg_freedom2 instanceof CalcError)\n                    return $deg_freedom2;\n                return new CalcError(err);\n            }\n            xargs.push($deg_freedom2);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), Finv_right);\n\ndefineBuiltinFunction('F.TEST', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $array1 = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $array1) {\n                    if ($array1 instanceof CalcError)\n                        throw $array1;\n                    if ((typeof $array1 == 'number' ? ($array1 = limitPrecision($array1), true) : false) || (typeof $array1 == 'boolean' ? ($array1 = +$array1, true) : false) || (typeof $array1 == 'string' && !/^(?:=|true|false)/i.test($array1) ? (tmp = calc.parse(0, 0, 0, $array1), /^date|number|percent$/.test(tmp.type) ? ($array1 = +tmp.value, true) : false) : false))\n                        ret.push($array1);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($array1);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            try {\n                var $array2 = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $array2) {\n                    if ($array2 instanceof CalcError)\n                        throw $array2;\n                    if ((typeof $array2 == 'number' ? ($array2 = limitPrecision($array2), true) : false) || (typeof $array2 == 'boolean' ? ($array2 = +$array2, true) : false) || (typeof $array2 == 'string' && !/^(?:=|true|false)/i.test($array2) ? (tmp = calc.parse(0, 0, 0, $array2), /^date|number|percent$/.test(tmp.type) ? ($array2 = +tmp.value, true) : false) : false))\n                        ret.push($array2);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($array2);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            if (!($array1.length >= 2 ? true : (err = 'DIV/0', false)))\n                return new CalcError(err);\n        }\n        {\n            if (!($array2.length >= 2 ? true : (err = 'DIV/0', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), Ftest);\n\ndefineBuiltinFunction('FISHER', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x > -1 && $x < 1 ? true : (err = 'NUM', false)))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), fisher);\n\ndefineBuiltinFunction('FISHERINV', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $y = args[i++];\n            if ($y instanceof CalcError)\n                return $y;\n            if (!((typeof ($y = this.force($y)) == 'number' ? ($y = limitPrecision($y), true) : false) || (typeof $y == 'boolean' ? ($y = +$y, true) : false) || (typeof $y == 'string' && !/^(?:=|true|false)/i.test($y) ? (tmp = calc.parse(0, 0, 0, $y), /^date|number|percent$/.test(tmp.type) ? ($y = +tmp.value, true) : false) : false))) {\n                if ($y instanceof CalcError)\n                    return $y;\n                return new CalcError(err);\n            }\n            xargs.push($y);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), fisherinv);\n\ndefineBuiltinFunction('T.DIST', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        {\n            var $deg_freedom = args[i++];\n            if ($deg_freedom instanceof CalcError)\n                return $deg_freedom;\n            if (!((typeof ($deg_freedom = this.force($deg_freedom)) == 'number' || (typeof $deg_freedom == 'boolean' ? ($deg_freedom = +$deg_freedom, true) : false) || (typeof $deg_freedom == 'string' && !/^(?:=|true|false)/i.test($deg_freedom) ? (tmp = calc.parse(0, 0, 0, $deg_freedom), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom = +tmp.value, true) : false) : false)) && (($deg_freedom |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($deg_freedom instanceof CalcError)\n                    return $deg_freedom;\n                return new CalcError(err);\n            }\n            xargs.push($deg_freedom);\n        }\n        {\n            var $cumulative = args[i++];\n            if ($cumulative instanceof CalcError)\n                return $cumulative;\n            if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                if ($cumulative instanceof CalcError)\n                    return $cumulative;\n                return new CalcError(err);\n            }\n            xargs.push($cumulative);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), Tdist);\n\ndefineBuiltinFunction('T.DIST.RT', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        {\n            var $deg_freedom = args[i++];\n            if ($deg_freedom instanceof CalcError)\n                return $deg_freedom;\n            if (!((typeof ($deg_freedom = this.force($deg_freedom)) == 'number' || (typeof $deg_freedom == 'boolean' ? ($deg_freedom = +$deg_freedom, true) : false) || (typeof $deg_freedom == 'string' && !/^(?:=|true|false)/i.test($deg_freedom) ? (tmp = calc.parse(0, 0, 0, $deg_freedom), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom = +tmp.value, true) : false) : false)) && (($deg_freedom |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($deg_freedom instanceof CalcError)\n                    return $deg_freedom;\n                return new CalcError(err);\n            }\n            xargs.push($deg_freedom);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), Tdist_right);\n\ndefineBuiltinFunction('T.DIST.2T', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x >= 0 ? true : (err = 'NUM', false)))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        {\n            var $deg_freedom = args[i++];\n            if ($deg_freedom instanceof CalcError)\n                return $deg_freedom;\n            if (!((typeof ($deg_freedom = this.force($deg_freedom)) == 'number' || (typeof $deg_freedom == 'boolean' ? ($deg_freedom = +$deg_freedom, true) : false) || (typeof $deg_freedom == 'string' && !/^(?:=|true|false)/i.test($deg_freedom) ? (tmp = calc.parse(0, 0, 0, $deg_freedom), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom = +tmp.value, true) : false) : false)) && (($deg_freedom |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($deg_freedom instanceof CalcError)\n                    return $deg_freedom;\n                return new CalcError(err);\n            }\n            xargs.push($deg_freedom);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), Tdist_2tail);\n\ndefineBuiltinFunction('T.INV', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $p = args[i++];\n            if ($p instanceof CalcError)\n                return $p;\n            if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p > 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                if ($p instanceof CalcError)\n                    return $p;\n                return new CalcError(err);\n            }\n            xargs.push($p);\n        }\n        {\n            var $deg_freedom = args[i++];\n            if ($deg_freedom instanceof CalcError)\n                return $deg_freedom;\n            if (!((typeof ($deg_freedom = this.force($deg_freedom)) == 'number' || (typeof $deg_freedom == 'boolean' ? ($deg_freedom = +$deg_freedom, true) : false) || (typeof $deg_freedom == 'string' && !/^(?:=|true|false)/i.test($deg_freedom) ? (tmp = calc.parse(0, 0, 0, $deg_freedom), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom = +tmp.value, true) : false) : false)) && (($deg_freedom |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($deg_freedom instanceof CalcError)\n                    return $deg_freedom;\n                return new CalcError(err);\n            }\n            xargs.push($deg_freedom);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), Tdist_inv);\n\ndefineBuiltinFunction('T.INV.2T', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $p = args[i++];\n            if ($p instanceof CalcError)\n                return $p;\n            if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p > 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                if ($p instanceof CalcError)\n                    return $p;\n                return new CalcError(err);\n            }\n            xargs.push($p);\n        }\n        {\n            var $deg_freedom = args[i++];\n            if ($deg_freedom instanceof CalcError)\n                return $deg_freedom;\n            if (!((typeof ($deg_freedom = this.force($deg_freedom)) == 'number' || (typeof $deg_freedom == 'boolean' ? ($deg_freedom = +$deg_freedom, true) : false) || (typeof $deg_freedom == 'string' && !/^(?:=|true|false)/i.test($deg_freedom) ? (tmp = calc.parse(0, 0, 0, $deg_freedom), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom = +tmp.value, true) : false) : false)) && (($deg_freedom |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($deg_freedom instanceof CalcError)\n                    return $deg_freedom;\n                return new CalcError(err);\n            }\n            xargs.push($deg_freedom);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), Tdist_2tail_inv);\n\ndefineBuiltinFunction('T.TEST', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $array1 = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $array1) {\n                    if ($array1 instanceof CalcError)\n                        throw $array1;\n                    if ((typeof $array1 == 'number' ? ($array1 = limitPrecision($array1), true) : false) || (typeof $array1 == 'boolean' ? ($array1 = +$array1, true) : false) || (typeof $array1 == 'string' && !/^(?:=|true|false)/i.test($array1) ? (tmp = calc.parse(0, 0, 0, $array1), /^date|number|percent$/.test(tmp.type) ? ($array1 = +tmp.value, true) : false) : false))\n                        ret.push($array1);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($array1);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            try {\n                var $array2 = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $array2) {\n                    if ($array2 instanceof CalcError)\n                        throw $array2;\n                    if ((typeof $array2 == 'number' ? ($array2 = limitPrecision($array2), true) : false) || (typeof $array2 == 'boolean' ? ($array2 = +$array2, true) : false) || (typeof $array2 == 'string' && !/^(?:=|true|false)/i.test($array2) ? (tmp = calc.parse(0, 0, 0, $array2), /^date|number|percent$/.test(tmp.type) ? ($array2 = +tmp.value, true) : false) : false))\n                        ret.push($array2);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($array2);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            var $tails = args[i++];\n            if ($tails instanceof CalcError)\n                return $tails;\n            if (!((typeof ($tails = this.force($tails)) == 'number' || (typeof $tails == 'boolean' ? ($tails = +$tails, true) : false) || (typeof $tails == 'string' && !/^(?:=|true|false)/i.test($tails) ? (tmp = calc.parse(0, 0, 0, $tails), /^date|number|percent$/.test(tmp.type) ? ($tails = +tmp.value, true) : false) : false)) && ($tails |= 0, true) && ($tails === 1 || $tails === 2))) {\n                if ($tails instanceof CalcError)\n                    return $tails;\n                return new CalcError(err);\n            }\n            xargs.push($tails);\n        }\n        {\n            var $type = args[i++];\n            if ($type instanceof CalcError)\n                return $type;\n            if (!((typeof ($type = this.force($type)) == 'number' || (typeof $type == 'boolean' ? ($type = +$type, true) : false) || (typeof $type == 'string' && !/^(?:=|true|false)/i.test($type) ? (tmp = calc.parse(0, 0, 0, $type), /^date|number|percent$/.test(tmp.type) ? ($type = +tmp.value, true) : false) : false)) && ($type |= 0, true) && ($type === 1 || $type === 2 || $type === 3))) {\n                if ($type instanceof CalcError)\n                    return $type;\n                return new CalcError(err);\n            }\n            xargs.push($type);\n        }\n        {\n            if (!($type != 1 || $array1.length == $array2.length ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        {\n            if (!($array1.length >= 2 ? true : (err = 'DIV/0', false)))\n                return new CalcError(err);\n        }\n        {\n            if (!($array2.length >= 2 ? true : (err = 'DIV/0', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args.slice(i));\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), Tdist_test);\n\ndefineBuiltinFunction('CONFIDENCE.T', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $alpha = args[i++];\n            if ($alpha instanceof CalcError)\n                return $alpha;\n            if (!(((typeof ($alpha = this.force($alpha)) == 'number' ? ($alpha = limitPrecision($alpha), true) : false) || (typeof $alpha == 'boolean' ? ($alpha = +$alpha, true) : false) || (typeof $alpha == 'string' && !/^(?:=|true|false)/i.test($alpha) ? (tmp = calc.parse(0, 0, 0, $alpha), /^date|number|percent$/.test(tmp.type) ? ($alpha = +tmp.value, true) : false) : false)) && ($alpha > 0 && $alpha < 1 ? true : (err = 'NUM', false)))) {\n                if ($alpha instanceof CalcError)\n                    return $alpha;\n                return new CalcError(err);\n            }\n            xargs.push($alpha);\n        }\n        {\n            var $standard_dev = args[i++];\n            if ($standard_dev instanceof CalcError)\n                return $standard_dev;\n            if (!(((typeof ($standard_dev = this.force($standard_dev)) == 'number' ? ($standard_dev = limitPrecision($standard_dev), true) : false) || (typeof $standard_dev == 'boolean' ? ($standard_dev = +$standard_dev, true) : false) || (typeof $standard_dev == 'string' && !/^(?:=|true|false)/i.test($standard_dev) ? (tmp = calc.parse(0, 0, 0, $standard_dev), /^date|number|percent$/.test(tmp.type) ? ($standard_dev = +tmp.value, true) : false) : false)) && ($standard_dev > 0 ? true : (err = 'NUM', false)))) {\n                if ($standard_dev instanceof CalcError)\n                    return $standard_dev;\n                return new CalcError(err);\n            }\n            xargs.push($standard_dev);\n        }\n        {\n            var $size = args[i++];\n            if ($size instanceof CalcError)\n                return $size;\n            if (!((typeof ($size = this.force($size)) == 'number' || (typeof $size == 'boolean' ? ($size = +$size, true) : false) || (typeof $size == 'string' && !/^(?:=|true|false)/i.test($size) ? (tmp = calc.parse(0, 0, 0, $size), /^date|number|percent$/.test(tmp.type) ? ($size = +tmp.value, true) : false) : false)) && (($size |= 0) > 0 ? true : (err = 'NUM', false)) && ($size != 1 ? true : (err = 'DIV/0', false)))) {\n                if ($size instanceof CalcError)\n                    return $size;\n                return new CalcError(err);\n            }\n            xargs.push($size);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), confidence_t);\n\ndefineBuiltinFunction('CONFIDENCE.NORM', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $alpha = args[i++];\n            if ($alpha instanceof CalcError)\n                return $alpha;\n            if (!(((typeof ($alpha = this.force($alpha)) == 'number' ? ($alpha = limitPrecision($alpha), true) : false) || (typeof $alpha == 'boolean' ? ($alpha = +$alpha, true) : false) || (typeof $alpha == 'string' && !/^(?:=|true|false)/i.test($alpha) ? (tmp = calc.parse(0, 0, 0, $alpha), /^date|number|percent$/.test(tmp.type) ? ($alpha = +tmp.value, true) : false) : false)) && ($alpha > 0 && $alpha < 1 ? true : (err = 'NUM', false)))) {\n                if ($alpha instanceof CalcError)\n                    return $alpha;\n                return new CalcError(err);\n            }\n            xargs.push($alpha);\n        }\n        {\n            var $standard_dev = args[i++];\n            if ($standard_dev instanceof CalcError)\n                return $standard_dev;\n            if (!(((typeof ($standard_dev = this.force($standard_dev)) == 'number' ? ($standard_dev = limitPrecision($standard_dev), true) : false) || (typeof $standard_dev == 'boolean' ? ($standard_dev = +$standard_dev, true) : false) || (typeof $standard_dev == 'string' && !/^(?:=|true|false)/i.test($standard_dev) ? (tmp = calc.parse(0, 0, 0, $standard_dev), /^date|number|percent$/.test(tmp.type) ? ($standard_dev = +tmp.value, true) : false) : false)) && ($standard_dev > 0 ? true : (err = 'NUM', false)))) {\n                if ($standard_dev instanceof CalcError)\n                    return $standard_dev;\n                return new CalcError(err);\n            }\n            xargs.push($standard_dev);\n        }\n        {\n            var $size = args[i++];\n            if ($size instanceof CalcError)\n                return $size;\n            if (!((typeof ($size = this.force($size)) == 'number' || (typeof $size == 'boolean' ? ($size = +$size, true) : false) || (typeof $size == 'string' && !/^(?:=|true|false)/i.test($size) ? (tmp = calc.parse(0, 0, 0, $size), /^date|number|percent$/.test(tmp.type) ? ($size = +tmp.value, true) : false) : false)) && (($size |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($size instanceof CalcError)\n                    return $size;\n                return new CalcError(err);\n            }\n            xargs.push($size);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), confidence_norm);\n\ndefineBuiltinFunction('GAUSS', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $z = args[i++];\n            if ($z instanceof CalcError)\n                return $z;\n            if (!((typeof ($z = this.force($z)) == 'number' ? ($z = limitPrecision($z), true) : false) || (typeof $z == 'boolean' ? ($z = +$z, true) : false) || (typeof $z == 'string' && !/^(?:=|true|false)/i.test($z) ? (tmp = calc.parse(0, 0, 0, $z), /^date|number|percent$/.test(tmp.type) ? ($z = +tmp.value, true) : false) : false))) {\n                if ($z instanceof CalcError)\n                    return $z;\n                return new CalcError(err);\n            }\n            xargs.push($z);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), gauss);\n\ndefineBuiltinFunction('PHI', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), phi);\n\ndefineBuiltinFunction('LOGNORM.DIST', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x > 0 ? true : (err = 'NUM', false)))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        {\n            var $mean = args[i++];\n            if ($mean instanceof CalcError)\n                return $mean;\n            if (!((typeof ($mean = this.force($mean)) == 'number' ? ($mean = limitPrecision($mean), true) : false) || (typeof $mean == 'boolean' ? ($mean = +$mean, true) : false) || (typeof $mean == 'string' && !/^(?:=|true|false)/i.test($mean) ? (tmp = calc.parse(0, 0, 0, $mean), /^date|number|percent$/.test(tmp.type) ? ($mean = +tmp.value, true) : false) : false))) {\n                if ($mean instanceof CalcError)\n                    return $mean;\n                return new CalcError(err);\n            }\n            xargs.push($mean);\n        }\n        {\n            var $standard_dev = args[i++];\n            if ($standard_dev instanceof CalcError)\n                return $standard_dev;\n            if (!(((typeof ($standard_dev = this.force($standard_dev)) == 'number' ? ($standard_dev = limitPrecision($standard_dev), true) : false) || (typeof $standard_dev == 'boolean' ? ($standard_dev = +$standard_dev, true) : false) || (typeof $standard_dev == 'string' && !/^(?:=|true|false)/i.test($standard_dev) ? (tmp = calc.parse(0, 0, 0, $standard_dev), /^date|number|percent$/.test(tmp.type) ? ($standard_dev = +tmp.value, true) : false) : false)) && ($standard_dev > 0 ? true : (err = 'NUM', false)))) {\n                if ($standard_dev instanceof CalcError)\n                    return $standard_dev;\n                return new CalcError(err);\n            }\n            xargs.push($standard_dev);\n        }\n        {\n            var $cumulative = args[i++];\n            if ($cumulative instanceof CalcError)\n                return $cumulative;\n            if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                if ($cumulative instanceof CalcError)\n                    return $cumulative;\n                return new CalcError(err);\n            }\n            xargs.push($cumulative);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), lognorm_dist);\n\ndefineBuiltinFunction('LOGNORM.INV', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $probability = args[i++];\n            if ($probability instanceof CalcError)\n                return $probability;\n            if (!(((typeof ($probability = this.force($probability)) == 'number' ? ($probability = limitPrecision($probability), true) : false) || (typeof $probability == 'boolean' ? ($probability = +$probability, true) : false) || (typeof $probability == 'string' && !/^(?:=|true|false)/i.test($probability) ? (tmp = calc.parse(0, 0, 0, $probability), /^date|number|percent$/.test(tmp.type) ? ($probability = +tmp.value, true) : false) : false)) && ($probability > 0 && $probability < 1 ? true : (err = 'NUM', false)))) {\n                if ($probability instanceof CalcError)\n                    return $probability;\n                return new CalcError(err);\n            }\n            xargs.push($probability);\n        }\n        {\n            var $mean = args[i++];\n            if ($mean instanceof CalcError)\n                return $mean;\n            if (!((typeof ($mean = this.force($mean)) == 'number' ? ($mean = limitPrecision($mean), true) : false) || (typeof $mean == 'boolean' ? ($mean = +$mean, true) : false) || (typeof $mean == 'string' && !/^(?:=|true|false)/i.test($mean) ? (tmp = calc.parse(0, 0, 0, $mean), /^date|number|percent$/.test(tmp.type) ? ($mean = +tmp.value, true) : false) : false))) {\n                if ($mean instanceof CalcError)\n                    return $mean;\n                return new CalcError(err);\n            }\n            xargs.push($mean);\n        }\n        {\n            var $standard_dev = args[i++];\n            if ($standard_dev instanceof CalcError)\n                return $standard_dev;\n            if (!(((typeof ($standard_dev = this.force($standard_dev)) == 'number' ? ($standard_dev = limitPrecision($standard_dev), true) : false) || (typeof $standard_dev == 'boolean' ? ($standard_dev = +$standard_dev, true) : false) || (typeof $standard_dev == 'string' && !/^(?:=|true|false)/i.test($standard_dev) ? (tmp = calc.parse(0, 0, 0, $standard_dev), /^date|number|percent$/.test(tmp.type) ? ($standard_dev = +tmp.value, true) : false) : false)) && ($standard_dev > 0 ? true : (err = 'NUM', false)))) {\n                if ($standard_dev instanceof CalcError)\n                    return $standard_dev;\n                return new CalcError(err);\n            }\n            xargs.push($standard_dev);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), lognorm_inv);\n\ndefineBuiltinFunction('PROB', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $x_range = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $x_range) {\n                    if ($x_range instanceof CalcError)\n                        throw $x_range;\n                    if ((typeof $x_range == 'number' ? ($x_range = limitPrecision($x_range), true) : false) || (typeof $x_range == 'boolean' ? ($x_range = +$x_range, true) : false) || (typeof $x_range == 'string' && !/^(?:=|true|false)/i.test($x_range) ? (tmp = calc.parse(0, 0, 0, $x_range), /^date|number|percent$/.test(tmp.type) ? ($x_range = +tmp.value, true) : false) : false))\n                        ret.push($x_range);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($x_range);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            try {\n                var $prob_range = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $prob_range) {\n                    if ($prob_range instanceof CalcError)\n                        throw $prob_range;\n                    if ((typeof $prob_range == 'number' ? ($prob_range = limitPrecision($prob_range), true) : false) || (typeof $prob_range == 'boolean' ? ($prob_range = +$prob_range, true) : false) || (typeof $prob_range == 'string' && !/^(?:=|true|false)/i.test($prob_range) ? (tmp = calc.parse(0, 0, 0, $prob_range), /^date|number|percent$/.test(tmp.type) ? ($prob_range = +tmp.value, true) : false) : false))\n                        ret.push($prob_range);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($prob_range);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            var $lower_limit = args[i++];\n            if ($lower_limit instanceof CalcError)\n                return $lower_limit;\n            if (!((typeof ($lower_limit = this.force($lower_limit)) == 'number' ? ($lower_limit = limitPrecision($lower_limit), true) : false) || (typeof $lower_limit == 'boolean' ? ($lower_limit = +$lower_limit, true) : false) || (typeof $lower_limit == 'string' && !/^(?:=|true|false)/i.test($lower_limit) ? (tmp = calc.parse(0, 0, 0, $lower_limit), /^date|number|percent$/.test(tmp.type) ? ($lower_limit = +tmp.value, true) : false) : false))) {\n                if ($lower_limit instanceof CalcError)\n                    return $lower_limit;\n                return new CalcError(err);\n            }\n            xargs.push($lower_limit);\n        }\n        {\n            var $upper_limit = args[i++];\n            if ($upper_limit instanceof CalcError)\n                return $upper_limit;\n            if (!((typeof ($upper_limit = this.force($upper_limit)) == 'number' ? ($upper_limit = limitPrecision($upper_limit), true) : false) || (typeof $upper_limit == 'boolean' ? ($upper_limit = +$upper_limit, true) : false) || (typeof $upper_limit == 'string' && !/^(?:=|true|false)/i.test($upper_limit) ? (tmp = calc.parse(0, 0, 0, $upper_limit), /^date|number|percent$/.test(tmp.type) ? ($upper_limit = +tmp.value, true) : false) : false) || ($upper_limit == null ? ($upper_limit = $lower_limit, true) : false))) {\n                if ($upper_limit instanceof CalcError)\n                    return $upper_limit;\n                return new CalcError(err);\n            }\n            xargs.push($upper_limit);\n        }\n        {\n            if (!($prob_range.length == $x_range.length ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args.slice(i));\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), prob);\n\ndefineBuiltinFunction('SLOPE', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $known_y = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $known_y) {\n                    if ($known_y instanceof CalcError)\n                        throw $known_y;\n                    if ((typeof $known_y == 'number' ? ($known_y = limitPrecision($known_y), true) : false) || (typeof $known_y == 'boolean' ? ($known_y = +$known_y, true) : false) || (typeof $known_y == 'string' && !/^(?:=|true|false)/i.test($known_y) ? (tmp = calc.parse(0, 0, 0, $known_y), /^date|number|percent$/.test(tmp.type) ? ($known_y = +tmp.value, true) : false) : false))\n                        ret.push($known_y);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($known_y);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            try {\n                var $known_x = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $known_x) {\n                    if ($known_x instanceof CalcError)\n                        throw $known_x;\n                    if ((typeof $known_x == 'number' ? ($known_x = limitPrecision($known_x), true) : false) || (typeof $known_x == 'boolean' ? ($known_x = +$known_x, true) : false) || (typeof $known_x == 'string' && !/^(?:=|true|false)/i.test($known_x) ? (tmp = calc.parse(0, 0, 0, $known_x), /^date|number|percent$/.test(tmp.type) ? ($known_x = +tmp.value, true) : false) : false))\n                        ret.push($known_x);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($known_x);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            if (!($known_x.length == $known_y.length ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        {\n            if (!($known_x.length > 0 && $known_y.length > 0 ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), slope);\n\ndefineBuiltinFunction('INTERCEPT', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $known_y = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $known_y) {\n                    if ($known_y instanceof CalcError)\n                        throw $known_y;\n                    if ((typeof $known_y == 'number' ? ($known_y = limitPrecision($known_y), true) : false) || (typeof $known_y == 'boolean' ? ($known_y = +$known_y, true) : false) || (typeof $known_y == 'string' && !/^(?:=|true|false)/i.test($known_y) ? (tmp = calc.parse(0, 0, 0, $known_y), /^date|number|percent$/.test(tmp.type) ? ($known_y = +tmp.value, true) : false) : false))\n                        ret.push($known_y);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($known_y);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            try {\n                var $known_x = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $known_x) {\n                    if ($known_x instanceof CalcError)\n                        throw $known_x;\n                    if ((typeof $known_x == 'number' ? ($known_x = limitPrecision($known_x), true) : false) || (typeof $known_x == 'boolean' ? ($known_x = +$known_x, true) : false) || (typeof $known_x == 'string' && !/^(?:=|true|false)/i.test($known_x) ? (tmp = calc.parse(0, 0, 0, $known_x), /^date|number|percent$/.test(tmp.type) ? ($known_x = +tmp.value, true) : false) : false))\n                        ret.push($known_x);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($known_x);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            if (!($known_x.length == $known_y.length ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        {\n            if (!($known_x.length > 0 && $known_y.length > 0 ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), intercept);\n\ndefineBuiltinFunction('PEARSON', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $array1 = this.cellValues(args.slice(i, i + 1), true).reduce(function (ret, $array1) {\n                    if ($array1 instanceof CalcError)\n                        throw $array1;\n                    if (i <= args.length)\n                        ret.push($array1);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($array1);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            try {\n                var $array2 = this.cellValues(args.slice(i, i + 1), true).reduce(function (ret, $array2) {\n                    if ($array2 instanceof CalcError)\n                        throw $array2;\n                    if (i <= args.length)\n                        ret.push($array2);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($array2);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            if (!($array2.length == $array1.length ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        {\n            if (!($array2.length > 0 && $array1.length > 0 ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), pearson);\n\ndefineBuiltinFunction('RSQ', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $known_y = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $known_y) {\n                    if ($known_y instanceof CalcError)\n                        throw $known_y;\n                    if ((typeof $known_y == 'number' ? ($known_y = limitPrecision($known_y), true) : false) || (typeof $known_y == 'boolean' ? ($known_y = +$known_y, true) : false) || (typeof $known_y == 'string' && !/^(?:=|true|false)/i.test($known_y) ? (tmp = calc.parse(0, 0, 0, $known_y), /^date|number|percent$/.test(tmp.type) ? ($known_y = +tmp.value, true) : false) : false))\n                        ret.push($known_y);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($known_y);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            try {\n                var $known_x = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $known_x) {\n                    if ($known_x instanceof CalcError)\n                        throw $known_x;\n                    if ((typeof $known_x == 'number' ? ($known_x = limitPrecision($known_x), true) : false) || (typeof $known_x == 'boolean' ? ($known_x = +$known_x, true) : false) || (typeof $known_x == 'string' && !/^(?:=|true|false)/i.test($known_x) ? (tmp = calc.parse(0, 0, 0, $known_x), /^date|number|percent$/.test(tmp.type) ? ($known_x = +tmp.value, true) : false) : false))\n                        ret.push($known_x);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($known_x);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            if (!($known_x.length == $known_y.length ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        {\n            if (!($known_x.length > 0 && $known_y.length > 0 ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        {\n            if (!($known_x.length != 1 && $known_y.length != 1 ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), rsq);\n\ndefineBuiltinFunction('STEYX', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $known_y = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $known_y) {\n                    if ($known_y instanceof CalcError)\n                        throw $known_y;\n                    if ((typeof $known_y == 'number' ? ($known_y = limitPrecision($known_y), true) : false) || (typeof $known_y == 'boolean' ? ($known_y = +$known_y, true) : false) || (typeof $known_y == 'string' && !/^(?:=|true|false)/i.test($known_y) ? (tmp = calc.parse(0, 0, 0, $known_y), /^date|number|percent$/.test(tmp.type) ? ($known_y = +tmp.value, true) : false) : false))\n                        ret.push($known_y);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($known_y);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            try {\n                var $known_x = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $known_x) {\n                    if ($known_x instanceof CalcError)\n                        throw $known_x;\n                    if ((typeof $known_x == 'number' ? ($known_x = limitPrecision($known_x), true) : false) || (typeof $known_x == 'boolean' ? ($known_x = +$known_x, true) : false) || (typeof $known_x == 'string' && !/^(?:=|true|false)/i.test($known_x) ? (tmp = calc.parse(0, 0, 0, $known_x), /^date|number|percent$/.test(tmp.type) ? ($known_x = +tmp.value, true) : false) : false))\n                        ret.push($known_x);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($known_x);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            if (!($known_x.length == $known_y.length ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        {\n            if (!($known_x.length >= 3 && $known_y.length >= 3 ? true : (err = 'DIV/0', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), steyx);\n\ndefineBuiltinFunction('FORECAST', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $x = args[i++];\n            if ($x instanceof CalcError)\n                return $x;\n            if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                if ($x instanceof CalcError)\n                    return $x;\n                return new CalcError(err);\n            }\n            xargs.push($x);\n        }\n        {\n            try {\n                var $known_y = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $known_y) {\n                    if ($known_y instanceof CalcError)\n                        throw $known_y;\n                    if ((typeof $known_y == 'number' ? ($known_y = limitPrecision($known_y), true) : false) || (typeof $known_y == 'boolean' ? ($known_y = +$known_y, true) : false) || (typeof $known_y == 'string' && !/^(?:=|true|false)/i.test($known_y) ? (tmp = calc.parse(0, 0, 0, $known_y), /^date|number|percent$/.test(tmp.type) ? ($known_y = +tmp.value, true) : false) : false))\n                        ret.push($known_y);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($known_y);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            try {\n                var $known_x = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $known_x) {\n                    if ($known_x instanceof CalcError)\n                        throw $known_x;\n                    if ((typeof $known_x == 'number' ? ($known_x = limitPrecision($known_x), true) : false) || (typeof $known_x == 'boolean' ? ($known_x = +$known_x, true) : false) || (typeof $known_x == 'string' && !/^(?:=|true|false)/i.test($known_x) ? (tmp = calc.parse(0, 0, 0, $known_x), /^date|number|percent$/.test(tmp.type) ? ($known_x = +tmp.value, true) : false) : false))\n                        ret.push($known_x);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($known_x);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            if (!($known_x.length == $known_y.length ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        {\n            if (!($known_x.length > 0 && $known_y.length > 0 ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), forecast);\n\ndefineBuiltinFunction('LINEST', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $known_y = args[i++];\n            if ($known_y instanceof CalcError)\n                return $known_y;\n            if (!((m = this.asMatrix($known_y)) ? $known_y = m : false)) {\n                if ($known_y instanceof CalcError)\n                    return $known_y;\n                return new CalcError(err);\n            }\n            xargs.push($known_y);\n        }\n        {\n            var $known_x = args[i++];\n            if ($known_x instanceof CalcError)\n                return $known_x;\n            if (!(((m = this.asMatrix($known_x)) ? $known_x = m : false) || $known_x == null)) {\n                if ($known_x instanceof CalcError)\n                    return $known_x;\n                return new CalcError(err);\n            }\n            xargs.push($known_x);\n        }\n        {\n            var $const = args[i++];\n            if ($const instanceof CalcError)\n                return $const;\n            if (!(typeof ($const = this.force($const)) == 'boolean' || (typeof $const == 'number' ? ($const = !!$const, true) : false) || ($const == null ? ($const = true, true) : false))) {\n                if ($const instanceof CalcError)\n                    return $const;\n                return new CalcError(err);\n            }\n            xargs.push($const);\n        }\n        {\n            var $stats = args[i++];\n            if ($stats instanceof CalcError)\n                return $stats;\n            if (!(typeof ($stats = this.force($stats)) == 'boolean' || (typeof $stats == 'number' ? ($stats = !!$stats, true) : false) || ($stats == null ? ($stats = false, true) : false))) {\n                if ($stats instanceof CalcError)\n                    return $stats;\n                return new CalcError(err);\n            }\n            xargs.push($stats);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), linest);\n\ndefineBuiltinFunction('LOGEST', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $known_y = args[i++];\n            if ($known_y instanceof CalcError)\n                return $known_y;\n            if (!((m = this.asMatrix($known_y)) ? $known_y = m : false)) {\n                if ($known_y instanceof CalcError)\n                    return $known_y;\n                return new CalcError(err);\n            }\n            xargs.push($known_y);\n        }\n        {\n            var $known_x = args[i++];\n            if ($known_x instanceof CalcError)\n                return $known_x;\n            if (!(((m = this.asMatrix($known_x)) ? $known_x = m : false) || $known_x == null)) {\n                if ($known_x instanceof CalcError)\n                    return $known_x;\n                return new CalcError(err);\n            }\n            xargs.push($known_x);\n        }\n        {\n            var $const = args[i++];\n            if ($const instanceof CalcError)\n                return $const;\n            if (!(typeof ($const = this.force($const)) == 'boolean' || (typeof $const == 'number' ? ($const = !!$const, true) : false) || ($const == null ? ($const = true, true) : false))) {\n                if ($const instanceof CalcError)\n                    return $const;\n                return new CalcError(err);\n            }\n            xargs.push($const);\n        }\n        {\n            var $stats = args[i++];\n            if ($stats instanceof CalcError)\n                return $stats;\n            if (!(typeof ($stats = this.force($stats)) == 'boolean' || (typeof $stats == 'number' ? ($stats = !!$stats, true) : false) || ($stats == null ? ($stats = false, true) : false))) {\n                if ($stats instanceof CalcError)\n                    return $stats;\n                return new CalcError(err);\n            }\n            xargs.push($stats);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), logest);\n\ndefineBuiltinFunction('TREND', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $known_y = args[i++];\n            if ($known_y instanceof CalcError)\n                return $known_y;\n            if (!((m = this.asMatrix($known_y)) ? $known_y = m : false)) {\n                if ($known_y instanceof CalcError)\n                    return $known_y;\n                return new CalcError(err);\n            }\n            xargs.push($known_y);\n        }\n        {\n            var $known_x = args[i++];\n            if ($known_x instanceof CalcError)\n                return $known_x;\n            if (!(((m = this.asMatrix($known_x)) ? $known_x = m : false) || $known_x == null)) {\n                if ($known_x instanceof CalcError)\n                    return $known_x;\n                return new CalcError(err);\n            }\n            xargs.push($known_x);\n        }\n        {\n            var $new_x = args[i++];\n            if ($new_x instanceof CalcError)\n                return $new_x;\n            if (!(((m = this.asMatrix($new_x)) ? $new_x = m : false) || $new_x == null)) {\n                if ($new_x instanceof CalcError)\n                    return $new_x;\n                return new CalcError(err);\n            }\n            xargs.push($new_x);\n        }\n        {\n            var $const = args[i++];\n            if ($const instanceof CalcError)\n                return $const;\n            if (!(typeof ($const = this.force($const)) == 'boolean' || (typeof $const == 'number' ? ($const = !!$const, true) : false) || ($const == null ? ($const = true, true) : false))) {\n                if ($const instanceof CalcError)\n                    return $const;\n                return new CalcError(err);\n            }\n            xargs.push($const);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), trend);\n\ndefineBuiltinFunction('GROWTH', false, function () {\n    function check(args) {\n        var xargs = [], i = 0, m, err = 'VALUE';\n        {\n            var $known_y = args[i++];\n            if ($known_y instanceof CalcError)\n                return $known_y;\n            if (!((m = this.asMatrix($known_y)) ? $known_y = m : false)) {\n                if ($known_y instanceof CalcError)\n                    return $known_y;\n                return new CalcError(err);\n            }\n            xargs.push($known_y);\n        }\n        {\n            var $known_x = args[i++];\n            if ($known_x instanceof CalcError)\n                return $known_x;\n            if (!(((m = this.asMatrix($known_x)) ? $known_x = m : false) || $known_x == null)) {\n                if ($known_x instanceof CalcError)\n                    return $known_x;\n                return new CalcError(err);\n            }\n            xargs.push($known_x);\n        }\n        {\n            var $new_x = args[i++];\n            if ($new_x instanceof CalcError)\n                return $new_x;\n            if (!(((m = this.asMatrix($new_x)) ? $new_x = m : false) || $new_x == null)) {\n                if ($new_x instanceof CalcError)\n                    return $new_x;\n                return new CalcError(err);\n            }\n            xargs.push($new_x);\n        }\n        {\n            var $const = args[i++];\n            if ($const instanceof CalcError)\n                return $const;\n            if (!(typeof ($const = this.force($const)) == 'boolean' || (typeof $const == 'number' ? ($const = !!$const, true) : false) || ($const == null ? ($const = true, true) : false))) {\n                if ($const instanceof CalcError)\n                    return $const;\n                return new CalcError(err);\n            }\n            xargs.push($const);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), growth);\n\ndefineBuiltinFunction('FV', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $rate = args[i++];\n            if ($rate instanceof CalcError)\n                return $rate;\n            if (!((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false))) {\n                if ($rate instanceof CalcError)\n                    return $rate;\n                return new CalcError(err);\n            }\n            xargs.push($rate);\n        }\n        {\n            var $nper = args[i++];\n            if ($nper instanceof CalcError)\n                return $nper;\n            if (!((typeof ($nper = this.force($nper)) == 'number' ? ($nper = limitPrecision($nper), true) : false) || (typeof $nper == 'boolean' ? ($nper = +$nper, true) : false) || (typeof $nper == 'string' && !/^(?:=|true|false)/i.test($nper) ? (tmp = calc.parse(0, 0, 0, $nper), /^date|number|percent$/.test(tmp.type) ? ($nper = +tmp.value, true) : false) : false))) {\n                if ($nper instanceof CalcError)\n                    return $nper;\n                return new CalcError(err);\n            }\n            xargs.push($nper);\n        }\n        {\n            var $pmt = args[i++];\n            if ($pmt instanceof CalcError)\n                return $pmt;\n            if (!((typeof ($pmt = this.force($pmt)) == 'number' ? ($pmt = limitPrecision($pmt), true) : false) || (typeof $pmt == 'boolean' ? ($pmt = +$pmt, true) : false) || (typeof $pmt == 'string' && !/^(?:=|true|false)/i.test($pmt) ? (tmp = calc.parse(0, 0, 0, $pmt), /^date|number|percent$/.test(tmp.type) ? ($pmt = +tmp.value, true) : false) : false) || ($pmt == null ? ($pmt = 0, true) : false))) {\n                if ($pmt instanceof CalcError)\n                    return $pmt;\n                return new CalcError(err);\n            }\n            xargs.push($pmt);\n        }\n        {\n            var $pv = args[i++];\n            if ($pv instanceof CalcError)\n                return $pv;\n            if (!((typeof ($pv = this.force($pv)) == 'number' ? ($pv = limitPrecision($pv), true) : false) || (typeof $pv == 'boolean' ? ($pv = +$pv, true) : false) || (typeof $pv == 'string' && !/^(?:=|true|false)/i.test($pv) ? (tmp = calc.parse(0, 0, 0, $pv), /^date|number|percent$/.test(tmp.type) ? ($pv = +tmp.value, true) : false) : false) || ($pv == null ? ($pv = 0, true) : false))) {\n                if ($pv instanceof CalcError)\n                    return $pv;\n                return new CalcError(err);\n            }\n            xargs.push($pv);\n        }\n        {\n            var $type = args[i++];\n            if ($type instanceof CalcError)\n                return $type;\n            if (!(($type = this.force($type)) === 0 || $type === 1 || ($type == null ? ($type = 0, true) : false))) {\n                if ($type instanceof CalcError)\n                    return $type;\n                return new CalcError(err);\n            }\n            xargs.push($type);\n        }\n        {\n            if (!($pmt || $pv ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), FV);\n\ndefineBuiltinFunction('PV', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $rate = args[i++];\n            if ($rate instanceof CalcError)\n                return $rate;\n            if (!((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false))) {\n                if ($rate instanceof CalcError)\n                    return $rate;\n                return new CalcError(err);\n            }\n            xargs.push($rate);\n        }\n        {\n            var $nper = args[i++];\n            if ($nper instanceof CalcError)\n                return $nper;\n            if (!((typeof ($nper = this.force($nper)) == 'number' ? ($nper = limitPrecision($nper), true) : false) || (typeof $nper == 'boolean' ? ($nper = +$nper, true) : false) || (typeof $nper == 'string' && !/^(?:=|true|false)/i.test($nper) ? (tmp = calc.parse(0, 0, 0, $nper), /^date|number|percent$/.test(tmp.type) ? ($nper = +tmp.value, true) : false) : false))) {\n                if ($nper instanceof CalcError)\n                    return $nper;\n                return new CalcError(err);\n            }\n            xargs.push($nper);\n        }\n        {\n            var $pmt = args[i++];\n            if ($pmt instanceof CalcError)\n                return $pmt;\n            if (!((typeof ($pmt = this.force($pmt)) == 'number' ? ($pmt = limitPrecision($pmt), true) : false) || (typeof $pmt == 'boolean' ? ($pmt = +$pmt, true) : false) || (typeof $pmt == 'string' && !/^(?:=|true|false)/i.test($pmt) ? (tmp = calc.parse(0, 0, 0, $pmt), /^date|number|percent$/.test(tmp.type) ? ($pmt = +tmp.value, true) : false) : false) || ($pmt == null ? ($pmt = 0, true) : false))) {\n                if ($pmt instanceof CalcError)\n                    return $pmt;\n                return new CalcError(err);\n            }\n            xargs.push($pmt);\n        }\n        {\n            var $fv = args[i++];\n            if ($fv instanceof CalcError)\n                return $fv;\n            if (!((typeof ($fv = this.force($fv)) == 'number' ? ($fv = limitPrecision($fv), true) : false) || (typeof $fv == 'boolean' ? ($fv = +$fv, true) : false) || (typeof $fv == 'string' && !/^(?:=|true|false)/i.test($fv) ? (tmp = calc.parse(0, 0, 0, $fv), /^date|number|percent$/.test(tmp.type) ? ($fv = +tmp.value, true) : false) : false) || ($fv == null ? ($fv = 0, true) : false))) {\n                if ($fv instanceof CalcError)\n                    return $fv;\n                return new CalcError(err);\n            }\n            xargs.push($fv);\n        }\n        {\n            var $type = args[i++];\n            if ($type instanceof CalcError)\n                return $type;\n            if (!(($type = this.force($type)) === 0 || $type === 1 || ($type == null ? ($type = 0, true) : false))) {\n                if ($type instanceof CalcError)\n                    return $type;\n                return new CalcError(err);\n            }\n            xargs.push($type);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), PV);\n\ndefineBuiltinFunction('PMT', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $rate = args[i++];\n            if ($rate instanceof CalcError)\n                return $rate;\n            if (!((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false))) {\n                if ($rate instanceof CalcError)\n                    return $rate;\n                return new CalcError(err);\n            }\n            xargs.push($rate);\n        }\n        {\n            var $nper = args[i++];\n            if ($nper instanceof CalcError)\n                return $nper;\n            if (!((typeof ($nper = this.force($nper)) == 'number' ? ($nper = limitPrecision($nper), true) : false) || (typeof $nper == 'boolean' ? ($nper = +$nper, true) : false) || (typeof $nper == 'string' && !/^(?:=|true|false)/i.test($nper) ? (tmp = calc.parse(0, 0, 0, $nper), /^date|number|percent$/.test(tmp.type) ? ($nper = +tmp.value, true) : false) : false))) {\n                if ($nper instanceof CalcError)\n                    return $nper;\n                return new CalcError(err);\n            }\n            xargs.push($nper);\n        }\n        {\n            var $pmt = args[i++];\n            if ($pmt instanceof CalcError)\n                return $pmt;\n            if (!((typeof ($pmt = this.force($pmt)) == 'number' ? ($pmt = limitPrecision($pmt), true) : false) || (typeof $pmt == 'boolean' ? ($pmt = +$pmt, true) : false) || (typeof $pmt == 'string' && !/^(?:=|true|false)/i.test($pmt) ? (tmp = calc.parse(0, 0, 0, $pmt), /^date|number|percent$/.test(tmp.type) ? ($pmt = +tmp.value, true) : false) : false))) {\n                if ($pmt instanceof CalcError)\n                    return $pmt;\n                return new CalcError(err);\n            }\n            xargs.push($pmt);\n        }\n        {\n            var $fv = args[i++];\n            if ($fv instanceof CalcError)\n                return $fv;\n            if (!((typeof ($fv = this.force($fv)) == 'number' ? ($fv = limitPrecision($fv), true) : false) || (typeof $fv == 'boolean' ? ($fv = +$fv, true) : false) || (typeof $fv == 'string' && !/^(?:=|true|false)/i.test($fv) ? (tmp = calc.parse(0, 0, 0, $fv), /^date|number|percent$/.test(tmp.type) ? ($fv = +tmp.value, true) : false) : false) || ($fv == null ? ($fv = 0, true) : false))) {\n                if ($fv instanceof CalcError)\n                    return $fv;\n                return new CalcError(err);\n            }\n            xargs.push($fv);\n        }\n        {\n            var $type = args[i++];\n            if ($type instanceof CalcError)\n                return $type;\n            if (!(($type = this.force($type)) === 0 || $type === 1 || ($type == null ? ($type = 0, true) : false))) {\n                if ($type instanceof CalcError)\n                    return $type;\n                return new CalcError(err);\n            }\n            xargs.push($type);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), PMT);\n\ndefineBuiltinFunction('NPER', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $rate = args[i++];\n            if ($rate instanceof CalcError)\n                return $rate;\n            if (!((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false))) {\n                if ($rate instanceof CalcError)\n                    return $rate;\n                return new CalcError(err);\n            }\n            xargs.push($rate);\n        }\n        {\n            var $pmt = args[i++];\n            if ($pmt instanceof CalcError)\n                return $pmt;\n            if (!((typeof ($pmt = this.force($pmt)) == 'number' ? ($pmt = limitPrecision($pmt), true) : false) || (typeof $pmt == 'boolean' ? ($pmt = +$pmt, true) : false) || (typeof $pmt == 'string' && !/^(?:=|true|false)/i.test($pmt) ? (tmp = calc.parse(0, 0, 0, $pmt), /^date|number|percent$/.test(tmp.type) ? ($pmt = +tmp.value, true) : false) : false))) {\n                if ($pmt instanceof CalcError)\n                    return $pmt;\n                return new CalcError(err);\n            }\n            xargs.push($pmt);\n        }\n        {\n            var $pv = args[i++];\n            if ($pv instanceof CalcError)\n                return $pv;\n            if (!((typeof ($pv = this.force($pv)) == 'number' ? ($pv = limitPrecision($pv), true) : false) || (typeof $pv == 'boolean' ? ($pv = +$pv, true) : false) || (typeof $pv == 'string' && !/^(?:=|true|false)/i.test($pv) ? (tmp = calc.parse(0, 0, 0, $pv), /^date|number|percent$/.test(tmp.type) ? ($pv = +tmp.value, true) : false) : false))) {\n                if ($pv instanceof CalcError)\n                    return $pv;\n                return new CalcError(err);\n            }\n            xargs.push($pv);\n        }\n        {\n            var $fv = args[i++];\n            if ($fv instanceof CalcError)\n                return $fv;\n            if (!((typeof ($fv = this.force($fv)) == 'number' ? ($fv = limitPrecision($fv), true) : false) || (typeof $fv == 'boolean' ? ($fv = +$fv, true) : false) || (typeof $fv == 'string' && !/^(?:=|true|false)/i.test($fv) ? (tmp = calc.parse(0, 0, 0, $fv), /^date|number|percent$/.test(tmp.type) ? ($fv = +tmp.value, true) : false) : false) || ($fv == null ? ($fv = 0, true) : false))) {\n                if ($fv instanceof CalcError)\n                    return $fv;\n                return new CalcError(err);\n            }\n            xargs.push($fv);\n        }\n        {\n            var $type = args[i++];\n            if ($type instanceof CalcError)\n                return $type;\n            if (!(($type = this.force($type)) === 0 || $type === 1 || ($type == null ? ($type = 0, true) : false))) {\n                if ($type instanceof CalcError)\n                    return $type;\n                return new CalcError(err);\n            }\n            xargs.push($type);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), NPER);\n\ndefineBuiltinFunction('RATE', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $nper = args[i++];\n            if ($nper instanceof CalcError)\n                return $nper;\n            if (!((typeof ($nper = this.force($nper)) == 'number' ? ($nper = limitPrecision($nper), true) : false) || (typeof $nper == 'boolean' ? ($nper = +$nper, true) : false) || (typeof $nper == 'string' && !/^(?:=|true|false)/i.test($nper) ? (tmp = calc.parse(0, 0, 0, $nper), /^date|number|percent$/.test(tmp.type) ? ($nper = +tmp.value, true) : false) : false))) {\n                if ($nper instanceof CalcError)\n                    return $nper;\n                return new CalcError(err);\n            }\n            xargs.push($nper);\n        }\n        {\n            var $pmt = args[i++];\n            if ($pmt instanceof CalcError)\n                return $pmt;\n            if (!((typeof ($pmt = this.force($pmt)) == 'number' ? ($pmt = limitPrecision($pmt), true) : false) || (typeof $pmt == 'boolean' ? ($pmt = +$pmt, true) : false) || (typeof $pmt == 'string' && !/^(?:=|true|false)/i.test($pmt) ? (tmp = calc.parse(0, 0, 0, $pmt), /^date|number|percent$/.test(tmp.type) ? ($pmt = +tmp.value, true) : false) : false) || ($pmt == null ? ($pmt = 0, true) : false))) {\n                if ($pmt instanceof CalcError)\n                    return $pmt;\n                return new CalcError(err);\n            }\n            xargs.push($pmt);\n        }\n        {\n            var $pv = args[i++];\n            if ($pv instanceof CalcError)\n                return $pv;\n            if (!((typeof ($pv = this.force($pv)) == 'number' ? ($pv = limitPrecision($pv), true) : false) || (typeof $pv == 'boolean' ? ($pv = +$pv, true) : false) || (typeof $pv == 'string' && !/^(?:=|true|false)/i.test($pv) ? (tmp = calc.parse(0, 0, 0, $pv), /^date|number|percent$/.test(tmp.type) ? ($pv = +tmp.value, true) : false) : false))) {\n                if ($pv instanceof CalcError)\n                    return $pv;\n                return new CalcError(err);\n            }\n            xargs.push($pv);\n        }\n        {\n            var $fv = args[i++];\n            if ($fv instanceof CalcError)\n                return $fv;\n            if (!((typeof ($fv = this.force($fv)) == 'number' ? ($fv = limitPrecision($fv), true) : false) || (typeof $fv == 'boolean' ? ($fv = +$fv, true) : false) || (typeof $fv == 'string' && !/^(?:=|true|false)/i.test($fv) ? (tmp = calc.parse(0, 0, 0, $fv), /^date|number|percent$/.test(tmp.type) ? ($fv = +tmp.value, true) : false) : false) || ($fv == null ? ($fv = 0, true) : false))) {\n                if ($fv instanceof CalcError)\n                    return $fv;\n                return new CalcError(err);\n            }\n            xargs.push($fv);\n        }\n        {\n            var $type = args[i++];\n            if ($type instanceof CalcError)\n                return $type;\n            if (!(($type = this.force($type)) === 0 || $type === 1 || ($type == null ? ($type = 0, true) : false))) {\n                if ($type instanceof CalcError)\n                    return $type;\n                return new CalcError(err);\n            }\n            xargs.push($type);\n        }\n        {\n            var $guess = args[i++];\n            if ($guess instanceof CalcError)\n                return $guess;\n            if (!(((typeof ($guess = this.force($guess)) == 'number' ? ($guess = limitPrecision($guess), true) : false) || (typeof $guess == 'boolean' ? ($guess = +$guess, true) : false) || (typeof $guess == 'string' && !/^(?:=|true|false)/i.test($guess) ? (tmp = calc.parse(0, 0, 0, $guess), /^date|number|percent$/.test(tmp.type) ? ($guess = +tmp.value, true) : false) : false)) && ($guess > 0 ? true : (err = 'NUM', false)) || ($guess == null ? ($guess = 0.01, true) : false))) {\n                if ($guess instanceof CalcError)\n                    return $guess;\n                return new CalcError(err);\n            }\n            xargs.push($guess);\n        }\n        {\n            if (!($pmt || $fv ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), RATE);\n\ndefineBuiltinFunction('IPMT', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $rate = args[i++];\n            if ($rate instanceof CalcError)\n                return $rate;\n            if (!((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false))) {\n                if ($rate instanceof CalcError)\n                    return $rate;\n                return new CalcError(err);\n            }\n            xargs.push($rate);\n        }\n        {\n            var $per = args[i++];\n            if ($per instanceof CalcError)\n                return $per;\n            if (!(((typeof ($per = this.force($per)) == 'number' ? ($per = limitPrecision($per), true) : false) || (typeof $per == 'boolean' ? ($per = +$per, true) : false) || (typeof $per == 'string' && !/^(?:=|true|false)/i.test($per) ? (tmp = calc.parse(0, 0, 0, $per), /^date|number|percent$/.test(tmp.type) ? ($per = +tmp.value, true) : false) : false)) && ($per > 0 ? true : (err = 'NUM', false)))) {\n                if ($per instanceof CalcError)\n                    return $per;\n                return new CalcError(err);\n            }\n            xargs.push($per);\n        }\n        {\n            var $nper = args[i++];\n            if ($nper instanceof CalcError)\n                return $nper;\n            if (!(((typeof ($nper = this.force($nper)) == 'number' ? ($nper = limitPrecision($nper), true) : false) || (typeof $nper == 'boolean' ? ($nper = +$nper, true) : false) || (typeof $nper == 'string' && !/^(?:=|true|false)/i.test($nper) ? (tmp = calc.parse(0, 0, 0, $nper), /^date|number|percent$/.test(tmp.type) ? ($nper = +tmp.value, true) : false) : false)) && ($nper > 0 ? true : (err = 'NUM', false)))) {\n                if ($nper instanceof CalcError)\n                    return $nper;\n                return new CalcError(err);\n            }\n            xargs.push($nper);\n        }\n        {\n            var $pv = args[i++];\n            if ($pv instanceof CalcError)\n                return $pv;\n            if (!((typeof ($pv = this.force($pv)) == 'number' ? ($pv = limitPrecision($pv), true) : false) || (typeof $pv == 'boolean' ? ($pv = +$pv, true) : false) || (typeof $pv == 'string' && !/^(?:=|true|false)/i.test($pv) ? (tmp = calc.parse(0, 0, 0, $pv), /^date|number|percent$/.test(tmp.type) ? ($pv = +tmp.value, true) : false) : false))) {\n                if ($pv instanceof CalcError)\n                    return $pv;\n                return new CalcError(err);\n            }\n            xargs.push($pv);\n        }\n        {\n            var $fv = args[i++];\n            if ($fv instanceof CalcError)\n                return $fv;\n            if (!((typeof ($fv = this.force($fv)) == 'number' ? ($fv = limitPrecision($fv), true) : false) || (typeof $fv == 'boolean' ? ($fv = +$fv, true) : false) || (typeof $fv == 'string' && !/^(?:=|true|false)/i.test($fv) ? (tmp = calc.parse(0, 0, 0, $fv), /^date|number|percent$/.test(tmp.type) ? ($fv = +tmp.value, true) : false) : false) || ($fv == null ? ($fv = 0, true) : false))) {\n                if ($fv instanceof CalcError)\n                    return $fv;\n                return new CalcError(err);\n            }\n            xargs.push($fv);\n        }\n        {\n            var $type = args[i++];\n            if ($type instanceof CalcError)\n                return $type;\n            if (!(($type = this.force($type)) === 0 || $type === 1 || ($type == null ? ($type = 0, true) : false))) {\n                if ($type instanceof CalcError)\n                    return $type;\n                return new CalcError(err);\n            }\n            xargs.push($type);\n        }\n        {\n            if (!($per >= 1 && $per <= $nper ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), IPMT);\n\ndefineBuiltinFunction('PPMT', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $rate = args[i++];\n            if ($rate instanceof CalcError)\n                return $rate;\n            if (!((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false))) {\n                if ($rate instanceof CalcError)\n                    return $rate;\n                return new CalcError(err);\n            }\n            xargs.push($rate);\n        }\n        {\n            var $per = args[i++];\n            if ($per instanceof CalcError)\n                return $per;\n            if (!(((typeof ($per = this.force($per)) == 'number' ? ($per = limitPrecision($per), true) : false) || (typeof $per == 'boolean' ? ($per = +$per, true) : false) || (typeof $per == 'string' && !/^(?:=|true|false)/i.test($per) ? (tmp = calc.parse(0, 0, 0, $per), /^date|number|percent$/.test(tmp.type) ? ($per = +tmp.value, true) : false) : false)) && ($per > 0 ? true : (err = 'NUM', false)))) {\n                if ($per instanceof CalcError)\n                    return $per;\n                return new CalcError(err);\n            }\n            xargs.push($per);\n        }\n        {\n            var $nper = args[i++];\n            if ($nper instanceof CalcError)\n                return $nper;\n            if (!(((typeof ($nper = this.force($nper)) == 'number' ? ($nper = limitPrecision($nper), true) : false) || (typeof $nper == 'boolean' ? ($nper = +$nper, true) : false) || (typeof $nper == 'string' && !/^(?:=|true|false)/i.test($nper) ? (tmp = calc.parse(0, 0, 0, $nper), /^date|number|percent$/.test(tmp.type) ? ($nper = +tmp.value, true) : false) : false)) && ($nper > 0 ? true : (err = 'NUM', false)))) {\n                if ($nper instanceof CalcError)\n                    return $nper;\n                return new CalcError(err);\n            }\n            xargs.push($nper);\n        }\n        {\n            var $pv = args[i++];\n            if ($pv instanceof CalcError)\n                return $pv;\n            if (!((typeof ($pv = this.force($pv)) == 'number' ? ($pv = limitPrecision($pv), true) : false) || (typeof $pv == 'boolean' ? ($pv = +$pv, true) : false) || (typeof $pv == 'string' && !/^(?:=|true|false)/i.test($pv) ? (tmp = calc.parse(0, 0, 0, $pv), /^date|number|percent$/.test(tmp.type) ? ($pv = +tmp.value, true) : false) : false))) {\n                if ($pv instanceof CalcError)\n                    return $pv;\n                return new CalcError(err);\n            }\n            xargs.push($pv);\n        }\n        {\n            var $fv = args[i++];\n            if ($fv instanceof CalcError)\n                return $fv;\n            if (!((typeof ($fv = this.force($fv)) == 'number' ? ($fv = limitPrecision($fv), true) : false) || (typeof $fv == 'boolean' ? ($fv = +$fv, true) : false) || (typeof $fv == 'string' && !/^(?:=|true|false)/i.test($fv) ? (tmp = calc.parse(0, 0, 0, $fv), /^date|number|percent$/.test(tmp.type) ? ($fv = +tmp.value, true) : false) : false) || ($fv == null ? ($fv = 0, true) : false))) {\n                if ($fv instanceof CalcError)\n                    return $fv;\n                return new CalcError(err);\n            }\n            xargs.push($fv);\n        }\n        {\n            var $type = args[i++];\n            if ($type instanceof CalcError)\n                return $type;\n            if (!(($type = this.force($type)) === 0 || $type === 1 || ($type == null ? ($type = 0, true) : false))) {\n                if ($type instanceof CalcError)\n                    return $type;\n                return new CalcError(err);\n            }\n            xargs.push($type);\n        }\n        {\n            if (!($per >= 1 && $per <= $nper ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), PPMT);\n\ndefineBuiltinFunction('CUMPRINC', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $rate = args[i++];\n            if ($rate instanceof CalcError)\n                return $rate;\n            if (!(((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false)) && ($rate > 0 ? true : (err = 'NUM', false)))) {\n                if ($rate instanceof CalcError)\n                    return $rate;\n                return new CalcError(err);\n            }\n            xargs.push($rate);\n        }\n        {\n            var $nper = args[i++];\n            if ($nper instanceof CalcError)\n                return $nper;\n            if (!(((typeof ($nper = this.force($nper)) == 'number' ? ($nper = limitPrecision($nper), true) : false) || (typeof $nper == 'boolean' ? ($nper = +$nper, true) : false) || (typeof $nper == 'string' && !/^(?:=|true|false)/i.test($nper) ? (tmp = calc.parse(0, 0, 0, $nper), /^date|number|percent$/.test(tmp.type) ? ($nper = +tmp.value, true) : false) : false)) && ($nper > 0 ? true : (err = 'NUM', false)))) {\n                if ($nper instanceof CalcError)\n                    return $nper;\n                return new CalcError(err);\n            }\n            xargs.push($nper);\n        }\n        {\n            var $pv = args[i++];\n            if ($pv instanceof CalcError)\n                return $pv;\n            if (!(((typeof ($pv = this.force($pv)) == 'number' ? ($pv = limitPrecision($pv), true) : false) || (typeof $pv == 'boolean' ? ($pv = +$pv, true) : false) || (typeof $pv == 'string' && !/^(?:=|true|false)/i.test($pv) ? (tmp = calc.parse(0, 0, 0, $pv), /^date|number|percent$/.test(tmp.type) ? ($pv = +tmp.value, true) : false) : false)) && ($pv > 0 ? true : (err = 'NUM', false)))) {\n                if ($pv instanceof CalcError)\n                    return $pv;\n                return new CalcError(err);\n            }\n            xargs.push($pv);\n        }\n        {\n            var $start_period = args[i++];\n            if ($start_period instanceof CalcError)\n                return $start_period;\n            if (!(((typeof ($start_period = this.force($start_period)) == 'number' ? ($start_period = limitPrecision($start_period), true) : false) || (typeof $start_period == 'boolean' ? ($start_period = +$start_period, true) : false) || (typeof $start_period == 'string' && !/^(?:=|true|false)/i.test($start_period) ? (tmp = calc.parse(0, 0, 0, $start_period), /^date|number|percent$/.test(tmp.type) ? ($start_period = +tmp.value, true) : false) : false)) && ($start_period > 0 ? true : (err = 'NUM', false)))) {\n                if ($start_period instanceof CalcError)\n                    return $start_period;\n                return new CalcError(err);\n            }\n            xargs.push($start_period);\n        }\n        {\n            var $end_period = args[i++];\n            if ($end_period instanceof CalcError)\n                return $end_period;\n            if (!(((typeof ($end_period = this.force($end_period)) == 'number' ? ($end_period = limitPrecision($end_period), true) : false) || (typeof $end_period == 'boolean' ? ($end_period = +$end_period, true) : false) || (typeof $end_period == 'string' && !/^(?:=|true|false)/i.test($end_period) ? (tmp = calc.parse(0, 0, 0, $end_period), /^date|number|percent$/.test(tmp.type) ? ($end_period = +tmp.value, true) : false) : false)) && ($end_period > 0 ? true : (err = 'NUM', false)))) {\n                if ($end_period instanceof CalcError)\n                    return $end_period;\n                return new CalcError(err);\n            }\n            xargs.push($end_period);\n        }\n        {\n            var $type = args[i++];\n            if ($type instanceof CalcError)\n                return $type;\n            if (!(($type = this.force($type)) === 0 || $type === 1 || ($type == null ? ($type = 0, true) : false))) {\n                if ($type instanceof CalcError)\n                    return $type;\n                return new CalcError(err);\n            }\n            xargs.push($type);\n        }\n        {\n            if (!($end_period >= $start_period ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), CUMPRINC);\n\ndefineBuiltinFunction('CUMIPMT', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $rate = args[i++];\n            if ($rate instanceof CalcError)\n                return $rate;\n            if (!(((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false)) && ($rate > 0 ? true : (err = 'NUM', false)))) {\n                if ($rate instanceof CalcError)\n                    return $rate;\n                return new CalcError(err);\n            }\n            xargs.push($rate);\n        }\n        {\n            var $nper = args[i++];\n            if ($nper instanceof CalcError)\n                return $nper;\n            if (!(((typeof ($nper = this.force($nper)) == 'number' ? ($nper = limitPrecision($nper), true) : false) || (typeof $nper == 'boolean' ? ($nper = +$nper, true) : false) || (typeof $nper == 'string' && !/^(?:=|true|false)/i.test($nper) ? (tmp = calc.parse(0, 0, 0, $nper), /^date|number|percent$/.test(tmp.type) ? ($nper = +tmp.value, true) : false) : false)) && ($nper > 0 ? true : (err = 'NUM', false)))) {\n                if ($nper instanceof CalcError)\n                    return $nper;\n                return new CalcError(err);\n            }\n            xargs.push($nper);\n        }\n        {\n            var $pv = args[i++];\n            if ($pv instanceof CalcError)\n                return $pv;\n            if (!(((typeof ($pv = this.force($pv)) == 'number' ? ($pv = limitPrecision($pv), true) : false) || (typeof $pv == 'boolean' ? ($pv = +$pv, true) : false) || (typeof $pv == 'string' && !/^(?:=|true|false)/i.test($pv) ? (tmp = calc.parse(0, 0, 0, $pv), /^date|number|percent$/.test(tmp.type) ? ($pv = +tmp.value, true) : false) : false)) && ($pv > 0 ? true : (err = 'NUM', false)))) {\n                if ($pv instanceof CalcError)\n                    return $pv;\n                return new CalcError(err);\n            }\n            xargs.push($pv);\n        }\n        {\n            var $start_period = args[i++];\n            if ($start_period instanceof CalcError)\n                return $start_period;\n            if (!(((typeof ($start_period = this.force($start_period)) == 'number' ? ($start_period = limitPrecision($start_period), true) : false) || (typeof $start_period == 'boolean' ? ($start_period = +$start_period, true) : false) || (typeof $start_period == 'string' && !/^(?:=|true|false)/i.test($start_period) ? (tmp = calc.parse(0, 0, 0, $start_period), /^date|number|percent$/.test(tmp.type) ? ($start_period = +tmp.value, true) : false) : false)) && ($start_period > 0 ? true : (err = 'NUM', false)))) {\n                if ($start_period instanceof CalcError)\n                    return $start_period;\n                return new CalcError(err);\n            }\n            xargs.push($start_period);\n        }\n        {\n            var $end_period = args[i++];\n            if ($end_period instanceof CalcError)\n                return $end_period;\n            if (!(((typeof ($end_period = this.force($end_period)) == 'number' ? ($end_period = limitPrecision($end_period), true) : false) || (typeof $end_period == 'boolean' ? ($end_period = +$end_period, true) : false) || (typeof $end_period == 'string' && !/^(?:=|true|false)/i.test($end_period) ? (tmp = calc.parse(0, 0, 0, $end_period), /^date|number|percent$/.test(tmp.type) ? ($end_period = +tmp.value, true) : false) : false)) && ($end_period > 0 ? true : (err = 'NUM', false)))) {\n                if ($end_period instanceof CalcError)\n                    return $end_period;\n                return new CalcError(err);\n            }\n            xargs.push($end_period);\n        }\n        {\n            var $type = args[i++];\n            if ($type instanceof CalcError)\n                return $type;\n            if (!(($type = this.force($type)) === 0 || $type === 1 || ($type == null ? ($type = 0, true) : false))) {\n                if ($type instanceof CalcError)\n                    return $type;\n                return new CalcError(err);\n            }\n            xargs.push($type);\n        }\n        {\n            if (!($end_period >= $start_period ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), CUMIPMT);\n\ndefineBuiltinFunction('NPV', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $rate = args[i++];\n            if ($rate instanceof CalcError)\n                return $rate;\n            if (!((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false))) {\n                if ($rate instanceof CalcError)\n                    return $rate;\n                return new CalcError(err);\n            }\n            xargs.push($rate);\n        }\n        {\n            try {\n                var $values = this.cellValues(args.slice(i)).reduce(function (ret, $values) {\n                    if ($values instanceof CalcError)\n                        throw $values;\n                    if ((typeof $values == 'number' ? ($values = limitPrecision($values), true) : false) || (typeof $values == 'boolean' ? ($values = +$values, true) : false) || (typeof $values == 'string' && !/^(?:=|true|false)/i.test($values) ? (tmp = calc.parse(0, 0, 0, $values), /^date|number|percent$/.test(tmp.type) ? ($values = +tmp.value, true) : false) : false))\n                        ret.push($values);\n                    return ret;\n                }.bind(this), []);\n                i = args.length;\n                xargs.push($values);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            if (!($values.length > 0 ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), NPV);\n\ndefineBuiltinFunction('IRR', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $values = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $values) {\n                    if ($values instanceof CalcError)\n                        throw $values;\n                    if ((typeof $values == 'number' ? ($values = limitPrecision($values), true) : false) || (typeof $values == 'boolean' ? ($values = +$values, true) : false) || (typeof $values == 'string' && !/^(?:=|true|false)/i.test($values) ? (tmp = calc.parse(0, 0, 0, $values), /^date|number|percent$/.test(tmp.type) ? ($values = +tmp.value, true) : false) : false))\n                        ret.push($values);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($values);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            var $guess = args[i++];\n            if ($guess instanceof CalcError)\n                return $guess;\n            if (!((typeof ($guess = this.force($guess)) == 'number' ? ($guess = limitPrecision($guess), true) : false) || (typeof $guess == 'boolean' ? ($guess = +$guess, true) : false) || (typeof $guess == 'string' && !/^(?:=|true|false)/i.test($guess) ? (tmp = calc.parse(0, 0, 0, $guess), /^date|number|percent$/.test(tmp.type) ? ($guess = +tmp.value, true) : false) : false) || ($guess == null ? ($guess = 0.1, true) : false))) {\n                if ($guess instanceof CalcError)\n                    return $guess;\n                return new CalcError(err);\n            }\n            xargs.push($guess);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), IRR);\n\ndefineBuiltinFunction('EFFECT', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $nominal_rate = args[i++];\n            if ($nominal_rate instanceof CalcError)\n                return $nominal_rate;\n            if (!(((typeof ($nominal_rate = this.force($nominal_rate)) == 'number' ? ($nominal_rate = limitPrecision($nominal_rate), true) : false) || (typeof $nominal_rate == 'boolean' ? ($nominal_rate = +$nominal_rate, true) : false) || (typeof $nominal_rate == 'string' && !/^(?:=|true|false)/i.test($nominal_rate) ? (tmp = calc.parse(0, 0, 0, $nominal_rate), /^date|number|percent$/.test(tmp.type) ? ($nominal_rate = +tmp.value, true) : false) : false)) && ($nominal_rate > 0 ? true : (err = 'NUM', false)))) {\n                if ($nominal_rate instanceof CalcError)\n                    return $nominal_rate;\n                return new CalcError(err);\n            }\n            xargs.push($nominal_rate);\n        }\n        {\n            var $npery = args[i++];\n            if ($npery instanceof CalcError)\n                return $npery;\n            if (!((typeof ($npery = this.force($npery)) == 'number' || (typeof $npery == 'boolean' ? ($npery = +$npery, true) : false) || (typeof $npery == 'string' && !/^(?:=|true|false)/i.test($npery) ? (tmp = calc.parse(0, 0, 0, $npery), /^date|number|percent$/.test(tmp.type) ? ($npery = +tmp.value, true) : false) : false)) && (($npery |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($npery instanceof CalcError)\n                    return $npery;\n                return new CalcError(err);\n            }\n            xargs.push($npery);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), EFFECT);\n\ndefineBuiltinFunction('NOMINAL', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $effect_rate = args[i++];\n            if ($effect_rate instanceof CalcError)\n                return $effect_rate;\n            if (!(((typeof ($effect_rate = this.force($effect_rate)) == 'number' ? ($effect_rate = limitPrecision($effect_rate), true) : false) || (typeof $effect_rate == 'boolean' ? ($effect_rate = +$effect_rate, true) : false) || (typeof $effect_rate == 'string' && !/^(?:=|true|false)/i.test($effect_rate) ? (tmp = calc.parse(0, 0, 0, $effect_rate), /^date|number|percent$/.test(tmp.type) ? ($effect_rate = +tmp.value, true) : false) : false)) && ($effect_rate > 0 ? true : (err = 'NUM', false)))) {\n                if ($effect_rate instanceof CalcError)\n                    return $effect_rate;\n                return new CalcError(err);\n            }\n            xargs.push($effect_rate);\n        }\n        {\n            var $npery = args[i++];\n            if ($npery instanceof CalcError)\n                return $npery;\n            if (!((typeof ($npery = this.force($npery)) == 'number' || (typeof $npery == 'boolean' ? ($npery = +$npery, true) : false) || (typeof $npery == 'string' && !/^(?:=|true|false)/i.test($npery) ? (tmp = calc.parse(0, 0, 0, $npery), /^date|number|percent$/.test(tmp.type) ? ($npery = +tmp.value, true) : false) : false)) && (($npery |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                if ($npery instanceof CalcError)\n                    return $npery;\n                return new CalcError(err);\n            }\n            xargs.push($npery);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), NOMINAL);\n\ndefineBuiltinFunction('XNPV', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $rate = args[i++];\n            if ($rate instanceof CalcError)\n                return $rate;\n            if (!((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false))) {\n                if ($rate instanceof CalcError)\n                    return $rate;\n                return new CalcError(err);\n            }\n            xargs.push($rate);\n        }\n        {\n            try {\n                var $values = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $values) {\n                    if ($values instanceof CalcError)\n                        throw $values;\n                    if ((typeof $values == 'number' ? ($values = limitPrecision($values), true) : false) || (typeof $values == 'boolean' ? ($values = +$values, true) : false) || (typeof $values == 'string' && !/^(?:=|true|false)/i.test($values) ? (tmp = calc.parse(0, 0, 0, $values), /^date|number|percent$/.test(tmp.type) ? ($values = +tmp.value, true) : false) : false))\n                        ret.push($values);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($values);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            try {\n                var $dates = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $dates) {\n                    if ($dates instanceof CalcError)\n                        throw $dates;\n                    if ((typeof $dates == 'number' || (typeof $dates == 'boolean' ? ($dates = +$dates, true) : false) || (typeof $dates == 'string' && !/^(?:=|true|false)/i.test($dates) ? (tmp = calc.parse(0, 0, 0, $dates), /^date|number|percent$/.test(tmp.type) ? ($dates = +tmp.value, true) : false) : false)) && ($dates |= 0, true))\n                        ret.push($dates);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($dates);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            if (!($values.length == $dates.length ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args.slice(i));\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), XNPV);\n\ndefineBuiltinFunction('XIRR', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            try {\n                var $values = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $values) {\n                    if ($values instanceof CalcError)\n                        throw $values;\n                    if ((typeof $values == 'number' ? ($values = limitPrecision($values), true) : false) || (typeof $values == 'boolean' ? ($values = +$values, true) : false) || (typeof $values == 'string' && !/^(?:=|true|false)/i.test($values) ? (tmp = calc.parse(0, 0, 0, $values), /^date|number|percent$/.test(tmp.type) ? ($values = +tmp.value, true) : false) : false))\n                        ret.push($values);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($values);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            try {\n                var $dates = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $dates) {\n                    if ($dates instanceof CalcError)\n                        throw $dates;\n                    if ((typeof $dates == 'number' || (typeof $dates == 'boolean' ? ($dates = +$dates, true) : false) || (typeof $dates == 'string' && !/^(?:=|true|false)/i.test($dates) ? (tmp = calc.parse(0, 0, 0, $dates), /^date|number|percent$/.test(tmp.type) ? ($dates = +tmp.value, true) : false) : false)) && ($dates |= 0, true))\n                        ret.push($dates);\n                    return ret;\n                }.bind(this), []);\n                i += 1;\n                xargs.push($dates);\n            } catch (ex) {\n                if (ex instanceof CalcError)\n                    return ex;\n                throw ex;\n            }\n        }\n        {\n            var $guess = args[i++];\n            if ($guess instanceof CalcError)\n                return $guess;\n            if (!((typeof ($guess = this.force($guess)) == 'number' ? ($guess = limitPrecision($guess), true) : false) || (typeof $guess == 'boolean' ? ($guess = +$guess, true) : false) || (typeof $guess == 'string' && !/^(?:=|true|false)/i.test($guess) ? (tmp = calc.parse(0, 0, 0, $guess), /^date|number|percent$/.test(tmp.type) ? ($guess = +tmp.value, true) : false) : false) || ($guess == null ? ($guess = 0.1, true) : false))) {\n                if ($guess instanceof CalcError)\n                    return $guess;\n                return new CalcError(err);\n            }\n            xargs.push($guess);\n        }\n        {\n            if (!($values.length == $dates.length ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args.slice(i));\n        toResolve.push(args.slice(i));\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), XIRR);\n\ndefineBuiltinFunction('ISPMT', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $rate = args[i++];\n            if ($rate instanceof CalcError)\n                return $rate;\n            if (!((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false))) {\n                if ($rate instanceof CalcError)\n                    return $rate;\n                return new CalcError(err);\n            }\n            xargs.push($rate);\n        }\n        {\n            var $per = args[i++];\n            if ($per instanceof CalcError)\n                return $per;\n            if (!(((typeof ($per = this.force($per)) == 'number' ? ($per = limitPrecision($per), true) : false) || (typeof $per == 'boolean' ? ($per = +$per, true) : false) || (typeof $per == 'string' && !/^(?:=|true|false)/i.test($per) ? (tmp = calc.parse(0, 0, 0, $per), /^date|number|percent$/.test(tmp.type) ? ($per = +tmp.value, true) : false) : false)) && ($per > 0 ? true : (err = 'NUM', false)))) {\n                if ($per instanceof CalcError)\n                    return $per;\n                return new CalcError(err);\n            }\n            xargs.push($per);\n        }\n        {\n            var $nper = args[i++];\n            if ($nper instanceof CalcError)\n                return $nper;\n            if (!(((typeof ($nper = this.force($nper)) == 'number' ? ($nper = limitPrecision($nper), true) : false) || (typeof $nper == 'boolean' ? ($nper = +$nper, true) : false) || (typeof $nper == 'string' && !/^(?:=|true|false)/i.test($nper) ? (tmp = calc.parse(0, 0, 0, $nper), /^date|number|percent$/.test(tmp.type) ? ($nper = +tmp.value, true) : false) : false)) && ($nper > 0 ? true : (err = 'NUM', false)))) {\n                if ($nper instanceof CalcError)\n                    return $nper;\n                return new CalcError(err);\n            }\n            xargs.push($nper);\n        }\n        {\n            var $pv = args[i++];\n            if ($pv instanceof CalcError)\n                return $pv;\n            if (!((typeof ($pv = this.force($pv)) == 'number' ? ($pv = limitPrecision($pv), true) : false) || (typeof $pv == 'boolean' ? ($pv = +$pv, true) : false) || (typeof $pv == 'string' && !/^(?:=|true|false)/i.test($pv) ? (tmp = calc.parse(0, 0, 0, $pv), /^date|number|percent$/.test(tmp.type) ? ($pv = +tmp.value, true) : false) : false))) {\n                if ($pv instanceof CalcError)\n                    return $pv;\n                return new CalcError(err);\n            }\n            xargs.push($pv);\n        }\n        {\n            if (!($per >= 1 && $per <= $nper ? true : (err = 'N/A', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), ISPMT);\n\ndefineBuiltinFunction('DB', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $cost = args[i++];\n            if ($cost instanceof CalcError)\n                return $cost;\n            if (!((typeof ($cost = this.force($cost)) == 'number' ? ($cost = limitPrecision($cost), true) : false) || (typeof $cost == 'boolean' ? ($cost = +$cost, true) : false) || (typeof $cost == 'string' && !/^(?:=|true|false)/i.test($cost) ? (tmp = calc.parse(0, 0, 0, $cost), /^date|number|percent$/.test(tmp.type) ? ($cost = +tmp.value, true) : false) : false))) {\n                if ($cost instanceof CalcError)\n                    return $cost;\n                return new CalcError(err);\n            }\n            xargs.push($cost);\n        }\n        {\n            var $salvage = args[i++];\n            if ($salvage instanceof CalcError)\n                return $salvage;\n            if (!((typeof ($salvage = this.force($salvage)) == 'number' ? ($salvage = limitPrecision($salvage), true) : false) || (typeof $salvage == 'boolean' ? ($salvage = +$salvage, true) : false) || (typeof $salvage == 'string' && !/^(?:=|true|false)/i.test($salvage) ? (tmp = calc.parse(0, 0, 0, $salvage), /^date|number|percent$/.test(tmp.type) ? ($salvage = +tmp.value, true) : false) : false))) {\n                if ($salvage instanceof CalcError)\n                    return $salvage;\n                return new CalcError(err);\n            }\n            xargs.push($salvage);\n        }\n        {\n            var $life = args[i++];\n            if ($life instanceof CalcError)\n                return $life;\n            if (!(((typeof ($life = this.force($life)) == 'number' ? ($life = limitPrecision($life), true) : false) || (typeof $life == 'boolean' ? ($life = +$life, true) : false) || (typeof $life == 'string' && !/^(?:=|true|false)/i.test($life) ? (tmp = calc.parse(0, 0, 0, $life), /^date|number|percent$/.test(tmp.type) ? ($life = +tmp.value, true) : false) : false)) && ($life > 0 ? true : (err = 'NUM', false)))) {\n                if ($life instanceof CalcError)\n                    return $life;\n                return new CalcError(err);\n            }\n            xargs.push($life);\n        }\n        {\n            var $period = args[i++];\n            if ($period instanceof CalcError)\n                return $period;\n            if (!(((typeof ($period = this.force($period)) == 'number' ? ($period = limitPrecision($period), true) : false) || (typeof $period == 'boolean' ? ($period = +$period, true) : false) || (typeof $period == 'string' && !/^(?:=|true|false)/i.test($period) ? (tmp = calc.parse(0, 0, 0, $period), /^date|number|percent$/.test(tmp.type) ? ($period = +tmp.value, true) : false) : false)) && ($period > 0 ? true : (err = 'NUM', false)))) {\n                if ($period instanceof CalcError)\n                    return $period;\n                return new CalcError(err);\n            }\n            xargs.push($period);\n        }\n        {\n            var $month = args[i++];\n            if ($month instanceof CalcError)\n                return $month;\n            if (!((typeof ($month = this.force($month)) == 'number' ? ($month = limitPrecision($month), true) : false) || (typeof $month == 'boolean' ? ($month = +$month, true) : false) || (typeof $month == 'string' && !/^(?:=|true|false)/i.test($month) ? (tmp = calc.parse(0, 0, 0, $month), /^date|number|percent$/.test(tmp.type) ? ($month = +tmp.value, true) : false) : false) || ($month == null ? ($month = 12, true) : false))) {\n                if ($month instanceof CalcError)\n                    return $month;\n                return new CalcError(err);\n            }\n            xargs.push($month);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), DB);\n\ndefineBuiltinFunction('DDB', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $cost = args[i++];\n            if ($cost instanceof CalcError)\n                return $cost;\n            if (!((typeof ($cost = this.force($cost)) == 'number' ? ($cost = limitPrecision($cost), true) : false) || (typeof $cost == 'boolean' ? ($cost = +$cost, true) : false) || (typeof $cost == 'string' && !/^(?:=|true|false)/i.test($cost) ? (tmp = calc.parse(0, 0, 0, $cost), /^date|number|percent$/.test(tmp.type) ? ($cost = +tmp.value, true) : false) : false))) {\n                if ($cost instanceof CalcError)\n                    return $cost;\n                return new CalcError(err);\n            }\n            xargs.push($cost);\n        }\n        {\n            var $salvage = args[i++];\n            if ($salvage instanceof CalcError)\n                return $salvage;\n            if (!((typeof ($salvage = this.force($salvage)) == 'number' ? ($salvage = limitPrecision($salvage), true) : false) || (typeof $salvage == 'boolean' ? ($salvage = +$salvage, true) : false) || (typeof $salvage == 'string' && !/^(?:=|true|false)/i.test($salvage) ? (tmp = calc.parse(0, 0, 0, $salvage), /^date|number|percent$/.test(tmp.type) ? ($salvage = +tmp.value, true) : false) : false))) {\n                if ($salvage instanceof CalcError)\n                    return $salvage;\n                return new CalcError(err);\n            }\n            xargs.push($salvage);\n        }\n        {\n            var $life = args[i++];\n            if ($life instanceof CalcError)\n                return $life;\n            if (!(((typeof ($life = this.force($life)) == 'number' ? ($life = limitPrecision($life), true) : false) || (typeof $life == 'boolean' ? ($life = +$life, true) : false) || (typeof $life == 'string' && !/^(?:=|true|false)/i.test($life) ? (tmp = calc.parse(0, 0, 0, $life), /^date|number|percent$/.test(tmp.type) ? ($life = +tmp.value, true) : false) : false)) && ($life > 0 ? true : (err = 'NUM', false)))) {\n                if ($life instanceof CalcError)\n                    return $life;\n                return new CalcError(err);\n            }\n            xargs.push($life);\n        }\n        {\n            var $period = args[i++];\n            if ($period instanceof CalcError)\n                return $period;\n            if (!(((typeof ($period = this.force($period)) == 'number' ? ($period = limitPrecision($period), true) : false) || (typeof $period == 'boolean' ? ($period = +$period, true) : false) || (typeof $period == 'string' && !/^(?:=|true|false)/i.test($period) ? (tmp = calc.parse(0, 0, 0, $period), /^date|number|percent$/.test(tmp.type) ? ($period = +tmp.value, true) : false) : false)) && ($period > 0 ? true : (err = 'NUM', false)))) {\n                if ($period instanceof CalcError)\n                    return $period;\n                return new CalcError(err);\n            }\n            xargs.push($period);\n        }\n        {\n            var $factor = args[i++];\n            if ($factor instanceof CalcError)\n                return $factor;\n            if (!((typeof ($factor = this.force($factor)) == 'number' ? ($factor = limitPrecision($factor), true) : false) || (typeof $factor == 'boolean' ? ($factor = +$factor, true) : false) || (typeof $factor == 'string' && !/^(?:=|true|false)/i.test($factor) ? (tmp = calc.parse(0, 0, 0, $factor), /^date|number|percent$/.test(tmp.type) ? ($factor = +tmp.value, true) : false) : false) || ($factor == null ? ($factor = 2, true) : false))) {\n                if ($factor instanceof CalcError)\n                    return $factor;\n                return new CalcError(err);\n            }\n            xargs.push($factor);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), DDB);\n\ndefineBuiltinFunction('SLN', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $cost = args[i++];\n            if ($cost instanceof CalcError)\n                return $cost;\n            if (!((typeof ($cost = this.force($cost)) == 'number' ? ($cost = limitPrecision($cost), true) : false) || (typeof $cost == 'boolean' ? ($cost = +$cost, true) : false) || (typeof $cost == 'string' && !/^(?:=|true|false)/i.test($cost) ? (tmp = calc.parse(0, 0, 0, $cost), /^date|number|percent$/.test(tmp.type) ? ($cost = +tmp.value, true) : false) : false))) {\n                if ($cost instanceof CalcError)\n                    return $cost;\n                return new CalcError(err);\n            }\n            xargs.push($cost);\n        }\n        {\n            var $salvage = args[i++];\n            if ($salvage instanceof CalcError)\n                return $salvage;\n            if (!((typeof ($salvage = this.force($salvage)) == 'number' ? ($salvage = limitPrecision($salvage), true) : false) || (typeof $salvage == 'boolean' ? ($salvage = +$salvage, true) : false) || (typeof $salvage == 'string' && !/^(?:=|true|false)/i.test($salvage) ? (tmp = calc.parse(0, 0, 0, $salvage), /^date|number|percent$/.test(tmp.type) ? ($salvage = +tmp.value, true) : false) : false))) {\n                if ($salvage instanceof CalcError)\n                    return $salvage;\n                return new CalcError(err);\n            }\n            xargs.push($salvage);\n        }\n        {\n            var $life = args[i++];\n            if ($life instanceof CalcError)\n                return $life;\n            if (!(((typeof ($life = this.force($life)) == 'number' ? ($life = limitPrecision($life), true) : false) || (typeof $life == 'boolean' ? ($life = +$life, true) : false) || (typeof $life == 'string' && !/^(?:=|true|false)/i.test($life) ? (tmp = calc.parse(0, 0, 0, $life), /^date|number|percent$/.test(tmp.type) ? ($life = +tmp.value, true) : false) : false)) && ($life > 0 ? true : (err = 'NUM', false)))) {\n                if ($life instanceof CalcError)\n                    return $life;\n                return new CalcError(err);\n            }\n            xargs.push($life);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), SLN);\n\ndefineBuiltinFunction('SYD', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $cost = args[i++];\n            if ($cost instanceof CalcError)\n                return $cost;\n            if (!((typeof ($cost = this.force($cost)) == 'number' ? ($cost = limitPrecision($cost), true) : false) || (typeof $cost == 'boolean' ? ($cost = +$cost, true) : false) || (typeof $cost == 'string' && !/^(?:=|true|false)/i.test($cost) ? (tmp = calc.parse(0, 0, 0, $cost), /^date|number|percent$/.test(tmp.type) ? ($cost = +tmp.value, true) : false) : false))) {\n                if ($cost instanceof CalcError)\n                    return $cost;\n                return new CalcError(err);\n            }\n            xargs.push($cost);\n        }\n        {\n            var $salvage = args[i++];\n            if ($salvage instanceof CalcError)\n                return $salvage;\n            if (!((typeof ($salvage = this.force($salvage)) == 'number' ? ($salvage = limitPrecision($salvage), true) : false) || (typeof $salvage == 'boolean' ? ($salvage = +$salvage, true) : false) || (typeof $salvage == 'string' && !/^(?:=|true|false)/i.test($salvage) ? (tmp = calc.parse(0, 0, 0, $salvage), /^date|number|percent$/.test(tmp.type) ? ($salvage = +tmp.value, true) : false) : false))) {\n                if ($salvage instanceof CalcError)\n                    return $salvage;\n                return new CalcError(err);\n            }\n            xargs.push($salvage);\n        }\n        {\n            var $life = args[i++];\n            if ($life instanceof CalcError)\n                return $life;\n            if (!(((typeof ($life = this.force($life)) == 'number' ? ($life = limitPrecision($life), true) : false) || (typeof $life == 'boolean' ? ($life = +$life, true) : false) || (typeof $life == 'string' && !/^(?:=|true|false)/i.test($life) ? (tmp = calc.parse(0, 0, 0, $life), /^date|number|percent$/.test(tmp.type) ? ($life = +tmp.value, true) : false) : false)) && ($life > 0 ? true : (err = 'NUM', false)))) {\n                if ($life instanceof CalcError)\n                    return $life;\n                return new CalcError(err);\n            }\n            xargs.push($life);\n        }\n        {\n            var $per = args[i++];\n            if ($per instanceof CalcError)\n                return $per;\n            if (!(((typeof ($per = this.force($per)) == 'number' ? ($per = limitPrecision($per), true) : false) || (typeof $per == 'boolean' ? ($per = +$per, true) : false) || (typeof $per == 'string' && !/^(?:=|true|false)/i.test($per) ? (tmp = calc.parse(0, 0, 0, $per), /^date|number|percent$/.test(tmp.type) ? ($per = +tmp.value, true) : false) : false)) && ($per > 0 ? true : (err = 'NUM', false)))) {\n                if ($per instanceof CalcError)\n                    return $per;\n                return new CalcError(err);\n            }\n            xargs.push($per);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), SYD);\n\ndefineBuiltinFunction('VDB', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $cost = args[i++];\n            if ($cost instanceof CalcError)\n                return $cost;\n            if (!(((typeof ($cost = this.force($cost)) == 'number' ? ($cost = limitPrecision($cost), true) : false) || (typeof $cost == 'boolean' ? ($cost = +$cost, true) : false) || (typeof $cost == 'string' && !/^(?:=|true|false)/i.test($cost) ? (tmp = calc.parse(0, 0, 0, $cost), /^date|number|percent$/.test(tmp.type) ? ($cost = +tmp.value, true) : false) : false)) && ($cost >= 0 ? true : (err = 'NUM', false)))) {\n                if ($cost instanceof CalcError)\n                    return $cost;\n                return new CalcError(err);\n            }\n            xargs.push($cost);\n        }\n        {\n            var $salvage = args[i++];\n            if ($salvage instanceof CalcError)\n                return $salvage;\n            if (!(((typeof ($salvage = this.force($salvage)) == 'number' ? ($salvage = limitPrecision($salvage), true) : false) || (typeof $salvage == 'boolean' ? ($salvage = +$salvage, true) : false) || (typeof $salvage == 'string' && !/^(?:=|true|false)/i.test($salvage) ? (tmp = calc.parse(0, 0, 0, $salvage), /^date|number|percent$/.test(tmp.type) ? ($salvage = +tmp.value, true) : false) : false)) && ($salvage >= 0 ? true : (err = 'NUM', false)))) {\n                if ($salvage instanceof CalcError)\n                    return $salvage;\n                return new CalcError(err);\n            }\n            xargs.push($salvage);\n        }\n        {\n            var $life = args[i++];\n            if ($life instanceof CalcError)\n                return $life;\n            if (!(((typeof ($life = this.force($life)) == 'number' ? ($life = limitPrecision($life), true) : false) || (typeof $life == 'boolean' ? ($life = +$life, true) : false) || (typeof $life == 'string' && !/^(?:=|true|false)/i.test($life) ? (tmp = calc.parse(0, 0, 0, $life), /^date|number|percent$/.test(tmp.type) ? ($life = +tmp.value, true) : false) : false)) && ($life > 0 ? true : (err = 'NUM', false)))) {\n                if ($life instanceof CalcError)\n                    return $life;\n                return new CalcError(err);\n            }\n            xargs.push($life);\n        }\n        {\n            var $start_period = args[i++];\n            if ($start_period instanceof CalcError)\n                return $start_period;\n            if (!(((typeof ($start_period = this.force($start_period)) == 'number' ? ($start_period = limitPrecision($start_period), true) : false) || (typeof $start_period == 'boolean' ? ($start_period = +$start_period, true) : false) || (typeof $start_period == 'string' && !/^(?:=|true|false)/i.test($start_period) ? (tmp = calc.parse(0, 0, 0, $start_period), /^date|number|percent$/.test(tmp.type) ? ($start_period = +tmp.value, true) : false) : false)) && ($start_period >= 0 ? true : (err = 'NUM', false)))) {\n                if ($start_period instanceof CalcError)\n                    return $start_period;\n                return new CalcError(err);\n            }\n            xargs.push($start_period);\n        }\n        {\n            var $end_period = args[i++];\n            if ($end_period instanceof CalcError)\n                return $end_period;\n            if (!(((typeof ($end_period = this.force($end_period)) == 'number' ? ($end_period = limitPrecision($end_period), true) : false) || (typeof $end_period == 'boolean' ? ($end_period = +$end_period, true) : false) || (typeof $end_period == 'string' && !/^(?:=|true|false)/i.test($end_period) ? (tmp = calc.parse(0, 0, 0, $end_period), /^date|number|percent$/.test(tmp.type) ? ($end_period = +tmp.value, true) : false) : false)) && ($end_period >= 0 ? true : (err = 'NUM', false)))) {\n                if ($end_period instanceof CalcError)\n                    return $end_period;\n                return new CalcError(err);\n            }\n            xargs.push($end_period);\n        }\n        {\n            var $factor = args[i++];\n            if ($factor instanceof CalcError)\n                return $factor;\n            if (!(((typeof ($factor = this.force($factor)) == 'number' ? ($factor = limitPrecision($factor), true) : false) || (typeof $factor == 'boolean' ? ($factor = +$factor, true) : false) || (typeof $factor == 'string' && !/^(?:=|true|false)/i.test($factor) ? (tmp = calc.parse(0, 0, 0, $factor), /^date|number|percent$/.test(tmp.type) ? ($factor = +tmp.value, true) : false) : false)) && ($factor >= 0 ? true : (err = 'NUM', false)) || ($factor == null ? ($factor = 2, true) : false))) {\n                if ($factor instanceof CalcError)\n                    return $factor;\n                return new CalcError(err);\n            }\n            xargs.push($factor);\n        }\n        {\n            var $no_switch = args[i++];\n            if ($no_switch instanceof CalcError)\n                return $no_switch;\n            if (!(typeof ($no_switch = this.force($no_switch)) == 'boolean' || (typeof $no_switch == 'number' ? ($no_switch = !!$no_switch, true) : false) || ($no_switch == null ? ($no_switch = false, true) : false))) {\n                if ($no_switch instanceof CalcError)\n                    return $no_switch;\n                return new CalcError(err);\n            }\n            xargs.push($no_switch);\n        }\n        {\n            if (!($end_period >= $start_period ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), VDB);\n\ndefineBuiltinFunction('COUPDAYBS', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $settlement = args[i++];\n            if ($settlement instanceof CalcError)\n                return $settlement;\n            if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                if ($settlement instanceof CalcError)\n                    return $settlement;\n                return new CalcError(err);\n            }\n            xargs.push($settlement);\n        }\n        {\n            var $maturity = args[i++];\n            if ($maturity instanceof CalcError)\n                return $maturity;\n            if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                if ($maturity instanceof CalcError)\n                    return $maturity;\n                return new CalcError(err);\n            }\n            xargs.push($maturity);\n        }\n        {\n            var $frequency = args[i++];\n            if ($frequency instanceof CalcError)\n                return $frequency;\n            if (!((typeof ($frequency = this.force($frequency)) == 'number' || (typeof $frequency == 'boolean' ? ($frequency = +$frequency, true) : false) || (typeof $frequency == 'string' && !/^(?:=|true|false)/i.test($frequency) ? (tmp = calc.parse(0, 0, 0, $frequency), /^date|number|percent$/.test(tmp.type) ? ($frequency = +tmp.value, true) : false) : false)) && ($frequency |= 0, true) && ($frequency === 1 || $frequency === 2 || $frequency === 4))) {\n                if ($frequency instanceof CalcError)\n                    return $frequency;\n                return new CalcError(err);\n            }\n            xargs.push($frequency);\n        }\n        {\n            var $basis = args[i++];\n            if ($basis instanceof CalcError)\n                return $basis;\n            if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                if ($basis instanceof CalcError)\n                    return $basis;\n                return new CalcError(err);\n            }\n            xargs.push($basis);\n        }\n        {\n            if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), COUPDAYBS);\n\ndefineBuiltinFunction('COUPDAYS', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $settlement = args[i++];\n            if ($settlement instanceof CalcError)\n                return $settlement;\n            if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                if ($settlement instanceof CalcError)\n                    return $settlement;\n                return new CalcError(err);\n            }\n            xargs.push($settlement);\n        }\n        {\n            var $maturity = args[i++];\n            if ($maturity instanceof CalcError)\n                return $maturity;\n            if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                if ($maturity instanceof CalcError)\n                    return $maturity;\n                return new CalcError(err);\n            }\n            xargs.push($maturity);\n        }\n        {\n            var $frequency = args[i++];\n            if ($frequency instanceof CalcError)\n                return $frequency;\n            if (!((typeof ($frequency = this.force($frequency)) == 'number' || (typeof $frequency == 'boolean' ? ($frequency = +$frequency, true) : false) || (typeof $frequency == 'string' && !/^(?:=|true|false)/i.test($frequency) ? (tmp = calc.parse(0, 0, 0, $frequency), /^date|number|percent$/.test(tmp.type) ? ($frequency = +tmp.value, true) : false) : false)) && ($frequency |= 0, true) && ($frequency === 1 || $frequency === 2 || $frequency === 4))) {\n                if ($frequency instanceof CalcError)\n                    return $frequency;\n                return new CalcError(err);\n            }\n            xargs.push($frequency);\n        }\n        {\n            var $basis = args[i++];\n            if ($basis instanceof CalcError)\n                return $basis;\n            if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                if ($basis instanceof CalcError)\n                    return $basis;\n                return new CalcError(err);\n            }\n            xargs.push($basis);\n        }\n        {\n            if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), COUPDAYS);\n\ndefineBuiltinFunction('COUPDAYSNC', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $settlement = args[i++];\n            if ($settlement instanceof CalcError)\n                return $settlement;\n            if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                if ($settlement instanceof CalcError)\n                    return $settlement;\n                return new CalcError(err);\n            }\n            xargs.push($settlement);\n        }\n        {\n            var $maturity = args[i++];\n            if ($maturity instanceof CalcError)\n                return $maturity;\n            if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                if ($maturity instanceof CalcError)\n                    return $maturity;\n                return new CalcError(err);\n            }\n            xargs.push($maturity);\n        }\n        {\n            var $frequency = args[i++];\n            if ($frequency instanceof CalcError)\n                return $frequency;\n            if (!((typeof ($frequency = this.force($frequency)) == 'number' || (typeof $frequency == 'boolean' ? ($frequency = +$frequency, true) : false) || (typeof $frequency == 'string' && !/^(?:=|true|false)/i.test($frequency) ? (tmp = calc.parse(0, 0, 0, $frequency), /^date|number|percent$/.test(tmp.type) ? ($frequency = +tmp.value, true) : false) : false)) && ($frequency |= 0, true) && ($frequency === 1 || $frequency === 2 || $frequency === 4))) {\n                if ($frequency instanceof CalcError)\n                    return $frequency;\n                return new CalcError(err);\n            }\n            xargs.push($frequency);\n        }\n        {\n            var $basis = args[i++];\n            if ($basis instanceof CalcError)\n                return $basis;\n            if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                if ($basis instanceof CalcError)\n                    return $basis;\n                return new CalcError(err);\n            }\n            xargs.push($basis);\n        }\n        {\n            if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), COUPDAYSNC);\n\ndefineBuiltinFunction('COUPPCD', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $settlement = args[i++];\n            if ($settlement instanceof CalcError)\n                return $settlement;\n            if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                if ($settlement instanceof CalcError)\n                    return $settlement;\n                return new CalcError(err);\n            }\n            xargs.push($settlement);\n        }\n        {\n            var $maturity = args[i++];\n            if ($maturity instanceof CalcError)\n                return $maturity;\n            if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                if ($maturity instanceof CalcError)\n                    return $maturity;\n                return new CalcError(err);\n            }\n            xargs.push($maturity);\n        }\n        {\n            var $frequency = args[i++];\n            if ($frequency instanceof CalcError)\n                return $frequency;\n            if (!((typeof ($frequency = this.force($frequency)) == 'number' || (typeof $frequency == 'boolean' ? ($frequency = +$frequency, true) : false) || (typeof $frequency == 'string' && !/^(?:=|true|false)/i.test($frequency) ? (tmp = calc.parse(0, 0, 0, $frequency), /^date|number|percent$/.test(tmp.type) ? ($frequency = +tmp.value, true) : false) : false)) && ($frequency |= 0, true) && ($frequency === 1 || $frequency === 2 || $frequency === 4))) {\n                if ($frequency instanceof CalcError)\n                    return $frequency;\n                return new CalcError(err);\n            }\n            xargs.push($frequency);\n        }\n        {\n            var $basis = args[i++];\n            if ($basis instanceof CalcError)\n                return $basis;\n            if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                if ($basis instanceof CalcError)\n                    return $basis;\n                return new CalcError(err);\n            }\n            xargs.push($basis);\n        }\n        {\n            if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), COUPPCD);\n\ndefineBuiltinFunction('COUPNCD', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $settlement = args[i++];\n            if ($settlement instanceof CalcError)\n                return $settlement;\n            if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                if ($settlement instanceof CalcError)\n                    return $settlement;\n                return new CalcError(err);\n            }\n            xargs.push($settlement);\n        }\n        {\n            var $maturity = args[i++];\n            if ($maturity instanceof CalcError)\n                return $maturity;\n            if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                if ($maturity instanceof CalcError)\n                    return $maturity;\n                return new CalcError(err);\n            }\n            xargs.push($maturity);\n        }\n        {\n            var $frequency = args[i++];\n            if ($frequency instanceof CalcError)\n                return $frequency;\n            if (!((typeof ($frequency = this.force($frequency)) == 'number' || (typeof $frequency == 'boolean' ? ($frequency = +$frequency, true) : false) || (typeof $frequency == 'string' && !/^(?:=|true|false)/i.test($frequency) ? (tmp = calc.parse(0, 0, 0, $frequency), /^date|number|percent$/.test(tmp.type) ? ($frequency = +tmp.value, true) : false) : false)) && ($frequency |= 0, true) && ($frequency === 1 || $frequency === 2 || $frequency === 4))) {\n                if ($frequency instanceof CalcError)\n                    return $frequency;\n                return new CalcError(err);\n            }\n            xargs.push($frequency);\n        }\n        {\n            var $basis = args[i++];\n            if ($basis instanceof CalcError)\n                return $basis;\n            if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                if ($basis instanceof CalcError)\n                    return $basis;\n                return new CalcError(err);\n            }\n            xargs.push($basis);\n        }\n        {\n            if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), COUPNCD);\n\ndefineBuiltinFunction('COUPNUM', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $settlement = args[i++];\n            if ($settlement instanceof CalcError)\n                return $settlement;\n            if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                if ($settlement instanceof CalcError)\n                    return $settlement;\n                return new CalcError(err);\n            }\n            xargs.push($settlement);\n        }\n        {\n            var $maturity = args[i++];\n            if ($maturity instanceof CalcError)\n                return $maturity;\n            if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                if ($maturity instanceof CalcError)\n                    return $maturity;\n                return new CalcError(err);\n            }\n            xargs.push($maturity);\n        }\n        {\n            var $frequency = args[i++];\n            if ($frequency instanceof CalcError)\n                return $frequency;\n            if (!((typeof ($frequency = this.force($frequency)) == 'number' || (typeof $frequency == 'boolean' ? ($frequency = +$frequency, true) : false) || (typeof $frequency == 'string' && !/^(?:=|true|false)/i.test($frequency) ? (tmp = calc.parse(0, 0, 0, $frequency), /^date|number|percent$/.test(tmp.type) ? ($frequency = +tmp.value, true) : false) : false)) && ($frequency |= 0, true) && ($frequency === 1 || $frequency === 2 || $frequency === 4))) {\n                if ($frequency instanceof CalcError)\n                    return $frequency;\n                return new CalcError(err);\n            }\n            xargs.push($frequency);\n        }\n        {\n            var $basis = args[i++];\n            if ($basis instanceof CalcError)\n                return $basis;\n            if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                if ($basis instanceof CalcError)\n                    return $basis;\n                return new CalcError(err);\n            }\n            xargs.push($basis);\n        }\n        {\n            if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), COUPNUM);\n\ndefineBuiltinFunction('ACCRINTM', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $issue = args[i++];\n            if ($issue instanceof CalcError)\n                return $issue;\n            if (!((typeof ($issue = this.force($issue)) == 'number' || (typeof $issue == 'boolean' ? ($issue = +$issue, true) : false) || (typeof $issue == 'string' && !/^(?:=|true|false)/i.test($issue) ? (tmp = calc.parse(0, 0, 0, $issue), /^date|number|percent$/.test(tmp.type) ? ($issue = +tmp.value, true) : false) : false)) && ($issue |= 0, true))) {\n                if ($issue instanceof CalcError)\n                    return $issue;\n                return new CalcError(err);\n            }\n            xargs.push($issue);\n        }\n        {\n            var $settlement = args[i++];\n            if ($settlement instanceof CalcError)\n                return $settlement;\n            if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                if ($settlement instanceof CalcError)\n                    return $settlement;\n                return new CalcError(err);\n            }\n            xargs.push($settlement);\n        }\n        {\n            var $rate = args[i++];\n            if ($rate instanceof CalcError)\n                return $rate;\n            if (!(((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false)) && ($rate > 0 ? true : (err = 'NUM', false)))) {\n                if ($rate instanceof CalcError)\n                    return $rate;\n                return new CalcError(err);\n            }\n            xargs.push($rate);\n        }\n        {\n            var $par = args[i++];\n            if ($par instanceof CalcError)\n                return $par;\n            if (!((($par = this.force($par)) == null ? ($par = 1000, true) : false) || ((typeof $par == 'number' ? ($par = limitPrecision($par), true) : false) || (typeof $par == 'boolean' ? ($par = +$par, true) : false) || (typeof $par == 'string' && !/^(?:=|true|false)/i.test($par) ? (tmp = calc.parse(0, 0, 0, $par), /^date|number|percent$/.test(tmp.type) ? ($par = +tmp.value, true) : false) : false)) && ($par > 0 ? true : (err = 'NUM', false)))) {\n                if ($par instanceof CalcError)\n                    return $par;\n                return new CalcError(err);\n            }\n            xargs.push($par);\n        }\n        {\n            var $basis = args[i++];\n            if ($basis instanceof CalcError)\n                return $basis;\n            if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                if ($basis instanceof CalcError)\n                    return $basis;\n                return new CalcError(err);\n            }\n            xargs.push($basis);\n        }\n        {\n            if (!($issue < $settlement ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), ACCRINTM);\n\ndefineBuiltinFunction('ACCRINT', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $issue = args[i++];\n            if ($issue instanceof CalcError)\n                return $issue;\n            if (!((typeof ($issue = this.force($issue)) == 'number' || (typeof $issue == 'boolean' ? ($issue = +$issue, true) : false) || (typeof $issue == 'string' && !/^(?:=|true|false)/i.test($issue) ? (tmp = calc.parse(0, 0, 0, $issue), /^date|number|percent$/.test(tmp.type) ? ($issue = +tmp.value, true) : false) : false)) && ($issue |= 0, true))) {\n                if ($issue instanceof CalcError)\n                    return $issue;\n                return new CalcError(err);\n            }\n            xargs.push($issue);\n        }\n        {\n            var $first_interest = args[i++];\n            if ($first_interest instanceof CalcError)\n                return $first_interest;\n            if (!((typeof ($first_interest = this.force($first_interest)) == 'number' || (typeof $first_interest == 'boolean' ? ($first_interest = +$first_interest, true) : false) || (typeof $first_interest == 'string' && !/^(?:=|true|false)/i.test($first_interest) ? (tmp = calc.parse(0, 0, 0, $first_interest), /^date|number|percent$/.test(tmp.type) ? ($first_interest = +tmp.value, true) : false) : false)) && ($first_interest |= 0, true))) {\n                if ($first_interest instanceof CalcError)\n                    return $first_interest;\n                return new CalcError(err);\n            }\n            xargs.push($first_interest);\n        }\n        {\n            var $settlement = args[i++];\n            if ($settlement instanceof CalcError)\n                return $settlement;\n            if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                if ($settlement instanceof CalcError)\n                    return $settlement;\n                return new CalcError(err);\n            }\n            xargs.push($settlement);\n        }\n        {\n            var $rate = args[i++];\n            if ($rate instanceof CalcError)\n                return $rate;\n            if (!(((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false)) && ($rate > 0 ? true : (err = 'NUM', false)))) {\n                if ($rate instanceof CalcError)\n                    return $rate;\n                return new CalcError(err);\n            }\n            xargs.push($rate);\n        }\n        {\n            var $par = args[i++];\n            if ($par instanceof CalcError)\n                return $par;\n            if (!((($par = this.force($par)) == null ? ($par = 1000, true) : false) || ((typeof $par == 'number' ? ($par = limitPrecision($par), true) : false) || (typeof $par == 'boolean' ? ($par = +$par, true) : false) || (typeof $par == 'string' && !/^(?:=|true|false)/i.test($par) ? (tmp = calc.parse(0, 0, 0, $par), /^date|number|percent$/.test(tmp.type) ? ($par = +tmp.value, true) : false) : false)) && ($par > 0 ? true : (err = 'NUM', false)))) {\n                if ($par instanceof CalcError)\n                    return $par;\n                return new CalcError(err);\n            }\n            xargs.push($par);\n        }\n        {\n            var $frequency = args[i++];\n            if ($frequency instanceof CalcError)\n                return $frequency;\n            if (!((typeof ($frequency = this.force($frequency)) == 'number' || (typeof $frequency == 'boolean' ? ($frequency = +$frequency, true) : false) || (typeof $frequency == 'string' && !/^(?:=|true|false)/i.test($frequency) ? (tmp = calc.parse(0, 0, 0, $frequency), /^date|number|percent$/.test(tmp.type) ? ($frequency = +tmp.value, true) : false) : false)) && ($frequency |= 0, true) && ($frequency === 1 || $frequency === 2 || $frequency === 4))) {\n                if ($frequency instanceof CalcError)\n                    return $frequency;\n                return new CalcError(err);\n            }\n            xargs.push($frequency);\n        }\n        {\n            var $basis = args[i++];\n            if ($basis instanceof CalcError)\n                return $basis;\n            if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                if ($basis instanceof CalcError)\n                    return $basis;\n                return new CalcError(err);\n            }\n            xargs.push($basis);\n        }\n        {\n            var $calc_method = args[i++];\n            if ($calc_method instanceof CalcError)\n                return $calc_method;\n            if (!(typeof ($calc_method = this.force($calc_method)) == 'boolean' || (typeof $calc_method == 'number' ? ($calc_method = !!$calc_method, true) : false) || ($calc_method == null ? ($calc_method = true, true) : false))) {\n                if ($calc_method instanceof CalcError)\n                    return $calc_method;\n                return new CalcError(err);\n            }\n            xargs.push($calc_method);\n        }\n        {\n            if (!($issue < $settlement ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), ACCRINT);\n\ndefineBuiltinFunction('DISC', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $settlement = args[i++];\n            if ($settlement instanceof CalcError)\n                return $settlement;\n            if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                if ($settlement instanceof CalcError)\n                    return $settlement;\n                return new CalcError(err);\n            }\n            xargs.push($settlement);\n        }\n        {\n            var $maturity = args[i++];\n            if ($maturity instanceof CalcError)\n                return $maturity;\n            if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                if ($maturity instanceof CalcError)\n                    return $maturity;\n                return new CalcError(err);\n            }\n            xargs.push($maturity);\n        }\n        {\n            var $pr = args[i++];\n            if ($pr instanceof CalcError)\n                return $pr;\n            if (!(((typeof ($pr = this.force($pr)) == 'number' ? ($pr = limitPrecision($pr), true) : false) || (typeof $pr == 'boolean' ? ($pr = +$pr, true) : false) || (typeof $pr == 'string' && !/^(?:=|true|false)/i.test($pr) ? (tmp = calc.parse(0, 0, 0, $pr), /^date|number|percent$/.test(tmp.type) ? ($pr = +tmp.value, true) : false) : false)) && ($pr > 0 ? true : (err = 'NUM', false)))) {\n                if ($pr instanceof CalcError)\n                    return $pr;\n                return new CalcError(err);\n            }\n            xargs.push($pr);\n        }\n        {\n            var $redemption = args[i++];\n            if ($redemption instanceof CalcError)\n                return $redemption;\n            if (!(((typeof ($redemption = this.force($redemption)) == 'number' ? ($redemption = limitPrecision($redemption), true) : false) || (typeof $redemption == 'boolean' ? ($redemption = +$redemption, true) : false) || (typeof $redemption == 'string' && !/^(?:=|true|false)/i.test($redemption) ? (tmp = calc.parse(0, 0, 0, $redemption), /^date|number|percent$/.test(tmp.type) ? ($redemption = +tmp.value, true) : false) : false)) && ($redemption > 0 ? true : (err = 'NUM', false)))) {\n                if ($redemption instanceof CalcError)\n                    return $redemption;\n                return new CalcError(err);\n            }\n            xargs.push($redemption);\n        }\n        {\n            var $basis = args[i++];\n            if ($basis instanceof CalcError)\n                return $basis;\n            if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                if ($basis instanceof CalcError)\n                    return $basis;\n                return new CalcError(err);\n            }\n            xargs.push($basis);\n        }\n        {\n            if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), DISC);\n\ndefineBuiltinFunction('INTRATE', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $settlement = args[i++];\n            if ($settlement instanceof CalcError)\n                return $settlement;\n            if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                if ($settlement instanceof CalcError)\n                    return $settlement;\n                return new CalcError(err);\n            }\n            xargs.push($settlement);\n        }\n        {\n            var $maturity = args[i++];\n            if ($maturity instanceof CalcError)\n                return $maturity;\n            if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                if ($maturity instanceof CalcError)\n                    return $maturity;\n                return new CalcError(err);\n            }\n            xargs.push($maturity);\n        }\n        {\n            var $investment = args[i++];\n            if ($investment instanceof CalcError)\n                return $investment;\n            if (!(((typeof ($investment = this.force($investment)) == 'number' ? ($investment = limitPrecision($investment), true) : false) || (typeof $investment == 'boolean' ? ($investment = +$investment, true) : false) || (typeof $investment == 'string' && !/^(?:=|true|false)/i.test($investment) ? (tmp = calc.parse(0, 0, 0, $investment), /^date|number|percent$/.test(tmp.type) ? ($investment = +tmp.value, true) : false) : false)) && ($investment > 0 ? true : (err = 'NUM', false)))) {\n                if ($investment instanceof CalcError)\n                    return $investment;\n                return new CalcError(err);\n            }\n            xargs.push($investment);\n        }\n        {\n            var $redemption = args[i++];\n            if ($redemption instanceof CalcError)\n                return $redemption;\n            if (!(((typeof ($redemption = this.force($redemption)) == 'number' ? ($redemption = limitPrecision($redemption), true) : false) || (typeof $redemption == 'boolean' ? ($redemption = +$redemption, true) : false) || (typeof $redemption == 'string' && !/^(?:=|true|false)/i.test($redemption) ? (tmp = calc.parse(0, 0, 0, $redemption), /^date|number|percent$/.test(tmp.type) ? ($redemption = +tmp.value, true) : false) : false)) && ($redemption > 0 ? true : (err = 'NUM', false)))) {\n                if ($redemption instanceof CalcError)\n                    return $redemption;\n                return new CalcError(err);\n            }\n            xargs.push($redemption);\n        }\n        {\n            var $basis = args[i++];\n            if ($basis instanceof CalcError)\n                return $basis;\n            if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                if ($basis instanceof CalcError)\n                    return $basis;\n                return new CalcError(err);\n            }\n            xargs.push($basis);\n        }\n        {\n            if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), INTRATE);\n\ndefineBuiltinFunction('RECEIVED', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $settlement = args[i++];\n            if ($settlement instanceof CalcError)\n                return $settlement;\n            if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                if ($settlement instanceof CalcError)\n                    return $settlement;\n                return new CalcError(err);\n            }\n            xargs.push($settlement);\n        }\n        {\n            var $maturity = args[i++];\n            if ($maturity instanceof CalcError)\n                return $maturity;\n            if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                if ($maturity instanceof CalcError)\n                    return $maturity;\n                return new CalcError(err);\n            }\n            xargs.push($maturity);\n        }\n        {\n            var $investment = args[i++];\n            if ($investment instanceof CalcError)\n                return $investment;\n            if (!(((typeof ($investment = this.force($investment)) == 'number' ? ($investment = limitPrecision($investment), true) : false) || (typeof $investment == 'boolean' ? ($investment = +$investment, true) : false) || (typeof $investment == 'string' && !/^(?:=|true|false)/i.test($investment) ? (tmp = calc.parse(0, 0, 0, $investment), /^date|number|percent$/.test(tmp.type) ? ($investment = +tmp.value, true) : false) : false)) && ($investment > 0 ? true : (err = 'NUM', false)))) {\n                if ($investment instanceof CalcError)\n                    return $investment;\n                return new CalcError(err);\n            }\n            xargs.push($investment);\n        }\n        {\n            var $discount = args[i++];\n            if ($discount instanceof CalcError)\n                return $discount;\n            if (!(((typeof ($discount = this.force($discount)) == 'number' ? ($discount = limitPrecision($discount), true) : false) || (typeof $discount == 'boolean' ? ($discount = +$discount, true) : false) || (typeof $discount == 'string' && !/^(?:=|true|false)/i.test($discount) ? (tmp = calc.parse(0, 0, 0, $discount), /^date|number|percent$/.test(tmp.type) ? ($discount = +tmp.value, true) : false) : false)) && ($discount > 0 ? true : (err = 'NUM', false)))) {\n                if ($discount instanceof CalcError)\n                    return $discount;\n                return new CalcError(err);\n            }\n            xargs.push($discount);\n        }\n        {\n            var $basis = args[i++];\n            if ($basis instanceof CalcError)\n                return $basis;\n            if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                if ($basis instanceof CalcError)\n                    return $basis;\n                return new CalcError(err);\n            }\n            xargs.push($basis);\n        }\n        {\n            if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), RECEIVED);\n\ndefineBuiltinFunction('PRICE', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $settlement = args[i++];\n            if ($settlement instanceof CalcError)\n                return $settlement;\n            if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                if ($settlement instanceof CalcError)\n                    return $settlement;\n                return new CalcError(err);\n            }\n            xargs.push($settlement);\n        }\n        {\n            var $maturity = args[i++];\n            if ($maturity instanceof CalcError)\n                return $maturity;\n            if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                if ($maturity instanceof CalcError)\n                    return $maturity;\n                return new CalcError(err);\n            }\n            xargs.push($maturity);\n        }\n        {\n            var $rate = args[i++];\n            if ($rate instanceof CalcError)\n                return $rate;\n            if (!(((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false)) && ($rate > 0 ? true : (err = 'NUM', false)))) {\n                if ($rate instanceof CalcError)\n                    return $rate;\n                return new CalcError(err);\n            }\n            xargs.push($rate);\n        }\n        {\n            var $yld = args[i++];\n            if ($yld instanceof CalcError)\n                return $yld;\n            if (!(((typeof ($yld = this.force($yld)) == 'number' ? ($yld = limitPrecision($yld), true) : false) || (typeof $yld == 'boolean' ? ($yld = +$yld, true) : false) || (typeof $yld == 'string' && !/^(?:=|true|false)/i.test($yld) ? (tmp = calc.parse(0, 0, 0, $yld), /^date|number|percent$/.test(tmp.type) ? ($yld = +tmp.value, true) : false) : false)) && ($yld > 0 ? true : (err = 'NUM', false)))) {\n                if ($yld instanceof CalcError)\n                    return $yld;\n                return new CalcError(err);\n            }\n            xargs.push($yld);\n        }\n        {\n            var $redemption = args[i++];\n            if ($redemption instanceof CalcError)\n                return $redemption;\n            if (!(((typeof ($redemption = this.force($redemption)) == 'number' ? ($redemption = limitPrecision($redemption), true) : false) || (typeof $redemption == 'boolean' ? ($redemption = +$redemption, true) : false) || (typeof $redemption == 'string' && !/^(?:=|true|false)/i.test($redemption) ? (tmp = calc.parse(0, 0, 0, $redemption), /^date|number|percent$/.test(tmp.type) ? ($redemption = +tmp.value, true) : false) : false)) && ($redemption > 0 ? true : (err = 'NUM', false)))) {\n                if ($redemption instanceof CalcError)\n                    return $redemption;\n                return new CalcError(err);\n            }\n            xargs.push($redemption);\n        }\n        {\n            var $frequency = args[i++];\n            if ($frequency instanceof CalcError)\n                return $frequency;\n            if (!((typeof ($frequency = this.force($frequency)) == 'number' || (typeof $frequency == 'boolean' ? ($frequency = +$frequency, true) : false) || (typeof $frequency == 'string' && !/^(?:=|true|false)/i.test($frequency) ? (tmp = calc.parse(0, 0, 0, $frequency), /^date|number|percent$/.test(tmp.type) ? ($frequency = +tmp.value, true) : false) : false)) && ($frequency |= 0, true) && ($frequency === 1 || $frequency === 2 || $frequency === 4))) {\n                if ($frequency instanceof CalcError)\n                    return $frequency;\n                return new CalcError(err);\n            }\n            xargs.push($frequency);\n        }\n        {\n            var $basis = args[i++];\n            if ($basis instanceof CalcError)\n                return $basis;\n            if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                if ($basis instanceof CalcError)\n                    return $basis;\n                return new CalcError(err);\n            }\n            xargs.push($basis);\n        }\n        {\n            if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), PRICE);\n\ndefineBuiltinFunction('PRICEDISC', false, function () {\n    function check(args) {\n        var tmp, xargs = [], i = 0, err = 'VALUE';\n        {\n            var $settlement = args[i++];\n            if ($settlement instanceof CalcError)\n                return $settlement;\n            if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                if ($settlement instanceof CalcError)\n                    return $settlement;\n                return new CalcError(err);\n            }\n            xargs.push($settlement);\n        }\n        {\n            var $maturity = args[i++];\n            if ($maturity instanceof CalcError)\n                return $maturity;\n            if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                if ($maturity instanceof CalcError)\n                    return $maturity;\n                return new CalcError(err);\n            }\n            xargs.push($maturity);\n        }\n        {\n            var $discount = args[i++];\n            if ($discount instanceof CalcError)\n                return $discount;\n            if (!(((typeof ($discount = this.force($discount)) == 'number' ? ($discount = limitPrecision($discount), true) : false) || (typeof $discount == 'boolean' ? ($discount = +$discount, true) : false) || (typeof $discount == 'string' && !/^(?:=|true|false)/i.test($discount) ? (tmp = calc.parse(0, 0, 0, $discount), /^date|number|percent$/.test(tmp.type) ? ($discount = +tmp.value, true) : false) : false)) && ($discount > 0 ? true : (err = 'NUM', false)))) {\n                if ($discount instanceof CalcError)\n                    return $discount;\n                return new CalcError(err);\n            }\n            xargs.push($discount);\n        }\n        {\n            var $redemption = args[i++];\n            if ($redemption instanceof CalcError)\n                return $redemption;\n            if (!(((typeof ($redemption = this.force($redemption)) == 'number' ? ($redemption = limitPrecision($redemption), true) : false) || (typeof $redemption == 'boolean' ? ($redemption = +$redemption, true) : false) || (typeof $redemption == 'string' && !/^(?:=|true|false)/i.test($redemption) ? (tmp = calc.parse(0, 0, 0, $redemption), /^date|number|percent$/.test(tmp.type) ? ($redemption = +tmp.value, true) : false) : false)) && ($redemption > 0 ? true : (err = 'NUM', false)))) {\n                if ($redemption instanceof CalcError)\n                    return $redemption;\n                return new CalcError(err);\n            }\n            xargs.push($redemption);\n        }\n        {\n            var $basis = args[i++];\n            if ($basis instanceof CalcError)\n                return $basis;\n            if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                if ($basis instanceof CalcError)\n                    return $basis;\n                return new CalcError(err);\n            }\n            xargs.push($basis);\n        }\n        {\n            if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                return new CalcError(err);\n        }\n        if (i < args.length)\n            return new CalcError('N/A');\n        return xargs;\n    }\n    function resolve(args, callback) {\n        var toResolve = [], i = 0;\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        toResolve.push(args[i++]);\n        this.resolveCells(toResolve, callback);\n    }\n    return {\n        check: check,\n        resolve: resolve\n    };\n}(), PRICEDISC);\n\n/* -----[ utils ]----- */\n\n// function resultAsMatrix(f) {\n//     return function() {\n//         var a = f.apply(this, arguments);\n//         return this.asMatrix(a);\n//     };\n// }\n\n/* -----[ definitions: statistical functions ]----- */\n\nvar MAX_IT = 300,     // Maximum allowed number of iterations\n    EPS = 2.2204e-16, // Relative accuracy; 1-3*(4/3-1) = 2.220446049250313e-16\n    FP_MIN = 1.0e-30, // Near the smallest representable as floating-point, number.\n    f_abs = Math.abs;\n\nfunction ERF(x) {\n    if (f_abs(x) >= 3.3) {\n        return 1 - ERFC(x);\n    }\n    var S = x > 0 ? 1 : -1;\n    if (S == -1) {\n        x = -x;\n    }\n    var m = 0, an = 1;\n    for (var n = 1; n < 100; n++) {\n        m += an;\n        an *= 2*x*x/(2*n+1);\n    }\n    return S*2/Math.sqrt(Math.PI)*x*Math.exp(-x*x)*m;\n}\n\nfunction ERFC(x) {\n    if (f_abs(x) < 3.3) {\n        return 1 - ERF(x);\n    }\n    var s = 1;\n    if (x < 0) {\n        s = -1;\n        x = -x;\n    }\n    var frac = x;\n    for (var n = 8; n >= 1; n -= 0.5) {\n        frac = x + n/frac;\n    }\n    frac = 1 / (x + frac);\n    return s == 1\n        ? Math.exp(-x*x)/Math.sqrt(Math.PI)*frac\n        : 2 - Math.exp(-x*x)/Math.sqrt(Math.PI)*frac;\n}\n\nfunction GAMMALN(x) { // Returns the value ln[Γ(x)] for x > 0.\n    var cof = [\n        1.000000000190015, 76.18009172947146, -86.50532032941677,\n        24.01409824083091, -1.231739572450155, 0.1208650973866179e-2, -0.5395239384953e-5\n    ];\n    var y = x, tmp = x + 5.5, ser = cof[0];\n    tmp -= (x + 0.5) * Math.log(tmp);\n    for (var j = 1; j <= 6; j++) {\n        y += 1;\n        ser += cof[j] / y;\n    }\n    return -tmp + Math.log(Math.sqrt(2*Math.PI) * ser / x); // log(Γ(x)) = log(Γ(x+1)) - log(x)\n}\n\nfunction GAMMA(x) { // returns Infinity for 0 or negative _integer argument.\n    if (x > 0) {\n        return Math.exp(GAMMALN(x));\n    }\n    var pi = Math.PI, y = -x; // For x<0 we use the reflection formula: Γ(x)Γ(1-x) = PI / sin(PI*x)\n    return -pi / (y*GAMMA(y)*Math.sin(pi*y));\n}\n\nfunction BETALN(a, b) {\n    return GAMMALN(a) + GAMMALN(b) - GAMMALN(a+b);\n}\n\nfunction BETA(a, b) {\n    return Math.exp(BETALN(a, b));\n}\n\nfunction gamma_inc(a, x) { // returns the normalized incomplete gamma function P(a, x); x > 0.\n    return x < a+1.0 ? g_series(a, x) : 1 - g_contfrac(a, x);\n}\n\nfunction g_series(a, x) { // evaluate P(a, x) by its series representation (converges quickly for x < a+1).\n    var sum = 1/a,\n        frac = sum,\n        ap = a;\n    var gln = GAMMALN(a), n;\n    for (n = 1; n <= MAX_IT; n++) {\n        ap++;\n        frac *= x/ap;\n        sum += frac;\n        if (f_abs(frac) < f_abs(sum)*EPS) {\n            break; // already the last frac is too small versus the current sum value\n        }\n    }\n    return sum * Math.exp(-x + a*Math.log(x) - gln); // e^{-x} * x^a * Γ(a) * sum\n}\n\nfunction g_contfrac(a, x) { // Q(a, x) by its continued fraction representation (converges quickly for x > a + 1); modified Lentz’s method (Numerical Recipes (The Art of Scientific Computing), 2rd Edition $5.2)\n    var f = FP_MIN, c = f, d = 0, aj = 1, bj = x + 1 - a;\n    var gln = GAMMALN(a);\n    for (var i = 1; i <= MAX_IT; i++) {\n        d = bj + aj * d;\n        if (f_abs(d) < FP_MIN) {\n            d = FP_MIN;\n        }\n        c = bj + aj / c;\n        if (f_abs(c) < FP_MIN) {\n            c = FP_MIN;\n        }\n        d = 1 / d;\n        var delta = c * d;\n        f *= delta;\n        if (f_abs(delta - 1) < EPS) {\n            break;\n        }\n        bj += 2;\n        aj = -i * (i - a);\n    }\n    return f * Math.exp(-x - gln + a * Math.log(x));\n}\n\nfunction GAMMA_DIST(x, a, b, cumulative) { // a > 0, b > 0; x >= 0\n    if (!cumulative) {\n        return Math.pow(x/b, a-1)*Math.exp(-x/b)/(b*GAMMA(a)); // the PDF of the Gamma distribution\n    }\n    return gamma_inc(a, x/b); // (else) compute the CDF (using the incomplete Gamma function)\n}\n\nfunction GAMMA_INV(p, a, b) { // the quantile function of the Gamma distribution\n    if (p === 0) {\n        return 0;\n    }\n    if (p == 1) {\n        return Infinity;\n    }\n    var m = 0, M = 10, x = 0, ab = a*b;\n    if (ab > 1) {\n        M *= ab;\n    }\n    for (var i = 0; i < MAX_IT; i++) {\n        x = 0.5*(m + M); // console.log(x);\n        var q = GAMMA_DIST(x, a, b, true);\n        if (f_abs(p - q) < 1e-16) {\n            break;\n        }\n        if (q > p) {\n            M = x;\n        } else {\n            m = x;\n        }\n    }\n    return x;\n}\n\nfunction NORM_S_DIST(x, cumulative) {\n    if (!cumulative) {\n        return Math.exp(-x*x/2)/Math.sqrt(2*Math.PI);\n    }\n    return 0.5 + 0.5*ERF(x/Math.sqrt(2));\n}\n\nfunction NORM_S_INV(p) { // see [1] $26.2.3 and http://home.online.no/~pjacklam/notes/invnorm/#References\n    // Coefficients in rational approximations.\n    var a = [-3.969683028665376e+01, 2.209460984245205e+02,\n             -2.759285104469687e+02, 1.383577518672690e+02,\n             -3.066479806614716e+01, 2.506628277459239e+00],\n        b = [-5.447609879822406e+01, 1.615858368580409e+02,\n             -1.556989798598866e+02, 6.680131188771972e+01,\n             -1.328068155288572e+01],\n        c = [-7.784894002430293e-03, -3.223964580411365e-01,\n             -2.400758277161838e+00, -2.549732539343734e+00,\n             4.374664141464968e+00, 2.938163982698783e+00],\n        d = [ 7.784695709041462e-03, 3.224671290700398e-01,\n              2.445134137142996e+00, 3.754408661907416e+00];\n    // Define break-points.\n    var plow = 0.02425,\n        phigh = 1 - plow;\n    var q, r;\n    // Rational approximation for lower region:\n    if (p < plow) {\n        q = Math.sqrt(-2*Math.log(p));\n        return (((((c[0]*q+c[1])*q+c[2])*q+c[3])*q+c[4])*q+c[5]) / ((((d[0]*q+d[1])*q+d[2])*q+d[3])*q+1);\n    }\n    // Rational approximation for upper region:\n    if (phigh < p) {\n        q = Math.sqrt(-2*Math.log(1-p));\n        return -(((((c[0]*q+c[1])*q+c[2])*q+c[3])*q+c[4])*q+c[5]) / ((((d[0]*q+d[1])*q+d[2])*q+d[3])*q+1);\n    }\n    // Rational approximation for central region:\n    q = p - 0.5;\n    r = q*q;\n    return (((((a[0]*r+a[1])*r+a[2])*r+a[3])*r+a[4])*r+a[5])*q / (((((b[0]*r+b[1])*r+b[2])*r+b[3])*r+b[4])*r+1);\n}\n\nfunction NORM_DIST(x, m, s, cumulative) {\n    if (!cumulative) {\n        return Math.exp(-(x-m)*(x-m)/(2*s*s))/(s*Math.sqrt(2*Math.PI)); // NORM_S_DIST((x-m)/s)/s;\n    }\n    return NORM_S_DIST((x-m)/s, true);\n}\n\nfunction NORM_INV(p, m, s) {\n    return m + s*NORM_S_INV(p);\n}\n\nfunction betastd_pdf(x, a, b) {\n    return Math.exp((a-1)*Math.log(x) + (b-1)*Math.log(1-x) - BETALN(a, b));\n}\n\nfunction betastd_cdf(x, a, b) {\n    var k = Math.exp(a*Math.log(x) + b*Math.log(1-x) - BETALN(a, b));\n    return x < (a+1)/(a+b+2) ? k*beta_lentz(a, b, x)/a : 1 - k*beta_lentz(b, a, 1-x)/b;\n}\n\nfunction beta_lentz(a, b, x) { // estimates continued fraction by modified Lentz’s method ([2] $8.17.22)\n    var m, m2;\n    var aa, c, d, del, h, qab, qam, qap;\n    qab = a + b; // These q’s will be used in factors that occur in the coefficients d_n\n    qap = a + 1;\n    qam = a - 1;\n    c = 1; // First step of Lentz’s method.\n    d = 1 - qab * x / qap;\n    if (f_abs(d) < FP_MIN) {\n        d = FP_MIN;\n    }\n    d = 1/d;\n    h = d;\n    for (m = 1; m <= MAX_IT; m++) {\n        m2 = 2*m;\n        aa = m*(b - m)*x / ((qam + m2)*(a + m2));\n        d = 1 + aa*d; // One step (the even one) of the recurrence.\n        if (f_abs(d) < FP_MIN) {\n            d = FP_MIN;\n        }\n        c = 1 + aa/c;\n        if (f_abs(c) < FP_MIN) {\n            c = FP_MIN;\n        }\n        d = 1/d;\n        h *= d*c;\n        aa = -(a + m)*(qab + m)*x / ((a + m2)*(qap + m2));\n        d = 1 + aa*d; // Next step of the recurrence (the odd one).\n        if (f_abs(d) < FP_MIN) {\n            d = FP_MIN;\n        }\n        c = 1 + aa/c;\n        if (f_abs(c) < FP_MIN) {\n            c = FP_MIN;\n        }\n        d = 1/d;\n        del = d*c;\n        h *= del;\n        if (f_abs(del - 1) < EPS) {\n            break;\n        }\n    }\n    return h; // if(m > MAX_IT) throw new Error(\"a or b too big, or MAX_IT too small\");\n}\n\nfunction betastd_inv(p, a, b) { // the quantile function of the standard Beta distribution\n    var m = 0, M = 1, x = 0;\n    for (var i = 0; i < MAX_IT; i++) {\n        x = 0.5*(m + M);\n        var q = betastd_cdf(x, a, b);\n        if (f_abs(p - q) < EPS) {\n            break;\n        }\n        if (q > p) {\n            M = x;\n        } else {\n            m = x;\n        }\n    }\n    return x;\n}\n\nfunction BETADIST(x, a, b, m, M) {\n    return betastd_cdf((x-m)/(M-m), a, b);\n}\n\nfunction BETA_DIST(x, a, b, cdf, m, M) {\n    if (cdf) {\n        return betastd_cdf((x-m)/(M-m), a, b);\n    }\n    return betastd_pdf((x-m)/(M-m), a, b) / (M-m);\n}\n\nfunction BETA_INV(p, a, b, m, M) {\n    return m + (M-m)*betastd_inv(p, a, b);\n}\n\nfunction chisq_left(x, n, cds) {  // CHISQ.DIST(x,deg_freedom,cumulative)\n    return GAMMA_DIST(x, n/2, 2, cds);\n}\n\nfunction chisq_right(x, n) { // CHISQ.DIST.RT(x,deg_freedom)\n    return 1 - chisq_left(x, n, true);\n}\n\nfunction chisq_left_inv(p, n) { // CHISQ.INV( probability, degrees_freedom )\n    return GAMMA_INV(p, n/2, 2);\n}\n\nfunction chisq_right_inv(p, n) { // CHISQ.INV.RT(probability,deg_freedom)\n    return chisq_left_inv(1-p, n);\n}\n\nfunction chisq_test(obsv, expect) {\n    var rows = obsv.length, cols = obsv[0].length;\n    var x = 0, i, j;\n    for (i = 0; i < rows; i++) {\n        for (j = 0; j < cols; j++) {\n            var eij = expect[i][j];\n            var delta = obsv[i][j] - eij;\n            delta *= delta;\n            x += delta/eij;\n        }\n    }\n    var n = (rows - 1)*(cols - 1);\n    return chisq_right(x, n);\n}\n\nfunction expon(x, r, cdf) { // EXPON.DIST(x, lambda, cumulative)\n    if (cdf) {\n        return 1 - Math.exp(-r*x);\n    }\n    return r * Math.exp(-r*x);\n}\n\nfunction poisson(k, m, cdf) { // POISSON.DIST(x, mean, cumulative)\n    if (cdf) {\n        return 1 - chisq_left(2*m, 2*(k+1), true);\n    }\n    //return chisq_left(2*m, 2*k, true) - chisq_left(2*m, 2*(k+1), true);\n    var lnf = 0;\n    for (var i = 2; i <= k; i++) {\n        lnf += Math.log(i); // compute log(k!)\n    }\n    return Math.exp(k*Math.log(m) - m - lnf);\n}\n\nfunction Fdist(x, n, d, cdf) { //F.DIST(x,deg_freedom1,deg_freedom2,cumulative)\n    if (cdf) {\n        return betastd_cdf(n*x/(d+n*x), n/2, d/2);\n    }\n    var u = n/d;\n    n /= 2; d /= 2;\n    return u/BETA(n, d) * Math.pow(u*x, n-1) / Math.pow(1+u*x, n+d);\n}\n\nfunction Fdist_right(x, n, d) { // F.DIST.RT(x,deg_freedom1,deg_freedom2)\n    return 1 - Fdist(x, n, d, true);\n}\n\nfunction Finv_right(p, n, d) { // F.INV.RT(probability,deg_freedom1,deg_freedom2\n    return d/n*(1/BETA_INV(p, d/2, n/2, 0, 1) - 1);\n}\n\nfunction Finv(p, n, d) { // F.INV(probability,deg_freedom1,deg_freedom2\n    return d/n*(1/BETA_INV(1-p, d/2, n/2, 0, 1) - 1);\n}\n\nfunction _mean(arr) {\n    var me = 0, n = arr.length;\n    for (var i = 0; i < n; i++) {\n        me += arr[i];\n    }\n    return me / n;\n}\n\nfunction _var_sq(arr, m) { // returns the (n-1)-part of the sum of the squares of deviations from m (= VAR)\n    var v = 0, n = arr.length;\n    for (var i = 0; i < n; i++) {\n        var delta = arr[i] - m;\n        v += delta*delta;\n    }\n    return v / (n-1);\n}\n\nfunction Ftest(arr1, arr2) { // F.TEST(array1,array2)\n    var n1 = arr1.length - 1, n2 = arr2.length - 1;\n    var va1 = _var_sq(arr1, _mean(arr1)),\n        va2 = _var_sq(arr2, _mean(arr2));\n    if (!va1 || !va2) {\n        throw new CalcError(\"DIV/0\");\n    }\n    return 2*Fdist(va1 / va2, n1, n2, true);\n}\n\nfunction fisher(x) { // FISHER(x)\n    return 0.5*Math.log((1+x)/(1-x));\n}\n\nfunction fisherinv(x) { // FISHERINV(x)\n    var e2 = Math.exp(2*x);\n    return (e2 - 1)/(e2 + 1);\n}\n\nfunction Tdist(x, n, cdf) { // T.DIST(x,deg_freedom, cumulative)\n    if (cdf) {\n        return 1 - 0.5*betastd_cdf(n/(x*x+n), n/2, 0.5);\n    }\n    return 1/(Math.sqrt(n)*BETA(0.5, n/2)) * Math.pow(1 + x*x/n, -(n+1)/2);\n}\n\nfunction Tdist_right(x, n) { // T.DIST.RT(x,deg_freedom)\n    return 1 - Tdist(x, n, true);\n}\n\nfunction Tdist_2tail(x, n) { // T.DIST.2T(x,deg_freedom)\n    if (x < 0) {\n        x = -x;\n    }\n    return 2*Tdist_right(x, n);\n}\n\nfunction Tdist_inv(p, n) { // T.INV(probability,deg_freedom)\n    var x = betastd_inv(2*Math.min(p, 1-p), n/2, 0.5); // ibetainv();\n    x = Math.sqrt(n * (1 - x) / x);\n    return (p > 0.5) ? x : -x;\n}\n\nfunction Tdist_2tail_inv(p, n) { // T.INV.2T(probability,deg_freedom)\n    // T2 = 2T_r = p => T_r(x,n) = p/2 => 1 - T(x,n,true) = p/2 => x = T^-1(1-p/2, n)\n    return Tdist_inv(1-p/2, n);\n}\n\nfunction Tdist_test(gr1, gr2, tail, type) { // T.TEST(array1,array2,tails,type)\n    var n1 = gr1.length, n2 = gr2.length;\n    var t_st, df; // the t-statistic and the \"degree of freedom\"\n    if (type == 1) { // paired (dependent) samples\n        var d = 0, d2 = 0;\n        for (var i = 0; i < n1; i++) {\n            var delta = gr1[i] - gr2[i];\n            d += delta;\n            d2 += delta*delta;\n        }\n        var md = d/n1; //, md2 = d2 / n1;\n        t_st = md / Math.sqrt((d2 - d*md)/(n1*(n1-1))); // has a \"Student T\" distribution\n        return tail == 1 ? Tdist_right(t_st, n1-1) : Tdist_2tail(t_st, n1-1);\n    }\n    // unpaired (independent) samples\n    var m1 = _mean(gr1), m2 = _mean(gr2),\n        v1 = _var_sq(gr1, m1), v2 = _var_sq(gr2, m2);\n    if (type == 3) { // unpaired, unequal variances\n        var u1 = v1/n1, u2 = v2/n2, u = u1 + u2;\n        var q1 = u1/u, q2 = u2/u; // u==0 must be invalidated\n        df = 1/(q1*q1/(n1-1) + q2*q2/(n2-1));\n        t_st = f_abs(m1-m2)/Math.sqrt(u);\n        return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n    }\n    else { // (type == 2) unpaired, equal variances (\"equal\" in the sense that there is no significant difference in variance in both groups - a prealable F-test could revealed that)\n        df = n1 + n2 - 2;\n        t_st = f_abs(m1-m2)*Math.sqrt(df*n1*n2/((n1+n2)*((n1-1)*v1+(n2-1)*v2)));\n        return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n    }\n}\n\nfunction confidence_t(alpha, stddev, size) { // CONFIDENCE.T(alpha,standard_dev,size)\n    return -Tdist_inv(alpha/2, size-1)*stddev/Math.sqrt(size);\n}\n\nfunction confidence_norm(alpha, stddev, size) { // CONFIDENCE.NORM(alpha,standard_dev,size)\n    return -NORM_S_INV(alpha/2)*stddev/Math.sqrt(size);\n}\n\nfunction gauss(z) { // GAUSS(z)\n    return NORM_S_DIST(z, true) - 0.5;\n}\n\nfunction phi(x) { // PHI(x)\n    return NORM_S_DIST(x);\n}\n\nfunction lognorm_dist(x, m, s, cumulative) { // LOGNORM.DIST(x,mean,standard_dev,cumulative)\n    if (cumulative) {\n        return 0.5 + 0.5*ERF((Math.log(x)-m)/(s*Math.sqrt(2)));\n    }\n    var t = Math.log(x)-m;\n    return Math.exp(-t*t/(2*s*s))/(x*s*Math.sqrt(2*Math.PI));\n}\n\nfunction lognorm_inv(p, m, s) { //LOGNORM.INV(probability, mean, standard_dev)\n    return Math.exp(NORM_INV(p, m, s));\n}\n\nfunction prob(x_, p_, lw, up) { //PROB(x_range, prob_range, [lower_limit], [upper_limit])\n    var n = x_.length;\n    var s = 0, i;\n    for (i = 0; i < n; i++) {\n        if (p_[i] <= 0 || p_[i] > 1) {\n            throw new CalcError(\"NUM\");\n        }\n        s += p_[i];\n    }\n    if (s != 1) {\n        throw new CalcError(\"NUM\");\n    }\n    var res = 0;\n    for (i = 0; i < n; i++) {\n        var x = x_[i];\n        if (x >= lw && x <= up) {\n            res += p_[i];\n        }\n    }\n    return res;\n}\n\nfunction slope(y_, x_) { // SLOPE(known_y's, known_x's)\n    var mx = _mean(x_), my = _mean(y_), b1 = 0, b2 = 0;\n    for (var i = 0, n = y_.length; i < n; i++) {\n        var t = x_[i] - mx;\n        b1 += t*(y_[i] - my);\n        b2 += t*t;\n    }\n    return b1/b2;\n}\n\nfunction intercept(y_, x_) { // INTERCEPT(known_y's, known_x's)\n    var mx = _mean(x_), my = _mean(y_);\n    // return my - mx*slope(y_, x_);  //but repeating the calls for _mean()\n    var b1 = 0, b2 = 0;\n    for (var i = 0, n = y_.length; i < n; i++) {\n        var t = x_[i] - mx;\n        b1 += t*(y_[i] - my);\n        b2 += t*t;\n    }\n    return my - b1*mx/b2;\n}\n\nfunction pearson(x_, y_) { // PEARSON(array1, array2)\n    whipNumberArrays(x_, y_);\n    var mx = _mean(x_), my = _mean(y_);\n    var s1 = 0, s2 = 0, s3 = 0;\n    for (var i = 0, n = x_.length; i < n; i++) {\n        var t1 = x_[i] - mx, t2 = y_[i] - my;\n        s1 += t1*t2;\n        s2 += t1*t1;\n        s3 += t2*t2;\n    }\n    return s1/Math.sqrt(s2*s3);\n}\n\nfunction rsq(x_, y_) { // RSQ(known_y's,known_x's)\n    var r = pearson(x_, y_);\n    return r*r;\n}\n\nfunction steyx(y_, x_) { //STEYX(known_y's, known_x's)\n    var n = x_.length;\n    var mx = _mean(x_), my = _mean(y_);\n    var s1 = 0, s2 = 0, s3 = 0;\n    for (var i = 0; i < n; i++) {\n        var t1 = x_[i] - mx, t2 = y_[i] - my;\n        s1 += t2*t2;\n        s2 += t1*t2;\n        s3 += t1*t1;\n    }\n    return Math.sqrt((s1 - s2*s2/s3)/(n-2));\n}\n\nfunction forecast(x, y_, x_) { //FORECAST(x, known_y's, known_x's)\n    var mx = _mean(x_), my = _mean(y_);\n    var s1 = 0, s2 = 0;\n    for (var i = 0, n = x_.length; i < n; i++) {\n        var t1 = x_[i] - mx, t2 = y_[i] - my;\n        s1 += t1*t2;\n        s2 += t1*t1;\n    }\n    if (s2 === 0) {\n        throw new CalcError(\"N/A\");\n    }\n    var b = s1/s2, a = my - b*mx;\n    return a + b*x;\n}\n\nfunction _mat_mean(Mat) { // returns the mean value of a Matrix(n, 1)\n    var n = Mat.height, sum = 0;\n    for (var i=0; i < n; i++) {\n        sum += Mat.data[i][0];\n    }\n    return sum/n;\n}\n\nfunction _mat_devsq(Mat, mean) { // returns the sum of squares of deviations for a Matrix(n, 1)\n    var n = Mat.height, sq = 0;\n    for (var i=0; i < n; i++) {\n        var x = Mat.data[i][0] - mean;\n        sq += x*x;\n    }\n    return sq;\n}\n\nfunction linest(Y, X, konst, stats) { // LINEST(known_y's, [known_x's], [const], [stats])\n    var i = 0;\n\n    if (!X) {\n        // if not passed, X should default to array {1, 2, 3, ...} (same size as Y)\n        X = Y.map(function(){ return ++i; });\n    }\n\n    if (konst) { // adding 1's column is unnecessary when const==false (meaning that y_intercept==0)\n        X = X.clone();\n        X.eachRow(function(row){\n            X.data[row].unshift(1);\n        });\n        ++X.width;\n    }\n\n    var Xt = X.transpose();\n    var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y); // the last square estimate of the coefficients\n    var line_1 = [];\n    for (i = B.height-1; i >= 0; i--) {\n        line_1.push(B.data[i][0]); // regression coefficients ('slopes') and the y_intercept\n    }\n    if (!konst) {\n        line_1.push(0); // display 0 for y_intercept, when const==false\n    }\n    if (!stats) {\n        return this.asMatrix([ line_1 ]); // don't display statistics about the regression, when stats==false\n    }\n\n    var Y1 = X.multiply(B); // the predicted Y values\n    var y_y1 = Y.adds(Y1, true); // the errors of the predictions (= Y - Y1)\n    var mp = !konst? 0 : _mat_mean(Y1);\n    var SSreg = _mat_devsq(Y1, mp); // The regression sum of squares\n    var me = !konst? 0 : _mat_mean(y_y1);\n    var SSresid = _mat_devsq(y_y1, me); // The residual sum of squares\n    var line_5 = [];\n    line_5.push(SSreg, SSresid);\n    var R2 = SSreg / (SSreg + SSresid); // The coefficient of determination\n    var degfre = Y.height - X.width; // The degrees of freedom\n    var err_est = Math.sqrt(SSresid / degfre); // The standard error for the y estimate\n    var line_3 = [];\n    line_3.push(R2, err_est);\n    var F_sta = !konst ? (R2/X.width)/((1-R2)/(degfre)) : (SSreg/(X.width-1))/(SSresid/degfre); // The F statistic\n    var line_4 = [];\n    line_4.push(F_sta, degfre);\n    var SCP = Xt.multiply(X).inverse();\n    var line_2 = [];\n    for (i=SCP.height-1; i >= 0; i--) { // The standard errors (of coefficients an y-intercept)\n        line_2.push(Math.sqrt(SCP.data[i][i]*SSresid/degfre));\n    }\n    return this.asMatrix([line_1, line_2, line_3, line_4, line_5]);\n}\n\nfunction logest(Y, X, konst, stats) { // LOGEST(known_y's, [known_x's], [const], [stats])\n    return linest.call(this, Y.map(Math.log), X, konst, stats).map(Math.exp);\n}\n\nfunction trend(Y, X, W, konst) { // TREND(known_y's, [known_x's], [new_x's], [const])\n    var i = 0;\n\n    if (!X) {\n        // if not passed, X should default to array {1, 2, 3, ...} (same size as Y)\n        X = Y.map(function(){ return ++i; });\n    }\n\n    if (konst) { // adding 1's column is unnecessary when const==false (meaning that y_intercept==0)\n        X = X.clone();\n        X.eachRow(function(row){\n            X.data[row].unshift(1);\n        });\n        ++X.width;\n    }\n\n    var Xt = X.transpose();\n    var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y); // the last square estimate of the coefficients\n\n    if (!W) {\n        W = X;\n    } else {\n        if (konst) { // for non-zero y_intercept\n            W = W.clone();\n            W.eachRow(function(row){\n                W.data[row].unshift(1);\n            });\n            ++W.width;\n        }\n    }\n    return W.multiply(B); // the predicted Y values for the W values\n}\n\nfunction growth(Y, X, new_X, konst) { // GROWTH(known_y's, [known_x's], [new_x's], [const])\n    // = EXP(TREND(LN(Y_), X_, new_X, const))\n    return trend.call(this, Y.map(Math.log), X, new_X, konst).map(Math.exp);\n}\n\n/*\n  [1] Handbook of Mathematical Functions (NIST, 1964-2010):\n  https://en.wikipedia.org/wiki/Abramowitz_and_Stegun\n  http://dlmf.nist.gov/\n  http://www.aip.de/groups/soe/local/numres/\n\n  [2] https://en.wikibooks.org/wiki/Statistics/Numerical_Methods/Numerics_in_Excel\n*/\n\n/* -----[ financial functions ]----- */\n\n//// find the root of a function known an initial guess (Newton's method) ////\nfunction root_newton(func, guess, max_it, eps) { // func(x) must return [value_F(x), value_F'(x)]\n    var MAX_IT = max_it || 20, // maximum number of iterations\n        EPS = eps || 1E-7; // accuracy\n    var root = guess;\n    for (var j = 1; j <= MAX_IT; j++) {\n        var f_d = func(root),\n            f = f_d[0], // the value of the function\n            df = f_d[1]; // the value of the derivative\n        var dx = f / df;\n        root -= dx;\n        if (Math.abs(dx) < EPS) {\n            return root;\n        }\n    }\n    return new CalcError(\"NUM\");\n}\n\n\n/* https://support.office.com/en-us/article/PV-function-23879d31-0e02-4321-be01-da16e8168cbd\n   if(rate==0):\n   PMT * nper + PV + FV = 0\n   else: //the basic equation (with six variables) implied in financial problems\n   PV * (1+rate)^nper + PMT * (1+rate*type) * ((1+rate)^nper-1) / rate + FV = 0         [1]\n*/\n\n\n//// FV (final or future value) ////\n/* I initially invest £1000 in a saving scheme and then at the end of each month I invest an\n   extra £50. If the interest rate is 0.5% per month and I continue this process for two year,\n   how much will my saving be worth: =FV(0.005, 24, -50, -1000, 0) */\nfunction FV(rate, nper, pmt, pv, type) { // FV(rate,nper,pmt,[pv],[type])\n    var h1 = Math.pow(1+rate, nper);\n    var h2 = rate ? (h1 - 1)/rate : nper;\n    return -(pv * h1 + pmt * h2 * (1 + rate*type));\n}\n\n//// PV (present value of investment) ////\n/* If I wish to accumulate £5000 in four years time by depositing £75 per month in a fixed\n   rate account with interest rate of 0.4% per month, what initial investment must I also\n   make: =PV(0.004, 4*12, -75, 5000, 0) */\nfunction PV(rate, nper, pmt, fv, type) { // PV(rate, nper, pmt, [fv], [type])\n    if (!rate) {\n        return -fv - pmt*nper;\n    }\n    var h1 = Math.pow(1+rate, nper);\n    return -(fv + pmt * (h1 - 1)/rate * (1 + rate*type)) / h1;\n}\n\n//// PMT monthly payments (= principal part PPMT + interest part IPMT) ////\n/* How much will the monthly repayments be if I borrow £100,000 over 20 years with an\n   effective monthly interest rate is 0.5%: =PMT(0.005, 12*20, 100000, 0, 0) */\nfunction PMT(rate, nper, pv, fv, type) { // PMT(rate, nper, pv, [fv], [type])\n    if (!rate) {\n        return -(fv + pv)/nper;\n    }\n    var h1 = Math.pow(1+rate, nper);\n    return -rate*(fv + pv*h1)/((1 + rate*type)*(h1 - 1));\n}\n\n//// NPER (number of periods for an investment) ////\n/* How long would it take me to pay off a loan of £10,000 at a rate of 0.5% per month if I\n   can afford to pay £100 per month: =NPER(0.5%, -100, 10000, 0, 0) */\nfunction NPER(rate, pmt, pv, fv, type) { // NPER(rate,pmt,pv,[fv],[type])\n    if (!rate) {\n        return -(fv + pv) / pmt;\n    }\n    var h1 = pmt*(1 + rate*type);\n    return Math.log((h1 - fv*rate)/(h1 + pv*rate)) / Math.log(1 + rate);\n}\n\n//// RATE (the interest rate per period) ////\n/* I borrow £1000 over 1 year making payments of £100 per month at the end of each\n   month. What is the monthly interest rate: =RATE(12, −100, 1000, 0, 0, 0) */\n\nfunction RATE(nper, pmt, pv, fv, type, guess) { // RATE(nper, pmt, pv, [fv], [type], [guess])\n    function xfd(x) { // returns F(x) and F'(x), where F is given by the equation [1]\n        var h2 = Math.pow(1+x, nper-1), h1 = h2*(1+x);\n        return [ pv*h1 + pmt*(1/x + type)*(h1 - 1) + fv,\n                 nper*pv*h2 + pmt*(-(h1 - 1)/(x*x) + (1/x + type)*nper*h2) ];\n    }\n    return root_newton(xfd, guess); // a root of the equation F(x)=0\n}\n\n//// IPMT (interest part of a loan or investment) ////\n//// PPMT (principal part of a loan) ////\n\nfunction IPMT(rate, per, nper, pv, fv, type) { // IPMT(rate, per, nper, pv, [fv], [type])\n    if (type==1 && per==1) { // interest before beginnig of the payments... = ZERO\n        return 0;\n    }\n    var pmt = PMT(rate, nper, pv, fv, type);\n    var ipmt = FV(rate, per - 1, pmt, pv, type) * rate;\n    return type ? ipmt/(1 + rate) : ipmt;\n}\n\nfunction PPMT(rate, per, nper, pv, fv, type) { // PPMT(rate, per, nper, pv, [fv], [type])\n    var pmt = PMT(rate, nper, pv, fv, type);\n    return pmt - IPMT(rate, per, nper, pv, fv, type);\n}\n\n//// CUMPRINC (cumulative principal paid) ////\n/* The amount financed is $200,000 at an interest rate of 7.25% for 30 years. How much is the amount of principal\n   and the amount of interest paid in the first year: CUMPRINC(0.0725/12, 12*30, 200000, 1, 12, 0)\n   and CUMIPMT(0.0725/12, 12*30, 200000, 1, 12, 0) */\nfunction CUMPRINC(rate, nper, pv, start, end, type) { // CUMPRINC(rate, nper, pv, start_period, end_period, type)\n    if (type == 1) { // start >= 1 (as in Excel), but if pay at beginning of the period (type==1),\n        start --;    // then periods must be counted from Zero (decreasing given start and end parameters)\n        end --;\n    }\n    var tn = Math.pow(1 + rate, nper),\n        ts = Math.pow(1 + rate, start-1),\n        te = Math.pow(1 + rate, end);\n    var monthlyPayment = rate * pv * tn / (tn - 1);\n    var remainingBalanceAtStart = ts * pv - ((ts - 1) / rate) * monthlyPayment;\n    var remainingBalanceAtEnd = te * pv - ((te - 1) / rate) * monthlyPayment;\n    return remainingBalanceAtEnd - remainingBalanceAtStart;\n}\n\n//// CUMIPMT (cumulative  interest paid) ////\nfunction CUMIPMT(rate, nper, pv, start, end, type) { // CUMIPMT(rate, nper, pv, start_period, end_period, type)\n    var cip = 0;\n    for (var i=start; i<=end; i++) {\n        cip += IPMT(rate, i, nper, pv, 0, type);\n    }\n    return cip;\n}\n\n//// NPV (Net Present Value of an investment based on a series of periodic cash flows and a discount rate) ////\nfunction NPV(rate, flows) { // NPV(rate,value1,[value2],...)\n    var npv = 0;\n    for (var i=0, n=flows.length; i < n; i++) {\n        npv += flows[i]*Math.pow(1 + rate, -i-1);\n    }\n    return npv;\n}\n\n//// IRR (Internal Rate of Return on an investment based on a series of periodic cash flows) ////\nfunction IRR(flows, guess) { // IRR(values, [guess])\n    function xfd(x) {\n        var npv = 0, npv1 = 0;\n        for (var j=0, n=flows.length; j < n; j++) {\n            npv += flows[j]*Math.pow(1 + x, -j-1); // construct the NPV(x) value,\n            npv1 += -j*flows[j]*Math.pow(1+x, -j-2); // the value in x of the NPV()-derivative\n        }\n        return [npv, npv1];\n    }\n    return root_newton(xfd, guess);\n}\n\n//// EFFECT (effective annual interest rate) ////\n/* which investment option is better - one that pays 5 percent after one year, or a\n   savings account that pays a monthly interest of 4.75 percent:\n   = (5% - EFFECT(4.75%, 12)) * 10000 */\nfunction EFFECT(nominal_rate, npery) { // EFFECT(nominal_rate, npery)\n    return Math.pow(1 + nominal_rate/npery, npery) - 1;\n}\n\n//// NOMINAL (nominal annual interest rate) ////\nfunction NOMINAL(effect_rate, npery) { // NOMINAL(effect_rate, npery)\n    return npery*(Math.pow(effect_rate + 1, 1/npery) - 1);\n}\n\n//// XNPV (Net Present Value of a series of cashflows at irregular intervals) ////\nfunction XNPV(rate, values, dates) { // XNPV(rate, values, dates)\n    var npv = 0;\n    for (var i=0, n=values.length; i < n; i++) {\n        npv += values[i]*Math.pow(1 + rate, (dates[0]-dates[i])/365);\n    }\n    return npv;\n}\n\n//// XIRR (Internal Rate of Return of a series of cashflows at irregular intervals) ////\nfunction XIRR(values, dates, guess) { // XIRR(values, dates, [guess])\n    function xfd(x) {\n        var npv = values[0], npv1 = 0;\n        for (var j=1, n=values.length; j < n; j++) {\n            var delta = (dates[0] - dates[j]) / 365;\n            npv += values[j]*Math.pow(1 + x, delta); // construct the XNPV(x) value,\n            npv1 += delta*values[j]*Math.pow(1+x, delta - 1); // the value in x of the XNPV()-derivative\n        }\n        return [npv, npv1];\n    }\n    return root_newton(xfd, guess); // , 100, 0.1);\n}\n\n//// ISPMT (Interest paid during a Specific Period of an investment) ////\nfunction ISPMT(rate, per, nper, pv) { // ISPMT(rate, per, nper, pv)\n    var tmp = -pv*rate;\n    return tmp*(1 - per/nper);\n}\n\n//// DB (Declining Balance depreciation) ////\nfunction DB(cost, salvage, life, period, month) { // DB(cost, salvage, life, period, [month])\n    var rate = 1 - Math.pow(salvage/cost, 1/life);\n    rate = Math.floor(rate*1000 + 0.5) / 1000; // rounded to three decimals\n    var db = cost * rate * month / 12;\n    if (period == 1) {\n        return db;\n    }\n    for (var i=1; i < life; i++) {\n        if (i == period - 1) {\n            return (cost - db) * rate;\n        }\n        db += (cost - db) * rate;\n    }\n    return (cost - db) * rate * (12 - month) / 12;\n}\n\n//// DDB (Double Declining Balance depreciation) ////\nfunction DDB(cost, salvage, life, period, factor) { // DDB(cost, salvage, life, period, [factor])\n    var f = factor / life;\n    var prior = -cost * (Math.pow(1-f, period-1) - 1);\n    var dep = (cost - prior) * f;\n    /* Depreciation cannot exceed book value.  */\n    dep = Math.min(dep, Math.max(0, cost - prior - salvage));\n    return dep;\n}\n\n//// SLN (straight-line depreciation) ////\nfunction SLN(cost, salvage, life) { // SLN(cost, salvage, life)\n    return (cost - salvage) / life;\n}\n\n//// SYD (Sum-of-Years' digits Depreciation) ////\nfunction SYD(cost, salvage, life, per) { // SYD(cost, salvage, life, per)\n    return (cost - salvage) * (life - per + 1) * 2 / (life * (life + 1));\n}\n\n//// VDB (Variable Declining Balance) ////\n//\n// Code adapted from Gnumeric, which in turn took it from OpenOffice.  The original code is\n// available under GNU Lesser General Public License (LGPL).\n// https://github.com/GNOME/gnumeric/blob/master/plugins/fn-financial/sc-fin.c\nfunction VDB(cost, salvage, life, start, end, factor, no_switch) {\n    var interest = factor >= life ? 1 : factor / life;\n\n    function _getGDA(value, period) {\n        var gda, oldValue, newValue;\n        if (interest == 1) {\n            oldValue = period == 1 ? value : 0;\n        } else {\n            oldValue = value * Math.pow(1 - interest, period - 1);\n        }\n        newValue = value * Math.pow(1 - interest, period);\n        gda = newValue < salvage ? oldValue - salvage : oldValue - newValue;\n        return gda < 0 ? 0 : gda;\n    }\n\n    function _interVDB(cost, life1, period) {\n        var remValue = cost - salvage;\n        var intEnd = Math.ceil(period);\n        var term, lia = 0, vdb = 0, nowLia = false;\n        for (var i = 1; i <= intEnd; i++) {\n            if (!nowLia) {\n                var gda = _getGDA(cost, i);\n                lia = remValue / (life1 - i + 1);\n                if (lia > gda) {\n                    term = lia;\n                    nowLia = true;\n                } else {\n                    term = gda;\n                    remValue -= gda;\n                }\n            } else {\n                term = lia;\n            }\n            if (i == intEnd) {\n                term *= period + 1 - intEnd;\n            }\n            vdb += term;\n        }\n        return vdb;\n    }\n\n    var intStart = Math.floor(start), intEnd = Math.ceil(end);\n    var vdb = 0;\n    if (no_switch) {\n        for (var i = intStart + 1; i <= intEnd; i++) {\n            var term = _getGDA(cost, i);\n            if (i == intStart + 1) {\n                term *= Math.min(end, intStart + 1) - start;\n            } else {\n                if (i == intEnd) {\n                    term *= end + 1 - intEnd;\n                }\n            }\n            vdb += term;\n        }\n    } else {\n        var life1 = life;\n        if (start != Math.floor(start)) {\n            if (factor > 1) {\n                if (start >= life / 2) {\n                    var part = start - life / 2;\n                    start = life / 2;\n                    end -= part;\n                    life1 += 1;\n                }\n            }\n        }\n        cost -= _interVDB(cost, life1, start);\n        vdb = _interVDB(cost, life - start, end - start);\n    }\n    return vdb;\n}\n\n/*************************************************************************************/\n\n/*   (from  http://beginnersinvest.about.com)\n     an investor agrees to loan money to a company or government in exchange for a predetermined interest rate for a pre-determined length of time.\n\n     If an investor wanted to buy a $25,000 Coca-Cola bond with a 30 year maturity and an 10% coupon, it would work like this: He would send in the $25,000 from his savings account and get a $25,000 engraved bond certificate in exchange. After 30 years, he would be able to get his whole $25,000 back from the Coca-Cola company (of course, he can always sell it before then if he needs the money).\n\n     Every year, he’s entitled to receive 10% interest on the money he lent, or $2,500. Since most companies in the United States pay interest semi-annually, he would likely have 60 coupons attached to his bond for $1,250 each.\n     Every June 30th and December 31st, the investor would go down, clip the proper coupon, send it in, and get their money.\n\n     Although the practice is now defunct, the terminology stuck and interest payments on bonds will forever be known as coupons.\n*/\n\n\n// \"Use EDATE to calculate maturity dates or due dates that fall on the same day of the month as the date of issue.\"\n// See also: DATEDIF, DAY, DAYS, DAY360, EOMONTH (wich can be useful to determine limits of coupon periods)\nfunction _edate(base, months) { // EDATE(start_date, months)\n    var d = unpackDate$1(base);\n    var m = d.month + months;\n    var y = d.year + Math.floor(m/12);\n    m %= 12;\n    if (m < 0) {\n        m += 12;\n    }\n    d = Math.min(d.date, daysInMonth(y, m));\n    return packDate$1(y, m, d);\n}\n\nfunction _daysBetween(from, to, basis) {\n    if (basis == 1 || basis == 2 || basis == 3) { // Actual/Actual || Actual/360 || Actual/365\n        return to - from;\n    }\n    return _days_360(from, to, basis);\n}\n\n// Find coupon dates that enclose the settlement date, counting backward from the maturity date.\n/* independent of the 'basis' convention to count days - here we have no need to count days */\nfunction _borderCoupons(settlement, maturity, freq) {\n    var sett = unpackDate$1(settlement), base = unpackDate$1(maturity);\n    var periods = base.year - sett.year;\n    if (periods > 0) {\n        periods = (periods - 1) * freq;\n    }\n    var prev, next, months = 12/freq;\n    do {\n        periods++;\n        prev = _edate(maturity, - periods*months);\n    } while (settlement < prev);\n    periods--;\n    next = _edate(maturity, - periods*months);\n    return [ prev, next ];\n}\n\n// Find coupon dates that enclose the settlement date, counting forward from the first-coupon payment.\n/* independent of the 'basis' convention to count days - here we have no need to count days */\nfunction _borderCoupons_fw(first, settlement, freq) {\n    var sett = unpackDate$1(settlement), base = unpackDate$1(first);\n    var periods = sett.year - base.year;\n    if (periods > 0) {\n        periods = (periods - 1) * freq;\n    }\n    var prev = first, next, months = 12/freq;\n    while (settlement > prev) {\n        next = prev;\n        periods++;\n        prev = _edate(first, periods*months);\n    }\n    return [ next, prev ];\n}\n\n//// COUPDAYBS (COUPon DAYs Beginning to Settlement) ////\n/* returns the number of days from the beginning of the coupon period to the settlement date */\nfunction COUPDAYBS(settlement, maturity, frequency, basis) { // COUPDAYBS(settlement, maturity, frequency, [basis])\n    var prev = _borderCoupons(settlement, maturity, frequency)[0];\n    return _daysBetween(prev, settlement, basis);\n}\n\n//// COUPDAYS (COUPon DAYs containing Settlement) ////\n/* Returns the number of days in the coupon period that contains the settlement date */\nfunction COUPDAYS(settl, matur, freq, basis) { // COUPDAYS(settlement, maturity, frequency, [basis])\n    if (basis == 1) {\n        var borders = _borderCoupons(settl, matur, freq);\n        return _daysBetween(borders[0], borders[1], 1);\n    }\n    if (basis == 3) {\n        return 365/freq;\n    }\n    return 360/freq;\n}\n\n//// COUPDAYSNC (COUPon DAYs Settlement to Next Coupon) ////\n/* Returns the number of days from the settlement date to the next coupon date */\nfunction COUPDAYSNC(settl, matur, freq, basis) { // COUPDAYSNC(settlement, maturity, frequency, [basis])\n    var next = _borderCoupons(settl, matur, freq)[1];\n    return _daysBetween(settl, next, basis);\n}\n\n//// COUPPCD (COUPon, Previous Coupon Date) ////\n/* Returns the previous coupon date before the settlement date */\nfunction COUPPCD(settl, matur, freq/*, basis*/) { // COUPPCD(settlement, maturity, frequency, [basis])\n    // It is no need to count days, so 'basis' becomes a inutil parameter.\n    return _borderCoupons(settl, matur, freq)[0];\n}\n\n//// COUPNCD (COUPon, Next Coupon Date) ////\n/* Returns the next coupon date after the settlement date */\nfunction COUPNCD(settl, matur, freq/*, basis*/) { // COUPNCD(settlement, maturity, frequency, [basis])\n    // It is no need to count days, so 'basis' becomes a inutil parameter.\n    return _borderCoupons(settl, matur, freq)[1];\n}\n\nfunction COUPNUM(settl, matur, freq/*, basis*/) { // COUPNUM(settlement, maturity, frequency, [basis])\n    var sett = unpackDate$1(settl),\n        mat = unpackDate$1(matur);\n    var months = 12*(mat.year - sett.year) + mat.month - sett.month;\n    //// Discount the last month if there are not enough days? Finally - we decide to not discount.\n    //// (if this \"last month\" have 2 days, Excel.COUPNUM returns 6 but GoogleSpreads give only 5)\n    //    var res = _edate(matur, -months);\n    //    if (sett.date >= unpackDate(res).date) {\n    //        months--; // an incomplete last month correspond to a qvasi-coupon period\n    //    }\n    return 1 + (months * freq / 12 | 0);\n}\n\nfunction daysInYear2(yr, basis) {\n    if (basis == 3) { return 365; }\n    if (basis == 1) { return isLeapYear(yr) ? 366 : 365; }\n    return 360;\n}\n\n//// ACCRINTM  the accrued interest for a security that pays interest at maturity ////\nfunction ACCRINTM(issue, maturity, rate, par, basis) { // ACCRINTM(issue, settlement, rate, par, [basis])\n    var year_days = daysInYear2(unpackDate$1(maturity).year, basis); // 360;\n    return rate*par * _daysBetween(issue, maturity, basis) / year_days;\n}\n\nfunction ACCRINT(issue, first, settl, rate, par, freq, basis, calc) {\n    var accr = 0, cost = par * rate / freq;\n    var brace, prev, next, prev1, next1, nrc;\n\n    var annual = basis % 2 === 0 ? 360 : 365; // only if to >> from, we eventually need to count leap years\n    function _numCoupons(from, to) { // better than COUPNUM(from, to, freq, basis)-1\n        return (to - from)*freq/annual | 0;\n    }\n\n    if (settl <= first) {\n        brace = _borderCoupons(settl, first, freq);\n        prev = brace[0];\n        next = brace[1];\n        if (prev <= issue) {\n            return cost * _daysBetween(issue, settl, basis) / _daysBetween(prev, next, basis);\n        }\n        brace = _borderCoupons(issue, prev, freq);\n        prev1 = brace[0];\n        next1 = brace[1];\n        nrc = _numCoupons(next1, settl); // when settl==next, days are counted implicitly by nrc\n        return cost *\n            (nrc +\n             _daysBetween(issue, next1, basis) / _daysBetween(prev1, next1, basis) +\n             (settl < next? _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis) : 0));\n    } else {\n        brace = _borderCoupons_fw(first, settl, freq);\n        prev = brace[0];\n        next = brace[1];\n        nrc = _numCoupons(first, settl); // COUPNUM(first, settl, freq, basis) - 1;\n        if (next == settl) {\n            accr = cost * nrc;\n        } else {\n            accr = cost * (nrc + _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis));\n        }\n        if (!calc) { return accr; } // Only the accrued interest between first and settlement dates.\n        brace = _borderCoupons(issue, first, freq); // Add the accrued interest between issue and first dates.\n        prev = brace[0];\n        next = brace[1];\n        nrc = _numCoupons(issue, first);\n        accr += cost * (nrc + _daysBetween(issue, next, basis) / _daysBetween(prev, next, basis));\n        return accr; // accrued interest between issue and settlement dates\n    }\n}\n\n//// DISC  the discount rate for a security (given price and redemption values per 100$ face value) ////\nfunction DISC(settl, matur, pr, redemption, basis) { // DISC(settlement, maturity, pr, redemption, [basis])\n    var annual = basis % 2 === 0 ? 360 : (isLeapYear(unpackDate$1(settl).year) ? 366 : 365);\n    return (redemption - pr)/redemption*annual/_daysBetween(settl, matur, basis);\n}\n\n//// INTRATE  the interest rate for a fully invested security ////\nfunction INTRATE(settl, matur, investment, redemption, basis) { // INTRATE(settlement, maturity, investment, redemption, [basis])\n    var annual = basis % 2 === 0 ? 360 : (isLeapYear(unpackDate$1(settl).year) ? 366 : 365);\n    return (redemption - investment)/investment*annual/_daysBetween(settl, matur, basis);\n}\n\n//// RECEIVED  the amount received at maturity for a fully invested security ////\nfunction RECEIVED(settl, matur, investment, discount, basis) { // RECEIVED(settlement, maturity, investment, discount, [basis])\n    var annual = basis % 2 === 0 ? 360 : (isLeapYear(unpackDate$1(settl).year) ? 366 : 365);\n    return investment/(1 - discount*_daysBetween(settl, matur, basis)/annual);\n}\n\n//// PRICE  the price per $100 face value of a security that pays periodic interest ////\nfunction PRICE(settl, matur, rate, yld, redemption, freq, basis) { // PRICE(settlement, maturity, rate, yld, redemption, frequency, [basis])\n    var N = 1 + ((matur - settl)*freq/(basis % 2 === 0 ? 360 : 365) | 0); // coupons playable between settlement and maturity dates\n    var brace = _borderCoupons(settl, matur, freq),\n        prev = brace[0], next = brace[1];\n    var beg_settl = _daysBetween(prev, settl, basis),\n        settl_end = _daysBetween(settl, next, basis),\n        beg_end = _daysBetween(prev, next, basis);\n    var den = 100*rate/freq,\n        yf = yld/freq,\n        frac = settl_end / beg_end;\n    if (N == 1) {\n        return (redemption + den)/(1 + frac*yf) - beg_settl / beg_end * den;\n    }\n    return redemption / Math.pow(1 + yf, N-1+frac)\n        + den * Math.pow(1 + yf, 1-N-frac) * (Math.pow(1+yf, N) - 1) / yf\n        - beg_settl / beg_end * den;\n}\n\n//// PRICEDISC  the price per $100 face value of a discounted security ////\nfunction PRICEDISC(settl, matur, discount, redemption, basis) { // PRICEDISC(settlement, maturity, discount, redemption, [basis])\n    var dsm = _daysBetween(settl, matur, basis),\n        dy = daysInYear2(unpackDate$1(matur).year, basis);\n    return redemption - discount*redemption*dsm/dy;\n}\n\n// Used in PEARSON, more could follow.  In some situations Excel appears to silently ignore\n// missing or non-numeric values, for example if some value in a is missing a corresponding\n// value in b, then the one in a is going to be ignored as if not present.  Arrays must have the\n// same number of elements.  I couldn't come up with a good name for this function.\nfunction whipNumberArrays(a, b) {\n    for (var i = a.length; --i >= 0;) {\n        if (typeof a[i] != \"number\" || typeof b[i] != \"number\") {\n            a.splice(i, 1);\n            b.splice(i, 1);\n        }\n    }\n}\n\nconst {\n    packDate, unpackDate,\n    packTime, unpackTime,\n    serialToDate, dateToSerial,\n    defineAlias\n} = calc.runtime;\n\nvar commonEngine = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  ALL_PROPERTIES: ALL_PROPERTIES,\n  ALL_REASONS: ALL_REASONS,\n  AddColumnCommand: AddColumnCommand,\n  AddCommand: AddCommand,\n  AddRowCommand: AddRowCommand,\n  AdjustDecimalsCommand: AdjustDecimalsCommand,\n  AdjustRowHeightCommand: AdjustRowHeightCommand,\n  ApplyFilterCommand: ApplyFilterCommand,\n  AutoFillCalculator: AutoFillCalculator,\n  AutoFillCommand: AutoFillCommand,\n  Axis: Axis,\n  AxisManager: AxisManager,\n  BorderChangeCommand: BorderChangeCommand,\n  BringToFrontCommand: BringToFrontCommand,\n  CalcError: CalcError,\n  CellRef: CellRef,\n  ClearContentCommand: ClearContentCommand,\n  ClearFilterCommand: ClearFilterCommand,\n  Clipboard: Clipboard,\n  ColumnWidthCommand: ColumnWidthCommand,\n  Command: Command,\n  Context: Context,\n  Controller: Controller,\n  CopyCommand: CopyCommand,\n  CustomFilter: CustomFilter,\n  CutCommand: CutCommand,\n  Deferred: Deferred,\n  DefineNameCommand: DefineNameCommand,\n  DeleteColumnCommand: DeleteColumnCommand,\n  DeleteCommand: DeleteCommand,\n  DeleteDrawingCommand: DeleteDrawingCommand,\n  DeleteNameCommand: DeleteNameCommand,\n  DeleteRowCommand: DeleteRowCommand,\n  Drawing: Drawing,\n  DrawingCommand: DrawingCommand,\n  DrawingUpdateCommand: DrawingUpdateCommand,\n  DynamicFilter: DynamicFilter,\n  EditCommand: EditCommand,\n  EditValidationCommand: EditValidationCommand,\n  EventListener: EventListener,\n  FIRSTREF: FIRSTREF,\n  Filter: Filter,\n  FilterCommand: FilterCommand,\n  FormulaBar: FormulaBar,\n  FormulaContext: FormulaContext,\n  FormulaInput: FormulaInput,\n  FreezePanesCommand: FreezePanesCommand,\n  Grid: Grid,\n  GridLinesChangeCommand: GridLinesChangeCommand,\n  HideLineCommand: HideLineCommand,\n  HyperlinkCommand: HyperlinkCommand,\n  InsertCommentCommand: InsertCommentCommand,\n  InsertImageCommand: InsertImageCommand,\n  Matrix: Matrix,\n  MergeCellCommand: MergeCellCommand,\n  NULLREF: NULLREF,\n  NameCommand: NameCommand,\n  NameEditor: NameEditor,\n  NameRef: NameRef,\n  OpenCommand: OpenCommand,\n  Pane: Pane,\n  PaneAxis: PaneAxis,\n  PaneGrid: PaneGrid,\n  PasteCommand: PasteCommand,\n  PropertyBag: PropertyBag,\n  PropertyChangeCommand: PropertyChangeCommand,\n  PropertyCleanCommand: PropertyCleanCommand,\n  Range: Range$1,\n  RangeList: RangeList,\n  RangeRef: RangeRef,\n  RangeTree: RangeTree,\n  Ref: Ref,\n  ReorderDrawingsCommand: ReorderDrawingsCommand,\n  RowHeightCommand: RowHeightCommand,\n  SHEETREF: SHEETREF,\n  SaveAsCommand: SaveAsCommand,\n  SendToBackCommand: SendToBackCommand,\n  Sheet: Sheet,\n  SheetDataSourceBinder: SheetDataSourceBinder,\n  SheetEditor: SheetEditor,\n  SheetNavigator: SheetNavigator,\n  SortCommand: SortCommand,\n  Sorter: Sorter,\n  SpreadsheetWidget: SpreadsheetWidget,\n  TargetValueCommand: TargetValueCommand,\n  TextWrapCommand: TextWrapCommand,\n  ToolbarCopyCommand: ToolbarCopyCommand,\n  ToolbarCutCommand: ToolbarCutCommand,\n  ToolbarPasteCommand: ToolbarPasteCommand,\n  TopFilter: TopFilter,\n  UnHideLineCommand: UnHideLineCommand,\n  UnionRef: UnionRef,\n  ValidationFormulaContext: ValidationFormulaContext,\n  ValueFilter: ValueFilter,\n  View: View,\n  Workbook: Workbook,\n  calc: calc,\n  dateToNumber: dateToNumber,\n  dateToSerial: dateToSerial,\n  defineAlias: defineAlias,\n  defineFunction: defineFunction,\n  draw: draw,\n  drawCell: drawCell,\n  formatting: formatting,\n  initDynamicFilter: initDynamicFilter,\n  intl: intl,\n  numberToDate: numberToDate,\n  packDate: packDate,\n  packTime: packTime,\n  registerEditor: registerEditor,\n  serialToDate: serialToDate,\n  unpackDate: unpackDate,\n  unpackTime: unpackTime,\n  validation: validationExport\n});\n\nexport { commonEngine as c };\nexport { __meta__ };"]}