{"version":3,"file":"kendo.spreadsheet.js","names":["clone","hash","target","Object","assign","keys","reduce","copy","key","drawTabularData","options","progress","$","Deferred","promise","dataSource","guidelines","guideColor","columns","headerBackground","headerColor","oddBackground","evenBackground","fontFamily","fontSize","paperSize","margin","landscape","fitWidth","scale","rowHeight","maxEmpty","useGridFormat","kendo","drawing","pdf","defineFont","drawDOM","getFontFaces","document","charWidth","charWidthFunction","textWidth","value","width","i","length","charAt","border","size","color","mkCell","data","borderLeft","borderTop","borderRight","borderBottom","fetch","reject","map","col","title","field","columnTitles","columnWidths","rows","row","rowIndex","cells","colIndex","format","Math","max","background","unshift","label","sheet","spreadsheet","Sheet","verticalAlign","fromJSON","name","w","index","draw","headerRows","resolve","bind","jQuery","ObservableObject","MESSAGES","messages","dialogs","apply","save","cancel","remove","retry","revert","okText","formatCellsDialog","categories","number","currency","date","fontFamilyDialog","fontSizeDialog","bordersDialog","alignmentDialog","buttons","justifyLeft","justifyCenter","justifyRight","justifyFull","alignTop","alignMiddle","alignBottom","mergeDialog","mergeCells","mergeHorizontally","mergeVertically","unmerge","freezeDialog","freezePanes","freezeRows","freezeColumns","unfreeze","confirmationDialog","text","validationDialog","hintMessage","hintTitle","criteria","any","custom","list","comparers","greaterThan","lessThan","between","notBetween","equalTo","notEqualTo","greaterThanOrEqualTo","lessThanOrEqualTo","comparerMessages","labels","comparer","min","start","end","onInvalidData","rejectInput","showWarning","showHint","ignoreBlank","showListButton","showCalendarButton","placeholders","typeTitle","typeMessage","exportAsDialog","defaultFileName","xlsx","description","area","workbook","selection","paper","a2","a3","a4","a5","b3","b4","b5","folio","legal","letter","tabloid","executive","normal","narrow","wide","fit","fileName","saveAsType","exportArea","margins","orientation","print","center","horizontally","vertically","modifyMergedDialog","errorMessage","rangeDisabledDialog","intersectsArrayDialog","incompatibleRangesDialog","noFillDirectionDialog","duplicateSheetNameDialog","overflowDialog","useKeyboardDialog","forCopy","forCut","forPaste","unsupportedSelectionDialog","linkDialog","url","removeLink","sheetRenameDialog","rename","insertCommentDialog","comment","removeComment","insertImageDialog","info","typeError","registry","register","dialogClass","registered","create","SpreadsheetDialog","Observable","extend","init","fn","call","this","translate","events","autoFocus","dialog","_dialog","scrollable","resizable","modal","visible","open","close","_onDialogClose","activate","_onDialogActivate","deactivate","_onDialogDeactivate","addClass","className","append","template","ns","errors","kendoWindow","trigger","action","_action","destroy","element","find","formattedValue","formatting","FormatCellsViewModel","useCategory","category","type","formatCurrency","set","currencies","allFormats","useFirstFormat","formats","undefined","_currency","decimals","iso","convert","categoryFilter","preview","get","uniqueBy","array","result","values","inArray","push","token","n","pattern","replace","Array","join","abbr","JSON","stringify","symbol","test","toLowerCase","FormatCellsDialog","defaultOptions","_generateFormats","$kendoOutput","htmlEncode","currenciesFrom","cultures","numberFormats","dateFormats","calendarPatterns","current","calendars","standard","patterns","range","slice","viewModel","Date","formatItemTemplate","currencyFilter","setOptions","filter","roleSelector","parent","attr","command","property","culture","numberFormat","MessageDialog","messageId","getter","ConfirmationDialog","confirm","isConfirmed","_confirmed","ValidationErrorDialog","_retry","FontFamilyDialog","_list","ul","fonts","defaultFont","default","ui","StaticList","DataSource","change","e","sender","FontSizeDialog","sizes","defaultSize","parseInt","BordersDialog","_borderPalette","observable","state","borderPalette","style","first","BorderPalette","_state","ColorChooser","_value","ColorPickerDialog","_colorPalette","colorPalette","kendoColorPalette","palette","CustomColorDialog","animation","one","_colorPicker","colorPicker","kendoFlatColorPicker","AlignmentDialog","iconClass","icon","dataItem","MergeDialog","FreezeDialog","ValidationViewModel","ValidationCellsViewModel","reset","criterion","setHintMessageTemplate","_mute","shouldBuild","buildMessages","hintTitleTemplate","hintMessageTemplate","from","to","setComparers","defaultHintTitle","all","defaultComparers","text_comparers","idx","shift","defaultHintMessage","isAny","isNumber","showToForNumber","showTo","showToForDate","isDate","isText","isList","isCustom","showRemove","update","validation","fromValidationObject","dataType","comparerType","allowNulls","showButton","messageTemplate","titleTemplate","useCustomMessages","toValidationObject","ValidationDialog","errorTemplate","message","validatable","Validator","validateOnBlur","validate","ExportAsDialog","extension","fileFormats","excel","excelExport","proxyURL","pdfExport","forceProxy","author","autoPrint","subject","keywords","creator","areas","paperSizes","hCenter","vCenter","TEXT","bottom","left","right","top","basicErrorDialog","id","msg","ImportErrorDialog","err","context","error","UseKeyboardDialog","HyperlinkDialog","self","arguments","model","link","on","ev","keyCode","val","stopPropagation","preventDefault","SheetRenameDialog","args","sheetName","_oldSheetName","_newSheetName","InsertCommentDialog","InsertImageDialog","okEnabled","imageUrl","hasImage","isHovered","_url","_image","window","URL","revokeObjectURL","blob","_width","height","_height","stopEvent","drop","selectFile","originalEvent","dataTransfer","files","dragEnter","dragLeave","image","createObjectURL","img","Image","src","onload","Localizable","path","def","split","thing","trans","isArray","ret","prototype","BORDER_TYPES","BORDER_TYPES_ICONS","allBorders","insideBorders","insideHorizontalBorders","insideVerticalBorders","outsideBorders","leftBorder","topBorder","rightBorder","bottomBorder","noBorders","BORDER_PALETTE_MESSAGES","colorPickerPalette","Widget","_borderTypePalette","_borderColorPalette","colorChooser","that","class","appendTo","kendoToggleButton","toHyphens","toggle","_toggle","FlatColorPicker","view","input","_change","wrapper","_apply","_cancel","previous","siblings","checked","getDefaultToolElement","firstIconName","ToolBar","toolbar","addColumnLeft","addColumnRight","addRowAbove","addRowBelow","alignment","alignmentButtons","backgroundColor","increaseFontSize","decreaseFontSize","bold","borders","cut","deleteColumn","deleteRow","formatTypes","automatic","percent","financial","time","dateTime","duration","moreFormats","formatDecreaseDecimal","formatIncreaseDecimal","freeze","freezeButtons","insertComment","insertImage","italic","merge","mergeButtons","paste","redo","undo","exportAs","toggleGridlines","sort","sortButtons","sortRangeAsc","sortRangeDesc","textColor","textWrap","underline","hyperlink","defaultFormats","COLOR_PICKER_MESSAGES","customColor","toolDefaults","separator","extensions","overflow","togglable","component","overflowComponent","componentOptions","fillMode","items","attributes","commandOn","toolIcon","clearButton","sample","itemTemplate","enable","popupComponent","formatCells","selected","SpreadsheetToolBar","forEach","t","showText","tools","toolbarName","parentMessages","defaultTools","handleClick","_click","click","commandType","file","home","insert","refresh","activeCell","_tools","tool","isFunction","showGridLines","_updateTool","resize","toArray","_getItem","vertical","menu","enabled","toolbarEl","widget","widgetInstance","menuItem","_ref","textAlign","removeClass","is","trim","cssProperties","propertyDictionary","Menu","CACHE_CHAR_WIDTH","func","span","div","createElement","position","whiteSpace","appendChild","createTextNode","String","fromCharCode","body","widths","firstChild","nextSibling","offsetWidth","removeChild","ch","code","charCodeAt","registerEditor","calendar","popup","kendoCalendar","kendoPopup","getKendoCalendar","getKendoPopup","callback","dateToNumber","anchor","querySelector","origin","alignLeft","numberToDate","Calendar","fromValidation","toValidation","formula","calc","runtime","Formula","_rowAndColPresent","disableDates","validationComparers","edit","kendoStaticList","selectable","autoBind","getKendoStaticList","item","add","el","Matrix","each","setDataSource","read","outerWidth","_outerWidth","DOT","EMPTYCHAR","SheetsBar","classNames","sheetsBarWrapper","_openDialog","openDialog","_addButton","_menuButton","_tree","dom","Tree","render","_createSheetsWrapper","_initSheetDropDownButtons","_toggleScrollEvents","_createSortable","_sortable","_onSheetReorderStart","_onSheetReorderEnd","_onSheetContextMenu","_onSheetSelect","sheetsBarKItem","_createEditor","distance","_editor","_renderSheets","_sheets","_selectedIndex","sheetsBarEditor","_onEditorKeydown","_onEditorBlur","_destroyEditor","canceled","newSheetName","off","_onSheetRename","renderSheets","sheets","selectedIndex","isInEditMode","_isRtl","support","isRtl","_renderHtml","_scrollableAllowed","_sheetsWrapper","sheetsBarScrollable","sheetsBarSheetsWrapper","_toggleScrollButtons","_sheetsGroup","scrollLeft","prev","sheetsBarPrev","next","sheetsBarNext","toggleClass","scrollWidth","scrollPrevButton","scrollNextButton","sheetsWrapper","event","_nowScrollingSheets","_scrollSheetsByDelta","renderScrollButtons","sheetElements","isSelectedSheet","role","elementContent","sheetsBarKActive","sheetsBarKTextbox","maxlength","sheetsBarKLink","sheetsBarKLinkText","contextMenuButton","html","renderButton","sheetsBarMoreIcon","ind","btnEl","allSheets","visibleSheets","isSingleVisibleSheet","shouldAllowMoveRight","shouldAllowMoveLeft","kendoDropDownButton","itemsWrapper","childrenElements","sheetsBarKReset","baseButtonClass","sheetsBarKButton","sheetsBarKButtonBare","ariaHidden","tabIndex","sheetsBarArrowWIcon","sheetsBarArrowEIcon","children","sheetsBarItems","Sortable","container","axis","ignore","draggable","hint","wrap","sheetsBarHintWrapper","sheetsBarKResetItems","closest","which","oldIndex","newIndex","_onSheetRemove","_onSheetDuplicate","_renamePrompt","_hideSheet","_moveSheet","renameSheetIndex","findIndex","sh","closeCallback","dlg","sheetIndex","direction","newSheetIndex","removedSheetName","confirmation","selectedSheetText","_scrollSheetsToItem","isAddButton","_onAddSelect","_onMenuSelect","addButton","sheetsBarAdd","kendoButton","sheetsBarPlusIcon","menuButton","sheetsBarSheetsMenu","sheetsBarMenuIcon","cssClass","isNaN","itemPosition","sheetsGroup","currentScrollOffset","itemWidth","itemOffset","sheetsGroupWidth","finish","animate","delta","scrLeft","sheetsBarRemove","sheetsBarKIcon","sheetsBarKFontIcon","sheetsBarKButtonDefaults","sheetsBarXIcon","sheetsBarKSprite","details","button","detailsSummary","detailsContent","iconCollapseName","iconExpandName","iconSearchName","textbox","filterByCondition","filterByValue","valuesTreeViewWrapper","actionButtons","filterMenu","sortAscending","sortDescending","search","addToCurrent","clear","blanks","operatorNone","and","or","operators","string","contains","doesnotcontain","startswith","endswith","matches","doesnotmatch","eq","neq","lt","gt","gte","lte","Details","FilterMenu","_summary","iconName","expanded","_icon","prependTo","_container","hide","show","fx","expand","stop","binders","spreadsheetFilterValue","Binder","bindings","templates","guid","dir","query","hasVisibleChildren","HierarchicalDataSource","toString","toLocaleLowerCase","itemVisible","indexOf","anyVisibleChildren","filterSpread","hidden","operator","uncheckAll","hasChildren","FilterMenuViewModel","valuesChange","valuesDataSource","toJSON","appendToSearch","valueFilter","concat","lastIndexOf","valueSelect","node","hasActiveSearch","filterValues","logic","operatorChange","isNone","isString","flattenOperators","hasOwnProperty","unique","FilterMenuController","valuesTree","column","columnRange","forEachCell","cell","isHiddenRow","distinctValues","a","b","filterType","filterForColumn","topValue","filters","allFilters","columnFilters","active","checkboxesConfig","checkChildren","_filterInit","_popup","_sort","_filterByCondition","_filterByValue","_actionButtons","valuesTreeView","openFor","hasClass","pageX","pageY","_active","customFilter","operatingRange","activeFilter","copyAnchorStyles","kendoMenu","select","_appendTemplate","compiledTemplate","_detailToggle","not","isExpanded","accentFoldingFiltering","activeContainer","defaultSheetName","nameBox","formulaInput","openUnsupported","shiftingNonblankCells","insertColumnWhenRowIsSelected","insertRowWhenColumnIsSelected","filterRangeContainingMerges","sortRangeContainingMerges","cantSortMultipleSelection","cantSortNullRef","cantSortMixedCells","validationError","cannotModifyDisabled","insertRowBelowLastRow","insertColAfterLastCol","tabs","menus","delete","unhide","bringToFront","sendToBack","PDFMixin","override_drawPDF","group","activeSheet","overrideSaveAsPDF","saveAsPDF","_drawPDF","then","root","pdfResultPromise","exportPDF","exportPDFToBlob","convertPromiseToDeferred","done","dataURI","saveAs","proxyTarget","fail","Workbook","__meta__","depends","undefined$1","browser","msie","version","K_ACTIVE","NS","commonEngine","FormulaInput","toActionSelector","selectors","COMPOSITE_UNAVAILABLE_ACTION_SELECTORS","UNHIDE_ACTION_SELECTORS","viewClassNames","View","ContextMenu","FormulaInputStaticList","d","itemClick","handler","FormulaInputRefArgs","constructor","NameBoxRefArgs","nameEditor","combo","initializeComboBox","transport","readData","success","cache","kendoComboBox","dataTextField","dataValueField","ignoreCase","onChange","noDataTemplate","onKeyDown","onDelete","editor","Spreadsheet","_renderInnerContent","SPREADSHEET_CONTENT_HTML_TEMPLATE","_createFormulaInputs","spreadsheetRef","_initSpreadsheetWidget","_bindWorkbookEvents","_onUpdateTools","_resizeHandler","_showWatermarkOverlay","widgetOptions","sheetsbar","formulaBarInputRef","_formulaBarInputRefList","_formulaBarInputRefPopup","formulaCellInputRef","_formulaCellInputRefList","_formulaCellInputRefPopup","nameBoxRef","createFilterMenu","createTabStrip","_initHeader","focus","createSheetEditor","sheetsBar","createSheetBar","openDialogCallback","_sheetsBar","createContextMenus","_dialogs","_initContextMenus","createSheetDataSource","getWorkbookCommand","commandName","commandOptions","getIconHTMLString","reason","sheetSelection","ref","dialogOptions","opts","commandArgs","saveAsExcel","ooxml","exportOptions","executeCommand","pop","contextmenu","objectRef","targetType","showUnhide","showUnmerge","isComposite","topLeft","bottomRight","cellContextMenu","colHeaderContextMenu","rowHeaderContextMenu","drawingContextMenu","setTimeout","locale","intl","kendoCultureToIntl","SpreadsheetWidget","formulaBarInputRefElement","formulaBarInputRefListId","listWrapper","insertAfter","aria","itemRole","Popup","formulaCellInputRefElement","formulaCellInputRefListId","cellEditor","contextMenuConfig","showOn","CELL_CONTEXT_MENU","COL_HEADER_CONTEXT_MENU","ROW_HEADER_CONTEXT_MENU","DRAWING_CONTEXT_MENU","onContextMenuSelect","_controller","navigator","_sheet","_activeDrawing","overElement","_getCopyRegex","newName","replaceAll","RegExp","sheetsbarOptions","onAddSelect","onSheetSelect","onSheetReorderEnd","onSheetRename","sheetToCopy","sheetByName","copies","regex","insertSheet","onSheetRemove","sheetToHide","x","visibleSheetIndex","nextVisibleSheet","_sheetsSearchCache","_createToolBar","toolbarId","empty","activeTabIndex","activeToolbar","_activeToolBar","undoRedoStack","content","toolbarOptions","defaultTab","_resize","layout","_workbookChanging","_workbookChange","_autoRefresh","recalc","Range","_workbookCut","_workbookCopy","_workbookPaste","moveSheetToIndex","removeSheet","sheetByIndex","renameSheet","autoRefresh","json","saveJSON","fromFile","_workbook","_workbookExcelExport","_workbookExcelImport","_initProgress","deferred","loading","pb","kendoProgressBar","chunkCount","finally","_workbookPdfExport","_workbookInsertSheet","_workbookRemoveSheet","_workbookSelectSheet","_workbookRenameSheet","_workbookInsertRow","_workbookInsertColumn","_workbookDeleteRow","_workbookDeleteColumn","_workbookHideRow","_workbookHideColumn","_workbookUnhideRow","_workbookUnhideColumn","_workbookSelect","_workbookChangeFormat","_workbookDataBinding","_workbookDataBound","_workbookProgress","columnWidth","headerHeight","headerWidth","defaultCellStyle","useCultureDecimals","defineName","undefineName","nameValue","forEachName","addImage","cleanupImages","plugin","kendo$1"],"sources":["kendo.spreadsheet.js"],"mappings":"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","ignoreList":[],"sourcesContent":["import './kendo.excel.js';\nimport './kendo.progressbar.js';\nimport './kendo.pdf.js';\nimport './kendo.toolbar.js';\nimport './kendo.list.js';\nimport './kendo.spreadsheet.common.js';\nimport './kendo.core.js';\nimport './kendo.binder.js';\nimport './kendo.validator.js';\nimport './kendo.icons.js';\nimport './kendo.window.js';\nimport './kendo.colorpicker.js';\nimport './kendo.combobox.js';\nimport './kendo.dropdownlist.js';\nimport './kendo.dropdownbutton.js';\nimport './kendo.popup.js';\nimport './kendo.togglebutton.js';\nimport './kendo.calendar.js';\nimport './kendo.listview.js';\nimport './kendo.dom.js';\nimport './kendo.sortable.js';\nimport './kendo.treeview.js';\nimport './kendo.numerictextbox.js';\nimport './kendo.datepicker.js';\nimport './kendo.datetimepicker.js';\nimport './kendo.ooxml.js';\n\n(function(kendo) {\n    var $ = kendo.jQuery;\n    var ObservableObject = kendo.data.ObservableObject;\n\n    var MESSAGES = kendo.spreadsheet.messages.dialogs = {\n        apply: \"Apply\",\n        save: \"Save\",\n        cancel: \"Cancel\",\n        remove: \"Remove\",\n        retry: \"Retry\",\n        revert: \"Revert\",\n        okText: \"OK\",\n        formatCellsDialog: {\n            title: \"Format\",\n            categories: {\n                number: \"Number\",\n                currency: \"Currency\",\n                date: \"Date\"\n            }\n        },\n        fontFamilyDialog: {\n            title: \"Font\"\n        },\n        fontSizeDialog: {\n            title: \"Font size\"\n        },\n        bordersDialog: {\n            title: \"Borders\"\n        },\n        alignmentDialog: {\n            title: \"Alignment\",\n            buttons: {\n                justifyLeft: \"Align left\",\n                justifyCenter: \"Center\",\n                justifyRight: \"Align right\",\n                justifyFull: \"Justify\",\n                alignTop: \"Align top\",\n                alignMiddle: \"Align middle\",\n                alignBottom: \"Align bottom\"\n            }\n        },\n        mergeDialog: {\n            title: \"Merge cells\",\n            buttons: {\n                mergeCells: \"Merge all\",\n                mergeHorizontally: \"Merge horizontally\",\n                mergeVertically: \"Merge vertically\",\n                unmerge: \"Unmerge\"\n            }\n        },\n        freezeDialog: {\n            title: \"Freeze panes\",\n            buttons: {\n                freezePanes: \"Freeze panes\",\n                freezeRows: \"Freeze rows\",\n                freezeColumns: \"Freeze columns\",\n                unfreeze: \"Unfreeze panes\"\n            }\n        },\n        confirmationDialog: {\n            text: \"Are you sure you want to remove this sheet?\",\n            title: \"Sheet remove\"\n        },\n        validationDialog: {\n            title: \"Data Validation\",\n            hintMessage: \"Please enter a valid {0} value {1}.\",\n            hintTitle: \"Validation {0}\",\n            criteria: {\n                any: \"Any value\",\n                number: \"Number\",\n                text: \"Text\",\n                date: \"Date\",\n                custom: \"Custom Formula\",\n                list: \"List\"\n            },\n            comparers: {\n                greaterThan: \"greater than\",\n                lessThan: \"less than\",\n                between: \"between\",\n                notBetween: \"not between\",\n                equalTo: \"equal to\",\n                notEqualTo: \"not equal to\",\n                greaterThanOrEqualTo: \"greater than or equal to\",\n                lessThanOrEqualTo: \"less than or equal to\"\n            },\n            comparerMessages: {\n                greaterThan: \"greater than {0}\",\n                lessThan: \"less than {0}\",\n                between: \"between {0} and {1}\",\n                notBetween: \"not between {0} and {1}\",\n                equalTo: \"equal to {0}\",\n                notEqualTo: \"not equal to {0}\",\n                greaterThanOrEqualTo: \"greater than or equal to {0}\",\n                lessThanOrEqualTo: \"less than or equal to {0}\",\n                custom: \"that satisfies the formula: {0}\"\n            },\n            labels: {\n                criteria: \"Criteria\",\n                comparer: \"Comparer\",\n                min: \"Min\",\n                max: \"Max\",\n                value: \"Value\",\n                start: \"Start\",\n                end: \"End\",\n                onInvalidData: \"On invalid data\",\n                rejectInput: \"Reject input\",\n                showWarning: \"Show warning\",\n                showHint: \"Show hint\",\n                hintTitle: \"Hint title\",\n                hintMessage: \"Hint message\",\n                ignoreBlank: \"Ignore blank\",\n                showListButton: \"Display button to show list\",\n                showCalendarButton: \"Display button to show calendar\"\n            },\n            placeholders: {\n                typeTitle: \"Type title\",\n                typeMessage: \"Type message\"\n            }\n        },\n        exportAsDialog: {\n            title: \"Export...\",\n            defaultFileName: \"Workbook\",\n            xlsx: {\n                description: \"Excel Workbook (.xlsx)\"\n            },\n            pdf: {\n                description: \"Portable Document Format (.pdf)\",\n                area: {\n                    workbook: \"Entire Workbook\",\n                    sheet: \"Active Sheet\",\n                    selection: \"Selection\"\n                },\n                paper: {\n                    a2        : \"A2 (420 mm × 594 mm)\",\n                    a3        : \"A3 (297 mm x 420 mm)\",\n                    a4        : \"A4 (210 mm x 297 mm)\",\n                    a5        : \"A5 (148 mm x 210 mm)\",\n                    b3        : \"B3 (353 mm × 500 mm)\",\n                    b4        : \"B4 (250 mm x 353 mm)\",\n                    b5        : \"B5 (176 mm x 250 mm)\",\n                    folio     : 'Folio (8.5\" x 13\")',\n                    legal     : 'Legal (8.5\" x 14\")',\n                    letter    : 'Letter (8.5\" x 11\")',\n                    tabloid   : 'Tabloid (11\" x 17\")',\n                    executive : 'Executive (7.25\" x 10.5\")'\n                },\n                margin: {\n                    normal: \"Normal\",\n                    narrow: \"Narrow\",\n                    wide: \"Wide\"\n                }\n            },\n            labels: {\n                scale: \"Scale\",\n                fit: \"Fit to page\",\n                fileName: \"File name\",\n                saveAsType: \"Save as type\",\n                exportArea: \"Export\",\n                paperSize: \"Paper size\",\n                margins: \"Margins\",\n                orientation: \"Orientation\",\n                print: \"Print\",\n                guidelines: \"Guidelines\",\n                center: \"Center\",\n                horizontally: \"Horizontally\",\n                vertically: \"Vertically\"\n            }\n        },\n        modifyMergedDialog: {\n            errorMessage: \"Cannot change part of a merged cell.\"\n        },\n        rangeDisabledDialog: {\n            errorMessage: \"Destination range contains disabled cells.\"\n        },\n        intersectsArrayDialog: {\n            errorMessage: \"You cannot alter part of an array\"\n        },\n        incompatibleRangesDialog: {\n            errorMessage: \"Incompatible ranges\"\n        },\n        noFillDirectionDialog: {\n            errorMessage: \"Cannot determine fill direction\"\n        },\n        duplicateSheetNameDialog: {\n            errorMessage: \"Duplicate sheet name\"\n        },\n        overflowDialog: {\n            errorMessage: \"Cannot paste, because the copy area and the paste area are not the same size and shape.\"\n        },\n        useKeyboardDialog: {\n            title: \"Copying and pasting\",\n            errorMessage: \"These actions cannot be invoked through the menu. Please use the keyboard shortcuts instead:\",\n            labels: {\n                forCopy: \"for copy\",\n                forCut: \"for cut\",\n                forPaste: \"for paste\"\n            }\n        },\n        unsupportedSelectionDialog: {\n            errorMessage: \"That action cannot be performed on multiple selection.\"\n        },\n        linkDialog: {\n            title: \"Hyperlink\",\n            labels: {\n                text: \"Text\",\n                url: \"Address\",\n                removeLink: \"Remove link\"\n            }\n        },\n        sheetRenameDialog: {\n            title: \"Rename Sheet\",\n            labels: {\n                text: \"Rename Sheet\",\n                rename: \"Rename\"\n            }\n        },\n        insertCommentDialog: {\n            title: \"Insert comment\",\n            labels: {\n                comment: \"Comment\",\n                removeComment: \"Remove comment\"\n            }\n        },\n        insertImageDialog: {\n            title: \"Insert image\",\n            info: \"Drag an image here, or click to select\",\n            typeError: \"Please select a JPEG, PNG or GIF image\"\n        }\n    };\n\n    var registry = {};\n    kendo.spreadsheet.dialogs = {\n        register: function(name, dialogClass) {\n            registry[name] = dialogClass;\n        },\n        registered: function(name) {\n            return !!registry[name];\n        },\n        create: function(name, options) {\n            var dialogClass = registry[name];\n\n            if (dialogClass) {\n                return new dialogClass(options);\n            }\n        }\n    };\n\n    var SpreadsheetDialog = kendo.spreadsheet.SpreadsheetDialog = kendo.Observable.extend({\n        init: function(options) {\n            kendo.Observable.fn.init.call(this, options);\n\n            this.options = translate($.extend(true, {}, this.options, options));\n\n            this.bind(this.events, options);\n        },\n        events: [\n            \"close\",\n            \"activate\"\n        ],\n        options: {\n            autoFocus: true\n        },\n        dialog: function() {\n            if (!this._dialog) {\n                var options = {\n                    autoFocus: false,\n                    scrollable: false,\n                    resizable: false,\n                    modal: true,\n                    visible: false,\n                    width: this.options.width || 320,\n                    title: this.options.title,\n                    open: function() {\n                        this.center();\n                    },\n                    close: this._onDialogClose.bind(this),\n                    activate: this._onDialogActivate.bind(this),\n                    deactivate: this._onDialogDeactivate.bind(this)\n                };\n                this._dialog = $(\"<div class='k-spreadsheet-window k-action-window k-popup-edit-form' />\")\n                    .addClass(this.options.className || \"\")\n                    .append(kendo.template(this.options.template)({\n                        messages: kendo.spreadsheet.messages.dialogs || MESSAGES,\n                        ns: kendo.ns,\n\n                        // this is for ImportErrorDialog.  ugly that\n                        // we need this line here, but I couldn't\n                        // figure out a better way\n                        errors: this.options.errors\n                    }))\n                    .kendoWindow(options)\n                    .data(\"kendoWindow\");\n            }\n\n            return this._dialog;\n        },\n        _onDialogClose: function() {\n            this.trigger(\"close\", {\n                action: this._action\n            });\n        },\n        _onDialogActivate: function() {\n            this.trigger(\"activate\");\n        },\n        _onDialogDeactivate: function() {\n            this.trigger(\"deactivate\");\n            this.destroy();\n        },\n        destroy: function() {\n            if (this._dialog) {\n                this._dialog.destroy();\n                this._dialog = null;\n            }\n        },\n        open: function() {\n            this.dialog().open();\n            this.dialog().element.find(\".k-button-solid-primary\").trigger(\"focus\");\n        },\n        apply: function() {\n            this.close();\n        },\n        close: function() {\n            this._action = \"close\";\n\n            this.dialog().close();\n        }\n    });\n\n    function formattedValue(value, format) {\n        return kendo.spreadsheet.formatting.text(value, format);\n    }\n\n    var FormatCellsViewModel = kendo.spreadsheet.FormatCellsViewModel = ObservableObject.extend({\n        init: function(options) {\n            ObservableObject.fn.init.call(this, options);\n\n            this.useCategory(this.category);\n        },\n        useCategory: function(category) {\n            var type = category && category.type || \"number\";\n            var formatCurrency = type == \"currency\";\n\n            this.category = category;\n\n            this.set(\"showCurrencyFilter\", formatCurrency && this.currencies.length > 1);\n\n            if (!formatCurrency) {\n                this.set(\"formats\", this.allFormats[type + \"Formats\"]);\n            } else {\n                this.currency(this.currencies[0]);\n            }\n\n            this.useFirstFormat();\n        },\n        useFirstFormat: function() {\n            if (this.formats.length) {\n                this.set(\"format\", this.formats[0].value);\n            }\n        },\n        currency: function(currency) {\n            if (currency !== undefined) {\n                this._currency = currency;\n\n                var info = currency.value;\n                var formats = [\n                    { currency: info, decimals: true },\n                    { currency: info, decimals: true, iso: true },\n                    { currency: info, decimals: false }\n                ];\n\n                formats = formats.map(function(format) {\n                    format = FormatCellsViewModel.convert.currency(format);\n\n                    return { value: format, name: formattedValue(1000, format) };\n                });\n\n                this.set(\"formats\", formats);\n\n                this.useFirstFormat();\n            }\n\n            return this._currency || this.currencies[0];\n        },\n        categoryFilter: function(category) {\n            if (category !== undefined) {\n                this.useCategory(category);\n            }\n\n            return this.category;\n        },\n        preview: function() {\n            var format = this.get(\"format\");\n            var value = this.value || 0;\n\n            if (format && format.length) {\n                return formattedValue(value, format);\n            } else {\n                return value;\n            }\n        }\n    });\n\n    FormatCellsViewModel.convert = {\n        currency: function(options) {\n            function repeat(token, n) {\n                return new Array(n+1).join(token);\n            }\n\n            // convert culture info to spreadsheet format\n            var info = options.currency;\n            var format = info.pattern[1];\n\n            if (options.decimals) {\n                format = format.replace(/n/g, \"n\" + info[\".\"] + repeat(\"0\", info.decimals));\n            }\n\n            if (options.iso) {\n                format = '\"' + info.abbr + '\" ' + format.replace(/\\s*\\$\\s*/g, \"\");\n            } else {\n                format = format.replace(/\\$/g, JSON.stringify(info.symbol));\n            }\n\n            format = format.replace(/n/g, \"?\");\n\n            return format;\n        },\n        date: function(format) {\n            if ((/T|Z/).test(format)) {\n                return \"\";\n            }\n\n            return format.toLowerCase().replace(/tt/g, \"AM/PM\").replace(/'/g, '\"');\n        }\n    };\n\n    function uniqueBy(field, array) {\n        var result = [];\n        var values = [];\n\n        for (var i = 0; i < array.length; i++) {\n            if ($.inArray(array[i][field], values) == -1) {\n                result.push(array[i]);\n                values.push(array[i][field]);\n            }\n        }\n\n        return result;\n    }\n\n    var FormatCellsDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.formatCellsDialog || MESSAGES;\n            var defaultOptions = {\n                title: messages.title,\n                categories: [\n                    { type: \"number\", name: messages.categories.number },\n                    { type: \"currency\", name: messages.categories.currency },\n                    { type: \"date\", name: messages.categories.date }\n                ]\n            };\n\n            SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n            this._generateFormats();\n        },\n        options: {\n            className: \"k-spreadsheet-format-cells\",\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div class='k-edit-form-container'><div class='k-root-tabs' data-${kendo.htmlEncode(data.ns)}role='tabstrip' data-${kendo.htmlEncode(data.ns)}text-field='name' data-${kendo.htmlEncode(data.ns)}bind='source: categories, value: categoryFilter' data-${kendo.htmlEncode(data.ns)}animation='false'></div>\n    <div class='k-spreadsheet-preview' data-${kendo.htmlEncode(data.ns)}bind='text: preview'></div><select data-${kendo.htmlEncode(data.ns)}role='dropdownlist' class='k-format-filter' data-${kendo.htmlEncode(data.ns)}text-field='description' data-${kendo.htmlEncode(data.ns)}value-field='value.name' data-${kendo.htmlEncode(data.ns)}bind='visible: showCurrencyFilter, value: currency, source: currencies'></select><ul data-${kendo.htmlEncode(data.ns)}role='staticlist' tabindex='0' id='formats-list' aria-label='formats list' class='k-list k-reset' bind:data-${kendo.htmlEncode(data.ns)}template='formatItemTemplate' data-${kendo.htmlEncode(data.ns)}value-primitive='true' data-${kendo.htmlEncode(data.ns)}value-field='value' data-${kendo.htmlEncode(data.ns)}bind='source: formats, value: format'></ul>\n    <div class='k-actions'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-${kendo.htmlEncode(data.ns)}bind='click: apply'><span class='k-button-text'>${kendo.htmlEncode(data.messages.apply)}</span></button><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-${kendo.htmlEncode(data.ns)}bind='click: close'><span class='k-button-text'>${kendo.htmlEncode(data.messages.cancel)}</span></button></div>\n</div>`;\n                return $kendoOutput;\n            }\n        },\n        _generateFormats: function() {\n            var options = this.options;\n\n            if (!options.currencies) {\n                options.currencies = FormatCellsDialog.currenciesFrom(kendo.cultures);\n            }\n\n            if (!options.numberFormats) {\n                options.numberFormats = [\n                    { value: \"#.00%\", name: \"100.00%\" },\n                    { value: \"#%\", name: \"100%\" },\n                    { value: \"#.00\", name: \"1024.00\" },\n                    { value: \"#,###.00\", name: \"1,024.00\" }\n                ];\n            }\n\n            if (!options.dateFormats) {\n                var calendarPatterns = kendo.cultures.current.calendars.standard.patterns;\n\n                options.dateFormats = uniqueBy(\"value\", $.map(calendarPatterns, function(format) {\n                    format = FormatCellsViewModel.convert.date(format);\n\n                    if (!format) {\n                        return;\n                    }\n\n                    return { value: format, name: formattedValue(34567.7678, format) };\n                }));\n            }\n        },\n        open: function(range) {\n            var options = this.options;\n            var value = range.value();\n            var categories = options.categories.slice(0);\n            var element;\n\n            this.viewModel = new FormatCellsViewModel({\n                currencies: options.currencies.slice(0),\n                allFormats: {\n                    numberFormats: options.numberFormats.slice(0),\n                    dateFormats: options.dateFormats.slice(0)\n                },\n                categories: categories,\n                format: range.format(),\n                category: value instanceof Date ? categories[2] : categories[0],\n                apply: this.apply.bind(this),\n                close: this.close.bind(this),\n                value: value,\n                formatItemTemplate: (data) => kendo.htmlEncode(data.name)\n            });\n\n            SpreadsheetDialog.fn.open.call(this);\n\n            element = this.dialog().element;\n\n            kendo.bind(element, this.viewModel);\n\n            var currencyFilter = element.find(\"select.k-format-filter\").data(\"kendoDropDownList\");\n\n            if (options.currencies.length > 10) {\n                currencyFilter.setOptions({ filter: \"contains\" });\n            }\n\n            element.find(kendo.roleSelector(\"staticlist\")).parent().addClass(\"k-list-wrapper\");\n\n            element.find(\".k-tabstrip-item\").attr(\"aria-controls\", \"formats-list\");\n        },\n        apply: function() {\n            var format = this.viewModel.format;\n\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"PropertyChangeCommand\",\n                options: {\n                    property: \"format\",\n                    value: format\n                }\n            });\n        }\n    });\n\n    FormatCellsDialog.currenciesFrom = function (cultures) {\n        return uniqueBy(\"description\", $.map(cultures, function(culture, name) {\n            if (!(/-/).test(name)) {\n                return;\n            }\n\n            var currency = culture.numberFormat.currency;\n            var description = kendo.format(\n                \"{0} ({1}, {2})\",\n                currency.name,\n                currency.abbr,\n                currency.symbol\n            );\n\n            return { description: description, value: currency };\n        }));\n    };\n\n    kendo.spreadsheet.dialogs.register(\"formatCells\", FormatCellsDialog);\n\n    kendo.spreadsheet.dialogs.FormatCellsDialog = FormatCellsDialog;\n\n    var MessageDialog = SpreadsheetDialog.extend({\n        options: {\n            className: \"k-spreadsheet-message\",\n            title: \"\",\n            messageId: \"\",\n            text: \"\",\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div class='k-spreadsheet-message-content' data-${kendo.htmlEncode(data.ns)}bind='text: text'></div>\n<div class='k-actions'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'\n        data-${kendo.htmlEncode(data.ns)}bind='click: close'><span\n            class='k-button-text'>${data.messages.okText}</span></button></div>`;\n                return $kendoOutput;\n            }\n        },\n        open: function() {\n            SpreadsheetDialog.fn.open.call(this);\n\n            var options = this.options;\n            var text = options.text;\n\n            if (options.messageId) {\n                text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n            }\n\n            kendo.bind(this.dialog().element, {\n                text: text,\n                close: this.close.bind(this)\n            });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"message\", MessageDialog);\n\n    var ConfirmationDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.confirmationDialog || MESSAGES;\n            var defaultOptions = {\n                title: messages.title,\n                text: messages.text\n            };\n\n            SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n        },\n        options: {\n            className: \"k-spreadsheet-message\",\n            messageId: \"\",\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div class='k-spreadsheet-message-content' data-${kendo.htmlEncode(data.ns)}bind='text: text'></div>\n<div class='k-actions'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'\n        data-${kendo.htmlEncode(data.ns)}bind='click: confirm'><span\n            class='k-button-text'>${data.messages.okText}</span></button><button\n        class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'\n        data-${kendo.htmlEncode(data.ns)}bind='click: cancel'><span\n            class='k-button-text'>${data.messages.cancel}</span></button></div>`;\n                return $kendoOutput;\n            }\n        },\n        open: function() {\n            SpreadsheetDialog.fn.open.call(this);\n\n            var options = this.options;\n            var text = options.text;\n\n            if (options.messageId) {\n                text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n            }\n\n            kendo.bind(this.dialog().element, {\n                text: text,\n                confirm: this.confirm.bind(this),\n                cancel: this.close.bind(this)\n            });\n        },\n        isConfirmed: function() {\n            return this._confirmed;\n        },\n        confirm: function() {\n            this._confirmed = true;\n            this.close();\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"confirmation\", ConfirmationDialog);\n\n    var ValidationErrorDialog = SpreadsheetDialog.extend({\n        options: {\n            className: \"k-spreadsheet-message\",\n            title: \"\",\n            messageId: \"\",\n            text: \"\",\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div class='k-spreadsheet-message-content' data-${kendo.htmlEncode(data.ns)}bind='text: text'></div><div class='k-actions'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-${kendo.htmlEncode(data.ns)}bind='click: retry'><span class='k-button-text'>${data.messages.retry}</span></button><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-${kendo.htmlEncode(data.ns)}bind='click: cancel'><span class='k-button-text'>${data.messages.cancel}</span></button></div>`;\n                return $kendoOutput;\n            }\n        },\n        open: function() {\n            SpreadsheetDialog.fn.open.call(this);\n\n            var options = this.options;\n            var text = options.text;\n\n            if (options.messageId) {\n                text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n            }\n\n            kendo.bind(this.dialog().element, {\n                text: text,\n                retry: this.retry.bind(this),\n                cancel: this.close.bind(this)\n            });\n        },\n        retry: function() {\n            this._retry = true;\n            this.close();\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"validationError\", ValidationErrorDialog);\n\n    var FontFamilyDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.fontFamilyDialog || MESSAGES;\n\n            SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n\n            this._list();\n        },\n        options: {\n            template: () => \"<ul class='k-list k-reset'></ul>\"\n        },\n        _list: function() {\n            var ul = this.dialog().element.find(\"ul\");\n            var fonts = this.options.options;\n            var defaultFont = this.options.default;\n\n            this.list = new kendo.ui.StaticList(ul, {\n                dataSource: new kendo.data.DataSource({ data: fonts }),\n                template: (data) => kendo.htmlEncode(data),\n                value: defaultFont,\n                change: this.apply.bind(this)\n            });\n\n            this.list.dataSource.fetch();\n        },\n        apply: function(e) {\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"PropertyChangeCommand\",\n                options: {\n                    property: \"fontFamily\",\n                    value: e.sender.value()[0]\n                }\n            });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"fontFamily\", FontFamilyDialog);\n\n    var FontSizeDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.fontSizeDialog || MESSAGES;\n\n            SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n\n            this._list();\n        },\n        options: {\n            template: () => \"<ul class='k-list k-reset'></ul>\"\n        },\n        _list: function() {\n            var ul = this.dialog().element.find(\"ul\");\n            var sizes = this.options.options;\n            var defaultSize = this.options.default;\n\n            this.list = new kendo.ui.StaticList(ul, {\n                dataSource: new kendo.data.DataSource({ data: sizes }),\n                template: (data) => kendo.htmlEncode(data),\n                value: defaultSize,\n                change: this.apply.bind(this)\n            });\n\n            this.list.dataSource.fetch();\n        },\n        apply: function(e) {\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"PropertyChangeCommand\",\n                options: {\n                    property: \"fontSize\",\n                    value: kendo.parseInt(e.sender.value()[0])\n                }\n            });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"fontSize\", FontSizeDialog);\n\n    var BordersDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.bordersDialog || MESSAGES;\n\n            SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n\n            this.element = this.dialog().element;\n            this._borderPalette();\n\n            this.viewModel = kendo.observable({\n                apply: this.apply.bind(this),\n                close: this.close.bind(this)\n            });\n\n            kendo.bind(this.element.find(\".k-actions\"), this.viewModel);\n        },\n        options: {\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div></div>\n<div class='k-actions'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'\n        data-${kendo.htmlEncode(data.ns)}bind='click: apply'><span\n            class='k-button-text'>${kendo.htmlEncode(data.messages.apply)}</span></button><button\n        class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'\n        data-${kendo.htmlEncode(data.ns)}bind='click: close'><span\n            class='k-button-text'>${kendo.htmlEncode(data.messages.cancel)}</span></button></div>`;\n                return $kendoOutput;\n            }\n        },\n        apply: function() {\n            SpreadsheetDialog.fn.apply.call(this);\n\n            var state = this.borderPalette.value();\n\n            if (state.color && state.type) {\n                this.trigger(\"action\", {\n                    command: \"BorderChangeCommand\",\n                    options: {\n                        border: state.type,\n                        style: { size: 1, color: state.color }\n                    }\n                });\n            }\n        },\n        _borderPalette: function() {\n            var element = this.dialog().element.find(\"div\").first();\n\n            this.borderPalette = new kendo.spreadsheet.BorderPalette(element, {\n                change: this.value.bind(this)\n            });\n        },\n        value: function(state) {\n            if (state === undefined) {\n                return this._state;\n            } else {\n                this._state = state;\n            }\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"borders\", BordersDialog);\n\n    var ColorChooser = SpreadsheetDialog.extend({\n        init: function(options) {\n            SpreadsheetDialog.fn.init.call(this, options);\n\n            this.element = this.dialog().element;\n            this.property = options.property;\n            this.options.title = options.title;\n\n            this.viewModel = kendo.observable({\n                apply: this.apply.bind(this),\n                close: this.close.bind(this)\n            });\n\n            kendo.bind(this.element.find(\".k-actions\"), this.viewModel);\n        },\n        options: {\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div></div>\n<div class='k-actions'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'\n        data-${kendo.htmlEncode(data.ns)}bind='click: apply'><span\n            class='k-button-text'>${kendo.htmlEncode(data.messages.apply)}</span></button><button\n        class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'\n        data-${kendo.htmlEncode(data.ns)}bind='click: close'><span\n            class='k-button-text'>${kendo.htmlEncode(data.messages.cancel)}</span></button></div>`;\n                return $kendoOutput;\n            }\n        },\n        apply: function() {\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"PropertyChangeCommand\",\n                options: {\n                    property: this.property,\n                    value: this.value()\n                }\n            });\n        },\n        value: function(e) {\n            if (e === undefined) {\n                return this._value;\n            } else {\n                this._value = e.value;\n            }\n        }\n    });\n\n    var ColorPickerDialog = ColorChooser.extend({\n        init: function(options) {\n            options.width = 177;\n            ColorChooser.fn.init.call(this, options);\n            this._colorPalette();\n        },\n        _colorPalette: function() {\n            var element = this.dialog().element.find(\"div\").first();\n            this.colorPalette = element.kendoColorPalette({\n                palette: [ //metro palette\n                    \"#ffffff\", \"#000000\", \"#d6ecff\", \"#4e5b6f\", \"#7fd13b\", \"#ea157a\", \"#feb80a\", \"#00addc\", \"#738ac8\", \"#1ab39f\",\n                    \"#f2f2f2\", \"#7f7f7f\", \"#a7d6ff\", \"#d9dde4\", \"#e5f5d7\", \"#fad0e4\", \"#fef0cd\", \"#c5f2ff\", \"#e2e7f4\", \"#c9f7f1\",\n                    \"#d8d8d8\", \"#595959\", \"#60b5ff\", \"#b3bcca\", \"#cbecb0\", \"#f6a1c9\", \"#fee29c\", \"#8be6ff\", \"#c7d0e9\", \"#94efe3\",\n                    \"#bfbfbf\", \"#3f3f3f\", \"#007dea\", \"#8d9baf\", \"#b2e389\", \"#f272af\", \"#fed46b\", \"#51d9ff\", \"#aab8de\", \"#5fe7d5\",\n                    \"#a5a5a5\", \"#262626\", \"#003e75\", \"#3a4453\", \"#5ea226\", \"#af0f5b\", \"#c58c00\", \"#0081a5\", \"#425ea9\", \"#138677\",\n                    \"#7f7f7f\", \"#0c0c0c\", \"#00192e\", \"#272d37\", \"#3f6c19\", \"#750a3d\", \"#835d00\", \"#00566e\", \"#2c3f71\", \"#0c594f\"\n                ],\n                change: this.value.bind(this)\n            }).data(\"kendoColorPalette\");\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"colorPicker\", ColorPickerDialog);\n\n    var CustomColorDialog = ColorChooser.extend({\n        init: function(options) {\n            options.width = 268;\n            ColorChooser.fn.init.call(this, options);\n            this.dialog().setOptions({ animation: false });\n            this.dialog().one(\"activate\", this._colorPicker.bind(this));\n        },\n        _colorPicker: function() {\n            var element = this.dialog().element.find(\"div\").first();\n            this.colorPicker = element.kendoFlatColorPicker({\n                change: this.value.bind(this)\n            }).data(\"kendoFlatColorPicker\");\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"customColor\", CustomColorDialog);\n\n    var AlignmentDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.alignmentDialog || MESSAGES;\n            var defaultOptions = {\n                title: messages.title,\n                buttons: [\n                    { property: \"textAlign\",     value: \"left\",    iconClass: \"align-left\",   text: messages.buttons.justifyLeft },\n                    { property: \"textAlign\",     value: \"center\",  iconClass: \"align-center\", text: messages.buttons.justifyCenter },\n                    { property: \"textAlign\",     value: \"right\",   iconClass: \"align-right\",  text: messages.buttons.justifyRight },\n                    { property: \"textAlign\",     value: \"justify\", iconClass: \"align-justify\",   text: messages.buttons.justifyFull },\n                    { property: \"verticalAlign\", value: \"top\",     iconClass: \"align-top\",      text: messages.buttons.alignTop },\n                    { property: \"verticalAlign\", value: \"center\",  iconClass: \"align-middle\",   text: messages.buttons.alignMiddle },\n                    { property: \"verticalAlign\", value: \"bottom\",  iconClass: \"align-bottom\",   text: messages.buttons.alignBottom }\n                ]\n            };\n\n            SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n            this._list();\n        },\n        options: {\n            template: () => \"<ul class='k-list k-reset'></ul>\"\n        },\n        _list: function() {\n            var ul = this.dialog().element.find(\"ul\");\n\n            this.list = new kendo.ui.StaticList(ul, {\n                dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                template: (data) => `<a role='button' title='${data.text}' data-property='${data.property}' data-value='${data.value}'>\n                                ${kendo.ui.icon(data.iconClass)} ${data.text}\n                           </a>`,\n                change: this.apply.bind(this)\n            });\n\n            this.list.dataSource.fetch();\n        },\n        apply: function(e) {\n            var dataItem = e.sender.value()[0];\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"PropertyChangeCommand\",\n                options: {\n                    property: dataItem.property,\n                    value: dataItem.value\n                }\n            });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"alignment\", AlignmentDialog);\n\n    var MergeDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.mergeDialog || MESSAGES;\n            var defaultOptions = {\n                title: messages.title,\n                buttons: [\n                    { value: \"cells\",        iconClass: \"cells-merge\",        text: messages.buttons.mergeCells },\n                    { value: \"horizontally\", iconClass: \"cells-merge-horizontally\", text: messages.buttons.mergeHorizontally },\n                    { value: \"vertically\",   iconClass: \"cells-merge-vertically\",   text: messages.buttons.mergeVertically },\n                    { value: \"unmerge\",      iconClass: \"table-unmerge\",      text: messages.buttons.unmerge }\n                ]\n            };\n\n            SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n            this._list();\n        },\n        options: {\n            template: () => \"<ul class='k-list k-reset'></ul>\"\n        },\n        _list: function() {\n            var ul = this.dialog().element.find(\"ul\");\n\n            this.list = new kendo.ui.StaticList(ul, {\n                dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                template: (data) => `<a role='button' title='${data.text}' data-value='${data.value}'>` +\n                            `${kendo.ui.icon(data.iconClass)}${data.text}` +\n                          \"</a>\",\n                change: this.apply.bind(this)\n            });\n\n            this.list.dataSource.fetch();\n        },\n        apply: function(e) {\n            var dataItem = e.sender.value()[0];\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"MergeCellCommand\",\n                options: {\n                    value: dataItem.value\n                }\n            });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"merge\", MergeDialog);\n\n    var FreezeDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.freezeDialog || MESSAGES;\n            var defaultOptions = {\n                title: messages.title,\n                buttons: [\n                    { value: \"panes\",    iconClass: \"pane-freeze\",  text: messages.buttons.freezePanes },\n                    { value: \"rows\",     iconClass: \"row-freeze\",    text: messages.buttons.freezeRows },\n                    { value: \"columns\",  iconClass: \"column-freeze\",    text: messages.buttons.freezeColumns },\n                    { value: \"unfreeze\", iconClass: \"table-unmerge\", text: messages.buttons.unfreeze }\n                ]\n            };\n\n            SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n            this._list();\n        },\n        options: {\n            template: () => \"<ul class='k-list k-reset'></ul>\"\n        },\n        _list: function() {\n            var ul = this.dialog().element.find(\"ul\");\n\n            this.list = new kendo.ui.StaticList(ul, {\n                dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                template: (data) => `<a role='button' title='${data.text}' data-value='${data.value}'>` +\n                            `${kendo.ui.icon(data.iconClass)}${data.text}` +\n                          \"</a>\",\n                change: this.apply.bind(this)\n            });\n\n            this.list.dataSource.fetch();\n        },\n        apply: function(e) {\n            var dataItem = e.sender.value()[0];\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"FreezePanesCommand\",\n                options: {\n                    value: dataItem.value\n                }\n            });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"freeze\", FreezeDialog);\n\n    var ValidationViewModel = kendo.spreadsheet.ValidationCellsViewModel = ObservableObject.extend({\n        init: function(options) {\n            ObservableObject.fn.init.call(this, options);\n\n            this.bind(\"change\", (function(e) {\n\n                if (e.field === \"criterion\") {\n                    this.reset();\n\n                    if (this.criterion === \"custom\" || this.criterion === \"list\") {\n                        this.setHintMessageTemplate();\n                    }\n                }\n\n                if (e.field === \"comparer\") {\n                    this.setHintMessageTemplate();\n                }\n\n                if ((e.field == \"hintMessage\" || e.field == \"hintTitle\") && !this._mute) {\n                    this.shouldBuild = false;\n                }\n\n                if ((e.field == \"from\" || e.field == \"to\" || e.field == \"hintMessageTemplate\" || e.field == \"type\") && this.shouldBuild) {\n                    this.buildMessages();\n                }\n            }).bind(this));\n\n            this.reset();\n        },\n        buildMessages: function() {\n            this._mute = true;\n            this.set(\"hintTitle\", this.hintTitleTemplate ? kendo.format(this.hintTitleTemplate, this.type) : \"\");\n            this.set(\"hintMessage\", this.hintMessageTemplate ? kendo.format(this.hintMessageTemplate, this.from, this.to) : \"\");\n            this._mute = false;\n        },\n        reset: function() {\n            this.setComparers();\n            this.set(\"comparer\", this.comparers[0].type);\n            this.set(\"from\", null);\n            this.set(\"to\", null);\n\n            this.set(\"useCustomMessages\", false);\n\n            this.shouldBuild = true;\n\n            this.hintTitleTemplate = this.defaultHintTitle;\n            this.buildMessages();\n        },\n        //TODO: refactor\n        setComparers: function() {\n            var all = this.defaultComparers;\n            var comparers = [];\n\n            if (this.criterion === \"text\") {\n                var text_comparers = [\"equalTo\", \"notEqualTo\"];\n                for (var idx = 0; idx < all.length; idx++) {\n                    if (text_comparers[0] == all[idx].type) {\n                        comparers.push(all[idx]);\n                        text_comparers.shift();\n                    }\n                }\n            } else {\n                comparers = all.slice();\n            }\n\n            this.set(\"comparers\", comparers);\n        },\n        setHintMessageTemplate: function() {\n           if (this.criterion !== \"custom\" && this.criterion !== \"list\") {\n               this.set(\"hintMessageTemplate\", kendo.format(this.defaultHintMessage, this.criterion, this.comparerMessages[this.comparer]));\n           } else {\n               this.set(\"hintMessageTemplate\", \"\");\n               this.set(\"hintMessage\", \"\");\n           }\n        },\n        isAny: function() {\n            return this.get(\"criterion\") === \"any\";\n        },\n        isNumber: function() {\n            return this.get(\"criterion\") === \"number\";\n        },\n        showToForNumber: function() {\n            return this.showTo() && this.isNumber();\n        },\n        showToForDate: function() {\n            return this.showTo() && this.isDate();\n        },\n        isText: function() {\n            return this.get(\"criterion\") === \"text\";\n        },\n        isDate: function() {\n            return this.get(\"criterion\") === \"date\";\n        },\n        isList: function() {\n            return this.get(\"criterion\") === \"list\";\n        },\n        isCustom: function() {\n            return this.get(\"criterion\") === \"custom\";\n        },\n        showRemove: function() {\n            return this.get(\"hasValidation\");\n        },\n        showTo: function() {\n            return this.get(\"comparer\") == \"between\" || this.get(\"comparer\") == \"notBetween\";\n        },\n        update: function(validation) {\n            this.set(\"hasValidation\", !!validation);\n\n            if (validation) {\n                this.fromValidationObject(validation);\n            }\n        },\n        fromValidationObject: function(validation) {\n            this.set(\"criterion\", validation.dataType);\n            this.set(\"comparer\", validation.comparerType);\n            this.set(\"from\", validation.from);\n            this.set(\"to\", validation.to);\n            this.set(\"type\", validation.type);\n            this.set(\"ignoreBlank\", validation.allowNulls);\n            this.set(\"showButton\", validation.showButton);\n\n            if (validation.messageTemplate || validation.titleTemplate) {\n                this.hintMessageTemplate = validation.messageTemplate;\n                this.hintMessage = validation.messageTemplate;\n                this.hintTitleTemplate = validation.titleTemplate;\n                this.hintTitle = validation.titleTemplate;\n                this.useCustomMessages = true;\n                this.buildMessages();\n            } else {\n                this.useCustomMessages = false;\n            }\n        },\n        toValidationObject: function() {\n            if (this.criterion === \"any\") {\n                return null;\n            }\n\n            var options = {\n                type: this.type,\n                dataType: this.criterion,\n                comparerType: this.comparer,\n                from: this.from,\n                to: this.to,\n                allowNulls: this.ignoreBlank,\n                showButton: this.showButton\n            };\n\n            if (this.useCustomMessages) {\n                options.messageTemplate = this.shouldBuild ? this.hintMessageTemplate : this.hintMessage;\n                options.titleTemplate = this.hintTitle;\n            }\n\n            return options;\n        }\n    });\n\n    var ValidationDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.validationDialog || MESSAGES;\n            var defaultOptions = {\n                title: messages.title,\n                hintMessage: messages.hintMessage,\n                hintTitle: messages.hintTitle,\n                criteria: [\n                    { type: \"any\", name: messages.criteria.any },\n                    { type: \"number\", name: messages.criteria.number },\n                    { type: \"text\", name: messages.criteria.text },\n                    { type: \"date\", name: messages.criteria.date },\n                    { type: \"custom\", name: messages.criteria.custom },\n                    { type: \"list\", name: messages.criteria.list }\n                ],\n                comparers: [\n                    { type: \"greaterThan\", name: messages.comparers.greaterThan },\n                    { type: \"lessThan\",    name: messages.comparers.lessThan },\n                    { type: \"between\",     name: messages.comparers.between },\n                    { type: \"notBetween\",  name: messages.comparers.notBetween },\n                    { type: \"equalTo\",     name: messages.comparers.equalTo },\n                    { type: \"notEqualTo\",  name: messages.comparers.notEqualTo },\n                    { type: \"greaterThanOrEqualTo\", name: messages.comparers.greaterThanOrEqualTo },\n                    { type: \"lessThanOrEqualTo\",    name: messages.comparers.lessThanOrEqualTo }\n                ],\n                comparerMessages: messages.comparerMessages\n            };\n\n            SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n        },\n        options: {\n            width: 450,\n            criterion: \"any\",\n            type: \"reject\",\n            ignoreBlank: true,\n            showButton: true,\n            useCustomMessages: false,\n            errorTemplate: (data) =>\n                `<div class=\"k-tooltip k-tooltip-error k-validator-tooltip\">\n                    ${kendo.ui.icon({ icon: \"exclamation-circle\", iconClass: \"k-tooltip-icon\" })}\n                    <span class=\"k-tooltip-content\">${data.message}</span>\n                    <span class=\"k-callout k-callout-n\"></span>\n                </div>`,\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div class=\"k-edit-form-container\">\n                    <div class=\"k-edit-label\"><label for=\"criteria\">${kendo.htmlEncode(data.messages.validationDialog.labels.criteria)}:</label></div>\n                    <div class=\"k-edit-field\"><select id=\"criteria\" data-${kendo.htmlEncode(data.ns)}role=\"dropdownlist\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.criteria)}\" data-${kendo.htmlEncode(data.ns)}text-field=\"name\" data-${kendo.htmlEncode(data.ns)}value-field=\"type\" data-${kendo.htmlEncode(data.ns)}bind=\"value: criterion, source: criteria\"></select></div>\n                    <div data-${kendo.htmlEncode(data.ns)}bind=\"visible: isNumber\">\n                    <div class=\"k-edit-label\"><label for=\"number-comparer\">${kendo.htmlEncode(data.messages.validationDialog.labels.comparer)}:</label></div>\n                    <div class=\"k-edit-field\"><select id=\"number-comparer\" data-${kendo.htmlEncode(data.ns)}role=\"dropdownlist\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.comparer)}\" data-${kendo.htmlEncode(data.ns)}text-field=\"name\" data-${kendo.htmlEncode(data.ns)}value-field=\"type\" data-${kendo.htmlEncode(data.ns)}bind=\"value: comparer, source: comparers\"></select></div>\n                    <div class=\"k-edit-label\"><label for=\"comparer-min\">${kendo.htmlEncode(data.messages.validationDialog.labels.min)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"comparer-min\" name=\"${kendo.htmlEncode(data.messages.validationDialog.labels.min)}\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.min)}\" placeholder=\"e.g. 10\" class=\"k-input-inner\" data-${kendo.htmlEncode(data.ns)}bind=\"value: from, enabled: isNumber\" required=\"required\" /></span></div>\n                    <div data-${kendo.htmlEncode(data.ns)}bind=\"visible: showTo\">\n                    <div class=\"k-edit-label\"><label for=\"comparer-max\">${kendo.htmlEncode(data.messages.validationDialog.labels.max)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"comparer-max\" name=\"${kendo.htmlEncode(data.messages.validationDialog.labels.max)}\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.max)}\" placeholder=\"e.g. 100\" class=\"k-input-inner\" data-${kendo.htmlEncode(data.ns)}bind=\"value: to, enabled: showToForNumber\" required=\"required\" /></span></div>\n                    </div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"visible: isText\">\n                    <div class=\"k-edit-label\"><label for=\"text-comparer\">${kendo.htmlEncode(data.messages.validationDialog.labels.comparer)}:</label></div>\n                    <div class=\"k-edit-field\"><select id=\"text-comparer\" data-${kendo.htmlEncode(data.ns)}role=\"dropdownlist\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.comparer)}\" data-${kendo.htmlEncode(data.ns)}text-field=\"name\" data-${kendo.htmlEncode(data.ns)}value-field=\"type\" data-${kendo.htmlEncode(data.ns)}bind=\"value: comparer, source: comparers\"></select></div>\n                    <div class=\"k-edit-label\"><label for=\"text-comparer-value\">${kendo.htmlEncode(data.messages.validationDialog.labels.value)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"text-comparer-value\" name=\"${kendo.htmlEncode(data.messages.validationDialog.labels.value)}\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.value)}\" class=\"k-input-inner\" data-${kendo.htmlEncode(data.ns)}bind=\"value: from, enabled: isText\" required=\"required\" /></span></div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"visible: isDate\">\n                    <div class=\"k-edit-label\"><label for=\"date-comparer\">${kendo.htmlEncode(data.messages.validationDialog.labels.comparer)}:</label></div>\n                    <div class=\"k-edit-field\"><select id=\"date-comparer\" data-${kendo.htmlEncode(data.ns)}role=\"dropdownlist\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.comparer)}\" data-${kendo.htmlEncode(data.ns)}text-field=\"name\" data-${kendo.htmlEncode(data.ns)}value-field=\"type\" data-${kendo.htmlEncode(data.ns)}bind=\"value: comparer, source: comparers\"></select></div>\n                    <div class=\"k-edit-label\"><label for=\"date-comparer-start\">${kendo.htmlEncode(data.messages.validationDialog.labels.start)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"date-comparer-start\" name=\"${kendo.htmlEncode(data.messages.validationDialog.labels.start)}\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.start)}\" class=\"k-input-inner\" data-${kendo.htmlEncode(data.ns)}bind=\"value: from, enabled: isDate\" required=\"required\" /></span></div>\n                    <div data-${kendo.htmlEncode(data.ns)}bind=\"visible: showTo\">\n                    <div class=\"k-edit-label\"><label for=\"date-comparer-end\">${kendo.htmlEncode(data.messages.validationDialog.labels.end)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"date-comparer-end\" name=\"${kendo.htmlEncode(data.messages.validationDialog.labels.end)}\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.end)}\" class=\"k-input-inner\" data-${kendo.htmlEncode(data.ns)}bind=\"value: to, enabled: showToForDate\" required=\"required\" /></span></div>\n                    </div></div><div data-${kendo.htmlEncode(data.ns)}bind=\"visible: isCustom\">\n                    <div class=\"k-edit-label\"><label for=\"custom-comparer-value\">${kendo.htmlEncode(data.messages.validationDialog.labels.value)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"custom-comparer-value\" name=\"${kendo.htmlEncode(data.messages.validationDialog.labels.value)}\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.value)}\" class=\"k-input-inner\" data-${kendo.htmlEncode(data.ns)}bind=\"value: from, enabled: isCustom\" required=\"required\" /></span></div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"visible: isList\">\n                    <div class=\"k-edit-label\"><label for=\"list-comparer-value\">${kendo.htmlEncode(data.messages.validationDialog.labels.value)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"list-comparer-value\" name=\"${kendo.htmlEncode(data.messages.validationDialog.labels.value)}\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.value)}\" class=\"k-input-inner\" data-${kendo.htmlEncode(data.ns)}bind=\"value: from, enabled: isList\" required=\"required\" /></span></div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"visible: isList\">\n                    <div class=\"k-edit-field\"><input type=\"checkbox\" name=\"showButton\" id=\"listShowButton\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-${kendo.htmlEncode(data.ns)}bind=\"checked: showButton\" /><label for=\"listShowButton\" class=\"k-checkbox-label\"> ${kendo.htmlEncode(data.messages.validationDialog.labels.showListButton)}</label></div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"visible: isDate\">\n                    <div class=\"k-edit-field\"><input type=\"checkbox\" name=\"showButton\" id=\"dateShowButton\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-${kendo.htmlEncode(data.ns)}bind=\"checked: showButton\" /><label for=\"dateShowButton\" class=\"k-checkbox-label\"> ${kendo.htmlEncode(data.messages.validationDialog.labels.showCalendarButton)}</label></div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"invisible: isAny\">\n                    <div class=\"k-edit-field\"><input type=\"checkbox\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.ignoreBlank)}\" name=\"ignoreBlank\" id=\"ignoreBlank\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-${kendo.htmlEncode(data.ns)}bind=\"checked: ignoreBlank\" /><label for=\"ignoreBlank\" class=\"k-checkbox-label\"> ${kendo.htmlEncode(data.messages.validationDialog.labels.ignoreBlank)}</label></div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"invisible: isAny\">\n                    <div class=\"k-hr\"></div>\n                    <div class=\"k-edit-label\"><label>${kendo.htmlEncode(data.messages.validationDialog.labels.onInvalidData)}:</label></div>\n                    <div class=\"k-edit-field\"><input type=\"radio\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.rejectInput)}\" id=\"validationTypeReject\" name=\"validationType\" value=\"reject\" data-${kendo.htmlEncode(data.ns)}bind=\"checked: type\" class=\"k-radio k-radio-md\" /><label for=\"validationTypeReject\" class=\"k-radio-label\">${kendo.htmlEncode(data.messages.validationDialog.labels.rejectInput)}</label> <input type=\"radio\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.showWarning)}\" id=\"validationTypeWarning\" name=\"validationType\" value=\"warning\" data-${kendo.htmlEncode(data.ns)}bind=\"checked: type\" class=\"k-radio k-radio-md\" /><label for=\"validationTypeWarning\" class=\"k-radio-label\">${kendo.htmlEncode(data.messages.validationDialog.labels.showWarning)}</label></div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"invisible: isAny\" class=\"hint-wrapper\">\n                    <div class=\"k-edit-field\"><input type=\"checkbox\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.showHint)}\" name=\"useCustomMessages\" id=\"useCustomMessages\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-${kendo.htmlEncode(data.ns)}bind=\"checked: useCustomMessages\" /><label class=\"k-checkbox-label\" for=\"useCustomMessages\"> ${kendo.htmlEncode(data.messages.validationDialog.labels.showHint)}</label></div>\n                    <div data-${kendo.htmlEncode(data.ns)}bind=\"visible: useCustomMessages\">\n                    <div class=\"k-edit-label\"><label for=\"hint-title\">${kendo.htmlEncode(data.messages.validationDialog.labels.hintTitle)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"hint-title\" name=\"hint-title\" class=\"k-input-inner\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.hintTitle)}\" placeholder=\"${kendo.htmlEncode(data.messages.validationDialog.placeholders.typeTitle)}\" data-${kendo.htmlEncode(data.ns)}bind=\"value: hintTitle\" /></span></div>\n                    <div class=\"k-edit-label\"><label for=\"hint-message\">${kendo.htmlEncode(data.messages.validationDialog.labels.hintMessage)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"hint-message\" class=\"k-input-inner\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.hintMessage)}\" placeholder=\"${kendo.htmlEncode(data.messages.validationDialog.placeholders.typeMessage)}\" data-${kendo.htmlEncode(data.ns)}bind=\"value: hintMessage\" /></span></div>\n                    </div></div>\n                    <div class=\"k-actions\"><button class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\" data-${kendo.htmlEncode(data.ns)}bind=\"visible: showRemove, click: remove\"><span class=\"k-button-text\">${kendo.htmlEncode(data.messages.remove)}</span></button><button class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary\" data-${kendo.htmlEncode(data.ns)}bind=\"click: apply\"><span class=\"k-button-text\">${kendo.htmlEncode(data.messages.apply)}</span></button><button class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\" data-${kendo.htmlEncode(data.ns)}bind=\"click: close\"><span class=\"k-button-text\">${kendo.htmlEncode(data.messages.cancel)}</span></button></div>\n                    </div>`;\n                return $kendoOutput;\n            }\n        },\n        open: function(range) {\n            var options = this.options;\n            var element;\n\n            this.viewModel = new ValidationViewModel({\n                type: options.type,\n                defaultHintMessage: options.hintMessage,\n                defaultHintTitle: options.hintTitle,\n                defaultComparers: options.comparers.slice(0),\n                comparerMessages: options.comparerMessages,\n                criteria: options.criteria.slice(0),\n                criterion: options.criterion,\n                ignoreBlank: options.ignoreBlank,\n                showButton: options.showButton,\n                apply: this.apply.bind(this),\n                close: this.close.bind(this),\n                remove: this.remove.bind(this)\n            });\n\n            this.viewModel.update(range.validation());\n\n            SpreadsheetDialog.fn.open.call(this);\n\n            element = this.dialog().element;\n\n            if (this.validatable) {\n                this.validatable.destroy();\n            }\n\n            kendo.bind(element, this.viewModel);\n\n            this.validatable = new kendo.ui.Validator(element.find(\".k-edit-form-container\"), {\n                validateOnBlur: false,\n                errorTemplate: this.options.errorTemplate || undefined\n            });\n        },\n        apply: function() {\n\n            if (this.validatable.validate()) {\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"EditValidationCommand\",\n                    options: {\n                        value: this.viewModel.toValidationObject()\n                    }\n                });\n            }\n        },\n        remove: function() {\n            this.viewModel.set(\"criterion\", \"any\");\n            this.apply();\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"validation\", ValidationDialog);\n    kendo.spreadsheet.dialogs.ValidationDialog = ValidationDialog;\n\n    function PDF_PAPER_SIZE(size) {\n        return {\n            value: size,\n            text: TEXT(\"exportAsDialog.pdf.paper.\" + size)\n        };\n    }\n\n    var ExportAsDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            SpreadsheetDialog.fn.init.call(this, options);\n            options = this.options;\n\n            this.viewModel = kendo.observable({\n                title: options.title,\n                name: options.name,\n                extension: options.extension,\n                fileFormats:options.fileFormats,\n                excel: options.excelExport,\n                pdf: {\n                    proxyURL: options.pdfExport.proxyURL,\n                    forceProxy: options.pdfExport.forceProxy,\n                    title: options.pdfExport.title,\n                    author: options.pdfExport.author,\n                    autoPrint: options.pdfExport.autoPrint,\n                    subject: options.pdfExport.subject,\n                    keywords: options.pdfExport.keywords,\n                    creator: options.pdfExport.creator,\n                    date: options.pdfExport.date,\n\n                    fitWidth: options.pdf.fitWidth,\n                    area: options.pdf.area,\n                    areas: options.pdf.areas,\n                    paperSize: options.pdf.paperSize,\n                    paperSizes: options.pdf.paperSizes,\n                    margin: options.pdf.margin,\n                    margins: options.pdf.margins,\n                    landscape: options.pdf.landscape,\n                    guidelines: options.pdf.guidelines,\n                    hCenter: options.pdf.hCenter,\n                    vCenter: options.pdf.vCenter\n                },\n                apply: this.apply.bind(this),\n                close: this.close.bind(this)\n            });\n\n            var dialog = this.dialog();\n            this.viewModel.bind(\"change\", function(e) {\n                if (e.field === \"extension\") {\n                    this.set(\"showPdfOptions\", this.extension === \".pdf\" ? true : false);\n                    dialog.center();\n                }\n            });\n\n            kendo.bind(dialog.element, this.viewModel);\n        },\n        options: {\n            title: TEXT(\"exportAsDialog.title\", \"Export...\"),\n            name: TEXT(\"exportAsDialog.defaultFileName\", \"Workbook\"),\n            extension: \".xlsx\",\n            fileFormats: [{\n                description: TEXT(\"exportAsDialog.xlsx.description\", \"Excel Workbook (.xlsx)\"),\n                extension: \".xlsx\"\n            }, {\n                description: TEXT(\"exportAsDialog.pdf.description\", \"Portable Document Format (.pdf)\"),\n                extension: \".pdf\"\n            }],\n            pdf: {\n                fitWidth: true,\n                area: \"workbook\",\n                areas: [{\n                    area: \"workbook\",\n                    text: TEXT(\"exportAsDialog.pdf.area.workbook\", \"Entire Workbook\")\n                },{\n                    area: \"sheet\",\n                    text: TEXT(\"exportAsDialog.pdf.area.sheet\", \"Active Sheet\")\n                },{\n                    area: \"selection\",\n                    text: TEXT(\"exportAsDialog.pdf.area.selection\", \"Selection\")\n                }],\n                paperSize: \"a4\",\n                paperSizes: [\n                    \"a2\", \"a3\", \"a4\", \"a5\", \"b3\", \"b4\", \"b5\", \"folio\", \"legal\", \"letter\", \"tabloid\", \"executive\"\n                ].map(PDF_PAPER_SIZE),\n                margin: {bottom: \"0.75in\", left: \"0.7in\", right: \"0.7in\", top: \"0.75in\"},\n                margins: [\n                    { value: { bottom: \"0.75in\", left: \"0.7in\", right: \"0.7in\", top: \"0.75in\" },\n                      text: TEXT(\"exportAsDialog.pdf.margin.normal\", \"Normal\")\n                    },\n                    { value: { bottom: \"0.75in\", left: \"0.25in\", right: \"0.25in\", top: \"0.75in\" },\n                      text: TEXT(\"exportAsDialog.pdf.margin.narrow\", \"Narrow\")\n                    },\n                    { value: { bottom: \"1in\", left: \"1in\", right: \"1in\", top: \"1in\" },\n                      text: TEXT(\"exportAsDialog.pdf.margin.wide\", \"Wide\")\n                    }\n                ],\n                landscape: true,\n                guidelines: true,\n                hCenter: true,\n                vCenter: true\n            },\n            width: 520,\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div class='k-edit-label'><label id='name-label'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.fileName)}:</label></div>\n                    <div class='k-edit-field'><span class='k-textbox k-input k-input-md k-rounded-md k-input-solid'><input aria-labelledby='name-label' class='k-input-inner' data-${kendo.htmlEncode(data.ns)}bind='value: name' /></span></div>\n                    <div >\n                       <div class='k-edit-label'><label id='file-format-label'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.saveAsType)}:</label></div>\n                       <div class='k-edit-field'><select aria-labelledby='file-format-label' data-${kendo.htmlEncode(data.ns)}role='dropdownlist' class='k-file-format' data-${kendo.htmlEncode(data.ns)}text-field='description' data-${kendo.htmlEncode(data.ns)}value-field='extension' data-${kendo.htmlEncode(data.ns)}bind='value: extension, source: fileFormats'></select></div>\n                    </div>\n                    <div class='k-export-config' data-${kendo.htmlEncode(data.ns)}bind='visible: showPdfOptions'>\n                    <hr class='k-hr' />\n                    <div class='k-edit-label'><label id='export-area-label'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.exportArea)}:</label></div>\n                    <div class='k-edit-field'><select aria-labelledby='export-area-label' data-${kendo.htmlEncode(data.ns)}role='dropdownlist' class='k-file-format' data-${kendo.htmlEncode(data.ns)}text-field='text' data-${kendo.htmlEncode(data.ns)}value-field='area' data-${kendo.htmlEncode(data.ns)}bind='value: pdf.area, source: pdf.areas'></select></div>\n                    <div class='k-edit-label'><label id='paper-size-label'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.paperSize)}:</label></div>\n                    <div class='k-edit-field'><select aria-labelledby='paper-size-label' data-${kendo.htmlEncode(data.ns)}role='dropdownlist' class='k-file-format' data-${kendo.htmlEncode(data.ns)}text-field='text' data-${kendo.htmlEncode(data.ns)}value-field='value' data-${kendo.htmlEncode(data.ns)}bind='value: pdf.paperSize, source: pdf.paperSizes'></select></div>\n                    <div class='k-edit-label'><label id='margins-label'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.margins)}:</label></div>\n                    <div class='k-edit-field'><select aria-labelledby='margins-label' data-${kendo.htmlEncode(data.ns)}role='dropdownlist' class='k-file-format' data-${kendo.htmlEncode(data.ns)}value-primitive='true'data-${kendo.htmlEncode(data.ns)}text-field='text' data-${kendo.htmlEncode(data.ns)}value-field='value' data-${kendo.htmlEncode(data.ns)}bind='value: pdf.margin, source: pdf.margins'></select></div>\n                    <div class='k-edit-label'><label>${kendo.htmlEncode(data.messages.exportAsDialog.labels.orientation)}:</label></div>\n                    <div class='k-edit-field'>\n                       <div class='k-button-group'>\n                          <input type='radio' id='k-orientation-portrait' aria-label='orientation portrait' name='orientation' data-${kendo.htmlEncode(data.ns)}type='boolean' data-${kendo.htmlEncode(data.ns)}bind='checked: pdf.landscape' value='false' />\n                          <label class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-group-start k-orientation-button' for='k-orientation-portrait'>\n                          ${kendo.ui.icon({ icon: \"file\", iconClass: \"k-button-icon\" })}\n                          </label>\n                          <input type='radio' id='k-orientation-landscape' aria-label='orientation landscape' name='orientation' data-${kendo.htmlEncode(data.ns)}type='boolean' data-${kendo.htmlEncode(data.ns)}bind='checked: pdf.landscape' value='true' />\n                          <label class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-group-end k-orientation-button' for='k-orientation-landscape'>\n                          ${kendo.ui.icon({ icon: \"file-horizontal\", iconClass: \"k-button-icon\" })}\n                          </label>\n                       </div>\n                    </div>\n                    <div class='k-edit-label'><label>${kendo.htmlEncode(data.messages.exportAsDialog.labels.print)}:</label></div>\n                    <div class='k-edit-field'><input class='k-checkbox k-checkbox-md k-rounded-md' id='guidelines' type='checkbox' data-${kendo.htmlEncode(data.ns)}bind='checked: pdf.guidelines'/><label class='k-checkbox-label' for='guidelines'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.guidelines)}</label></div>\n                    <div class='k-edit-label'><label>${kendo.htmlEncode(data.messages.exportAsDialog.labels.scale)}:</label></div>\n                    <div class='k-edit-field'><input class='k-checkbox k-checkbox-md k-rounded-md' id='fitWidth' type='checkbox' data-${kendo.htmlEncode(data.ns)}bind='checked: pdf.fitWidth'/><label class='k-checkbox-label' for='fitWidth'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.fit)}</label></div>\n                    <div class='k-edit-label'><label>${kendo.htmlEncode(data.messages.exportAsDialog.labels.center)}:</label></div>\n                    <div class='k-edit-field'><input class='k-checkbox k-checkbox-md k-rounded-md' id='hCenter' type='checkbox' data-${kendo.htmlEncode(data.ns)}bind='checked: pdf.hCenter'/><label class='k-checkbox-label' for='hCenter'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.horizontally)}</label><input class='k-checkbox k-checkbox-md k-rounded-md' id='vCenter' type='checkbox' data-${kendo.htmlEncode(data.ns)}bind='checked: pdf.vCenter'/><label class='k-checkbox-label' for='vCenter'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.vertically)}</label></div>\n                    <div class='k-page-orientation'>\n                       ${kendo.ui.icon($(`<span data-${data.ns}bind='invisible: pdf.landscape'></span>`), { icon: \"file\" })}\n                       ${kendo.ui.icon($(`<span data-${data.ns}bind='visible: pdf.landscape'></span>`), { icon: \"file-horizontal\" })}\n                    </div>\n                    </div>\n                    <div class='k-actions'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-${kendo.htmlEncode(data.ns)}bind='click: apply'><span class='k-button-text'>${kendo.htmlEncode(data.messages.save)}</span></button><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-${kendo.htmlEncode(data.ns)}bind='click: close'><span class='k-button-text'>${kendo.htmlEncode(data.messages.cancel)}</span></button></div>`;\n                return $kendoOutput;\n            }\n        },\n        apply: function() {\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"SaveAsCommand\",\n                options: this.viewModel\n            });\n        }\n    });\n    kendo.spreadsheet.dialogs.register(\"exportAs\", ExportAsDialog);\n\n    function basicErrorDialog(id, msg) {\n        kendo.spreadsheet.dialogs.register(\n            id,\n            MessageDialog.extend({\n                options: { messageId: msg }\n            })\n        );\n    }\n\n    basicErrorDialog(\"modifyMerged\", \"modifyMergedDialog.errorMessage\");\n    basicErrorDialog(\"rangeDisabled\", \"rangeDisabledDialog.errorMessage\");\n    basicErrorDialog(\"intersectsArray\", \"intersectsArrayDialog.errorMessage\");\n    basicErrorDialog(\"overflow\", \"overflowDialog.errorMessage\");\n    basicErrorDialog(\"unsupportedSelection\", \"unsupportedSelectionDialog.errorMessage\");\n    basicErrorDialog(\"incompatibleRanges\", \"incompatibleRangesDialog.errorMessage\");\n    basicErrorDialog(\"noFillDirection\", \"noFillDirectionDialog.errorMessage\");\n    basicErrorDialog(\"duplicateSheetName\", \"duplicateSheetNameDialog.errorMessage\");\n\n    var ImportErrorDialog = MessageDialog.extend({\n        options: {\n            width: 640,\n            title: \"Errors in import\",\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div class='k-spreadsheet-message-content k-spreadsheet-import-errors'><div class='k--header-message'>We encountered ${data.errors.length} errors while reading this file.  Please be aware that some formulas might be missing, or contain invalid results.</div><div class='k--errors'><table><thead><tr><th>Context</th><th>Error message</th></tr></thead>`;\n                for (let i = 0; i < errors.length; ++i) {\n                    $kendoOutput += ``; let err = errors[i];;\n                    $kendoOutput += `<tr><td>${kendo.htmlEncode(err.context)}</td><td>${kendo.htmlEncode(err.error)}</td></tr>`;\n                }\n                $kendoOutput += `</table></div></div><div class='k-actions'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-${kendo.htmlEncode(data.ns)}bind='click: close'><span class='k-button-text'>${kendo.htmlEncode(data.messages.okText)}</span></button></div>`;\n                return $kendoOutput;\n            }\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"importError\", ImportErrorDialog);\n\n    var UseKeyboardDialog = MessageDialog.extend({\n        options: {\n            title: TEXT(\"useKeyboardDialog.title\", \"Copying and pasting\"),\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `${kendo.htmlEncode(data.messages.useKeyboardDialog.errorMessage)}\n                <div>Ctrl+C ${kendo.htmlEncode(data.messages.useKeyboardDialog.labels.forCopy)}</div>\n                <div>Ctrl+X ${kendo.htmlEncode(data.messages.useKeyboardDialog.labels.forCut)}</div>\n                <div>Ctrl+V ${kendo.htmlEncode(data.messages.useKeyboardDialog.labels.forPaste)}</div>\n                <div class=\"k-actions\"><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'\n                        data-${kendo.htmlEncode(data.ns)}bind='click: close'><span\n                            class='k-button-text'>${data.messages.okText}</span></button></div>`;\n                return $kendoOutput;\n            }\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"useKeyboard\", UseKeyboardDialog);\n\n    var HyperlinkDialog = SpreadsheetDialog.extend({\n        options: {\n            title: TEXT(\"linkDialog.title\", \"Hyperlink\"),\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div class='k-edit-label'><label id='url-label'>${kendo.htmlEncode(data.messages.linkDialog.labels.url)}:</label></div>\n<div class='k-edit-field'><span class='k-textbox k-input k-input-md k-rounded-md k-input-solid'><input\n            class='k-input-inner' data-${kendo.htmlEncode(data.ns)}bind='value: url'\n            title='${kendo.htmlEncode(data.messages.linkDialog.labels.url)}' aria-labelledby='url-label' /></span></div>\n<div class='k-actions'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-left'\n        data-${kendo.htmlEncode(data.ns)}bind='click: remove'><span\n            class='k-button-text'>${data.messages.linkDialog.labels.removeLink}</span></button><button\n        class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'\n        data-${kendo.htmlEncode(data.ns)}bind='click: apply'><span\n            class='k-button-text'>${data.messages.okText}</span></button><button\n        class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'\n        data-${kendo.htmlEncode(data.ns)}bind='click: cancel'><span\n            class='k-button-text'>${data.messages.cancel}</span></button></div>`;\n                return $kendoOutput;\n            },\n            autoFocus: false\n        },\n        open: function(range) {\n            var self = this;\n            SpreadsheetDialog.fn.open.apply(self, arguments);\n            var element = self.dialog().element;\n            var model = kendo.observable({\n                url: range.link(),\n                apply: function() {\n                    if (!/\\S/.test(model.url)) {\n                        model.url = null;\n                    }\n                    self.trigger(\"action\", {\n                        command: \"HyperlinkCommand\",\n                        options: {\n                            link: model.url\n                        }\n                    });\n                    self.close();\n                },\n                remove: function() {\n                    model.url = null;\n                    model.apply();\n                },\n                cancel: self.close.bind(self)\n            });\n            kendo.bind(element, model);\n\n            // it would be nice if we could easily handle that in one\n            // place for all dialogs, but it doesn't seem easily\n            // doable.\n            element.find(\"input\")\n                .trigger(\"focus\")\n                .on(\"keydown\", function(ev){\n                    if (ev.keyCode == 13 /*ENTER*/) {\n                        model.url = $(this).val(); // there won't be a \"change\" event and the model wouldn't update :-\\\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.apply();\n                    } else if (ev.keyCode == 27 /*ESC*/) {\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.cancel();\n                    }\n                });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"hyperlink\", HyperlinkDialog);\n\n    var SheetRenameDialog = SpreadsheetDialog.extend({\n        options: {\n            title: TEXT(\"sheetRenameDialog.title\", \"Rename Sheet\"),\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div class='k-edit-label'><label id='sheet-name-label'>${kendo.htmlEncode(data.messages.sheetRenameDialog.labels.text)}:</label></div>\n<div class='k-edit-field'><span class='k-textbox k-input k-input-md k-rounded-md k-input-solid'><input\n            class='k-input-inner' data-${kendo.htmlEncode(data.ns)}bind='value: sheetName'\n            title='${kendo.htmlEncode(data.messages.sheetRenameDialog.labels.text)}' aria-labelledby='sheet-name-label' /></span></div>\n<div class='k-actions'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'\n        data-${kendo.htmlEncode(data.ns)}bind='click: apply'><span\n            class='k-button-text'>${data.messages.sheetRenameDialog.labels.rename}</span></button><button\n        class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'\n        data-${kendo.htmlEncode(data.ns)}bind='click: cancel'><span\n            class='k-button-text'>${data.messages.cancel}</span></button></div>`;\n                return $kendoOutput;\n            },\n            autoFocus: false\n        },\n        open: function(range, args) {\n            let sheet = range.sheet();\n            let self = this;\n            SpreadsheetDialog.fn.open.apply(self, arguments);\n            let element = self.dialog().element;\n            let model = kendo.observable({\n                sheetName: args?._oldSheetName || sheet.name(),\n                apply: function() {\n                    self._newSheetName = model.sheetName;\n                    self.close();\n                },\n                cancel: self.close.bind(self)\n            });\n            kendo.bind(element, model);\n\n            element.find(\"input\")\n                .trigger(\"focus\")\n                .on(\"keydown\", function(ev){\n                    if (ev.keyCode == 13 /*ENTER*/) {\n                        model.sheetName = $(this).val();\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.apply();\n                    } else if (ev.keyCode == 27 /*ESC*/) {\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.cancel();\n                    }\n                });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"renameSheet\", SheetRenameDialog);\n\n    var InsertCommentDialog = SpreadsheetDialog.extend({\n        options: {\n            className: \"k-spreadsheet-insert-comment\",\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div class='k-edit-label'><label id='comment-label'>${kendo.htmlEncode(data.messages.insertCommentDialog.labels.comment)}:</label></div>\n                <div class='k-edit-field'><span class='k-input k-textarea k-input-solid k-input-md k-rounded-md'><textarea\n                    aria-labelledby='comment-label' rows='5' class='k-input-inner'\n                    data-${kendo.htmlEncode(data.ns)}bind='value: comment'></textarea></span></div>\n                <div class='k-actions'> <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-left'\n                    data-${kendo.htmlEncode(data.ns)}bind='click: remove'><span\n                    class='k-button-text'>${kendo.htmlEncode(data.messages.insertCommentDialog.labels.removeComment)}</span></button>\n                <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'\n                    data-${kendo.htmlEncode(data.ns)}bind='click: apply'><span\n                    class='k-button-text'>${kendo.htmlEncode(data.messages.okText)}</span></button> <button\n                    class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'\n                    data-${kendo.htmlEncode(data.ns)}bind='click: cancel'><span\n                    class='k-button-text'>${data.messages.cancel}</span></button></div>`;\n                return $kendoOutput;\n            },\n            title: TEXT(\"insertCommentDialog.title\", \"Insert comment\"),\n            autoFocus: false,\n            width: 450\n        },\n        open: function(range) {\n            var self = this;\n            SpreadsheetDialog.fn.open.apply(self, arguments);\n            var element = self.dialog().element;\n            var model = kendo.observable({\n                comment: range.comment(),\n                apply: function() {\n                    if (!/\\S/.test(model.comment)) {\n                        model.comment = null;\n                    }\n                    self.trigger(\"action\", {\n                        command: \"InsertCommentCommand\",\n                        options: {\n                            value: model.comment\n                        }\n                    });\n                    self.close();\n                },\n                remove: function() {\n                    model.comment = null;\n                    model.apply();\n                },\n                cancel: self.close.bind(self)\n            });\n            kendo.bind(element, model);\n\n            element.find(\"textarea\").trigger(\"focus\");\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"insertComment\", InsertCommentDialog);\n\n    var InsertImageDialog = SpreadsheetDialog.extend({\n        options: {\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div class='k-spreadsheet-insert-image-dialog'> <label\n        data-${kendo.htmlEncode(data.ns)}bind='style: { background-image: imageUrl }, css: { k-spreadsheet-has-image: hasImage, k-hover: isHovered }, events: { dragenter: dragEnter, dragover: stopEvent, dragleave: dragLeave, drop: drop }'>\n        <div data-${kendo.htmlEncode(data.ns)}bind='text: info'></div>\n        <input type='file' data-${kendo.htmlEncode(data.ns)}bind='events: { change: change }'\n            accept='image/png, image/jpeg, image/gif' />\n    </label></div>\n<div class='k-actions'> <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'\n        data-${kendo.htmlEncode(data.ns)}bind='enabled: okEnabled, click: apply'><span\n            class='k-button-text'>${kendo.htmlEncode(data.messages.okText)}</span></button> <button\n        class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'\n        data-${kendo.htmlEncode(data.ns)}bind='click: cancel'><span\n            class='k-button-text'>${data.messages.cancel}</span></button></div>`;\n                return $kendoOutput;\n            },\n            title: TEXT(\"insertImageDialog.title\", \"Insert image\"),\n            width: \"auto\"\n        },\n        open: function() {\n            var self = this;\n            SpreadsheetDialog.fn.open.apply(self, arguments);\n            var element = self.dialog().element;\n            var model = kendo.observable({\n                okEnabled: false,\n                info: kendo.spreadsheet.messages.dialogs.insertImageDialog.info,\n                imageUrl: \"\",\n                hasImage: false,\n                isHovered: false,\n                _url: null,\n                _image: null,\n                apply: function() {\n                    window.URL.revokeObjectURL(model._url);\n                    self.trigger(\"action\", {\n                        command: \"InsertImageCommand\",\n                        options: {\n                            blob   : model._image,\n                            width  : model._width,\n                            height : model._height\n                        }\n                    });\n                    self.close();\n                },\n                cancel: self.close.bind(self),\n                stopEvent: function(ev) {\n                    ev.stopPropagation();\n                    ev.preventDefault();\n                },\n                drop: function(ev) {\n                    model.stopEvent(ev);\n                    model.selectFile(ev.originalEvent.dataTransfer.files);\n                    model.set(\"isHovered\", false);\n                },\n                dragEnter: function(ev) {\n                    model.stopEvent(ev);\n                    model.set(\"isHovered\", true);\n                },\n                dragLeave: function(ev) {\n                    model.stopEvent(ev);\n                    model.set(\"isHovered\", false);\n                },\n                change: function(ev) {\n                    model.selectFile(ev.target.files);\n                },\n                selectFile: function(files) {\n                    var image;\n                    for (var i = 0; i < files.length; ++i) {\n                        if (/^image\\//i.test(files[i].type)) {\n                            image = files[i];\n                            break;\n                        }\n                    }\n                    if (model._url) {\n                        window.URL.revokeObjectURL(model._url);\n                    }\n                    if (image) {\n                        model._image = image;\n                        model._url = window.URL.createObjectURL(image);\n                        var img = new Image();\n                        img.src = model._url;\n                        img.onload = function() {\n                            model._width = img.width;\n                            model._height = img.height;\n                            model.set(\"info\", kendo.spreadsheet.messages.dialogs.insertImageDialog.info);\n                            model.set(\"okEnabled\", true);\n                            model.set(\"imageUrl\", \"url('\" + model._url + \"')\");\n                            model.set(\"hasImage\", true);\n                        };\n                    } else {\n                        model._image = null;\n                        model.set(\"info\", kendo.spreadsheet.messages.dialogs.insertImageDialog.typeError);\n                        model.set(\"okEnabled\", false);\n                        model.set(\"imageUrl\", \"\");\n                        model.set(\"hasImage\", false);\n                    }\n                }\n            });\n            kendo.bind(element, model);\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"insertImage\", InsertImageDialog);\n\n    function Localizable(path, def) {\n        this.path = path.split(\".\");\n        this.def = def;\n    }\n\n    Localizable.prototype.trans = function() {\n        var msg = kendo.spreadsheet.messages.dialogs;\n        for (var i = 0; i < this.path.length; ++i) {\n            msg = msg[this.path[i]];\n            if (!msg) {\n                return this.def;\n            }\n        }\n        return msg;\n    };\n\n    function TEXT(path, def) {\n        return new Localizable(path, def);\n    }\n\n    function translate(thing) {\n        if (thing instanceof Localizable) {\n            return thing.trans();\n        }\n        else if (Array.isArray(thing)) {\n            return thing.map(translate);\n        }\n        else if (thing != null && typeof thing == \"object\") {\n            return Object.keys(thing).reduce(function(ret, key){\n                ret[key] = translate(thing[key]);\n                return ret;\n            }, {});\n        }\n        return thing;\n    }\n\n})(window.kendo);\n\n(function(kendo) {\n\n        var $ = kendo.jQuery;\n        var BORDER_TYPES = [\n            \"allBorders\",\n            \"insideBorders\",\n            \"insideHorizontalBorders\",\n            \"insideVerticalBorders\",\n            \"outsideBorders\",\n            \"leftBorder\",\n            \"topBorder\",\n            \"rightBorder\",\n            \"bottomBorder\",\n            \"noBorders\"\n        ];\n        var BORDER_TYPES_ICONS = {\n           allBorders: \"bordersAll\",\n           insideBorders: \"bordersInside\",\n           insideHorizontalBorders: \"bordersInsideHorizontal\",\n           insideVerticalBorders: \"bordersInsideVertical\",\n           outsideBorders: \"bordersOutside\",\n           leftBorder: \"borderLeft\",\n           topBorder: \"borderTop\",\n           rightBorder: \"borderRight\",\n           bottomBorder: \"borderBottom\",\n           noBorders: \"bordersNone\"\n        };\n\n        var BORDER_PALETTE_MESSAGES = kendo.spreadsheet.messages.borderPalette = {\n            allBorders: \"All borders\",\n            insideBorders: \"Inside borders\",\n            insideHorizontalBorders: \"Inside horizontal borders\",\n            insideVerticalBorders: \"Inside vertical borders\",\n            outsideBorders: \"Outside borders\",\n            leftBorder: \"Left border\",\n            topBorder: \"Top border\",\n            rightBorder: \"Right border\",\n            bottomBorder: \"Bottom border\",\n            noBorders: \"No border\"\n        };\n\n        var colorPickerPalette = [ //metro palette\n            \"#ffffff\", \"#000000\", \"#d6ecff\", \"#4e5b6f\", \"#7fd13b\", \"#ea157a\", \"#feb80a\", \"#00addc\", \"#738ac8\", \"#1ab39f\",\n            \"#f2f2f2\", \"#7f7f7f\", \"#a7d6ff\", \"#d9dde4\", \"#e5f5d7\", \"#fad0e4\", \"#fef0cd\", \"#c5f2ff\", \"#e2e7f4\", \"#c9f7f1\",\n            \"#d8d8d8\", \"#595959\", \"#60b5ff\", \"#b3bcca\", \"#cbecb0\", \"#f6a1c9\", \"#fee29c\", \"#8be6ff\", \"#c7d0e9\", \"#94efe3\",\n            \"#bfbfbf\", \"#3f3f3f\", \"#007dea\", \"#8d9baf\", \"#b2e389\", \"#f272af\", \"#fed46b\", \"#51d9ff\", \"#aab8de\", \"#5fe7d5\",\n            \"#a5a5a5\", \"#262626\", \"#003e75\", \"#3a4453\", \"#5ea226\", \"#af0f5b\", \"#c58c00\", \"#0081a5\", \"#425ea9\", \"#138677\",\n            \"#7f7f7f\", \"#0c0c0c\", \"#00192e\", \"#272d37\", \"#3f6c19\", \"#750a3d\", \"#835d00\", \"#00566e\", \"#2c3f71\", \"#0c594f\"\n        ];\n\n        var BorderPalette = kendo.ui.Widget.extend({\n            init: function(element, options) {\n                kendo.ui.Widget.call(this, element, options);\n\n                this.element = element;\n                this.color = \"#000\";\n\n                this.element.addClass(\"k-spreadsheet-popup\");\n\n                this._borderTypePalette();\n                this._borderColorPalette();\n            },\n\n            options: {\n                name: \"BorderPalette\"\n            },\n\n            events: [\n                \"change\"\n            ],\n\n            destroy: function() {\n                this.colorChooser.destroy();\n                kendo.destroy(this.element.find(\".k-spreadsheet-border-type-palette\"));\n            },\n\n            value: function() {\n                return { type: this.type, color: this.color };\n            },\n\n            _borderTypePalette: function() {\n                var that = this;\n                var messages = BORDER_PALETTE_MESSAGES;\n\n                var element = $(\"<div />\", {\n                    \"class\": \"k-spreadsheet-border-type-palette\"\n                });\n\n                $('<span class=\"k-column-menu-group-header\"><span class=\"k-column-menu-group-header-text\">Border type</span></span>').appendTo(this.element);\n\n                element.appendTo(this.element);\n\n                BORDER_TYPES.map(function(type) {\n                    $('<button title=\"' + messages[type] + '\" aria-label=\"' + messages[type] + '\" data-border-type=\"' + type + '\">')\n                        .appendTo(element)\n                        .kendoToggleButton({\n                            icon: kendo.toHyphens(BORDER_TYPES_ICONS[type]),\n                            toggle: that._toggle.bind(that)\n                        });\n                });\n            },\n\n            _borderColorPalette: function() {\n                var element = $(\"<div />\", {\n                    \"class\": \"k-spreadsheet-border-color-palette\"\n                });\n\n                $('<span class=\"k-column-menu-group-header\"><span class=\"k-column-menu-group-header-text\">Border color</span></span>').appendTo(this.element);\n                element.appendTo(this.element);\n\n                this.colorChooser = new kendo.ui.FlatColorPicker(element, {\n                    buttons: !this.options.change,\n                    color: this.color,\n                    view: \"palette\",\n                    palette: colorPickerPalette,\n                    input: false,\n                    change: this._change.bind(this)\n                });\n\n                this.colorChooser.wrapper.find(\".k-coloreditor-apply\").on(\"click\", this._apply.bind(this));\n                this.colorChooser.wrapper.find(\".k-coloreditor-cancel\").on(\"click\", this._cancel.bind(this));\n            },\n\n            _change: function() {\n                this.color = this.colorChooser.value();\n            },\n\n            _toggle: function(e) {\n                var type = e.target.data(\"borderType\"),\n                    previous = e.target.siblings(\".k-selected\").data(\"kendoToggleButton\");\n\n                if (e.checked === true) {\n                    if (previous) {\n                        previous.toggle(false);\n                    }\n\n                    this.type = type;\n                } else {\n                    this.type = null;\n                }\n            },\n\n            _apply: function() {\n                this.trigger(\"change\", { type: this.type, color: this.color });\n            },\n\n            _cancel: function() {\n                this.trigger(\"change\", { type: null, color: null });\n            }\n        });\n\n        kendo.spreadsheet.BorderPalette = BorderPalette;\n\n    })(window.kendo);\n\n(function(kendo) {\n    var $ = kendo.jQuery;\n\n    function getDefaultToolElement(firstIconName) {\n        return `<button role=\"button\">${kendo.ui.icon({ icon: firstIconName, iconClass: \"k-button-icon\" })}<span class=\"k-button-text\">${kendo.ui.icon(\"caret-alt-down\")}</span></button>`\n    };\n\n    var ToolBar = kendo.ui.ToolBar;\n\n    var MESSAGES = kendo.spreadsheet.messages.toolbar = {\n        addColumnLeft: \"Add column left\",\n        addColumnRight: \"Add column right\",\n        addRowAbove: \"Add row above\",\n        addRowBelow: \"Add row below\",\n        alignment: \"Alignment\",\n        alignmentButtons: {\n            justifyLeft: \"Align left\",\n            justifyCenter: \"Center\",\n            justifyRight: \"Align right\",\n            justifyFull: \"Justify\",\n            alignTop: \"Align top\",\n            alignMiddle: \"Align middle\",\n            alignBottom: \"Align bottom\"\n        },\n        backgroundColor: \"Background\",\n        increaseFontSize: \"Increase font size\",\n        decreaseFontSize: \"Decrease font size\",\n        bold: \"Bold\",\n        borders: \"Borders\",\n        copy: \"Copy\",\n        cut: \"Cut\",\n        deleteColumn: \"Delete column\",\n        deleteRow: \"Delete row\",\n        filter: \"Filter\",\n        fontFamily: \"Font\",\n        fontSize: \"Font size\",\n        format: \"Custom format...\",\n        formatTypes: {\n            automatic: \"Automatic\",\n            text: \"Text\",\n            number: \"Number\",\n            percent: \"Percent\",\n            financial: \"Financial\",\n            currency: \"Currency\",\n            date: \"Date\",\n            time: \"Time\",\n            dateTime: \"Date time\",\n            duration: \"Duration\",\n            moreFormats: \"More formats...\"\n        },\n        formatDecreaseDecimal: \"Decrease decimal\",\n        formatIncreaseDecimal: \"Increase decimal\",\n        freeze: \"Freeze panes\",\n        freezeButtons: {\n            freezePanes: \"Freeze panes\",\n            freezeRows: \"Freeze rows\",\n            freezeColumns: \"Freeze columns\",\n            unfreeze: \"Unfreeze panes\"\n        },\n        insertComment: \"Insert comment\",\n        insertImage: \"Insert image\",\n        italic: \"Italic\",\n        merge: \"Merge cells\",\n        mergeButtons: {\n            mergeCells: \"Merge all\",\n            mergeHorizontally: \"Merge horizontally\",\n            mergeVertically: \"Merge vertically\",\n            unmerge: \"Unmerge\"\n        },\n        open: \"Open...\",\n        paste: \"Paste\",\n        redo: \"Redo\",\n        undo: \"Undo\",\n        exportAs: \"Export...\",\n        toggleGridlines: \"Toggle gridlines\",\n        sort: \"Sort\",\n        sortButtons: {\n            // sortSheetAsc: \"Sort sheet A to Z\",\n            // sortSheetDesc: \"Sort sheet Z to A\",\n            sortRangeAsc: \"Sort range A to Z\",\n            sortRangeDesc: \"Sort range Z to A\"\n        },\n        textColor: \"Text Color\",\n        textWrap: \"Wrap text\",\n        underline: \"Underline\",\n        validation: \"Data validation...\",\n        hyperlink: \"Link\"\n    };\n\n    var defaultTools = {\n        file: [\n            \"open\",\n            \"exportAs\",\n        ],\n        format: [\n            \"format\",\n            \"formatDecreaseDecimal\",\n            \"formatIncreaseDecimal\"\n        ],\n        home: [\n            [\"undo\", \"redo\"],\n            \"separator\",\n            [\"cut\", \"copy\", \"paste\"],\n            \"separator\",\n            \"fontFamily\", \"fontSize\", \"increaseFontSize\", \"decreaseFontSize\",\n            \"separator\",\n            [\"bold\", \"italic\", \"underline\"],\n            \"separator\",\n            \"textColor\",\n            \"separator\",\n            \"backgroundColor\",\n            \"borders\",\n            \"separator\",\n            \"alignment\",\n            \"textWrap\",\n        ],\n        insert: [\n            \"insertComment\",\n            \"separator\",\n            \"hyperlink\",\n            \"separator\",\n            \"insertImage\",\n            \"separator\",\n            [\"addColumnLeft\", \"addColumnRight\", \"addRowBelow\", \"addRowAbove\"],\n            \"separator\",\n            [\"deleteColumn\", \"deleteRow\"]\n        ],\n        data: [\n            \"sort\",\n            \"separator\",\n            \"filter\",\n            \"separator\",\n            \"validation\"\n        ],\n        view: [\n            \"freeze\",\n            \"merge\",\n            \"toggleGridlines\"\n        ]\n    };\n\n    var defaultFormats = kendo.spreadsheet.formats = {\n        automatic: null,\n        text: \"@\",\n        number: \"#,0.00\",\n        percent: \"0.00%\",\n        financial: '_(\"$\"* #,##0.00_);_(\"$\"* (#,##0.00);_(\"$\"* \"-\"??_);_(@_)',\n        currency: \"$#,##0.00;[Red]$#,##0.00\",\n        date: \"m/d/yyyy\",\n        time: \"h:mm:ss AM/PM\",\n        dateTime: \"m/d/yyyy h:mm\",\n        duration: \"[h]:mm:ss\"\n    };\n\n    var colorPickerPalette = [ //metro palette\n        \"#ffffff\", \"#000000\", \"#d6ecff\", \"#4e5b6f\", \"#7fd13b\", \"#ea157a\", \"#feb80a\", \"#00addc\", \"#738ac8\", \"#1ab39f\",\n        \"#f2f2f2\", \"#7f7f7f\", \"#a7d6ff\", \"#d9dde4\", \"#e5f5d7\", \"#fad0e4\", \"#fef0cd\", \"#c5f2ff\", \"#e2e7f4\", \"#c9f7f1\",\n        \"#d8d8d8\", \"#595959\", \"#60b5ff\", \"#b3bcca\", \"#cbecb0\", \"#f6a1c9\", \"#fee29c\", \"#8be6ff\", \"#c7d0e9\", \"#94efe3\",\n        \"#bfbfbf\", \"#3f3f3f\", \"#007dea\", \"#8d9baf\", \"#b2e389\", \"#f272af\", \"#fed46b\", \"#51d9ff\", \"#aab8de\", \"#5fe7d5\",\n        \"#a5a5a5\", \"#262626\", \"#003e75\", \"#3a4453\", \"#5ea226\", \"#af0f5b\", \"#c58c00\", \"#0081a5\", \"#425ea9\", \"#138677\",\n        \"#7f7f7f\", \"#0c0c0c\", \"#00192e\", \"#272d37\", \"#3f6c19\", \"#750a3d\", \"#835d00\", \"#00566e\", \"#2c3f71\", \"#0c594f\"\n    ];\n\n    var COLOR_PICKER_MESSAGES = kendo.spreadsheet.messages.colorPicker = {\n        reset: \"Reset color\",\n        customColor: \"Custom color...\",\n        apply: \"Apply\",\n        cancel: \"Cancel\"\n    };\n\n    var toolDefaults = {\n        undo: {\n           type: \"button\",\n           name: \"undo\",\n           icon: \"undo\",\n           command: \"undo\"\n        },\n        redo: {\n           type: \"button\",\n           name: \"redo\",\n           icon: \"redo\",\n           command: \"redo\"\n        },\n        separator: { type: \"separator\" },\n        //home tab\n        open: {\n            type: \"open\",\n            name: \"open\",\n            icon: \"folder-open\",\n            extensions: \".xlsx\",\n            command: \"OpenCommand\"\n        },\n        exportAs: {\n            type: \"button\",\n            name: \"exportAs\",\n            dialog: \"exportAs\",\n            overflow: \"never\",\n            icon: \"download\"\n        },\n        bold: {\n            type: \"button\",\n            command: \"PropertyChangeCommand\",\n            property: \"bold\",\n            value: true,\n            icon: \"bold\",\n            togglable: true\n        },\n        italic: {\n            type: \"button\",\n            command: \"PropertyChangeCommand\",\n            property: \"italic\",\n            value: true,\n            icon: \"italic\",\n            togglable: true\n        },\n        underline: {\n            type: \"button\",\n            command: \"PropertyChangeCommand\",\n            property: \"underline\",\n            value: true,\n            icon: \"underline\",\n            togglable: true\n        },\n        formatDecreaseDecimal: {\n            type: \"button\",\n            name: \"formatDecreaseDecimal\",\n            command: \"AdjustDecimalsCommand\",\n            value: -1,\n            icon: \"decimal-decrease\"\n        },\n        formatIncreaseDecimal: {\n            type: \"button\",\n            name: \"formatIncreaseDecimal\",\n            command: \"AdjustDecimalsCommand\",\n            value: +1,\n            icon: \"decimal-increase\"\n        },\n        textWrap: {\n            type: \"button\",\n            name: \"textWrap\",\n            command: \"TextWrapCommand\",\n            property: \"wrap\",\n            value: true,\n            icon: \"text-wrap\",\n            togglable: true\n        },\n        cut: {\n            type: \"button\",\n            name: \"cut\",\n            command: \"ToolbarCutCommand\",\n            icon: \"cut\"\n        },\n        copy: {\n            type: \"button\",\n            name: \"copy\",\n            command: \"ToolbarCopyCommand\",\n            icon: \"copy\"\n        },\n        paste: {\n            type: \"button\",\n            name: \"paste\",\n            command: \"ToolbarPasteCommand\",\n            icon: \"clipboard\"\n        },\n        alignment: {\n            type: \"component\",\n            name: \"alignment\",\n            property: \"alignment\",\n            component: \"DropDownButton\",\n            element: getDefaultToolElement(\"align-left\"),\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"alignment\",\n                icon: \"align-left\"\n            },\n            componentOptions: {\n                fillMode: \"flat\",\n                items: [\n                    { attributes: { \"data-value\": \"left\", \"data-property\": \"textAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-left\", text: MESSAGES.alignmentButtons.justifyLeft },\n                    { attributes: { \"data-value\": \"center\", \"data-property\": \"textAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-center\", text: MESSAGES.alignmentButtons.justifyCenter },\n                    { attributes: { \"data-value\": \"right\", \"data-property\": \"textAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-right\", text: MESSAGES.alignmentButtons.justifyRight },\n                    { attributes: { \"data-value\": \"justify\", \"data-property\": \"textAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-justify\", text: MESSAGES.alignmentButtons.justifyFull },\n                    { attributes: { class: \"k-separator\" } },\n                    { attributes: { \"data-value\": \"top\", \"data-property\": \"verticalAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-top\", text: MESSAGES.alignmentButtons.alignTop },\n                    { attributes: { \"data-value\": \"center\", \"data-property\": \"verticalAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-middle\", text: MESSAGES.alignmentButtons.alignMiddle },\n                    { attributes: { \"data-value\": \"bottom\", \"data-property\": \"verticalAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-bottom\", text: MESSAGES.alignmentButtons.alignBottom }\n                ],\n                commandOn: \"click\"\n            }\n        },\n        backgroundColor: {\n            type: \"component\",\n            name: \"backgroundColor\",\n            commandOn: \"change\",\n            command: \"PropertyChangeCommand\",\n            property: \"background\",\n            component: \"ColorPicker\",\n            componentOptions: {\n                view: \"palette\",\n                toolIcon: \"droplet\",\n                fillMode: \"flat\",\n                palette: colorPickerPalette,\n                clearButton: true,\n                messages: COLOR_PICKER_MESSAGES,\n                input: false,\n                commandOn: \"change\"\n            },\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"colorPicker\",\n                icon: \"droplet\",\n                property: \"background\"\n            }\n        },\n        textColor: {\n            type: \"component\",\n            name: \"textColor\",\n            commandOn: \"change\",\n            command: \"PropertyChangeCommand\",\n            property: \"color\",\n            component: \"ColorPicker\",\n            componentOptions: {\n                view: \"palette\",\n                fillMode: \"flat\",\n                toolIcon: \"foreground-color\",\n                palette: colorPickerPalette,\n                clearButton: true,\n                messages: COLOR_PICKER_MESSAGES,\n                input: false,\n                commandOn: \"change\"\n            },\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"colorPicker\",\n                icon: \"foreground-color\",\n                property: \"color\"\n            }\n        },\n        fontFamily: {\n            type: \"component\",\n            name: \"fontFamily\",\n            command: \"PropertyChangeCommand\",\n            property: \"fontFamily\",\n            component: \"DropDownList\",\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"fontFamily\",\n                icon: \"font-family\"\n            },\n            componentOptions: {\n                dataSource: [\"Arial\", \"Courier New\", \"Georgia\", \"Times New Roman\", \"Trebuchet MS\", \"Verdana\"],\n                value: \"Arial\",\n                fillMode: \"flat\",\n                commandOn: \"change\"\n            }\n        },\n        fontSize: {\n            type: \"component\",\n            name: \"fontSize\",\n            command: \"PropertyChangeCommand\",\n            property: \"fontSize\",\n            component: \"ComboBox\",\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"fontSize\",\n                icon: \"font-size\"\n            },\n            componentOptions: {\n                dataSource: [8, 9, 10, 11, 12, 13, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72],\n                value: 12,\n                fillMode: \"flat\",\n                commandOn: \"change\"\n            }\n        },\n        increaseFontSize: {\n            type: \"button\",\n            name: \"increaseFontSize\",\n            command: \"IncreaseFontSize\",\n            property: \"fontSize\",\n            icon: \"font-grow\"\n        },\n        decreaseFontSize: {\n            type: \"button\",\n            name: \"decreaseFontSize\",\n            command: \"DecreaseFontSize\",\n            property: \"fontSize\",\n            icon: \"font-shrink\"\n        },\n        format: {\n            type: \"component\",\n            name: \"format\",\n            component: \"DropDownButton\",\n            element: getDefaultToolElement(\"custom-format\"),\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"formatCells\",\n                icon: \"custom-format\"\n            },\n            componentOptions: {\n                fillMode: \"flat\",\n                items: [\n                    { attributes: { \"data-value\": defaultFormats.automatic, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.automatic },\n                    { attributes: { \"data-value\": defaultFormats.text, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.text },\n                    { attributes: { \"data-value\": defaultFormats.number, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.number, sample: \"1,499.99\" },\n                    { attributes: { \"data-value\": defaultFormats.percent, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.percent, sample: \"14.50%\" },\n                    { attributes: { \"data-value\": defaultFormats.financial, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.financial, sample: \"(1,000.12)\" },\n                    { attributes: { \"data-value\": defaultFormats.currency, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.currency, sample: \"$1,499.99\" },\n                    { attributes: { \"data-value\": defaultFormats.date, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.date, sample: \"4/21/2012\" },\n                    { attributes: { \"data-value\": defaultFormats.time, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.time, sample: \"5:49:00 PM\" },\n                    { attributes: { \"data-value\": defaultFormats.dateTime, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.dateTime, sample: \"4/21/2012 5:49:00\" },\n                    { attributes: { \"data-value\": defaultFormats.duration, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.duration, sample: \"168:05:00\" },\n                    { attributes: { \"data-value\": \"popup\", \"data-popup\": \"formatCells\" }, text: MESSAGES.formatTypes.moreFormats },\n                ],\n                itemTemplate: (data) => {\n                    let $kendoOutput;\n                    $kendoOutput = `<span class=\"k-link k-menu-link\"><span class=\"k-menu-link-text\">`; if (data.sample) { ;\n                    $kendoOutput += `<span class='k-spreadsheet-sample'>${kendo.htmlEncode(data.sample)}</span> `; } ;\n                    $kendoOutput += `${kendo.htmlEncode(data.text)}</span></span>`;\n                    return $kendoOutput;\n                },\n                commandOn: \"click\"\n            }\n        },\n        filter: {\n            type: \"button\",\n            name: \"filter\",\n            property: \"hasFilter\",\n            icon: \"filter\",\n            command: \"FilterCommand\",\n            togglable: true,\n            enable: false\n        },\n        merge: {\n            type: \"component\",\n            name: \"merge\",\n            component: \"DropDownButton\",\n            element: getDefaultToolElement(\"cells-merge\"),\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"merge\",\n                icon: \"cells-merge\"\n            },\n            componentOptions: {\n                fillMode: \"flat\",\n                items: [\n                    { attributes: { \"data-value\": \"cells\", \"data-command\": \"MergeCellCommand\" }, icon: \"cells-merge\", text: MESSAGES.mergeButtons.mergeCells },\n                    { attributes: { \"data-value\": \"horizontally\", \"data-command\": \"MergeCellCommand\" }, icon: \"cells-merge-horizontally\", text: MESSAGES.mergeButtons.mergeHorizontally },\n                    { attributes: { \"data-value\": \"vertically\", \"data-command\": \"MergeCellCommand\" }, icon: \"cells-merge-vertically\", text: MESSAGES.mergeButtons.mergeVertically },\n                    { attributes: { \"data-value\": \"unmerge\", \"data-command\": \"MergeCellCommand\" }, icon: \"table-unmerge\", text: MESSAGES.mergeButtons.unmerge }\n                ],\n                commandOn: \"click\"\n            }\n        },\n        freeze: {\n            type: \"component\",\n            name: \"freeze\",\n            component: \"DropDownButton\",\n            element: getDefaultToolElement(\"pane-freeze\"),\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"freeze\",\n                icon: \"pane-freeze\"\n            },\n            componentOptions: {\n                fillMode: \"flat\",\n                items: [\n                    { attributes: { \"data-value\": \"panes\", \"data-command\": \"FreezePanesCommand\" }, icon: \"pane-freeze\", text: MESSAGES.freezeButtons.freezePanes },\n                    { attributes: { \"data-value\": \"rows\", \"data-command\": \"FreezePanesCommand\" }, icon: \"row-freeze\", text: MESSAGES.freezeButtons.freezeRows },\n                    { attributes: { \"data-value\": \"columns\", \"data-command\": \"FreezePanesCommand\" }, icon: \"column-freeze\", text: MESSAGES.freezeButtons.freezeColumns },\n                    { attributes: { \"data-value\": \"unfreeze\", \"data-command\": \"FreezePanesCommand\" }, icon: \"table-unmerge\", text: MESSAGES.freezeButtons.unfreeze }\n                ],\n                commandOn: \"click\"\n            }\n        },\n        borders: {\n            type: \"popupButton\",\n            name: \"borders\",\n            icon: \"borders-all\",\n            popupComponent: kendo.spreadsheet.BorderPalette,\n            commandOn: \"change\",\n            command: \"BorderChangeCommand\",\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"borders\"\n            }\n        },\n        formatCells: {\n            type: \"button\",\n            dialog: \"formatCells\",\n            overflow: \"never\"\n        },\n        hyperlink: {\n            type: \"button\",\n            name: \"hyperlink\",\n            dialog: \"hyperlink\",\n            icon: \"link\"\n        },\n        toggleGridlines: {\n            type: \"button\",\n            name: \"toggleGridlines\",\n            command: \"GridLinesChangeCommand\",\n            property: \"gridLines\",\n            value: true,\n            icon: \"borders-none\",\n            togglable: true,\n            selected: true\n        },\n        insertComment: {\n            type: \"button\",\n            name: \"insertComment\",\n            dialog: \"insertComment\",\n            property: \"comment\",\n            togglable: true,\n            icon: \"comment\"\n        },\n        insertImage: {\n            type: \"button\",\n            name: \"insertImage\",\n            dialog: \"insertImage\",\n            icon: \"image\",\n        },\n\n        //insert tab\n        addColumnLeft: {\n            type: \"button\",\n            name: \"addColumnLeft\",\n            command: \"AddColumnCommand\",\n            value: \"left\",\n            icon: \"table-column-insert-left\"\n        },\n        addColumnRight: {\n            type: \"button\",\n            name: \"addColumnRight\",\n            command: \"AddColumnCommand\",\n            value: \"right\",\n            icon: \"table-column-insert-right\"\n        },\n        addRowBelow: {\n            type: \"button\",\n            name: \"addRowBelow\",\n            command: \"AddRowCommand\",\n            value: \"below\",\n            icon: \"table-row-insert-below\"\n        },\n        addRowAbove: {\n            type: \"button\",\n            name: \"addRowAbove\",\n            command: \"AddRowCommand\",\n            value: \"above\",\n            icon: \"table-row-insert-above\"\n        },\n        deleteColumn: {\n            type: \"button\",\n            name: \"deleteColumn\",\n            command: \"DeleteColumnCommand\",\n            icon: \"table-column-delete\"\n        },\n        deleteRow: {\n            type: \"button\",\n            name: \"deleteRow\",\n            command: \"DeleteRowCommand\",\n            icon: \"table-row-delete\"\n        },\n\n        //data tab\n        sort: {\n            type: \"component\",\n            name: \"sort\",\n            component: \"DropDownButton\",\n            element: getDefaultToolElement(\"sort-desc\"),\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"sort\",\n                icon: \"sort-desc\"\n            },\n            componentOptions: {\n                fillMode: \"flat\",\n                items: [\n                    { attributes: { \"data-value\": \"asc\", \"data-command\": \"SortCommand\" }, sheet: false, text: MESSAGES.sortButtons.sortRangeAsc, icon: \"sort-asc\" },\n                    { attributes: { \"data-value\": \"desc\", \"data-command\": \"SortCommand\" }, sheet: false, text: MESSAGES.sortButtons.sortRangeDesc, icon: \"sort-desc\" },\n                ],\n                commandOn: \"click\"\n            }\n        },\n        validation: {\n            type: \"button\",\n            name: \"validation\",\n            dialog: \"validation\",\n            icon: \"exclamation-circle\"\n        }\n    };\n\n    var SpreadsheetToolBar = ToolBar.extend({\n        init: function(element, options) {\n            Object.keys(toolDefaults).forEach((t) => {\n                if (t !== \"validation\") {\n                    toolDefaults[t].showText = \"overflow\";\n                }\n            });\n\n            options.tools = options.tools || SpreadsheetToolBar.prototype.options.tools[options.toolbarName];\n            options.parentMessages = MESSAGES;\n            options.defaultTools = toolDefaults;\n\n            ToolBar.fn.init.call(this, element, options);\n            var handleClick = this._click.bind(this);\n\n            this.element.addClass(\"k-spreadsheet-toolbar k-toolbar-md\");\n\n            this.bind({\n                click: handleClick,\n                toggle: handleClick,\n                change: handleClick\n            });\n        },\n        _click: function(e) {\n            var target = e.target,\n                property = target.data(\"property\"),\n                value = e.value || target.data(\"value\") || e.target.val(),\n                commandType = target.data(\"command\"),\n                dialog = target.data(\"dialog\"),\n                options = target.data(\"options\") || {};\n\n            if (value === \"popup\") {\n                // Special case to open custom format dialog from option of the format DDL\n                dialog = target.data(\"popup\");\n            }\n\n            if (commandType === \"IncreaseFontSize\") {\n                commandType = \"PropertyChangeCommand\";\n                value++;\n            }\n\n            if (commandType === \"DecreaseFontSize\") {\n                commandType = \"PropertyChangeCommand\";\n                value--;\n            }\n\n            options.property = property || null;\n            options.value = value || null;\n\n            if (dialog) {\n                this.dialog({\n                    name: dialog,\n                    options: options\n                });\n                return;\n            }\n\n            if (!commandType) {\n                return;\n            }\n\n            var args = {\n                command: commandType,\n                options: options\n            };\n\n            if (typeof args.options.value === \"boolean\") {\n                args.options.value = e.checked ? true : null;\n            }\n\n            this.action(args);\n        },\n        events: [\n            \"action\",\n            \"dialog\"\n        ],\n        options: {\n            name: \"SpreadsheetToolBar\",\n            resizable: true,\n            tools: defaultTools,\n            fillMode: \"flat\"\n        },\n        action: function(args) {\n            this.trigger(\"action\", args);\n        },\n        dialog: function(args) {\n            this.trigger(\"dialog\", args);\n        },\n        refresh: function(activeCell) {\n            var range = activeCell,\n                tools = this._tools();\n\n            for (var i = 0; i < tools.length; i++) {\n                var property = tools[i].property,\n                    tool = tools[i].tool,\n                    value = kendo.isFunction(range[property]) ? range[property]() : range;\n\n                if (property == \"gridLines\") {\n                    // this isn't really a property of the range, it's per-sheet.\n                    value = range.sheet().showGridLines();\n                }\n\n                this._updateTool(tool, value, property, range);\n            }\n\n            this.resize(true);\n        },\n        _tools: function() {\n            return this.element.find(\"[data-property]\").toArray().map(function(element) {\n                element = $(element);\n                return {\n                    property: element.attr(\"data-property\"),\n                    tool: this._getItem(element)\n                };\n            }.bind(this));\n        },\n        _updateTool: function(tool, value, property, range) {\n            var component = tool.component,\n                toolbarEl = tool.toolbarEl,\n                widget = kendo.widgetInstance(toolbarEl.find(\"[data-role]\")),\n                menuItem = tool.menuItem,\n                toggle = false,\n                vertical, text, menu, selection, enabled, label;\n\n            if (property === \"hasFilter\") {\n                selection = range.sheet().selection();\n\n                if (selection && selection._ref && selection._ref.height) {\n                    enabled = value || selection._ref.height() > 1;\n\n                    this.enable(toolbarEl, enabled);\n                }\n            } else if (property === \"alignment\") {\n                vertical = value.verticalAlign();\n                text = value.textAlign();\n                menu = component.menu.element;\n\n                menu.find(\".k-item .k-link\").removeClass(\"k-selected\");\n                menu.find(\".k-item[data-property=textAlign][data-value=\" + text + \"] .k-link\").addClass(\"k-selected\");\n                menu.find(\".k-item[data-property=verticalAlign][data-value=\" + vertical + \"] .k-link\").addClass(\"k-selected\");\n            } else if (property === \"background\" || property === \"color\") {\n                widget.value(value);\n            } else if (property === \"fontFamily\" || property === \"fontSize\") {\n                if (toolbarEl.is(\"button\")) {\n                    toolbarEl.attr(\"data-value\", value);\n                    toolbarEl.data(\"value\", value);\n                    return;\n                }\n                label = menuItem.find(\".k-menu-link-text\").text().split(\"(\")[0].trim();\n                menuItem.find(\".k-menu-link-text\").text(label + \" (\" + value + \") ...\");\n                widget.value(value);\n            }\n\n            if (component && component.toggle) {\n                if (typeof value === \"boolean\") {\n                    toggle = !!value;\n                } else if (typeof value === \"string\") {\n                    if (toolbarEl.data(\"value\")) {\n                        toggle = toolbarEl.data(\"value\") === value;\n                    } else {\n                        // if no value is specified in the tool options,\n                        // assume it should be ON if the range value is not null, and OFF otherwise.\n                        toggle = value != null;\n                    }\n                }\n\n                this.toggle(toolbarEl, toggle);\n            }\n        }\n    });\n\n    kendo.cssProperties.propertyDictionary[\"SpreadsheetToolBar\"] = kendo.cssProperties.propertyDictionary[\"ToolBar\"];\n\n    kendo.spreadsheet.ToolBar = SpreadsheetToolBar;\n\n    kendo.spreadsheet.Menu = kendo.ui.Menu;\n\n})(window.kendo);\n\n\"use strict\";\n\n    function clone(hash, target) {\n        if (!target) {\n            target = {};\n        }\n        if (Object.assign) {\n            return Object.assign(target, hash);\n        }\n        return Object.keys(hash).reduce(function(copy, key) {\n            copy[key] = hash[key];\n            return copy;\n        }, target);\n    }\n\n    function drawTabularData(options) {\n        var progress = new $.Deferred();\n        var promise = progress.promise();\n\n        options = clone(options, {\n            dataSource       : null,\n            guidelines       : true,\n            guideColor       : \"#000\",\n            columns          : null,\n            headerBackground : \"#999\",\n            headerColor      : \"#000\",\n            oddBackground    : null,\n            evenBackground   : null,\n            fontFamily       : \"Arial\",\n            fontSize         : 12,\n            paperSize        : \"A4\",\n            margin           : \"1cm\",\n            landscape        : true,\n            fitWidth         : false,\n            scale            : 1,\n            rowHeight        : 20,\n            maxEmpty         : 1,\n            useGridFormat    : true\n        });\n\n        // retrieve fonts; custom fonts should be already loaded\n        kendo.drawing.pdf.defineFont(\n            kendo.drawing.drawDOM.getFontFaces(document)\n        );\n\n        var charWidth = charWidthFunction(options.fontFamily, options.fontSize);\n\n        function textWidth(value) {\n            if (value != null) {\n                var width = 12;         // magic numbers :-/\n                for (var i = value.length; --i >= 0;) {\n                    width += charWidth(value.charAt(i));\n                }\n                return width;\n            }\n            return 0;\n        }\n\n        var border = options.guidelines ? { size: 1, color: options.guideColor } : null;\n\n        function mkCell(data) {\n            if (!border) {\n                return data;\n            }\n            return clone(data, {\n                borderLeft: border,\n                borderTop: border,\n                borderRight: border,\n                borderBottom: border\n            });\n        }\n\n        options.dataSource.fetch(function(){\n            var data = options.dataSource.data();\n            if (!data.length) {\n                return progress.reject(\"Empty dataset\");\n            }\n\n            // this really must be present\n            var columns = options.columns.map(function(col){\n                if (typeof col == \"string\") {\n                    return { title: col, field: col };\n                } else {\n                    return col;\n                }\n            });\n            var columnTitles = columns.map(function(col){\n                return col.title || col.field;\n            });\n            var columnWidths = columnTitles.map(textWidth);\n\n            // prepare data for a Sheet object's fromJSON method\n            var rows = data.map(function(row, rowIndex){\n                return {\n                    cells: columns.map(function(col, colIndex){\n                        var value = row[col.field];\n\n                        // NOTE: value might not be string.  I added option useGridFormat (default\n                        // true), which will use a column's format, if present, to convert the value\n                        // to a string, so that we can measure the width right now.\n                        if (options.useGridFormat) {\n                            if (value != null) {\n                                if (col.format) {\n                                    value = kendo.format(col.format, value);\n                                } else {\n                                    value += \"\";\n                                }\n                            }\n                            // adjust the column widths while we're at it\n                            columnWidths[colIndex] = Math.max(\n                                textWidth(value),\n                                columnWidths[colIndex]\n                            );\n                        }\n\n                        // if options.useGridFormat is false and col.format is present, pass it over\n                        // to the spreadsheet.  In that case we should calculate the widths after\n                        // the spreadsheet is created (XXX to be implemented when someone needs it).\n                        return mkCell({\n                            value: value,\n                            format: options.useGridFormat ? null : col.format,\n                            background: rowIndex % 2 ? options.evenBackground : options.oddBackground\n                        });\n                    })\n                };\n            });\n\n            // insert header line\n            rows.unshift({\n                cells: columnTitles.map(function(label){\n                    return mkCell({\n                        value: label,\n                        background: options.headerBackground,\n                        color: options.headerColor\n                    });\n                })\n            });\n\n            // init a Sheet object.  Note that we have to add one\n            // extra-row and column, because the very last ones can't\n            // have right/bottom borders (known limitation).\n            var sheet = new kendo.spreadsheet.Sheet(\n                rows.length + 1,        // rows\n                columns.length + 1,     // columns\n                options.rowHeight,      // row height\n                50,                     // column width\n                20,                     // header height\n                20,                     // header width,\n                {                       // default cell style\n                    fontFamily: options.fontFamily,\n                    fontSize: options.fontSize,\n                    verticalAlign: \"center\"\n                }\n            );\n\n            // load data\n            sheet.fromJSON({\n                name: \"Sheet1\",\n                rows: rows,\n                columns: columnWidths.map(function(w, i){\n                    return { index: i, width: w };\n                })\n            });\n\n            sheet.draw({\n                paperSize  : options.paperSize,\n                landscape  : options.landscape,\n                margin     : options.margin,\n                guidelines : false, // using borders instead (better contrast)\n                scale      : options.scale,\n                fitWidth   : options.fitWidth,\n                maxEmpty   : options.maxEmpty,\n                headerRows : 1\n            }, progress.resolve.bind(progress));\n        });\n\n        return promise;\n    }\n\n    var CACHE_CHAR_WIDTH = {};\n\n    var charWidthFunction = function(fontFamily, fontSize) {\n        var id = fontSize + \":\" + fontFamily;\n        var func = CACHE_CHAR_WIDTH[id];\n        if (!func) {\n            var span, div = document.createElement(\"div\");\n            div.style.position = \"fixed\";\n            div.style.left = \"-10000px\";\n            div.style.top = \"-10000px\";\n            div.style.fontFamily = fontFamily;\n            div.style.fontSize = fontSize + \"px\";\n            div.style.whiteSpace = \"pre\";\n            for (var i = 32; i < 128; ++i) {\n                span = document.createElement(\"span\");\n                span.appendChild(document.createTextNode(String.fromCharCode(i)));\n                div.appendChild(span);\n            }\n            document.body.appendChild(div);\n            var widths = {};\n            for (i = 32, span = div.firstChild; i < 128 && span; ++i, span = span.nextSibling) {\n                widths[i] = span.offsetWidth;\n            }\n            while ((span = div.firstChild)) {\n                div.removeChild(span);\n            }\n            func = CACHE_CHAR_WIDTH[id] = function(ch) {\n                var code = ch.charCodeAt(0);\n                var width = widths[code];\n                if (width == null) {\n                    // probably not an ASCII character, let's cache its width as well\n                    span = document.createElement(\"span\");\n                    span.appendChild(document.createTextNode(String.fromCharCode(code)));\n                    div.appendChild(span);\n                    width = widths[code] = span.offsetWidth;\n                    div.removeChild(span);\n                }\n                return width;\n            };\n        }\n        return func;\n    };\n\n    kendo.spreadsheet.drawTabularData = drawTabularData;\n\n(function(kendo) {\n\n    \"use strict\";\n\n\n    let registerEditor = kendo.spreadsheet.registerEditor;\n    var $ = kendo.jQuery;\n\n    registerEditor(\"_validation_date\", function(){\n        var context, calendar, popup;\n\n        function create() {\n            if (!calendar) {\n                calendar = $(\"<div>\").kendoCalendar();\n                popup = $(\"<div>\").kendoPopup();\n                calendar.appendTo(popup);\n                calendar = calendar.getKendoCalendar();\n                popup = popup.getKendoPopup();\n\n                calendar.bind(\"change\", function(){\n                    popup.close();\n                    var date = calendar.value();\n                    if (!context.range.format()) {\n                        context.range.format(\"yyyy-mm-dd\");\n                    }\n                    context.callback(kendo.spreadsheet.dateToNumber(date));\n                });\n            }\n            popup.setOptions({\n                anchor: context.view.element.querySelector(\".k-spreadsheet-editor-button\"),\n                origin: context.alignLeft ? \"bottom right\" : \"bottom left\",\n                position: context.alignLeft ? \"top right\" : \"top left\"\n            });\n        }\n\n        function open() {\n            create();\n\n            var date = context.range.value();\n            var sheet = context.range.sheet();\n            if (date != null) {\n                calendar.value(kendo.spreadsheet.numberToDate(date));\n            } else {\n                calendar.value(null);\n            }\n            var val = context.validation;\n            if (val) {\n                var min = kendo.ui.Calendar.fn.options.min;\n                var max = kendo.ui.Calendar.fn.options.max;\n                var fromValidation = val.from;\n                var toValidation = val.to;\n                var formula = kendo.spreadsheet.calc.runtime.Formula;\n\n                if (/^(?:greaterThan|between)/.test(val.comparerType)) {\n                    if(fromValidation instanceof formula && _rowAndColPresent(fromValidation.value)) {\n                        min = kendo.spreadsheet.numberToDate(sheet.range(fromValidation.value.row, fromValidation.value.col).value());\n                    } else {\n                        min = kendo.spreadsheet.numberToDate(fromValidation.value);\n                    }\n                }\n                if (val.comparerType == \"between\") {\n                    if(toValidation instanceof formula && _rowAndColPresent(toValidation.value)) {\n                        max = kendo.spreadsheet.numberToDate(sheet.range(toValidation.value.row, toValidation.value.col).value());\n                    } else {\n                        max = kendo.spreadsheet.numberToDate(val.to.value);\n                    }\n                }\n                if (val.comparerType == \"lessThan\" || val.comparerType == \"lessThanOrEqualTo\") {\n                    if(fromValidation instanceof formula && _rowAndColPresent(fromValidation.value)) {\n                        max = kendo.spreadsheet.numberToDate(sheet.range(fromValidation.value.row, fromValidation.value.col).value());\n                    } else {\n                        max = kendo.spreadsheet.numberToDate(val.from.value);\n                    }\n                }\n                calendar.setOptions({\n                    disableDates: function(date) {\n                        var from, to;\n\n                        if(fromValidation && fromValidation instanceof formula && _rowAndColPresent(fromValidation.value)) {\n                            from = sheet.range(fromValidation.value.row, fromValidation.value.col).value();\n                        } else {\n                            from = fromValidation ? fromValidation.value|0 : 0;\n                        }\n\n                        if(toValidation && toValidation instanceof formula && _rowAndColPresent(toValidation.value)) {\n                            to = sheet.range(toValidation.value.row, toValidation.value.col).value();\n                        } else {\n                            to = toValidation ? toValidation.value|0 : 0;\n                        }\n\n                        date = kendo.spreadsheet.dateToNumber(date) | 0;\n                        return !kendo.spreadsheet.validation\n                            .validationComparers[val.comparerType](date, from, to);\n                    },\n                    min: min,\n                    max: max\n                });\n            } else {\n                calendar.setOptions({ disableDates: null, min: null, max: null });\n            }\n            popup.open();\n        }\n\n        function _rowAndColPresent(value) {\n            return (value && value.row !== null && value.col !== null && value.row > -1 && value.col > -1);\n        }\n\n        return {\n            edit: function(options) {\n                context = options;\n                open();\n            },\n            icon: \"calendar\"\n        };\n    });\n\n    registerEditor(\"_validation_list\", function(){\n        var context, list, popup;\n        function create() {\n            if (!list) {\n                list = $(\"<ul class='k-list k-reset'/>\").kendoStaticList({\n                    template   : \"#:value#\",\n                    selectable : true,\n                    autoBind   : false\n                });\n                popup = $(\"<div class='k-spreadsheet-list-popup'>\").kendoPopup();\n                list.appendTo(popup);\n                popup = popup.getKendoPopup();\n                list = list.getKendoStaticList();\n\n                list.bind(\"change\", function(){\n                    popup.close();\n                    var item = list.value()[0];\n                    if (item) {\n                        context.callback(item.value);\n                    }\n                });\n            }\n            popup.setOptions({\n                anchor: context.view.element.querySelector(\".k-spreadsheet-editor-button\"),\n                origin: context.alignLeft ? \"bottom right\" : \"bottom left\",\n                position: context.alignLeft ? \"top right\" : \"top left\"\n            });\n        }\n        function open() {\n            create();\n            var items = context.validation.from.value;\n            var data = [], add = function(el){ data.push({ value: el }); };\n            if (items instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                items.each(add);\n            } else {\n                // actually Excel expects a simple string for list\n                // validation (comma-separated labels).\n                (items+\"\").split(/\\s*,\\s*/).forEach(add);\n            }\n            var dataSource = new kendo.data.DataSource({ data: data });\n            list.setDataSource(dataSource);\n            dataSource.read();\n            popup.open();\n        }\n        return {\n            edit: function(options) {\n                context = options;\n                open();\n            },\n            icon: \"caret-alt-down\"\n        };\n    });\n\n})(window.kendo);\n\n(function(kendo) {\n\n        var $ = kendo.jQuery;\n        var outerWidth = kendo._outerWidth;\n        var DOT = \".\";\n        var EMPTYCHAR = \" \";\n        var sheetsBarClassNames = {\n            sheetsBarWrapper: \"k-spreadsheet-sheets-bar\",\n            sheetsBarSheetsWrapper: \"k-tabstrip k-tabstrip-bottom\",\n            sheetsBarAdd: \"k-spreadsheet-sheet-add\",\n            sheetsBarSheetsMenu: \"k-spreadsheet-sheets-menu\",\n            sheetsBarRemove: \"k-spreadsheet-sheets-remove\",\n            sheetsBarItems: \"k-spreadsheet-sheets\",\n            sheetsBarEditor: \"k-spreadsheet-sheets-editor\",\n            sheetsBarScrollable: \"k-tabstrip-scrollable\",\n            sheetsBarNext: \"k-tabstrip-next\",\n            sheetsBarPrev: \"k-tabstrip-prev\",\n            sheetsBarKItem: \"k-item\",\n            sheetsBarKActive: \"k-active\",\n            sheetsBarKTextbox: \"k-textbox\",\n            sheetsBarKLink: \"k-link\",\n            sheetsBarKLinkText: \"k-link-text\",\n            sheetsBarKIcon: \"k-icon\",\n            sheetsBarKFontIcon: \"k-icon\",\n            sheetsBarKButton: \"k-button k-icon-button\",\n            sheetsBarKButtonDefaults: \"k-button-md k-rounded-md k-button-solid k-button-solid-base\",\n            sheetsBarKButtonBare: \"k-button-md k-rounded-md k-button-flat k-button-flat-base\",\n            sheetsBarArrowWIcon: \"caret-alt-left\",\n            sheetsBarArrowEIcon: \"caret-alt-right\",\n            sheetsBarKReset: \"k-reset k-tabstrip-items k-tabstrip-items-start\",\n            sheetsBarXIcon: \"x\",\n            sheetsBarMoreIcon: \"caret-alt-down\",\n            sheetsBarKSprite: \"k-sprite\",\n            sheetsBarPlusIcon: \"plus\",\n            sheetsBarMenuIcon: \"menu\",\n            sheetsBarHintWrapper: \"k-widget k-tabstrip k-tabstrip-bottom k-spreadsheet-sheets-items-hint\",\n            sheetsBarKResetItems: \"k-reset k-tabstrip-items k-tabstrip-items-start\"\n        };\n\n        var SheetsBar = kendo.ui.Widget.extend({\n            init: function(element, options) {\n                var classNames = SheetsBar.classNames;\n\n                kendo.ui.Widget.call(this, element, options);\n\n                element = this.element;\n\n                element.addClass(classNames.sheetsBarWrapper);\n\n                this._openDialog = options.openDialog;\n\n                this._addButton();\n                this._menuButton();\n                this._tree = new kendo.dom.Tree(element[0]);\n\n                this._tree.render([this._createSheetsWrapper([])]);\n                this._initSheetDropDownButtons();\n\n                this._toggleScrollEvents(true);\n\n                this._createSortable();\n\n                this._sortable.bind(\"start\", this._onSheetReorderStart.bind(this));\n\n                this._sortable.bind(\"end\", this._onSheetReorderEnd.bind(this));\n\n                element.on(\"click\", \"[ref-sheetsbar-more-button]\", this._onSheetContextMenu.bind(this));\n\n                element.on(\"click\", \"li\", this._onSheetSelect.bind(this));\n\n                element.on(\"dblclick\", \"li\" + DOT + classNames.sheetsBarKItem + DOT + classNames.sheetsBarKItem, this._createEditor.bind(this));\n            },\n\n            options: {\n                name: \"SheetsBar\",\n                scrollable: {\n                    distance: 200\n                }\n            },\n\n            events: [\n                \"select\",\n                \"reorder\",\n                \"rename\"\n            ],\n\n            _createEditor: function() {\n                if (this._editor) {\n                    return;\n                }\n\n                this._renderSheets(this._sheets, this._selectedIndex, true);\n                this._editor = this.element\n                    .find(kendo.format(\"input{0}{1}\", DOT, SheetsBar.classNames.sheetsBarEditor))\n                    .trigger(\"focus\")\n                    .on(\"keydown\", this._onEditorKeydown.bind(this))\n                    .on(\"blur\", this._onEditorBlur.bind(this));\n            },\n\n            _destroyEditor: function(canceled) {\n                var newSheetName = canceled ? null : this._editor.val();\n                this._editor.off();\n                this._editor = null;\n                this._renderSheets(this._sheets, this._selectedIndex, false);\n                this._onSheetRename(newSheetName);\n            },\n\n            renderSheets: function(sheets, selectedIndex) {\n                if (!sheets || selectedIndex < 0) {\n                    return;\n                }\n\n                this._renderSheets(sheets, selectedIndex, false);\n            },\n\n            _renderSheets: function(sheets, selectedIndex, isInEditMode) {\n                var that = this;\n                var classNames = SheetsBar.classNames;\n\n                that._isRtl = kendo.support.isRtl(that.element);\n                that._sheets = sheets;\n                that._selectedIndex = selectedIndex;\n\n                that._renderHtml(isInEditMode, true);\n\n                if (!that._scrollableAllowed()) {\n                    return;\n                }\n\n                var sheetsWrapper = that._sheetsWrapper();\n\n                sheetsWrapper.addClass(classNames.sheetsBarScrollable + EMPTYCHAR + classNames.sheetsBarSheetsWrapper);\n\n                that._toggleScrollButtons();\n            },\n\n            _toggleScrollButtons: function(toggle) {\n                var that = this;\n                var ul = that._sheetsGroup();\n                var wrapper = that._sheetsWrapper();\n                var scrollLeft = kendo.scrollLeft(ul);\n                var prev = wrapper.find(DOT + SheetsBar.classNames.sheetsBarPrev);\n                var next = wrapper.find(DOT + SheetsBar.classNames.sheetsBarNext);\n\n                if (toggle === false) {\n                    prev.addClass('k-disabled');\n                    next.addClass('k-disabled');\n                } else {\n                    prev.toggleClass('k-disabled', !(that._isRtl ? scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1 : scrollLeft !== 0));\n                    next.toggleClass('k-disabled', !(that._isRtl ? scrollLeft !== 0 : scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1));\n                }\n\n            },\n\n            _toggleScrollEvents: function(toggle) {\n                var that = this;\n                var classNames = SheetsBar.classNames;\n                var options = that.options;\n                var scrollPrevButton;\n                var scrollNextButton;\n                var sheetsWrapper = that._sheetsWrapper();\n                scrollPrevButton = sheetsWrapper.find(DOT + classNames.sheetsBarPrev);\n                scrollNextButton = sheetsWrapper.find(DOT + classNames.sheetsBarNext);\n\n                if (toggle) {\n                    scrollPrevButton.on(\"mousedown\", function(event) {\n                        event.preventDefault();\n                        event.stopPropagation();\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? 1 : -1));\n                    });\n\n                    scrollNextButton.on(\"mousedown\", function(event) {\n                        event.preventDefault();\n                        event.stopPropagation();\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? -1 : 1));\n                    });\n\n                    scrollPrevButton.add(scrollNextButton).on(\"mouseup\", function() {\n                        that._nowScrollingSheets = false;\n                    });\n                } else {\n                    scrollPrevButton.off();\n                    scrollNextButton.off();\n                }\n            },\n\n            _renderHtml: function(isInEditMode, renderScrollButtons) {\n                var idx;\n                var sheetElements = [];\n                var dom = kendo.dom;\n                var element = dom.element;\n                var sheets = this._sheets;\n                var selectedIndex = this._selectedIndex;\n                var classNames = SheetsBar.classNames;\n\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var sheet = sheets[idx];\n\n                    var isSelectedSheet = (idx === selectedIndex);\n                    var attr = { className: classNames.sheetsBarKItem + EMPTYCHAR, role: \"tab\" };\n                    var elementContent = [];\n                    if (sheet.state() !== 'visible') {\n                        attr.className += \"k-hidden \";\n                    }\n\n                    if (isSelectedSheet) {\n                        attr.className += classNames.sheetsBarKActive;\n                    }\n\n                    if (isSelectedSheet && isInEditMode) {\n                        elementContent.push(element(\"input\", {\n                            type: \"text\",\n                            value: sheet.name(),\n                            className: classNames.sheetsBarKTextbox + EMPTYCHAR + classNames.sheetsBarEditor,\n                            maxlength: 50\n                        }, []));\n                    } else {\n                        elementContent.push(element(\"span\", {\n                            className: classNames.sheetsBarKLink,\n                            title: sheet.name()\n                        }, [element(\"span\", { className: classNames.sheetsBarKLinkText }, [dom.text(sheet.name())])]));\n\n                        let contextMenuButton = element($(kendo.html.renderButton($(`<button ref-sheetsbar-more-button data-sheet-name=\"${sheet.name()}\" class=\"k-menu-button\"></button>`), {\n                            icon: classNames.sheetsBarMoreIcon,\n                            fillMode: \"flat\"\n                        }))[0]);\n\n                        elementContent.push(element(\"span\", {\n                            className: \"k-item-actions\",\n                            'data-type': 'context-menu',\n                        }, [contextMenuButton]));\n                    }\n\n                    sheetElements.push(element(\"li\", attr, elementContent));\n                }\n\n                kendo.destroy(this._sheetsWrapper());\n                this._addButton();\n                this._menuButton();\n                this._tree.render([ this._createSheetsWrapper(sheetElements, renderScrollButtons)]);\n                this._initSheetDropDownButtons();\n            },\n            _initSheetDropDownButtons: function() {\n                let that = this;\n                this.element.find(\"[ref-sheetsbar-more-button]\").each(function(ind, btnEl){\n                    let el = $(btnEl);\n                    let allSheets = that._sheets || [];\n                    let visibleSheets = allSheets.filter(sheet => sheet.state() === 'visible');\n                    let isSingleVisibleSheet = !that._sheets || that._sheets && visibleSheets.length < 2;\n                    let sheetName = el.data(\"sheetName\");\n                    let shouldAllowMoveRight = !(isSingleVisibleSheet || (that._sheets && ind == allSheets.length - 1));\n                    let shouldAllowMoveLeft = !(isSingleVisibleSheet || (that._sheets && ind === 0));\n                    el.kendoDropDownButton({\n                        icon: SheetsBar.classNames.sheetsBarMoreIcon,\n                        fillMode: \"flat\",\n                        items: [\n                            { text: \"Delete\", icon: \"trash\", attributes: { \"data-command\": \"delete\", \"data-sheet-name\": sheetName }, enabled: !isSingleVisibleSheet },\n                            { text: \"Duplicate\", icon: \"copy\", attributes: { \"data-command\": \"duplicate\", \"data-sheet-name\": sheetName } },\n                            { text: \"Rename\", icon: \"pencil\", attributes: { \"data-command\": \"rename\", \"data-sheet-name\": sheetName } },\n                            { text: \"Hide\", icon: \"eye-slash\", attributes: { \"data-command\": \"hide\", \"data-sheet-name\": sheetName }, enabled: !isSingleVisibleSheet },\n                            { text: \"Move Right\", icon: \"arrow-right\", attributes: { \"data-command\": \"move-right\", \"data-sheet-name\": sheetName }, enabled: shouldAllowMoveRight },\n                            { text: \"Move Left\", icon: \"arrow-left\", attributes: { \"data-command\": \"move-left\", \"data-sheet-name\": sheetName }, enabled: shouldAllowMoveLeft },\n                        ],\n                        click: that._onSheetContextMenu.bind(that)\n                    });\n                });\n            },\n            _createSheetsWrapper: function(sheetElements, renderScrollButtons) {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                var itemsWrapper = element('div', { className: 'k-tabstrip-items-wrapper k-hstack' });\n                var childrenElements = [element(\"ul\", {\n                    className: classNames.sheetsBarKReset,\n                    role: \"tablist\"\n                }, sheetElements), null, null];\n\n                renderScrollButtons = true;\n\n                if (renderScrollButtons) {\n                    var baseButtonClass = classNames.sheetsBarKButton + EMPTYCHAR + classNames.sheetsBarKButtonBare + EMPTYCHAR;\n\n                    childrenElements[1] = (element(\"button\", { ariaHidden: \"true\", tabIndex: -1, className: baseButtonClass + classNames.sheetsBarPrev }, [\n                        element($(kendo.ui.icon({ icon: classNames.sheetsBarArrowWIcon, iconClass: \"k-button-icon\" }))[0])\n                    ]));\n\n                    childrenElements[2] = (element(\"button\", { ariaHidden: \"true\", tabIndex: -1, className: baseButtonClass + classNames.sheetsBarNext }, [\n                        element($(kendo.ui.icon({ icon: classNames.sheetsBarArrowEIcon, iconClass: \"k-button-icon\" }))[0])\n                    ]));\n                }\n\n                itemsWrapper.children = childrenElements;\n\n                return element(\"div\", { className: classNames.sheetsBarItems }, [itemsWrapper]);\n            },\n\n            _createSortable: function() {\n                var classNames = SheetsBar.classNames;\n                this._sortable = new kendo.ui.Sortable(this.element, {\n                    filter: `ul li.${classNames.sheetsBarKItem}`,\n                    container: DOT + classNames.sheetsBarItems,\n                    axis: \"x\",\n                    animation: false,\n                    ignore: \"input\",\n                    end: function() {\n                        if (this.draggable.hint) {\n                            this.draggable.hint.remove();\n                        }\n                    },\n                    hint: function(element) {\n                        var hint = $(element).clone().attr(\"ref-sheetsbar-sortable-hint\", \"\");\n                        return hint.wrap(\"<div class='\" + classNames.sheetsBarHintWrapper + \"'><ul class='\" + classNames.sheetsBarKResetItems + \"'></ul></div>\").closest(\"div\");\n                    }\n                });\n            },\n\n            _onEditorKeydown: function(e) {\n                if (this._editor) {\n                    if (e.which === 13) {\n                        this._destroyEditor();\n                    }\n\n                    if (e.which === 27) {\n                        this._destroyEditor(true);\n                    }\n                }\n            },\n\n            _onEditorBlur: function() {\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n            },\n\n            _onSheetReorderEnd: function(e) {\n                e.preventDefault();\n                this.trigger(\"reorder\", { oldIndex: e.oldIndex, newIndex: e.newIndex });\n            },\n\n            _onSheetReorderStart: function(e) {\n                if (this._editor) {\n                    e.preventDefault();\n                }\n            },\n            _onSheetContextMenu: function(e) {\n                let sheetName = $(e.target).closest(\"li\").data(\"sheetName\");\n                let command = $(e.target).closest(\"li\").data(\"command\");\n\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n\n                if (sheetName && command) {\n                    switch(command) {\n                        case \"delete\":\n                            this._onSheetRemove(e);\n                            break;\n                        case \"duplicate\":\n                            this._onSheetDuplicate(sheetName);\n                            break;\n                        case \"rename\":\n                            this._renamePrompt(sheetName);\n                            break;\n                        case \"hide\":\n                            this._hideSheet(sheetName);\n                            break;\n                        case \"move-right\":\n                            this._moveSheet(sheetName, 1);\n                            break;\n                        case \"move-left\":\n                            this._moveSheet(sheetName, -1);\n                            break;\n                    }\n                }\n            },\n            _onSheetDuplicate: function(sheetName) {\n                this.trigger(\"duplicate\", { name: sheetName });\n            },\n            _renamePrompt: function(sheetName) {\n                let renameSheetIndex = this._sheets.findIndex(sh => sh.name() == sheetName);\n                let closeCallback = function(e) {\n                    let dlg = e.sender;\n                    if (dlg._newSheetName && dlg._newSheetName !== sheetName) {\n                        this.trigger(\"rename\", { name: dlg._newSheetName, sheetIndex: renameSheetIndex });\n                    }\n                }.bind(this);\n\n                this._openDialog(\"renameSheet\", {\n                    close: closeCallback,\n                    _oldSheetName: sheetName\n                });\n            },\n            _hideSheet: function(sheetName) {\n                this.trigger(\"hide\", { name: sheetName });\n            },\n            _moveSheet: function(sheetName, direction) {\n                let sheetIndex = this._sheets.findIndex(sheet => sheet.name() === sheetName);\n                let newSheetIndex = sheetIndex + direction;\n                if (newSheetIndex < 0 || newSheetIndex >= this._sheets.length) {\n                    return;\n                }\n\n                this.trigger(\"reorder\", { oldIndex: sheetIndex, newIndex: newSheetIndex });\n            },\n            _onSheetRemove: function(e) {\n                var removedSheetName = $(e.target).closest(\"li\").data(\"sheetName\");\n\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n\n                var closeCallback = function(e) {\n                    var dlg = e.sender;\n\n                    if (dlg.isConfirmed()) {\n                        this.trigger(\"remove\", { name: removedSheetName, confirmation: true });\n                    }\n                }.bind(this);\n\n                this._openDialog(\"confirmation\", {\n                    close: closeCallback\n                });\n            },\n\n            _onSheetSelect: function(e) {\n                var selectedSheetText = $(e.target).text();\n\n                if ($(e.target).is(DOT + SheetsBar.classNames.sheetsBarEditor) || !selectedSheetText) {\n                    e.preventDefault();\n                    return;\n                }\n\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n\n                this._scrollSheetsToItem($(e.target).closest(\"li\"));\n                this.trigger(\"select\", { name: selectedSheetText, isAddButton: false });\n            },\n\n            _onSheetRename: function(newSheetName) {\n                if (this._sheets[this._selectedIndex].name() === newSheetName || newSheetName === null) {\n                    return;\n                }\n\n                this.trigger(\"rename\", { name: newSheetName, sheetIndex: this._selectedIndex });\n            },\n\n            _onAddSelect: function(ev) {\n                ev.sender.element.removeClass(\"k-focus\");\n                this.trigger(\"select\", { isAddButton: true });\n            },\n\n            _onMenuSelect: function(ev) {\n                let sheetName = $(ev.target).closest(\"li\").data(\"sheetName\");\n                if (sheetName) {\n                    this.trigger(\"show\", { name: sheetName });\n                }\n            },\n\n            _addButton: function() {\n                var classNames = SheetsBar.classNames;\n                let addButton = this.element.find(\".\" + classNames.sheetsBarAdd);\n                if (!addButton.length) {\n                    addButton = $(`<button class=\"${classNames.sheetsBarAdd}\" aria-label=\"Add new sheet\"></button>`).appendTo(this.element);\n                } else {\n                    kendo.destroy(addButton);\n                }\n\n                addButton.kendoButton({\n                    icon: classNames.sheetsBarPlusIcon,\n                    fillMode: \"flat\",\n                    click: this._onAddSelect.bind(this)\n                });\n            },\n            _menuButton: function() {\n                var classNames = SheetsBar.classNames;\n                let menuButton = this.element.find(\".\" + classNames.sheetsBarSheetsMenu);\n                if (!menuButton.length) {\n                    menuButton = $(`<button class=\"${classNames.sheetsBarSheetsMenu}\"></button>`).appendTo(this.element);\n                } else {\n                    kendo.destroy(menuButton);\n                }\n\n                menuButton.kendoDropDownButton({\n                    icon: classNames.sheetsBarMenuIcon,\n                    fillMode: \"flat\",\n                    items: (this._sheets || []).map(sheet => ({\n                        text: sheet.name(),\n                        attributes: { 'data-sheet-name': sheet.name() },\n                        icon: sheet.state() === 'visible' ? 'eye' : 'eye-slash',\n                        cssClass: classNames\n                    })),\n                    click: this._onMenuSelect.bind(this)\n                });\n            },\n\n            destroy: function() {\n                this._sortable.destroy();\n            },\n\n            _scrollableAllowed: function() {\n                var options = this.options;\n                return options.scrollable && !isNaN(options.scrollable.distance);\n            },\n\n            _scrollSheetsToItem: function(item) {\n                var that = this;\n                var sheetsGroup = that._sheetsGroup();\n                var currentScrollOffset = kendo.scrollLeft(sheetsGroup);\n                var itemWidth = outerWidth(item);\n                var itemOffset = that._isRtl ? item.position().left : item.position().left - sheetsGroup.children().first().position().left;\n                var sheetsGroupWidth = sheetsGroup[0].offsetWidth;\n                var itemPosition;\n\n                if (that._isRtl) {\n                    if (itemOffset < 0) {\n                        itemPosition = currentScrollOffset + itemOffset - (sheetsGroupWidth - currentScrollOffset);\n                    } else if (itemOffset + itemWidth > sheetsGroupWidth) {\n                        itemPosition = currentScrollOffset + itemOffset - itemWidth;\n                    }\n                } else {\n                    if (currentScrollOffset + sheetsGroupWidth < itemOffset + itemWidth) {\n                        itemPosition = itemOffset + itemWidth - sheetsGroupWidth;\n                    } else if (currentScrollOffset > itemOffset) {\n                        itemPosition = itemOffset;\n                    }\n                }\n\n                sheetsGroup.finish().animate({ \"scrollLeft\": itemPosition }, \"fast\", \"linear\", function() {\n                    that._toggleScrollButtons();\n                });\n            },\n\n            _sheetsGroup: function() {\n                return this._sheetsWrapper().find(\"ul\");\n            },\n\n            _sheetsWrapper: function() {\n                return this.element.find(DOT + SheetsBar.classNames.sheetsBarItems);\n            },\n\n            _scrollSheetsByDelta: function(delta) {\n                var that = this;\n                var sheetsGroup = that._sheetsGroup();\n                var scrLeft = kendo.scrollLeft(sheetsGroup);\n\n                sheetsGroup.finish().animate({ \"scrollLeft\": scrLeft + delta }, \"fast\", \"linear\", function() {\n                    if (that._nowScrollingSheets) {\n                        that._scrollSheetsByDelta(delta);\n                    } else {\n                        that._toggleScrollButtons();\n                    }\n                });\n            }\n        });\n\n        kendo.spreadsheet.SheetsBar = SheetsBar;\n        $.extend(true, SheetsBar, { classNames: sheetsBarClassNames });\n    })(window.kendo);\n\n(function(kendo) {\n\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var classNames = {\n            details: \"k-details\",\n            button: \"k-button\",\n            detailsSummary: \"k-details-summary\",\n            detailsContent: \"k-details-content\",\n            icon: \"k-icon\",\n            iconCollapseName: \"caret-br\",\n            iconExpandName: \"caret-alt-right\",\n            iconSearchName: \"search\",\n            textbox: \"k-textbox\",\n            wrapper: \"k-spreadsheet-filter-menu\",\n            filterByCondition: \"k-spreadsheet-condition-filter\",\n            filterByValue: \"k-spreadsheet-value-filter\",\n            valuesTreeViewWrapper: \"k-spreadsheet-value-treeview-wrapper\",\n            actionButtons: \"k-actions\"\n        };\n\n        kendo.spreadsheet.messages.filterMenu = {\n            all: \"All\",\n            sortAscending: \"Sort range A to Z\",\n            sortDescending: \"Sort range Z to A\",\n            filterByValue: \"Filter by value\",\n            filterByCondition: \"Filter by condition\",\n            apply: \"Apply\",\n            search: \"Search\",\n            addToCurrent: \"Add to current selection\",\n            clear: \"Clear\",\n            blanks: \"(Blanks)\",\n            operatorNone: \"None\",\n            and: \"AND\",\n            or: \"OR\",\n            operators: {\n                string: {\n                    contains: \"Text contains\",\n                    doesnotcontain: \"Text does not contain\",\n                    startswith: \"Text starts with\",\n                    endswith: \"Text ends with\",\n                    matches: \"Text matches\",\n                    doesnotmatch: \"Text does not match\"\n                },\n                date: {\n                    eq:  \"Date is\",\n                    neq: \"Date is not\",\n                    lt:  \"Date is before\",\n                    gt:  \"Date is after\"\n                },\n                number: {\n                    eq: \"Is equal to\",\n                    neq: \"Is not equal to\",\n                    gte: \"Is greater than or equal to\",\n                    gt: \"Is greater than\",\n                    lte: \"Is less than or equal to\",\n                    lt: \"Is less than\"\n                }\n            }\n        };\n\n        var Details = Widget.extend({\n            init: function(element, options) {\n                Widget.fn.init.call(this, element, options);\n\n                this.element.addClass(FilterMenu.classNames.details);\n\n                this._summary = this.element.find(\".\" + FilterMenu.classNames.detailsSummary)\n                    .on(\"click\", this._toggle.bind(this));\n\n                var iconName = options.expanded ? FilterMenu.classNames.iconCollapseName : FilterMenu.classNames.iconExpandName;\n                this._icon = $(kendo.ui.icon(iconName))\n                    .prependTo(this._summary);\n\n                this._container = kendo.wrap(this._summary.next(), true);\n\n                if (!options.expanded) {\n                    this._container.hide();\n                }\n            },\n            options: {\n                name: \"Details\"\n            },\n            events: [ \"toggle\" ],\n            visible: function() {\n                return this.options.expanded;\n            },\n            toggle: function(show) {\n                var animation = kendo.fx(this._container).expand(\"vertical\");\n\n                animation.stop()[show ? \"reverse\" : \"play\"]();\n                kendo.ui.icon(this._icon, { icon: show ? FilterMenu.classNames.iconExpandName : FilterMenu.classNames.iconCollapseName });\n\n                this.options.expanded = !show;\n            },\n            _toggle: function() {\n                var show = this.visible();\n                this.toggle(show);\n                this.trigger(\"toggle\", { show: show });\n            }\n        });\n\n        kendo.data.binders.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function(element, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, element, bindings, options);\n\n                this._change = this.change.bind(this);\n                $(this.element).on(\"change\", this._change);\n            },\n            refresh: function() {\n                var that = this,\n                    value = that.bindings.spreadsheetFilterValue.get(); //get the value from the View-Model\n\n                $(that.element).val(value instanceof Date ? \"\" : value);\n            },\n            change: function() {\n                var value = this.element.value;\n                this.bindings.spreadsheetFilterValue.set(value); //update the View-Model\n            }\n        });\n\n        kendo.data.binders.widget.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function(widget, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, widget.element[0], bindings, options);\n\n                this.widget = widget;\n                this._change = this.change.bind(this);\n                this.widget.first(\"change\", this._change);\n            },\n            refresh: function() {\n                var binding = this.bindings.spreadsheetFilterValue,\n                    value = binding.get(),\n                    type = $(this.widget.element).data(\"filterType\");\n\n                if ((type === \"date\" && value instanceof Date) || (type === \"number\" && !isNaN(value))) {\n                    this.widget.value(value);\n                } else {\n                    this.widget.value(null);\n                }\n            },\n            change: function() {\n                var value = this.widget.value(),\n                    binding = this.bindings.spreadsheetFilterValue;\n\n                binding.set(value);\n            }\n        });\n\n        var templates = {\n            filterByValue: (data) =>\n                `<div class='${classNames.detailsSummary}'>${data.messages.filterByValue}</div>` +\n                `<div class='${classNames.detailsContent}'>` +\n                    \"<div class='k-searchbox k-input k-input-md k-rounded-md k-input-solid'>\" +\n                        kendo.ui.icon({ icon: \"search\", iconClass: \"k-input-icon\" }) +\n                        `<input class='k-input-inner' autocomplete='off' placeholder='${data.messages.search}' data-${data.ns}bind='events: { input: filterValues }' />` +\n                    \"</div>\" +\n                    `<div data-${data.ns}bind='visible: hasActiveSearch'><input class='k-checkbox k-checkbox-md k-rounded-md' type='checkbox' data-${data.ns}bind='checked: appendToSearch' id='_${data.guid}'/><label class='k-checkbox-label' for='_${data.guid}'>${data.messages.addToCurrent}</label></div>` +\n                    `<div class='${classNames.valuesTreeViewWrapper}'>` +\n                        `<div data-${data.ns}role='treeview' ` +\n                            `bind:data-${data.ns}checkboxes='checkboxesConfig' `+\n                            `data-${data.ns}bind='source: valuesDataSource, events: { check: valuesChange, select: valueSelect }' `+\n                            \"></div>\" +\n                    \"</div>\" +\n                \"</div>\",\n            filterByCondition: (data) =>\n                `<div class='${classNames.detailsSummary}'>${data.messages.filterByCondition}</div>` +\n                `<div class='${classNames.detailsContent}'>` +\n                    '<div>' +\n                        '<select ' +\n                            `aria-label=\"${data.messages.filterByCondition}\" ` +\n                            `data-${data.ns}role=\"dropdownlist\"` +\n                            `data-${data.ns}bind=\"value: operator, source: operators, events: { change: operatorChange } \"` +\n                            `data-${data.ns}value-primitive=\"false\"` +\n                            `data-${data.ns}option-label=\"${data.messages.operatorNone}\"` +\n                            `data-${data.ns}height=\"auto\"` +\n                            `data-${data.ns}text-field=\"text\"` +\n                            `data-${data.ns}value-field=\"unique\">`+\n                        '</select>'+\n                    '</div>' +\n\n                    `<div data-${data.ns}bind=\"visible: isString\">` +\n                        `<input aria-label=\"string-value\" data-filter-type=\"string\" data-${data.ns}bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" class=\"k-textbox\" />`+\n                    '</div>' +\n\n                    `<div data-${data.ns}bind=\"visible: isNumber\">` +\n                        `<input aria-label=\"number-value\" data-filter-type=\"number\" data-${data.ns}role=\"numerictextbox\" data-${data.ns}bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />`+\n                    '</div>' +\n\n                    `<div data-${data.ns}bind=\"visible: isDate\">` +\n                        `<input aria-label=\"date-value\" data-filter-type=\"date\" data-${data.ns}role=\"datepicker\" data-${data.ns}bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />`+\n                    '</div>' +\n                \"</div>\",\n            menuItem: (data) =>\n                `<li data-command='${data.command}' data-dir='${data.dir}'>` +\n                    `${kendo.ui.icon(data.iconClass)}${data.text}` +\n                \"</li>\",\n            actionButtons: (data) =>\n                `<button data-${data.ns}bind='click: apply' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'><span class='k-button-text'>${data.messages.apply}</span></button>` +\n                `<button data-${data.ns}bind='click: clear' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'><span class='k-button-text'>${data.messages.clear}</span></button>`\n        };\n\n        function distinctValues(values) {\n            var hash = {};\n            var result = [];\n\n            for (var i = 0; i < values.length; i++) {\n                if (!hash[values[i].value]) {\n                    hash[values[i].value] = values[i];\n                    result.push(values[i]);\n                } else if (!hash[values[i].value].checked && values[i].checked) {\n                    hash[values[i].value].checked = true;\n                }\n            }\n\n            return result;\n        }\n\n        function filter(dataSource, query) {\n            var hasVisibleChildren = false;\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            var valuesFilter = this;\n            var values = this.values;\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                var text = item.text.toString().toLocaleLowerCase(kendo.culture().name);\n                var itemVisible = query === true || query === \"\" || text.indexOf(query) >= 0;\n                var filterSpread = filter.bind(valuesFilter);\n                var anyVisibleChildren = filterSpread(item.children, query); // pass true if parent matches\n\n                hasVisibleChildren = hasVisibleChildren || anyVisibleChildren || itemVisible;\n                item.hidden = !itemVisible && !anyVisibleChildren;\n\n                if (query.length || (values && !values.length)) {\n                    item.checked = !item.hidden;\n                } else if (values && values.indexOf(item.text) != -1){\n                    item.checked = true;\n                }\n            }\n\n            if (data) {\n                // re-apply filter on children\n                dataSource.filter({ field: \"hidden\", operator: \"neq\", value: true });\n            }\n\n            return hasVisibleChildren;\n        }\n\n        function uncheckAll(dataSource) {\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                item.checked = false;\n\n                if (item.hasChildren) {\n                    uncheckAll(item.children);\n                }\n            }\n        }\n\n        var FilterMenuViewModel = kendo.spreadsheet.FilterMenuViewModel = kendo.data.ObservableObject.extend({\n            valuesChange: function(e) {\n                var dataSource = e ? e.sender.dataSource : this.valuesDataSource;\n                var checked = function(item) {\n                    return item.checked;\n                };\n                var value = function(item) {\n                    return item.dataType === \"date\" ? kendo.spreadsheet.dateToNumber(item.value) : item.value;\n                };\n                var unique = function(value, index, array) {\n                    return array.lastIndexOf(value) === index;\n                };\n                var data = dataSource.data();\n                var values = data.toJSON()[0].items;\n                var blanks = values.filter(function(item) {\n                    return item.dataType === \"blank\";\n                });\n\n                blanks = blanks.length ? blanks[0].checked : false;\n                values = values.filter(checked).map(value);\n\n                if (this.appendToSearch && this.valueFilter && this.valueFilter.values.length) {\n                    values = values.concat(this.valueFilter.values.toJSON()).sort().filter(unique);\n                }\n\n                this.set(\"valueFilter\", {\n                    values: values,\n                    blanks: blanks\n                });\n            },\n            valueSelect: function(e) {\n                e.preventDefault();\n\n                var node = e.sender.dataItem(e.node);\n                node.set(\"checked\", !node.checked);\n            },\n            hasActiveSearch: false,\n            appendToSearch: false,\n            filterValues: function(e) {\n                var query = typeof e == \"string\" ? e : $(e.target).val().toLocaleLowerCase(kendo.culture().name);\n                var dataSource = this.valuesDataSource;\n\n                this.set(\"hasActiveSearch\", !!query);\n\n                var filterSpread = filter.bind(this.valueFilter);\n                uncheckAll(dataSource);\n                filterSpread(dataSource, query);\n            },\n            reset: function() {\n                this.set(\"customFilter\", { logic: \"and\", criteria: [ { operator: null, value: null } ] });\n                this.set(\"valueFilter\", { values: [] });\n            },\n            operatorChange: function(e) {\n                var dataItem = e.sender.dataItem();\n                this.set(\"operatorType\", dataItem.type);\n\n                // https://github.com/telerik/kendo-ui-core/issues/3317 - when switching from Value\n                // filter to “filter by condition”, the customFilter property is lost.\n                if (!this.get(\"customFilter\")) {\n                    this.reset();\n                }\n\n                this.set(\"customFilter.criteria[0].operator\", dataItem.value);\n            },\n            isNone: function() {\n                return this.get(\"operatorType\") === undefined;\n            },\n            isString: function() {\n                return this.get(\"operatorType\") === \"string\";\n            },\n            isNumber: function() {\n                return this.get(\"operatorType\") === \"number\";\n            },\n            isDate: function() {\n                return this.get(\"operatorType\") === \"date\";\n            }\n        });\n\n        function flattenOperators(operators) {\n            var messages = kendo.spreadsheet.messages.filterMenu.operators;\n            var result = [];\n            for (var type in operators) {\n                if (!operators.hasOwnProperty(type)) {\n                    continue;\n                }\n\n                for (var operator in operators[type]) {\n                    if (!operators[type].hasOwnProperty(operator)) {\n                        continue;\n                    }\n\n                    result.push({\n                        text: messages[type][operator],\n                        value: operator,\n                        unique: type + \"_\" + operator,\n                        type: type\n                    });\n                }\n            }\n            return result;\n        }\n\n        var FilterMenuController = kendo.spreadsheet.FilterMenuController = {\n            valuesTree: function(range, column) {\n                return [{\n                    text: kendo.spreadsheet.messages.filterMenu.all,\n                    expanded: true,\n                    checked: false,\n                    items: this.values(range.resize({ top: 1 }), column)\n                }];\n            },\n            values: function(range, column) {\n                var values = [];\n                var messages = kendo.spreadsheet.messages.filterMenu;\n                var columnRange = range.column(column);\n                var sheet = range.sheet();\n\n                columnRange.forEachCell(function(row, col, cell) {\n                    var checked = true;\n                    if (sheet.isHiddenRow(row)) {\n                        checked = false;\n                    }\n\n                    var value = cell.value;\n                    var dataType = cell.dataType;\n                    var text = cell.text;\n\n                    if (value === undefined) {\n                        dataType = \"blank\";\n                    } else if (cell.format) {\n                        dataType = kendo.spreadsheet.formatting.type(value, cell.format);\n                    } else {\n                        dataType = typeof value;\n                    }\n\n                    if (value !== null && cell.format) {\n                        text = kendo.spreadsheet.formatting.text(value, cell.format);\n                    } else {\n                        text = dataType == \"blank\" ? messages.blanks : value;\n                    }\n\n                    if (dataType === \"percent\" || dataType === \"currency\") { //treat percent as number\n                        dataType = \"number\";\n                    }\n\n                    if (dataType === \"date\") {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n\n                    values.push({\n                        dataType: dataType,\n                        value: value,\n                        text: text,\n                        checked: checked\n                    });\n                });\n\n                values = distinctValues(values);\n\n                values.sort(function(a, b) {\n                    if (a.dataType === b.dataType) {\n                        return 0;\n                    }\n\n                    if (a.dataType === \"blank\" || b.dataType === \"blank\") {\n                        return a.dataType === \"blank\" ? -1 : 1;\n                    }\n\n                    if (a.dataType === \"number\" || b.dataType === \"number\") {\n                        return a.dataType === \"number\" ? -1 : 1;\n                    }\n\n                    if (a.dataType === \"date\" || b.dataType === \"date\") {\n                        return a.dataType === \"date\" ? -1 : 1;\n                    }\n\n                    return 0;\n                });\n\n                return values;\n            },\n\n            filterType: function(range, column) {\n                // 1. try to infer type from current filter\n                var sheet = range.sheet();\n                var filter = this.filterForColumn(column, sheet);\n                var type;\n\n                filter = filter && filter.filter.toJSON();\n\n                if (filter && filter.filter == \"custom\") {\n                    var value = filter.criteria[0].value;\n\n                    if (value instanceof Date) {\n                        type = \"date\";\n                    } else if (typeof value == \"string\") {\n                        type = \"string\";\n                    } else if (typeof value == \"number\") {\n                        type = \"number\";\n                    }\n                }\n\n                if (!type) {\n                    // 2. try to infer type from column data\n                    var topValue = this.values(range.row(1), column)[0];\n                    type = topValue && topValue.dataType;\n\n                    if (type == \"blank\") {\n                        type = null;\n                    }\n                }\n\n                return type;\n            },\n\n            filterForColumn: function(column, sheet) {\n                var allFilters = sheet.filter();\n                var filters;\n\n                if (allFilters) {\n                    filters =  allFilters.columns.filter(function(item) {\n                        return item.index === column;\n                    })[0];\n                }\n\n                return filters;\n            },\n\n            filter: function(column, sheet) {\n                var columnFilters = this.filterForColumn(column, sheet);\n\n                if (!columnFilters) {\n                    return;\n                }\n\n                var options = columnFilters.filter.toJSON();\n                var type = options.filter;\n\n                delete options.filter;\n\n                var result = {\n                    type: type,\n                    options: options\n                };\n\n                var criteria = options.criteria;\n                if (criteria && criteria.length) {\n                    result.operator = criteria[0].operator;\n                }\n\n                return result;\n            }\n        };\n\n        var FilterMenu = Widget.extend({\n            init: function(element, options) {\n                Widget.call(this, element, options);\n\n                this.element.addClass(FilterMenu.classNames.wrapper);\n\n                this.viewModel = new FilterMenuViewModel({\n                    active: \"value\",\n                    checkboxesConfig: { checkChildren: true },\n                    operator: null,\n                    operators: flattenOperators(this.options.operators),\n                    clear: this.clear.bind(this),\n                    apply: this.apply.bind(this)\n                });\n\n                this._filterInit();\n                this._popup();\n                this._sort();\n                this._filterByCondition();\n                this._filterByValue();\n                this._actionButtons();\n            },\n\n            options: {\n                name: \"FilterMenu\",\n                column: 0,\n                range: null,\n                operators: {\n                    string: {\n                        contains: \"Text contains\",\n                        doesnotcontain: \"Text does not contain\",\n                        startswith: \"Text starts with\",\n                        endswith: \"Text ends with\",\n                        matches: \"Text matches\",\n                        doesnotmatch: \"Text does not match\"\n                    },\n                    date: {\n                        eq:  \"Date is\",\n                        neq: \"Date is not\",\n                        lt:  \"Date is before\",\n                        gt:  \"Date is after\"\n                    },\n                    number: {\n                        eq: \"Is equal to\",\n                        neq: \"Is not equal to\",\n                        gte: \"Is greater than or equal to\",\n                        gt: \"Is greater than\",\n                        lte: \"Is less than or equal to\",\n                        lt: \"Is less than\"\n                    }\n                }\n            },\n\n            events: [\n                \"action\"\n            ],\n\n            destroy: function() {\n                Widget.fn.destroy.call(this);\n\n                this.menu.destroy();\n                this.valuesTreeView.destroy();\n                this.popup.destroy();\n            },\n\n            openFor: function(anchor, event) {\n                if ($(anchor).hasClass(\"k-spreadsheet-view-size\")) {\n                    // on touch devices this element will sit above to\n                    // enable scrolling; it's not useful as an anchor,\n                    // use event coords instead.\n                    this.popup.open(event.pageX, event.pageY);\n                } else {\n                    this.popup.setOptions({ anchor: anchor });\n                    this.popup.open();\n                }\n            },\n\n            close: function() {\n                this.popup.close();\n            },\n\n            clear: function() {\n                this.action({\n                    command: \"ClearFilterCommand\",\n                    options: {\n                        column: this.options.column\n                    }\n                });\n                this.viewModel.reset();\n                this.close();\n            },\n\n            apply: function() {\n                this._active();\n\n                var options = {\n                    operatingRange: this.options.range,\n                    column: this.options.column\n                };\n\n                var valueFilter;\n                var customFilter;\n\n                if (this.viewModel.active === \"value\") {\n                    this.viewModel.valuesChange({ sender: this.valuesTreeView });\n                    valueFilter = this.viewModel.valueFilter.toJSON();\n\n                    if (valueFilter.blanks || (valueFilter.values && valueFilter.values.length)) {\n                        options.valueFilter = valueFilter;\n                    }\n                } else if (this.viewModel.active === \"custom\") {\n                    customFilter = this.viewModel.customFilter.toJSON();\n\n                    if (customFilter.criteria.length && customFilter.criteria[0].value !== null) {\n                        options.customFilter = customFilter;\n                    }\n                }\n\n                if (options.valueFilter || options.customFilter) {\n                    this.action({ command: \"ApplyFilterCommand\", options: options });\n                }\n            },\n\n            action: function(options) {\n                this.trigger(\"action\", $.extend({ }, options));\n            },\n\n            _filterInit: function() {\n                var column = this.options.column;\n                var range = this.options.range;\n                var sheet = range.sheet();\n                var activeFilter = FilterMenuController.filter(column, sheet);\n\n                if (activeFilter) {\n                    var filterType = FilterMenuController.filterType(range, column);\n\n                    this.viewModel.set(\"active\", activeFilter.type);\n                    this.viewModel.set(activeFilter.type + \"Filter\", activeFilter.options);\n\n                    if (activeFilter.type == \"custom\") {\n                        this.viewModel.set(\"operator\", filterType + \"_\" + activeFilter.operator);\n                        this.viewModel.set(\"operatorType\", filterType);\n                    }\n                } else {\n                    this.viewModel.reset();\n                }\n            },\n\n            _popup: function() {\n                this.popup = this.element.kendoPopup({\n                    copyAnchorStyles: false\n                }).data(\"kendoPopup\");\n            },\n\n            _sort: function() {\n                var template = kendo.template(FilterMenu.templates.menuItem);\n                var messages = kendo.spreadsheet.messages.filterMenu;\n                var items = [\n                    { command: \"sort\", dir: \"asc\", text: messages.sortAscending, iconClass: \"sort-asc\" },\n                    { command: \"sort\", dir: \"desc\", text: messages.sortDescending, iconClass: \"sort-desc\" }\n                ];\n\n                var ul = $(\"<ul></ul>\", {\n                    \"html\": kendo.render(template, items)\n                }).appendTo(this.element);\n\n                this.menu = ul.kendoMenu({\n                    orientation: \"vertical\",\n                    select: function(e) {\n                        var dir = $(e.item).data(\"dir\");\n                        var range = this.options.range.resize({ top: 1 });\n                        var options = {\n                            value: dir,\n                            sheet: false,\n                            operatingRange: range,\n                            column: this.options.column\n                        };\n\n                        this.action({ command: \"SortCommand\", options: options });\n                    }.bind(this)\n                }).data(\"kendoMenu\");\n            },\n\n            _appendTemplate: function(template, className, details, expanded) {\n                var compiledTemplate = kendo.template(template);\n                var wrapper = $(\"<div class='\" + className + \"'/>\").html(compiledTemplate({\n                    messages: kendo.spreadsheet.messages.filterMenu,\n                    guid: kendo.guid(),\n                    ns: kendo.ns\n                }));\n\n                this.element.append(wrapper);\n\n                if (details) {\n                    details = new Details(wrapper, { expanded: expanded, toggle: this._detailToggle.bind(this) });\n                }\n\n                kendo.bind(wrapper, this.viewModel);\n\n                return wrapper;\n            },\n\n            _detailToggle: function(e) {\n                this.element\n                    .find(\"[\" + kendo.attr(\"role\") + \"=details]\")\n                    .not(e.sender.element)\n                    .data(\"kendoDetails\")\n                    .toggle(!e.show);\n            },\n\n            _filterByCondition: function() {\n                var isExpanded = this.viewModel.active === \"custom\";\n                this._appendTemplate(FilterMenu.templates.filterByCondition, FilterMenu.classNames.filterByCondition, true, isExpanded);\n            },\n\n            _filterByValue: function() {\n                var isExpanded = this.viewModel.active === \"value\";\n                var wrapper = this._appendTemplate(FilterMenu.templates.filterByValue, FilterMenu.classNames.filterByValue, true, isExpanded);\n\n                this.valuesTreeView = wrapper.find(\"[\" + kendo.attr(\"role\") + \"=treeview]\").data(\"kendoTreeView\");\n\n                var values = FilterMenuController.valuesTree(this.options.range, this.options.column);\n\n                this.viewModel.set(\"valuesDataSource\", new kendo.data.HierarchicalDataSource({ data: values, accentFoldingFiltering: kendo.culture().name }));\n            },\n\n            _actionButtons: function() {\n                this._appendTemplate(FilterMenu.templates.actionButtons, FilterMenu.classNames.actionButtons, false);\n            },\n\n            _active: function() {\n                var activeContainer = this.element.find(\"[\" + kendo.attr(\"role\") + \"=details]\").filter(function(index, element) {\n                    return $(element).data(\"kendoDetails\").visible();\n                });\n\n                if (activeContainer.hasClass(FilterMenu.classNames.filterByValue)) {\n                    this.viewModel.set(\"active\", \"value\");\n                } else if (activeContainer.hasClass(FilterMenu.classNames.filterByCondition)) {\n                    this.viewModel.set(\"active\", \"custom\");\n                }\n            }\n        });\n\n        kendo.spreadsheet.FilterMenu = FilterMenu;\n        $.extend(true, FilterMenu, { classNames: classNames, templates: templates });\n\n    })(window.kendo);\n\n(function(kendo) {\n\n    kendo.spreadsheet.messages.workbook = {\n        defaultSheetName: \"Sheet\"\n    };\n\n    kendo.spreadsheet.messages.view = {\n        nameBox: \"Name Box\",\n        formulaInput: \"Formula Input\",\n        errors: {\n            openUnsupported: \"Unsupported format. Please select an .xlsx file.\",\n            shiftingNonblankCells: \"Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.\",\n            insertColumnWhenRowIsSelected: \"Cannot insert column when all columns are selected.\",\n            insertRowWhenColumnIsSelected: \"Cannot insert row when all rows are selected.\",\n            filterRangeContainingMerges: \"Cannot create a filter within a range containing merges\",\n            sortRangeContainingMerges: \"Cannot sort a range containing merges\",\n            cantSortMultipleSelection: \"Cannot sort multiple selection\",\n            cantSortNullRef: \"Cannot sort empty selection\",\n            cantSortMixedCells: \"Cannot sort range containing cells of mixed shapes\",\n            validationError: \"The value that you entered violates the validation rules set on the cell.\",\n            cannotModifyDisabled: \"Cannot modify disabled cells.\",\n            insertRowBelowLastRow: \"Cannot insert row below the last row.\",\n            insertColAfterLastCol: \"Cannot insert column to the right of the last column.\"\n        },\n        tabs: {\n            file: \"File\",\n            home: \"Home\",\n            insert: \"Insert\",\n            format: \"Format\",\n            data: \"Data\",\n            view: \"View\"\n        }\n    };\n\n    kendo.spreadsheet.messages.menus = {\n        \"cut\": \"Cut\",\n        \"copy\": \"Copy\",\n        \"paste\": \"Paste\",\n        \"merge\": \"Merge\",\n        \"unmerge\": \"Unmerge\",\n        \"delete\": \"Delete\",\n        \"hide\": \"Hide\",\n        \"unhide\": \"Unhide\",\n        \"bringToFront\": \"Bring to front\",\n        \"sendToBack\": \"Send to back\"\n    };\n})(window.kendo);\n\n(function(kendo) {\n    let $ = kendo.jQuery;\n\n    if (kendo.PDFMixin) {\n        let override_drawPDF = function(options) {\n            var result = new $.Deferred();\n            var callback = function(group) {\n                result.resolve(group);\n            };\n            switch(options.area) {\n            case \"workbook\":\n                options.workbook.draw(options, callback);\n                break;\n            case \"sheet\":\n                options.workbook.activeSheet().draw(options, callback);\n                break;\n            case \"selection\":\n                options.workbook.activeSheet().selection().draw(options, callback);\n                break;\n            }\n\n            return result.promise();\n        };\n\n         let overrideSaveAsPDF = function(options) {\n            if (this.events.indexOf(\"pdfExport\") === -1) {\n                kendo.PDFMixin.extend(this);\n                this.saveAsPDF = overrideSaveAsPDF;\n                this._drawPDF = override_drawPDF;\n            }\n\n            var progress = new $.Deferred();\n            var promise = progress.promise();\n            var args = { promise: promise };\n            if (this.trigger(\"pdfExport\", args)) {\n                return;\n            }\n\n            this._drawPDF(options, progress)\n            .then(function(root) {\n                let pdfResultPromise = options.forceProxy\n                    ? kendo.pdf.exportPDF(root) // produce data URI for proxy\n                    : kendo.pdf.exportPDFToBlob(root);\n                return kendo.convertPromiseToDeferred(pdfResultPromise);\n            })\n            .done(function(dataURI) {\n                kendo.saveAs({\n                    dataURI: dataURI,\n                    fileName: options.fileName,\n                    proxyURL: options.proxyURL,\n                    forceProxy: options.forceProxy,\n                    proxyTarget: options.proxyTarget\n                });\n\n                progress.resolve();\n            })\n            .fail(function(err) {\n                progress.reject(err);\n            });\n\n            return promise;\n        };\n\n        kendo.spreadsheet.Workbook.prototype.saveAsPDF = overrideSaveAsPDF;\n\n        kendo.spreadsheet.Workbook.prototype._drawPDF = override_drawPDF;\n    }\n})(kendo);\n\nconst __meta__ = {\n    id: \"spreadsheet\",\n    name: \"Spreadsheet\",\n    category: \"web\",\n    description: \"Spreadsheet component\",\n    depends: [\n        \"core\", \"binder\", \"colorpicker\", \"combobox\", \"data\", \"dom\", \"dropdownlist\",\n        \"menu\", \"ooxml\", \"popup\", \"sortable\", \"toolbar\", \"treeview\",\n        \"window\", \"validator\", \"excel\", \"pdf\", \"drawing\", \"list\", \"spreadsheet.common\"]\n};\n\n(function(kendo, undefined$1) {\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n\n    const K_ACTIVE = \"k-active\";\n    let $ = kendo.jQuery;\n    let Widget = kendo.ui.Widget;\n    let NS = \".kendoSpreadsheet\";\n    let DOT = \".\";\n    let commonEngine = kendo.spreadsheet.commonEngine;\n    let FormulaInput = kendo.spreadsheet.FormulaInput;\n    let SheetsBar = kendo.spreadsheet.SheetsBar;\n\n    function toActionSelector(selectors) {\n        return selectors.map(function(action) {\n            return '[data-action=\"' + action + '\"]';\n        }).join(\",\");\n    }\n\n    let COMPOSITE_UNAVAILABLE_ACTION_SELECTORS = toActionSelector(['cut', 'copy', 'paste', 'insert-left', 'insert-right', 'insert-above', 'insert-below']);\n    let UNHIDE_ACTION_SELECTORS = toActionSelector(['unhide-row', 'unhide-column']);\n    let classNames = {\n        wrapper: \"k-spreadsheet\"\n    };\n\n    let viewClassNames = commonEngine.View.classNames;\n\n    const SPREADSHEET_CONTENT_HTML_TEMPLATE = ({ messages }) => `\n                            <div ref-header-container class=\"k-spreadsheet-header\"><div ref-header-menu></div><div ref-header-toolbar></div></div>\n                            <div class=\"k-spreadsheet-action-bar\">\n                                <div class=\"k-spreadsheet-name-editor\">\n                                    <input ref-namebox-input title=\"${messages.nameBox || \"Name Box\"}\" aria-label=\"${messages.nameBox || \"Name Box\"}\"></input>\n                                </div>\n                                <div class=\"k-spreadsheet-formula-bar\">\n                                    ${kendo.ui.icon(\"formula-fx\")}\n                                    <div class=\"k-spreadsheet-formula-input\"\n                                        role=\"combobox\"\n                                        title=\"${messages.view.formulaInput}\"\n                                        aria-haspopup=\"menu\"\n                                        aria-expanded=\"false\"\n                                        contentEditable=\"true\"\n                                        spellCheck=\"false\">\n                                    </div>\n                                </div>\n                            </div>\n                            <div class=\"k-spreadsheet-view\">\n                                <div class=\"k-spreadsheet-fixed-container\"></div>\n                                <div class=\"k-spreadsheet-scroller\">\n                                    <div class=\"k-spreadsheet-view-size\"></div>\n                                </div>\n                                <div tabIndex=\"0\" class=\"k-spreadsheet-clipboard\" contentEditable=\"true\" ></div>\n                                <div contentEditable=\"true\"\n                                    spellCheck=\"false\"\n                                    role=\"combobox\"\n                                    title=\"${messages.view.formulaInput}\"\n                                    aria-haspopup=\"menu\"\n                                    aria-expanded=\"false\"\n                                    class=\"k-spreadsheet-formula-input k-spreadsheet-cell-editor\">\n                                </div>\n                            </div>\n                            <div ref-sheets-bar></div>`;\n\n    const CELL_CONTEXT_MENU = ({ messages }) => `\n                    <ul class=\"${viewClassNames.cellContextMenu}\">\n                        <li data-action=\"cut\">${messages.menus.cut}</li>\n                        <li data-action=\"copy\">${messages.menus.copy}</li>\n                        <li data-action=\"paste\">${messages.menus.paste}</li>\n                        <li class=\"k-separator\"></li>\n                        <li data-action=\"merge\">${messages.menus.merge}</li>\n                        <li data-action=\"unmerge\">${messages.menus.unmerge}</li>\n                    </ul>`;\n\n    const ROW_HEADER_CONTEXT_MENU = ({ messages }) => `\n                    <ul class=\"${viewClassNames.rowHeaderContextMenu}\">\n                        <li data-action=\"cut\">${messages.menus.cut}</li>\n                        <li data-action=\"copy\">${messages.menus.copy}</li>\n                        <li data-action=\"paste\">${messages.menus.paste}</li>\n                        <li class=\"k-separator\"></li>\n                        <li data-action=\"delete-row\">${messages.menus.delete}</li>\n                        <li data-action=\"hide-row\">${messages.menus.hide}</li>\n                        <li data-action=\"unhide-row\">${messages.menus.unhide}</li>\n                    </ul>`;\n\n    const COL_HEADER_CONTEXT_MENU = ({ messages }) => `\n                    <ul class=\"${viewClassNames.colHeaderContextMenu}\">\n                        <li data-action=\"cut\">${messages.menus.cut}</li>\n                        <li data-action=\"copy\">${messages.menus.copy}</li>\n                        <li data-action=\"paste\">${messages.menus.paste}</li>\n                        <li class=\"k-separator\"></li>\n                        <li data-action=\"delete-column\">${messages.menus.delete}</li>\n                        <li data-action=\"hide-column\">${messages.menus.hide}</li>\n                        <li data-action=\"unhide-column\">${messages.menus.unhide}</li>\n                    </ul>`;\n\n    const DRAWING_CONTEXT_MENU = ({ messages }) => `\n                    <ul class=\"${viewClassNames.drawingContextMenu}\">\n                        <li data-action=\"bring-to-front\">${messages.menus.bringToFront}</li>\n                        <li data-action=\"send-to-back\">${messages.menus.sendToBack}</li>\n                        <li class=\"k-separator\"></li>\n                        <li data-action=\"delete-drawing\">${messages.menus.delete}</li>\n                    </ul>`;\n\n    kendo.spreadsheet.ContextMenu = kendo.ui.ContextMenu;\n\n    let FormulaInputStaticList = kendo.ui.StaticList.extend({\n        data: function(d) {\n            return this.dataSource.data(d);\n        },\n        itemClick: function(handler) {\n            this.bind(\"change\", function(ev) { handler(this.value()[0]); });\n        }\n    });\n\n    class FormulaInputRefArgs {\n        constructor({ list, popup }) {\n            this.current = { list, popup };\n            this.clone = function clone() {\n                return this;\n            };\n        }\n    }\n\n    class NameBoxRefArgs {\n        constructor({ nameEditor, container }) {\n            let combo = this.initializeComboBox(container, nameEditor);\n            this.current = {\n                value: (val) => {\n                    if (val === undefined$1) {\n                        const item = combo.value();\n                        return item ? (item.name || item) : item;\n                    } else {\n                        combo.value(val || '');\n                    }\n                }\n            };\n\n            this.nameEditor = nameEditor;\n\n            this.clone = function clone() {\n                return this;\n            };\n        }\n\n        initializeComboBox(container) {\n            let that = this;\n            let dataSource = new kendo.data.DataSource({\n                transport: {\n                    read: function(options) {\n                        let data = that.nameEditor()?.readData() || [];\n                        options.success(data);\n                    },\n                    cache: false\n                }\n            });\n\n            let combo = $(container).kendoComboBox({\n                clearButton: false,\n                dataTextField: \"name\",\n                dataValueField: \"name\",\n                template: ({ name }) => `${kendo.htmlEncode(name)}<a role='button' class='k-button-delete' href='\\\\#'>${kendo.ui.icon(\"x\")}</a>`,\n                dataSource: dataSource,\n                autoBind: false,\n                ignoreCase: true,\n                change: that.onChange.bind(that),\n                noDataTemplate: () => \"<div></div>\",\n                open: function() {\n                    dataSource.read();\n                }\n            }).data(\"kendoComboBox\");\n\n            combo.input\n                .on(\"keydown\", that.onKeyDown.bind(this));\n            combo.popup.element\n                .addClass(\"k-spreadsheet-names-popup\")\n\n                .on(\"mousemove\", function(ev) {\n                    // XXX: should remove this when we find a better\n                    // solution for the popup closing as we hover the\n                    // resize handles.\n                    ev.stopPropagation();\n                })\n\n                .on(\"click\", \".k-button-delete\", function(ev) {\n                    ev.preventDefault();\n                    ev.stopPropagation();\n                    let item = $(ev.target).closest(\".k-list-item\");\n                    item = combo.dataItem(item);\n                    that.onDelete(item.name);\n                });\n\n            return combo;\n        }\n\n        // Event: Handle change in ComboBox\n        onChange(event) {\n            const editor = this.nameEditor();\n            if (editor && event.sender.value()) {\n                editor.trigger(\"select\", { name: event.sender.value() });\n            }\n        }\n\n        // Event: Delete button click within item\n        onDelete(name) {\n            this.nameEditor()?.trigger(\"delete\", { name });\n        }\n\n        // Handling keyboard events like Enter, Escape\n        onKeyDown(event) {\n            const editor = this.nameEditor();\n            if (editor) {\n                if (event.key === 'Enter') {\n                    const name = event.target.value;\n                    editor.trigger(\"enter\", { value: name });\n                } else if (event.key === 'Escape') {\n                    editor.trigger(\"cancel\");\n                }\n            }\n        }\n    }\n\n    let Spreadsheet = kendo.ui.Widget.extend({\n        _renderInnerContent: function(element) {\n            $(element).append(SPREADSHEET_CONTENT_HTML_TEMPLATE(this.options));\n        },\n        init: function(element, options) {\n            let that = this;\n            Widget.fn.init.call(this, element, options);\n\n            this.options.messages = $.extend(true, {\n                view: kendo.spreadsheet.messages.view,\n                tabs: kendo.spreadsheet.messages.view.tabs,\n                menus: kendo.spreadsheet.messages.menus,\n                workbook: {\n                    defaultSheetName: \"Sheet\",\n                }\n            }, this.options.messages);\n\n            this.element.addClass(Spreadsheet.classNames.wrapper);\n            this.element.attr(\"role\", \"application\");\n            this._renderInnerContent(this.element);\n\n            this._createFormulaInputs();\n\n            that.spreadsheetRef = this._initSpreadsheetWidget();\n\n            this._bindWorkbookEvents();\n\n            const activeSheet = this.activeSheet();\n            this._onUpdateTools({ range: activeSheet.range(activeSheet.activeCell()) });\n\n            this._resizeHandler = function() { that.resize(); };\n            $(window).on(\"resize\" + NS, this._resizeHandler);\n\n            if (this._showWatermarkOverlay) {\n                this._showWatermarkOverlay(this.element[0]);\n            }\n        },\n        _initSpreadsheetWidget: function() {\n            let that = this;\n            let widgetOptions = $.extend({},\n                that.options, {\n                sheetsbar: that.options.sheetsbar != false ? that.options.sheetsbar : {},\n                formulaBarInputRef: new FormulaInputRefArgs({\n                    list: this._formulaBarInputRefList,\n                    popup: this._formulaBarInputRefPopup\n                }),\n                formulaCellInputRef: new FormulaInputRefArgs({\n                    list: this._formulaCellInputRefList,\n                    popup: this._formulaCellInputRefPopup\n                }),\n                nameBoxRef: new NameBoxRefArgs({\n                    container: that.element.find('.k-spreadsheet-name-editor [ref-namebox-input]'),\n                    nameEditor: function() {\n                        return that.spreadsheetRef?.view.nameEditor;\n                    }\n                }),\n                createFilterMenu: function(options) {\n                    let element = $(\"<div></div>\").appendTo(that.element);\n                    return new kendo.spreadsheet.FilterMenu(element, options);\n                },\n                createTabStrip: function(options) {\n                    if (that.options.toolbar) {\n                        that._initHeader();\n\n                        return {\n                            focus: function() { that.menu.wrapper.trigger(\"focus\"); },\n                            select: function(name) { that.menu.element.find(`li[ref-tab-name=\"${name}\"]`).click(); },\n                            destroy: function() { that.menu.destroy(); }\n                        };\n                    }\n                },\n                createSheetEditor: function(options) {\n                    that.sheetsBar._createEditor();\n                },\n                createSheetBar: function(openDialogCallback) {\n                    that._sheetsBar(openDialogCallback);\n                },\n                createContextMenus: function(options) {\n                    that._dialogs = [];\n                    that._initContextMenus();\n                },\n                createSheetDataSource: function(dataSource) {\n                    return kendo.data.DataSource.create(dataSource);\n                },\n                getWorkbookCommand: function(commandName, commandOptions) {\n                    return new kendo.spreadsheet[commandName](commandOptions);\n                },\n                getIconHTMLString: function(iconName) {\n                    return $(kendo.ui.icon(iconName))[0];\n                },\n                update: function(e) {\n                    that._onUpdateTools(e);\n                    if (e.reason.sheetSelection && that.sheetsBar) {\n                        that.sheetsBar.renderSheets(e.sender.sheets(), e.sender.sheetIndex(e.sheet));\n                    }\n                },\n                message: (args) => {\n                    // exclude these properties from the options\n                    let { sender, name, ref, range, ...dialogOptions } = args;\n                    let opts = $.extend({}, { pdfExport: that.options.pdf, excelExport: that.options.excel }, dialogOptions);\n                    let dialog = kendo.spreadsheet.dialogs.create(args.name, opts);\n\n                    if (dialog) {\n                        dialog.bind(\"action\", function(args) {\n                            if (args.command == \"SaveAsCommand\") {\n                                let { sender, ...commandArgs } = args;\n                                let fileName = args.options.name + args.options.extension;\n                                if (args.options.extension === \".xlsx\") {\n                                    return that.spreadsheetRef.saveAsExcel($.extend(commandArgs, {\n                                        fileName: fileName,\n                                        Workbook: kendo.ooxml.Workbook,\n                                        saveAs: function(data, fileName, exportOptions) {\n                                            kendo.saveAs({ dataURI: data, fileName, ...exportOptions });\n                                        }\n                                    }));\n                                } else if (this.options.extension === \".pdf\") {\n                                    return that.spreadsheetRef.saveAsPDF($.extend(args.options.pdf, { workbook: this.options.workbook, fileName: fileName }));\n                                }\n                            }\n\n                            that.spreadsheetRef.executeCommand(args);\n                        });\n\n                        dialog.bind(\"deactivate\", () => {\n                            dialog.destroy();\n                            that._dialogs.pop();\n                        });\n\n                        that._dialogs.push(dialog);\n\n                        dialog.open(args.range, args);\n                        args.dialog = dialog;\n                    }\n                },\n                contextmenu: (e) => {\n                    const { objectRef, targetType, showUnhide, showUnmerge, originalEvent, isComposite } = e;\n                    const selection = e.sender.activeSheet().select();\n                    const { topLeft, bottomRight } = selection;\n\n                    this.cellContextMenu.close();\n                    this.colHeaderContextMenu.close();\n                    this.rowHeaderContextMenu.close();\n                    this.drawingContextMenu.close();\n\n                    let menu;\n\n                    if (targetType == \"columnheader\") {\n                        menu = this.colHeaderContextMenu;\n                    } else if (targetType == \"rowheader\") {\n                        menu = this.rowHeaderContextMenu;\n                    } else if (targetType == \"drawing\") {\n                        menu = this.drawingContextMenu;\n                    } else {\n                        menu = this.cellContextMenu;\n                    }\n\n                    menu.element.find(COMPOSITE_UNAVAILABLE_ACTION_SELECTORS).toggle(!isComposite);\n                    menu.element.find(UNHIDE_ACTION_SELECTORS).toggle(showUnhide);\n                    menu.element.find('[data-action=unmerge]').toggle(showUnmerge);\n\n                    // avoid the immediate close\n                    setTimeout(function() {\n                        menu.open(e.originalEvent.pageX, e.originalEvent.pageY);\n                    });\n                },\n                locale: kendo.cultures.current.name,\n                intl: kendo.kendoCultureToIntl(),\n            });\n\n            return new kendo.spreadsheet.commonEngine.SpreadsheetWidget(this.element[0], widgetOptions);\n        },\n        _createFormulaInputs: function() {\n            let formulaBarInputRefElement = this.element.find('.k-spreadsheet-action-bar .k-spreadsheet-formula-input');\n            let formulaBarInputRefListId = kendo.guid();\n            formulaBarInputRefElement.attr(\"aria-controls\", formulaBarInputRefListId);\n\n            this._formulaBarInputRefList = new FormulaInputStaticList($(`<ul id=\"${formulaBarInputRefListId}\" />`)\n                .addClass(FormulaInput.classNames.listWrapper)\n                .insertAfter(formulaBarInputRefElement), {\n                aria: {\n                    role: 'menu',\n                    itemRole: 'menuitem'\n                },\n                autoBind: false,\n                selectable: true,\n                dataTextField: \"text\",\n                dataValueField: \"value\",\n                template: ({ text, value }) => `${text || value}`\n            });\n\n            this._formulaBarInputRefList.element.on(\"mousedown\", function(e) {\n                e.preventDefault();\n            });\n\n            this._formulaBarInputRefPopup = new kendo.ui.Popup(this._formulaBarInputRefList.element, {\n                anchor: this.element.find(\".k-spreadsheet-formula-input:not(.k-spreadsheet-cell-editor)\"),\n                open: function(ev) { formulaBarInputRefElement.attr(\"aria-expanded\", true); },\n                close: function(ev) { formulaBarInputRefElement.attr(\"aria-expanded\", false); }\n            });\n\n            let formulaCellInputRefElement = this.element.find('.k-spreadsheet-cell-editor');\n            let formulaCellInputRefListId = kendo.guid();\n            formulaCellInputRefElement.attr(\"aria-controls\", formulaCellInputRefListId);\n\n            this._formulaCellInputRefList = new FormulaInputStaticList($(`<ul id=\"${formulaCellInputRefListId}\" />`)\n                .addClass(FormulaInput.classNames.listWrapper)\n                .insertAfter(formulaCellInputRefElement), {\n                aria: {\n                    role: 'menu',\n                    itemRole: 'menuitem'\n                },\n                autoBind: false,\n                selectable: true,\n                dataValueField: \"value\",\n                dataTextField: \"text\",\n                template: ({ text, value }) => `${text || value}`\n\n            });\n\n            this._formulaCellInputRefList.element.on(\"mousedown\", function(e) {\n                e.preventDefault();\n            });\n\n            this._formulaCellInputRefPopup = new kendo.ui.Popup(this._formulaCellInputRefList.element, {\n                anchor: this.element.find(DOT + commonEngine.View.classNames.cellEditor),\n                open: function(ev) { formulaCellInputRefElement.attr(\"aria-expanded\", true); },\n                close: function(ev) { formulaCellInputRefElement.attr(\"aria-expanded\", false); }\n            });\n        },\n        _initContextMenus: function() {\n            let that = this;\n\n            let contextMenuConfig = {\n                target: this.element,\n                animation: false,\n                showOn: \"never\" // this is just an invalid event name to prevent the show\n            };\n\n            this.cellContextMenu = new kendo.spreadsheet.ContextMenu($(CELL_CONTEXT_MENU(that.options)).appendTo(that.element), contextMenuConfig);\n\n            this.colHeaderContextMenu = new kendo.spreadsheet.ContextMenu($(COL_HEADER_CONTEXT_MENU(that.options)).appendTo(that.element), contextMenuConfig);\n\n            this.rowHeaderContextMenu = new kendo.spreadsheet.ContextMenu($(ROW_HEADER_CONTEXT_MENU(that.options)).appendTo(that.element), contextMenuConfig);\n\n            this.drawingContextMenu = new kendo.spreadsheet.ContextMenu($(DRAWING_CONTEXT_MENU(that.options)).appendTo(that.element), contextMenuConfig);\n\n            this.cellContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n            this.rowHeaderContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n            this.colHeaderContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n            this.drawingContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n        },\n        onContextMenuSelect: function(e) {\n            let that = this;\n            let action = $(e.item).data(\"action\");\n            let command;\n            switch (action) {\n                case \"cut\":\n                    command = { command: \"ToolbarCutCommand\", options: { workbook: this.spreadsheetRef.workbook } };\n                    break;\n                case \"copy\":\n                    command = { command: \"ToolbarCopyCommand\", options: { workbook: this.spreadsheetRef.workbook } };\n                    break;\n                case \"paste\":\n                    command = { command: \"ToolbarPasteCommand\", options: { workbook: this.spreadsheetRef.workbook } };\n                    break;\n                case \"delete-drawing\":\n                    command = { command: \"DeleteDrawingCommand\", options: { drawing: this.spreadsheetRef._controller.navigator._sheet._activeDrawing } };\n                    break;\n                case \"bring-to-front\":\n                    command = { command: \"BringToFrontCommand\", options: { drawing: this.spreadsheetRef._controller.navigator._sheet._activeDrawing } };\n                    break;\n                case \"send-to-back\":\n                    command = { command: \"SendToBackCommand\", options: { drawing: this.spreadsheetRef._controller.navigator._sheet._activeDrawing } };\n                    break;\n                case \"unmerge\":\n                    command = { command: \"MergeCellCommand\", options: { value: \"unmerge\" } };\n                    break;\n                case \"merge\":\n                    this.spreadsheetRef.openDialog(\"merge\");\n                    break;\n                case \"hide-row\":\n                    command = { command: \"HideLineCommand\", options: { axis: \"row\" } };\n                    break;\n                case \"hide-column\":\n                    command = { command: \"HideLineCommand\", options: { axis: \"column\" } };\n                    break;\n                case \"unhide-row\":\n                    command = { command: \"UnHideLineCommand\", options: { axis: \"row\" } };\n                    break;\n                case \"unhide-column\":\n                    command = { command: \"UnHideLineCommand\", options: { axis: \"column\" } };\n                    break;\n                case \"delete-row\":\n                    command = { command: \"DeleteRowCommand\" };\n                    break;\n                case \"delete-column\":\n                    command = { command: \"DeleteColumnCommand\" };\n                    break;\n            }\n\n            if (command) {\n                that.spreadsheetRef.executeCommand(command);\n            }\n        },\n        _onUpdateTools: function(e) {\n            let reason = e.reason;\n            if (reason && (reason.overElement || reason.comment)) {\n                return;\n            }\n            this.toolbar?.refresh(e.range);\n        },\n        _getCopyRegex: function(sheetName) {\n            const newName = sheetName.replaceAll('(', '\\\\(').replaceAll(')', '\\\\)');\n            const st = `(${newName})\\\\s?\\\\(`;\n            return new RegExp(st, 's');\n        },\n        _sheetsBar: function(openDialogCallback) {\n            let that = this;\n\n            if (that.options.sheetsbar) {\n                let sheetsbarOptions = $.extend(true, {\n                    openDialog: openDialogCallback,\n                }, that.options.sheetsbar);\n\n                that.sheetsBar = new SheetsBar(that.element[0].querySelector('[ref-sheets-bar]'), sheetsbarOptions);\n\n                that.sheetsBar.bind(\"select\", function onSheetSelect(ev) {\n                    if (ev.isAddButton) {\n                        that.spreadsheetRef.view.sheetsbar.onAddSelect();\n                    } else {\n                        that.spreadsheetRef.view.sheetsbar.onSheetSelect(ev.name);\n                    }\n                });\n\n                that.sheetsBar.bind(\"reorder\", function onSheetReorderEnd(ev) {\n                    that.spreadsheetRef.view.sheetsbar.onSheetReorderEnd(ev);\n                });\n\n                that.sheetsBar.bind(\"rename\", function onSheetRename(ev) {\n                    that.spreadsheetRef.view.sheetsbar.onSheetRename(ev.name, ev.sheetIndex);\n                });\n\n                that.sheetsBar.bind(\"duplicate\", function onSheetDuplicate(ev) {\n                    let name = ev.name;\n                    let sheetToCopy = that.sheetByName(name);\n                    let sheetIndex = that.sheetIndex(sheetToCopy);\n                    let copies = 0;\n                    const regex = that._getCopyRegex(name);\n                    that.sheets().forEach(sheet => {\n                        const isPresent = regex.test(sheet.name());\n                        if (isPresent) {\n                            copies += 1;\n                        }\n                    });\n\n                    const newName = `${name} (${copies + 1})`;\n                    that.insertSheet({ data: { ...sheetToCopy.toJSON(), name: newName }, index: sheetIndex + 1 });\n                    that.spreadsheetRef.view.sheetsbar.onSheetSelect(newName);\n                });\n\n                that.sheetsBar.bind(\"remove\", function onSheetBarRemove(ev) {\n                    that.spreadsheetRef.view.sheetsbar.onSheetRemove(ev.name);\n                });\n\n                that.sheetsBar.bind(\"hide\", function onSheetBarHide(ev) {\n                    let sheetName = ev.name;\n                    let sheetToHide = that.sheetByName(sheetName);\n                    let visibleSheets = that.sheets().filter(x=> x.state() === \"visible\");\n                    let visibleSheetIndex = visibleSheets.findIndex(x=> x.name() === sheetName);\n                    let nextVisibleSheet = visibleSheets[visibleSheetIndex + 1] || visibleSheets[visibleSheetIndex - 1];\n                    sheetToHide._state('hidden');\n\n                    that.spreadsheetRef.workbook._sheetsSearchCache = {};\n                    that.spreadsheetRef.view.sheetsbar.onSheetSelect(nextVisibleSheet.name());\n                });\n\n                that.sheetsBar.bind(\"show\", function onSheetBarShow(ev) {\n                    let sheetName = ev.name;\n                    that.sheetByName(sheetName)._state('visible');\n                    that.spreadsheetRef.workbook._sheetsSearchCache = {};\n                    that.spreadsheetRef.view.sheetsbar.onSheetSelect(ev.name);\n                });\n            }\n        },\n        _createToolBar: function(options, tabs, toolbarId) {\n            let that = this;\n\n            if (that.toolbar) {\n                that.toolbar.destroy();\n                that.toolbar.element.empty();\n            }\n\n            let activeTabIndex = tabs.findIndex((item) => item.id === toolbarId);\n            let activeToolbar = tabs[activeTabIndex];\n            let tools = options[activeToolbar.id];\n\n            that._activeToolBar = activeToolbar.text;\n\n            that.toolbar = new kendo.spreadsheet.ToolBar(this.element.find(\"[ref-header-toolbar]\"), {\n                tools: typeof tools === \"boolean\" ? undefined$1 : tools,\n                toolbarName: activeToolbar.id,\n                fillMode: \"flat\",\n                action: function(args) {\n                    if (args.command === 'undo' || args.command === 'redo') {\n                        that.spreadsheetRef.workbook.undoRedoStack[args.command]();\n                        return;\n                    }\n\n                    if (args.command == \"OpenCommand\") {\n                        args.options.file = args.options.value;\n                    } else if (args.command === \"BorderChangeCommand\") {\n                        args.options.border = args.options.border || args.options.value.type;\n                        args.options.style = args.options.style || args.options.value.style || { color: args.options.value.color, size: 1 };\n                    }\n\n                    that.spreadsheetRef.executeCommand(args);\n                },\n                dialog: function(args) {\n                    that.spreadsheetRef.openDialog(args.name, args.options);\n                }\n            });\n            that.toolbar.element.attr(\"aria-label\", activeToolbar.text);\n        },\n\n        _initHeader: function() {\n            let that = this;\n            let messages = this.options.messages.tabs;\n            let options = $.extend(true, { file: true, home: true, insert: true, format: true, data: true, view: true }, this.options.toolbar);\n            let tabs = [];\n\n            if (this.menu) {\n                this.menu.destroy();\n                this.menu.empty();\n            }\n\n            if (this.toolbar) {\n                this.toolbar.destroy();\n                this.toolbar.empty();\n            }\n\n            for (let name in options) {\n                if (options[name] === true || options[name] instanceof Array) {\n                    tabs.push({ id: name, text: messages[name], content: \"\", attr: { \"ref-tab-name\": name } });\n                }\n            }\n\n            this.menu = new kendo.spreadsheet.Menu(this.element.find(\"[ref-header-menu]\"), {\n                dataSource: tabs,\n                toolbarOptions: options,\n                select: function(e) {\n                    let text = $(e.item).text();\n                    if (that._activeToolBar !== text) {\n                        $(e.item).addClass(K_ACTIVE)\n                            .siblings(\"li\").removeClass(K_ACTIVE);\n\n                        that._createToolBar(options, tabs, tabs.find((item) => item.text === text).id);\n                        const activeSheet = that.activeSheet();\n                        that._onUpdateTools({ range: activeSheet.range(activeSheet.activeCell()) });\n                    }\n                }\n            });\n\n            if (tabs.length) {\n                let defaultTab = tabs.find((item)=> item.id === \"home\");\n                this.menu.element.find(`li[ref-tab-name=\"home\"]`).addClass(K_ACTIVE);\n                that._createToolBar(options, tabs, defaultTab ? defaultTab.id : tabs[0].id);\n            }\n        },\n\n        executeCommand(options) {\n            return this.spreadsheetRef.executeCommand(options);\n        },\n\n        _resize: function() {\n            this.refresh({ layout: true });\n        },\n\n        _workbookChanging: function(e) {\n            if (this.trigger(\"changing\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookChange: function(e) {\n            if (this._autoRefresh) {\n                this.refresh(e);\n            }\n\n            if (e.recalc && e.ref) {\n                let range = e.range || new kendo.spreadsheet.Range(e.ref, this.activeSheet());\n                this.trigger(\"change\", { range: range });\n            }\n        },\n\n        _workbookCut: function(e) {\n            this.trigger(\"cut\", e);\n        },\n\n        _workbookCopy: function(e) {\n            this.trigger(\"copy\", e);\n        },\n\n        _workbookPaste: function(e) {\n            this.trigger(\"paste\", e);\n        },\n\n        activeSheet: function(sheet) {\n            return this.spreadsheetRef.activeSheet(sheet);\n        },\n\n        moveSheetToIndex: function(sheet, index) {\n            return this.spreadsheetRef.moveSheetToIndex(sheet, index);\n        },\n\n        insertSheet: function(options) {\n            return this.spreadsheetRef.insertSheet(options);\n        },\n\n        sheets: function() {\n            return this.spreadsheetRef.sheets();\n        },\n\n        removeSheet: function(sheet) {\n            return this.spreadsheetRef.removeSheet(sheet);\n        },\n\n        sheetByName: function(sheetName) {\n            return this.spreadsheetRef.sheetByName(sheetName);\n        },\n\n        sheetIndex: function(sheet) {\n            return this.spreadsheetRef.sheetIndex(sheet);\n        },\n\n        sheetByIndex: function(index) {\n            return this.spreadsheetRef.sheetByIndex(index);\n        },\n\n        renameSheet: function(sheet, newSheetName) {\n            return this.spreadsheetRef.renameSheet(sheet, newSheetName);\n        },\n\n        refresh: function(reason) {\n            this.spreadsheetRef.refresh(reason);\n\n            return this;\n        },\n\n        openDialog: function(name, options) {\n            return this.spreadsheetRef.openDialog(name, options);\n        },\n\n        autoRefresh: function(value) {\n            if (value !== undefined$1) {\n                this._autoRefresh = value;\n\n                if (value === true) {\n                    this.refresh();\n                }\n\n                return this;\n            }\n\n            return this._autoRefresh;\n        },\n\n        toJSON: function() {\n            return this.spreadsheetRef.toJSON();\n        },\n\n        fromJSON: function(json) {\n            this.spreadsheetRef.fromJSON(json);\n        },\n\n        saveJSON: function() {\n            return this.spreadsheetRef.saveJSON();\n        },\n\n        fromFile: function(blob, name) {\n            return this.spreadsheetRef.fromFile(blob, name);\n        },\n\n        saveAsPDF: function(options) {\n            this.spreadsheetRef.saveAsPDF(\n                $.extend({}, this.options.pdf, options, { workbook: this.spreadsheetRef._workbook })\n            );\n        },\n\n        saveAsExcel: function(options) {\n            this.spreadsheetRef.saveAsExcel(options);\n        },\n\n        draw: function(options, callback) {\n            this.spreadsheetRef.draw(options, callback);\n        },\n\n        _workbookExcelExport: function(e) {\n            if (this.trigger(\"excelExport\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookExcelImport: function(e) {\n            if (this.trigger(\"excelImport\", e)) {\n                e.preventDefault();\n            } else {\n                this._initProgress(e.deferred);\n            }\n        },\n\n        _initProgress: function(deferred) {\n            let loading =\n                $(\"<div class='k-loading-mask' \" +\n                    \"style='width: 100%; height: 100%; top: 0;'>\" +\n                    \"<div class='k-loading-color'></div>\" +\n                    \"</div>\")\n                    .appendTo(this.element);\n\n            let pb = $(\"<div class='k-loading-progress'>\")\n                .appendTo(loading)\n                .kendoProgressBar({\n                    type: \"chunk\", chunkCount: 10,\n                    min: 0, max: 1, value: 0\n                }).data(\"kendoProgressBar\");\n\n            deferred.progress(function(e) {\n                pb.value(e.progress);\n            })\n                .promise.finally(function() {\n                    kendo.destroy(loading);\n                    loading.remove();\n                });\n        },\n\n        _workbookPdfExport: function(e) {\n            if (this.trigger(\"pdfExport\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookInsertSheet: function(e) {\n            if (this.trigger(\"insertSheet\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookRemoveSheet: function(e) {\n            if (this.trigger(\"removeSheet\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookSelectSheet: function(e) {\n            if (this.trigger(\"selectSheet\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookRenameSheet: function(e) {\n            if (this.trigger(\"renameSheet\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookInsertRow: function(e) {\n            if (this.trigger(\"insertRow\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookInsertColumn: function(e) {\n            if (this.trigger(\"insertColumn\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookDeleteRow: function(e) {\n            if (this.trigger(\"deleteRow\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookDeleteColumn: function(e) {\n            if (this.trigger(\"deleteColumn\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookHideRow: function(e) {\n            if (this.trigger(\"hideRow\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookHideColumn: function(e) {\n            if (this.trigger(\"hideColumn\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookUnhideRow: function(e) {\n            if (this.trigger(\"unhideRow\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookUnhideColumn: function(e) {\n            if (this.trigger(\"unhideColumn\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookSelect: function(e) {\n            this.trigger(\"select\", e);\n        },\n\n        _workbookChangeFormat: function(e) {\n            this.trigger(\"changeFormat\", e);\n        },\n\n        _workbookDataBinding: function(e) {\n            if (this.trigger(\"dataBinding\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookDataBound: function(e) {\n            this.trigger(\"dataBound\", e);\n        },\n\n        _workbookProgress: function(e) {\n            kendo.ui.progress(this.element, e.toggle);\n        },\n\n        _bindWorkbookEvents: function() {\n            this.spreadsheetRef.bind(\"cut\", this._workbookCut.bind(this));\n            this.spreadsheetRef.bind(\"copy\", this._workbookCopy.bind(this));\n            this.spreadsheetRef.bind(\"paste\", this._workbookPaste.bind(this));\n            this.spreadsheetRef.bind(\"changing\", this._workbookChanging.bind(this));\n            this.spreadsheetRef.bind(\"change\", this._workbookChange.bind(this));\n            this.spreadsheetRef.bind(\"excelExport\", this._workbookExcelExport.bind(this));\n            this.spreadsheetRef.bind(\"excelImport\", this._workbookExcelImport.bind(this));\n            this.spreadsheetRef.bind(\"pdfExport\", this._workbookPdfExport.bind(this));\n            this.spreadsheetRef.bind(\"insertSheet\", this._workbookInsertSheet.bind(this));\n            this.spreadsheetRef.bind(\"removeSheet\", this._workbookRemoveSheet.bind(this));\n            this.spreadsheetRef.bind(\"selectSheet\", this._workbookSelectSheet.bind(this));\n            this.spreadsheetRef.bind(\"renameSheet\", this._workbookRenameSheet.bind(this));\n            this.spreadsheetRef.bind(\"insertRow\", this._workbookInsertRow.bind(this));\n            this.spreadsheetRef.bind(\"insertColumn\", this._workbookInsertColumn.bind(this));\n            this.spreadsheetRef.bind(\"deleteRow\", this._workbookDeleteRow.bind(this));\n            this.spreadsheetRef.bind(\"deleteColumn\", this._workbookDeleteColumn.bind(this));\n            this.spreadsheetRef.bind(\"hideRow\", this._workbookHideRow.bind(this));\n            this.spreadsheetRef.bind(\"hideColumn\", this._workbookHideColumn.bind(this));\n            this.spreadsheetRef.bind(\"unhideRow\", this._workbookUnhideRow.bind(this));\n            this.spreadsheetRef.bind(\"unhideColumn\", this._workbookUnhideColumn.bind(this));\n            this.spreadsheetRef.bind(\"select\", this._workbookSelect.bind(this));\n            this.spreadsheetRef.bind(\"changeFormat\", this._workbookChangeFormat.bind(this));\n            this.spreadsheetRef.bind(\"dataBinding\", this._workbookDataBinding.bind(this));\n            this.spreadsheetRef.bind(\"dataBound\", this._workbookDataBound.bind(this));\n            this.spreadsheetRef.bind(\"progress\", this._workbookProgress.bind(this));\n        },\n\n        destroy: function() {\n            kendo.ui.Widget.fn.destroy.call(this);\n\n            this._formulaBarInputRefPopup?.destroy();\n            this._formulaCellInputRefPopup?.destroy();\n            this._formulaBarInputRefList?.destroy();\n            this._formulaCellInputRefList?.destroy();\n\n            this._formulaBarInputRefList = this._formulaCellInputRefList = null;\n            this._formulaBarInputRefPopup = this._formulaCellInputRefPopup = null;\n\n            if (this.menu) {\n                this.menu.destroy();\n            }\n\n            if (this.toolbar) {\n                this.toolbar.destroy();\n            }\n\n            if (this.sheetsBar) {\n                this.sheetsBar.destroy();\n            }\n\n            this._dialogs?.forEach(function(dialog) {\n                dialog?.destroy();\n            });\n\n            this.spreadsheetRef?.destroy();\n\n            this.cellContextMenu?.destroy();\n\n            this.rowHeaderContextMenu?.destroy();\n            this.colHeaderContextMenu?.destroy();\n            this.drawingContextMenu?.destroy();\n\n            this.cellContextMenu = this.rowHeaderContextMenu =\n                this.colHeaderContextMenu =\n                this.drawingContextMenu = null;\n\n            if (this._resizeHandler) {\n                $(window).off(\"resize\" + NS, this._resizeHandler);\n            }\n\n            kendo.destroy(this.element);\n        },\n\n        options: {\n            name: \"Spreadsheet\",\n            toolbar: true,\n            sheetsbar: true,\n            rows: 200,\n            columns: 50,\n            rowHeight: 30,\n            columnWidth: 64,\n            headerHeight: 30,\n            headerWidth: 32,\n            excel: {\n                proxyURL: \"\",\n                fileName: \"Workbook.xlsx\"\n            },\n            messages: {},\n            pdf: {\n                // which part of the workbook to be exported\n                area: \"workbook\",\n                fileName: \"Workbook.pdf\",\n                proxyURL: \"\",\n                // paperSize can be an usual name, i.e. \"A4\", or an array of two Number-s specifying the\n                // width/height in points (1pt = 1/72in), or strings including unit, i.e. \"10mm\".  Supported\n                // units are \"mm\", \"cm\", \"in\" and \"pt\".  The default \"auto\" means paper size is determined\n                // by content.\n                paperSize: \"a4\",\n                // True to reverse the paper dimensions if needed such that width is the larger edge.\n                landscape: true,\n                // An object containing { left, top, bottom, right } margins with units.\n                margin: null,\n                // Optional information for the PDF Info dictionary; all strings except for the date.\n                title: null,\n                author: null,\n                subject: null,\n                keywords: null,\n                creator: \"Kendo UI PDF Generator v.\" + kendo.version,\n                // Creation Date; defaults to new Date()\n                date: null\n            },\n            defaultCellStyle: {\n                fontFamily: \"Arial\",\n                fontSize: 12\n            },\n            useCultureDecimals: false\n        },\n\n        defineName: function(name, value, hidden) {\n            return this.spreadsheetRef.defineName(name, value, hidden);\n        },\n\n        undefineName: function(name) {\n            return this.spreadsheetRef.undefineName(name);\n        },\n\n        nameValue: function(name) {\n            return this.spreadsheetRef.nameValue(name);\n        },\n\n        forEachName: function(func) {\n            return this.spreadsheetRef.forEachName(func);\n        },\n\n        cellContextMenu: function() {\n            return this.cellContextMenu;\n        },\n\n        rowHeaderContextMenu: function() {\n            return this.rowHeaderContextMenu;\n        },\n\n        colHeaderContextMenu: function() {\n            return this.colHeaderContextMenu;\n        },\n\n        addImage: function(image) {\n            return this.spreadsheetRef.addImage(image);\n        },\n\n        cleanupImages: function() {\n            return this.spreadsheetRef.cleanupImages();\n        },\n\n        events: [\n            \"cut\",\n            \"copy\",\n            \"paste\",\n            \"pdfExport\",\n            \"excelExport\",\n            \"excelImport\",\n            \"changing\",\n            \"change\",\n            \"render\",\n            \"removeSheet\",\n            \"selectSheet\",\n            \"renameSheet\",\n            \"insertRow\",\n            \"insertColumn\",\n            \"deleteRow\",\n            \"insertSheet\",\n            \"deleteColumn\",\n            \"hideRow\",\n            \"hideColumn\",\n            \"unhideRow\",\n            \"unhideColumn\",\n            \"select\",\n            \"changeFormat\",\n            \"dataBinding\",\n            \"dataBound\"\n        ]\n    });\n\n    kendo.ui.plugin(Spreadsheet);\n    $.extend(true, Spreadsheet, { classNames: classNames });\n})(window.kendo);\nvar kendo$1 = kendo;\n\nexport { __meta__, kendo$1 as default };\n"]}