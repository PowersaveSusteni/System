{"version":3,"file":"kendo.data.js","names":["logic","or","concat","acc","fn","a","identity","and","operatorsMap","isnullorempty","kendo","isBlank","isnotnullorempty","isPresent","contains","b","indexOf","doesnotcontain","doesnotendwith","length","doesnotstartwith","lastIndexOf","endswith","eq","gt","gte","isempty","isnotempty","isnotnull","isnull","lt","lte","neq","startswith","dateRegExp","convertValue","value","ignoreCase","accentFoldingFiltering","isString","date","exec","Date","getTime","toLocaleLowerCase","toLowerCase","isDate","typedGetter","prop","x","isNumeric","transformFilter","field","operator","itemProp","isFunction","getter","op","isCompositeFilterDescriptor","source","filters","transformCompositeFilter","filter","combiner","map","extendAccentFolding","reduce","Object","assign","filterExprNoEval","expr","__meta__","id","name","category","description","depends","features","$","undefined$1","extend","isPlainObject","isEmptyObject","isArray","Array","grep","ajax","each","noop","window","Observable","Class","STRING","FUNCTION","CREATE","READ","UPDATE","DESTROY","CHANGE","SYNC","GET","ERROR","REQUESTSTART","PROGRESS","REQUESTEND","ITEMSLOADED","ITEMLOAD","crud","o","stringify","math","Math","push","join","pop","splice","shift","slice","unshift","toString","stableSort","support","objectKeys","ObservableArray","init","array","type","that","this","ObservableObject","call","wrapAll","_loadPromises","_loadedNodes","at","index","toJSON","serializeFunctions","idx","json","parent","target","wrap","object","Model","bind","e","isGroup","hasOwnProperty","trigger","node","items","action","promise","_loading","done","collection","nodes","loading","result","arguments","apply","omitChangeEvent","sort","howMany","item","i","len","omitCache","children","unbind","forEach","callback","thisArg","context","reduceRight","find","every","some","remove","empty","Symbol","iterator","prototype","LazyObservableArray","data","events","_events","_parent","eventHandler","prefix","key","event","_notifyChange","ownKeys","ignoreObjectKeys","keys","filteredObjectKeys","props","protoKeys","getPrototypeOf","isPrimitiveType","getOwnPropertyNames","f","member","_handlers","charAt","uid","guid","shouldSerialize","get","_set","composite","paths","split","path","obj","set","setter","isSetPrevented","current","change","isObservableArray","isDataSource","DataSource","equal","y","xtype","parsers","number","parseFloat","parseDate","boolean","string","default","defaultValues","defaults","_initializers","dirty","dirtyFields","idField","_defaultId","_parse","parse","fieldName","fields","getFieldByName","editable","accept","isNew","define","base","options","model","originalName","proto","functionFields","nameToUse","nullable","defaultValue","Comparer","selector","compare","localeCompare","create","dir","combine","comparers","StableComparer","asc","valueA","valueB","__position","desc","operators","quote","str","replace","JSON","textOp","impl","ignore","getMatchRegexp","pattern","rx","esc","ch","matches","substring","doesnotmatch","Query","normalizeSort","descriptor","descriptors","d","sortFields","sorts","sortObject","filterExpr","expression","noEval","expressions","fieldFunctions","operatorFunctions","match","operatorMap","equals","isequalto","equalto","ne","notequals","isnotequalto","notequalto","notequal","islessthan","lessthan","less","le","islessthanorequalto","lessthanequal","isgreaterthan","greaterthan","greater","isgreaterthanorequalto","greaterthanequal","ge","notsubstringof","normalizeOperator","normalizeFilter","compareDescriptor","f1","f2","normalizeDescriptor","fieldComparer","normalizeGroup","skipItemSorting","aggregates","normalizeGroupWithoutCompare","groupValueComparer","calculateAggregate","accumulator","state","aggr","functionName","aggregate","functions","accessor","compareFilters","expr1","expr2","filters1","filters2","toArray","range","count","skip","take","select","order","inPlace","orderBy","orderByDescending","comparer","compiled","group","allData","getFilteredData","g","groupPaging","groupAllData","cachedFilteredData","hasSubgroups","itemCount","subgroupCount","groupBy","currentValue","sorted","_sortForGrouping","groupValue","_sortGroups","groups","sum","isNumber","average","max","min","val","isNaN","process","groupDescriptorsWithoutSort","total","customGroupSort","groupDescriptors","anyGroupDescriptorHasCompare","query","groupDescriptorsWithoutCompare","normalizedSort","filterCallback","flatGroups","groupDescriptor","virtual","LocalTransport","read","success","update","destroy","RemoteTransport","parameterMap","url","cache","Cache","add","submit","option","setup","error","parameters","operation","_store","clear","serializeRecords","getters","modelInstance","originalFieldNames","fieldNames","record","setters","convertRecords","convertGroup","wrapDataAccess","originalFunction","converter","wrapDataAccessBase","store","inmemory","DataReader","schema","modelBase","dataFunction","_dataAccessFunction","groupsFunction","serializeFunction","serialize","serializeGetters","fromName","from","_wrapDataAccessBase","errors","fillLastGroup","originalGroup","newGroup","currOriginal","currentNew","mergeGroups","dest","indexFunction","groupsLength","indexFn","groupIndex","itemIndex","flattenGroups","wrapGroupItems","eachGroupItems","func","replaceInRanges","ranges","observable","replaceInRange","replaceWithObservable","view","serverGrouping","viewIndex","indexOfPristineModel","indexOfModel","fieldNameFromModel","convertFilterDescriptorsField","convertDescriptorsField","_map","_prefetch","_data","_pristineData","_ranges","_view","_pristineTotal","_destroyed","_pageSize","pageSize","_page","page","_sort","_sortFields","_filter","_group","_aggregate","_total","_groupPaging","_groupsState","_shouldDetachObservableParents","transport","Transport","pushCreate","_pushCreate","pushUpdate","_pushUpdate","pushDestroy","_pushDestroy","offlineStorage","_storage","getItem","localStorage","setItem","reader","readers","_detachObservableParents","_observe","_online","serverSorting","serverPaging","serverFiltering","serverAggregates","batch","inPlaceSort","clone","online","sync","Deferred","resolve","offlineData","_isGrouped","_isServerGrouped","_isServerGroupPaged","_isGroupPaged","_push","_readData","_flatData","useRanges","getByUid","_getByUid","dataItems","_storeData","_addRange","_process","_observeView","flatView","insert","_createNewModel","_wrapInEmptyGroup","_insertModelInRange","pushInsert","rangeSpan","_getCurrentRangeSpan","pushed","autoSync","pristine","last","pristineData","_updatePristineForModel","_removeItems","itemsToRemove","removePristine","shouldRemovePristine","destroyed","found","_eachItem","_removePristineForModel","pushMove","_moveItems","moved","dataItem","hasGroups","_pushInDestroyed","removeModel","_removeModelFromRanges","created","notFetched","updated","promises","_sendSubmit","_send","when","then","changedItems","_accept","models","_syncEnd","_change","cancelChanges","_cancelModel","_changesCanceled","_markOfflineUpdatesAsDirty","__state__","hasChanges","response","serverGroup","_handleCustomErrors","values","_executeOnPristineForModel","deepExtend","_eachPristineItem","_pristineForModel","_modelCanceled","_submit","status","reject","deferred","_promise","method","converted","params","_params","_queueRequest","isPrevented","_dequeueRequest","args","_readAggregates","replaceSubset","_serverGroupsTotal","_aggregateResult","itemIds","_skip","endless","j","_changeHandler","updatePristine","end","start","timestamp","_timeStamp","outerStart","outerEnd","_sortRanges","_groupsFlat","_appendToGroupsFlat","_updateOuterRangesLength","_getGroupByUid","xhr","errorThrown","isExcelExportRequest","_requestInProgress","_pending","_shouldWrap","_updateTotalForAction","parseInt","_operationsForUpdatedFields","updatedFields","_updatedFields","operations","stringified","u","partialUpdate","_preventPartialUpdate","stringifiedKey","cleanObject","cleanObjectKeys","k","handler","first","_calculateAggregates","_take","currentRangeStart","_clearEmptyGroups","_queryProcess","resultData","dataToAggregate","_setView","_setFilterTotal","_mergeState","_currentRangeStart","moreItemsCount","_hasExpandedSubGroups","_findGroupedRange","parents","itemsLength","groupCount","itemsToSkip","taken","_fetchGroupItems","_fetchingGroupItems","skipped","includeParents","excludeHeader","currentItems","_expandedSubGroupItemsCount","includeCurrentItems","subGroup","temp","endSpecified","groupItemsSkip","firstItem","lastItem","expandedSubGroupItemsCount","groupItemCount","getGroupItems","lastItemIndex","round","floor","hasNotFetchedItems","subgroups","_composeItemsFilter","findSubgroups","_queueWithTimeout","_groupItemsSuccessHandler","delay","clearTimeout","_timeout","setTimeout","totalField","totalCount","_updateRangePristineData","countAdded","_currentRequestTimeStamp","_skipRequestsInProgress","indexOfCurrentGroup","currentGroup","dataLength","indexes","rangesLength","_containsSubGroup","_cloneGroup","subgroup","currentSubGroup","filterTotal","setDefaultValue","fetch","_query","next","totalPages","prev","_pageableQueryOptions","getGroupsFlat","groupsTotal","includeExpanded","_calculateGroupsTotal","itemsField","ignoreState","_groupsTotal","countGroupRange","_emptyAggregates","ceil","inRange","_findRange","lastRange","firstItemUid","enableRequestsInProgress","pageSkip","size","_processRangeData","_originalPageSkip","_originalSize","_adjustPageSkip","_groupRangeExists","_rangeExists","prefetch","skipIdx","takeIdx","startIndex","endIndex","rangeData","rangeEnd","processed","flatData","prevRangeEnd","remote","groupMapOptions","isGroupPaged","startField","endField","_mergeGroups","_getRangesMismatch","mismatch","prevGroup","eventData","_omitPrefetch","paging","sorting","filtering","_prefetchSuccessHandler","force","_multiplePrefetch","prevRange","_getPrevRange","_getNextRange","availableItemsCount","_removeModelFromRange","_updateRangesLength","mismatchFound","mismatchLength","lengthDifference","abs","rangeLength","dataSource","transportOptions","transports","schemas","logToConsole","table","fieldIndex","cells","cell","tbody","tBodies","rows","fieldCount","nodeName","innerHTML","inferTable","optgroup","firstField","secondField","parentNode","disabled","label","text","attributes","specified","inferSelect","Node","hasChildren","childrenField","childrenOptions","hasChildrenObject","_childrenOptions","_initChildren","_loaded","HierarchicalDataSource","_updateChildrenField","append","loaded","level","_childrenLoaded","load","one","_matchFilter","dataMethod","_attachBubbleHandlers","_hierarchicalFilter","_childrenLoading","isLoading","_markHierarchicalQuery","_updateHierarchicalFilter","_find","inferList","list","textChild","className","textField","urlField","spriteCssClassField","imageUrlField","elements","tagName","firstChild","attr","nodeType","nodeValue","trim","_dataSource","Buffer","viewSize","disablePrefetch","_prefetching","buffer","_reset","_syncWithDataSource","setViewSize","_recalculate","itemPresent","dataOffset","prefetchThreshold","midPageThreshold","nextMidRange","nextPageThreshold","nextFullRange","pullBackThreshold","offset","previousMidRange","previousFullRange","_goToRange","nextRange","syncDataSource","prefetchOffset","expanding","_expanding","_syncPending","_firstItemUid","BatchBuffer","batchSize","batchBuffer","endreached","prefetching","prefetched","reset","resize","jQuery","kendo$1"],"sources":["kendo.data.js"],"mappings":"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","ignoreList":[],"sourcesContent":["import './kendo.core.js';\nimport './kendo.data.odata.js';\nimport './kendo.data.xml.js';\n\n/*\nThis code is copied/inspired by the internal @progress/kendo-data-query repo:\nhttps://github.com/telerik/kendo-data-query/tree/develop/src/filtering\n\n!!!\n1. If updates are to be synced consider the accentFoldingFiltering,\n   which at the moment is not present as a feature in the data-query-package.\n\n2. Double-check available operators as well.\n\n3. Make sure objs are strings -> i.e., replace (a || \"\") to (a + '')\n!!!\n\nIn future, if we consider reusing the code directly we should revise the above omissions.\n*/\n\nconst logic = {\n    \"or\": {\n        concat: (acc, fn) => a => acc(a) || fn(a),\n        identity: () => false\n    },\n    \"and\": {\n        concat: (acc, fn) => a => acc(a) && fn(a),\n        identity: () => true\n    }\n};\n\nconst operatorsMap = {\n    isnullorempty: (a) => kendo.isBlank(a) || a === '',\n    isnotnullorempty: (a) => kendo.isPresent(a) && a !== '',\n    contains: (a, b) => (a + '').indexOf(b) >= 0,\n    doesnotcontain: (a, b) => (a + '').indexOf(b) === -1,\n    doesnotendwith: (a, b) => (a + '').indexOf(b, (a || \"\").length - (b || \"\").length) < 0,\n    doesnotstartwith: (a, b) => (a + '').lastIndexOf(b, 0) === -1,\n    endswith: (a, b) => (a + '').indexOf(b, (a || \"\").length - (b || \"\").length) >= 0,\n    eq: (a, b) => a === b,\n    gt: (a, b) => a > b,\n    gte: (a, b) => a >= b,\n    isempty: (a) => a === '',\n    isnotempty: (a) => a !== '',\n    isnotnull: (a) => kendo.isPresent(a),\n    isnull: (a) => kendo.isBlank(a),\n    lt: (a, b) => a < b,\n    lte: (a, b) => a <= b,\n    neq: (a, b) => a != b,\n    startswith: (a, b) => (a + '').lastIndexOf(b, 0) === 0\n};\n\nconst dateRegExp = /^\\/Date\\((.*?)\\)\\/$/;\n\nconst convertValue = (value, ignoreCase, accentFoldingFiltering) => {\n    if (value != null && kendo.isString(value)) {\n        const date = dateRegExp.exec(value);\n        if (date) {\n            return new Date(+date[1]).getTime();\n        } else if (ignoreCase) {\n            return accentFoldingFiltering ? value.toLocaleLowerCase(accentFoldingFiltering) : value.toLowerCase();\n        }\n    } else if (value != null && kendo.isDate(value)) {\n        return value.getTime();\n    }\n    return value;\n};\n\nconst typedGetter = (prop, value, ignoreCase, accentFoldingFiltering) => {\n    if (!kendo.isPresent(value)) {\n        return prop;\n    }\n\n    let acc = prop;\n\n    if (kendo.isString(value)) {\n        const date = dateRegExp.exec(value);\n        if (date) {\n            value = new Date(+date[1]);\n        } else {\n            acc = a => {\n                const x = prop(a);\n                if (typeof x === 'string' && ignoreCase) {\n                    return accentFoldingFiltering ? x.toLocaleLowerCase(accentFoldingFiltering) : x.toLowerCase();\n                } else {\n                    return kendo.isNumeric(x) ? x + \"\" : x;\n                }\n            };\n        }\n    }\n\n    if (kendo.isDate(value)) {\n        return a => {\n            const x = acc(a);\n            return kendo.isDate(x) ? x.getTime() : x;\n        };\n    }\n    return acc;\n};\n\nconst transformFilter = ({ field, ignoreCase, value, operator = 'eq', accentFoldingFiltering }) => {\n    field = !kendo.isPresent(field) ? a => a : field;\n\n    ignoreCase = kendo.isPresent(ignoreCase) ? ignoreCase : true;\n\n    const itemProp = typedGetter(\n        kendo.isFunction(field) ? field : kendo.getter(field, true),\n        value,\n        ignoreCase,\n        accentFoldingFiltering\n    );\n\n    value = convertValue(value, ignoreCase, accentFoldingFiltering);\n\n    const op = kendo.isFunction(operator) ? operator : operatorsMap[operator];\n\n    return a => op(itemProp(a), value, ignoreCase);\n};\n\nconst isCompositeFilterDescriptor = (source) => kendo.isPresent(source.filters);\n\nconst transformCompositeFilter = (filter) => {\n    const accentFoldingFiltering = filter.accentFoldingFiltering;\n    const combiner = logic[filter.logic || 'and'];\n    return filter.filters\n        .filter(kendo.isPresent)\n        .map(x => (isCompositeFilterDescriptor(x) ? transformCompositeFilter(extendAccentFolding(x, accentFoldingFiltering)) : transformFilter(extendAccentFolding(x, accentFoldingFiltering))))\n        .reduce(combiner.concat, combiner.identity);\n};\n\nconst extendAccentFolding = (filter, accentFoldingFiltering) => (kendo.isPresent(accentFoldingFiltering) ? Object.assign(filter, { accentFoldingFiltering }) : filter);\n\nconst filterExprNoEval = function(expr) {\n    return transformCompositeFilter(expr);\n};\n\nconst __meta__ = {\n    id: \"data\",\n    name: \"Data source\",\n    category: \"framework\",\n    description: \"Powerful component for using local and remote data.Fully supports CRUD, Sorting, Paging, Filtering, Grouping, and Aggregates.\",\n    depends: [ \"core\" ],\n    features: [ {\n        id: \"data-odata\",\n        name: \"OData\",\n        description: \"Support for accessing Open Data Protocol (OData) services.\",\n        depends: [ \"data.odata\" ]\n    }, {\n        id: \"data-signalr\",\n        name: \"SignalR\",\n        description: \"Support for binding to SignalR hubs.\",\n        depends: [ \"data.signalr\" ]\n    }, {\n        id: \"data-XML\",\n        name: \"XML\",\n        description: \"Support for binding to XML.\",\n        depends: [ \"data.xml\" ]\n    }]\n};\n\n\n(function($, undefined$1) {\n    var extend = $.extend,\n        isPlainObject = $.isPlainObject,\n        isEmptyObject = $.isEmptyObject,\n        isArray = Array.isArray,\n        grep = $.grep,\n        ajax = $.ajax,\n        map,\n        each = $.each,\n        noop = $.noop,\n        kendo = window.kendo,\n        isFunction = kendo.isFunction,\n        Observable = kendo.Observable,\n        Class = kendo.Class,\n        STRING = \"string\",\n        FUNCTION = \"function\",\n        ASCENDING = \"asc\",\n        CREATE = \"create\",\n        READ = \"read\",\n        UPDATE = \"update\",\n        DESTROY = \"destroy\",\n        CHANGE = \"change\",\n        SYNC = \"sync\",\n        GET = \"get\",\n        ERROR = \"error\",\n        REQUESTSTART = \"requestStart\",\n        PROGRESS = \"progress\",\n        REQUESTEND = \"requestEnd\",\n        ITEMSLOADED = \"itemsLoaded\",\n        ITEMLOAD = \"itemLoad\",\n        crud = [CREATE, READ, UPDATE, DESTROY],\n        identity = function(o) { return o; },\n        getter = kendo.getter,\n        stringify = kendo.stringify,\n        math = Math,\n        push = [].push,\n        join = [].join,\n        pop = [].pop,\n        splice = [].splice,\n        shift = [].shift,\n        slice = [].slice,\n        unshift = [].unshift,\n        toString = {}.toString,\n        stableSort = kendo.support.stableSort,\n        dateRegExp = /^\\/Date\\((.*?)\\)\\/$/,\n        objectKeys = [];\n\n    var ObservableArray = Observable.extend({\n        init: function(array, type) {\n            var that = this;\n\n            that.type = type || ObservableObject;\n\n            Observable.fn.init.call(that);\n\n            that.length = array.length;\n\n            that.wrapAll(array, that);\n            that._loadPromises = [];\n            that._loadedNodes = [];\n        },\n\n        at: function(index) {\n            return this[index];\n        },\n\n        toJSON: function(serializeFunctions) {\n            var idx, length = this.length, value, json = new Array(length);\n\n            for (idx = 0; idx < length; idx++) {\n                value = this[idx];\n\n                if (value instanceof ObservableObject) {\n                    value = value.toJSON(serializeFunctions);\n                }\n\n                json[idx] = value;\n            }\n\n            return json;\n        },\n\n        parent: noop,\n\n        wrapAll: function(source, target) {\n            var that = this,\n                idx,\n                length,\n                parent = function() {\n                    return that;\n                };\n\n            target = target || [];\n\n            for (idx = 0, length = source.length; idx < length; idx++) {\n                target[idx] = that.wrap(source[idx], parent);\n            }\n\n            return target;\n        },\n\n        wrap: function(object, parent) {\n            var that = this,\n                observable;\n\n            if (object !== null && toString.call(object) === \"[object Object]\") {\n                observable = object instanceof that.type || object instanceof Model;\n\n                if (!observable) {\n                    object = object instanceof ObservableObject ? object.toJSON() : object;\n                    object = new that.type(object);\n                }\n\n                object.parent = parent;\n\n                object.bind(CHANGE, function(e) {\n                    var isGroup = object.hasOwnProperty(\"hasSubgroups\");\n                    that.trigger(CHANGE, {\n                        field: e.field,\n                        node: e.node,\n                        index: e.index,\n                        items: e.items || [this],\n                        action: e.node || isGroup ? (e.action || \"itemloaded\") : \"itemchange\"\n                    });\n                });\n\n                object.bind(ITEMLOAD, function(e) {\n                    that._loadPromises.push(e.promise);\n                    that._loading = true;\n\n                    e.promise.done(function() {\n                        that._loadedNodes.push(e.node);\n                        var index = that._loadPromises.indexOf(e.promise);\n                        that._loadPromises.splice(index, 1);\n\n                        if (!that._loadPromises.length) {\n                            that._loading = false;\n                            that.trigger(ITEMSLOADED, { collection: that, nodes: that._loadedNodes });\n                            that._loadedNodes = [];\n                        }\n                    });\n                });\n            }\n\n            return object;\n        },\n\n        loading: function() {\n            return this._loading;\n        },\n\n        push: function() {\n            var index = this.length,\n                items = this.wrapAll(arguments),\n                result;\n\n            result = push.apply(this, items);\n\n            if (!this.omitChangeEvent) {\n                this.trigger(CHANGE, {\n                    action: \"add\",\n                    index: index,\n                    items: items\n                });\n            }\n\n            return result;\n        },\n\n        slice: slice,\n\n        sort: [].sort,\n\n        join: join,\n\n        pop: function() {\n            var length = this.length, result = pop.apply(this);\n\n            if (length) {\n                this.trigger(CHANGE, {\n                    action: \"remove\",\n                    index: length - 1,\n                    items: [result]\n                });\n            }\n\n            return result;\n        },\n\n        splice: function(index, howMany, item) {\n            var items = this.wrapAll(slice.call(arguments, 2)),\n                result, i, len;\n\n            result = splice.apply(this, [index, howMany].concat(items));\n\n            if (result.length) {\n                if (!this.omitChangeEvent) {\n                    this.trigger(CHANGE, {\n                        action: \"remove\",\n                        index: index,\n                        items: this.omitCache && this.omitCache.length ? result.concat(this.omitCache) : result\n                    });\n                    this.omitCache = [];\n                }\n\n                for (i = 0, len = result.length; i < len; i++) {\n                    if (result[i] && result[i].children) {\n                        result[i].unbind(CHANGE);\n                    }\n                }\n            }\n\n            if (item) {\n                if (!this.omitChangeEvent) {\n                    this.trigger(CHANGE, {\n                        action: \"add\",\n                        index: index,\n                        items: items\n                    });\n                }\n            }\n            return result;\n        },\n\n        shift: function() {\n            var length = this.length, result = shift.apply(this);\n\n            if (length) {\n                this.trigger(CHANGE, {\n                    action: \"remove\",\n                    index: 0,\n                    items: [result]\n                });\n            }\n\n            return result;\n        },\n\n        unshift: function() {\n            var items = this.wrapAll(arguments),\n                result;\n\n            result = unshift.apply(this, items);\n\n            this.trigger(CHANGE, {\n                action: \"add\",\n                index: 0,\n                items: items\n            });\n\n            return result;\n        },\n\n        indexOf: function(item) {\n            var that = this,\n                idx,\n                length;\n\n            for (idx = 0, length = that.length; idx < length; idx++) {\n                if (that[idx] === item) {\n                    return idx;\n                }\n            }\n            return -1;\n        },\n\n        forEach: function(callback, thisArg) {\n            var idx = 0;\n            var length = this.length;\n            var context = thisArg || window;\n\n            for (; idx < length; idx++) {\n                callback.call(context, this[idx], idx, this);\n            }\n        },\n\n        map: function(callback, thisArg) {\n            var idx = 0;\n            var result = [];\n            var length = this.length;\n            var context = thisArg || window;\n\n            for (; idx < length; idx++) {\n                result[idx] = callback.call(context, this[idx], idx, this);\n            }\n\n            return result;\n        },\n\n        reduce: function(callback) {\n            var idx = 0,\n                result,\n                length = this.length;\n\n            if (arguments.length == 2) {\n                result = arguments[1];\n            } else if (idx < length) {\n                result = this[idx++];\n            }\n\n            for (; idx < length; idx++) {\n                result = callback(result, this[idx], idx, this);\n            }\n\n            return result;\n        },\n\n        reduceRight: function(callback) {\n            var idx = this.length - 1,\n                result;\n\n            if (arguments.length == 2) {\n                result = arguments[1];\n            } else if (idx > 0) {\n                result = this[idx--];\n            }\n\n            for (; idx >= 0; idx--) {\n                result = callback(result, this[idx], idx, this);\n            }\n\n            return result;\n        },\n\n        filter: function(callback, thisArg) {\n            var idx = 0;\n            var result = [];\n            var item;\n            var length = this.length;\n            var context = thisArg || window;\n\n            for (; idx < length; idx++) {\n                item = this[idx];\n                if (callback.call(context, item, idx, this)) {\n                    result[result.length] = item;\n                }\n            }\n\n            return result;\n        },\n\n        find: function(callback, thisArg) {\n            var idx = 0;\n            var item;\n            var length = this.length;\n            var context = thisArg || window;\n\n            for (; idx < length; idx++) {\n                item = this[idx];\n                if (callback.call(context, item, idx, this)) {\n                    return item;\n                }\n            }\n        },\n\n        every: function(callback, thisArg) {\n            var idx = 0;\n            var item;\n            var length = this.length;\n            var context = thisArg || window;\n\n            for (; idx < length; idx++) {\n                item = this[idx];\n                if (!callback.call(context, item, idx, this)) {\n                    return false;\n                }\n            }\n\n            return true;\n        },\n\n        some: function(callback, thisArg) {\n            var idx = 0;\n            var item;\n            var length = this.length;\n            var context = thisArg || window;\n\n            for (; idx < length; idx++) {\n                item = this[idx];\n                if (callback.call(context, item, idx, this)) {\n                    return true;\n                }\n            }\n\n            return false;\n        },\n\n        // non-standard collection methods\n        remove: function(item) {\n            var idx = this.indexOf(item);\n\n            if (idx !== -1) {\n                this.splice(idx, 1);\n            }\n        },\n\n        empty: function() {\n            this.splice(0, this.length);\n        }\n    });\n\n    // Polyfill for Symbol.iterator\n    if (typeof Symbol !== \"undefined\" && Symbol.iterator && !ObservableArray.prototype[Symbol.iterator]) {\n        ObservableArray.prototype[Symbol.iterator] = [][Symbol.iterator];\n    }\n\n    var LazyObservableArray = ObservableArray.extend({\n        init: function(data, type, events) {\n            var parentFn = function() { return this; };\n\n            Observable.fn.init.call(this);\n\n            this.type = type || ObservableObject;\n\n            if (events) {\n                this._events = events;\n            }\n\n            for (var idx = 0; idx < data.length; idx++) {\n                this[idx] = data[idx];\n            }\n\n            this.length = idx;\n            this._parent = parentFn.bind(this);\n            this._loadPromises = [];\n            this._loadedNodes = [];\n        },\n        at: function(index) {\n            var item = this[index];\n\n            if (!(item instanceof this.type)) {\n                item = this[index] = this.wrap(item, this._parent);\n            } else {\n                item.parent = this._parent;\n            }\n\n            return item;\n        }\n    });\n\n    function eventHandler(context, type, field, prefix) {\n        return function(e) {\n            var event = {}, key;\n\n            for (key in e) {\n                event[key] = e[key];\n            }\n\n            if (prefix) {\n                event.field = field + \".\" + e.field;\n            } else {\n                event.field = field;\n            }\n\n            if (type == CHANGE && context._notifyChange) {\n                context._notifyChange(event);\n            }\n\n            context.trigger(type, event);\n        };\n    }\n\n    function isPrimitiveType(value) {\n        return (typeof value === \"object\" && Object.getPrototypeOf(value) === Object.getPrototypeOf({}))\n                || Object.getPrototypeOf(value) === Object.getPrototypeOf(new Date())\n                || typeof value !== \"object\";\n      }\n\n    function ownKeys(value, ignoreObjectKeys) {\n        var props = [];\n        var protoKeys = [];\n        var keys, filteredObjectKeys;\n\n        value = value || {};\n\n        if (!isPrimitiveType(value)) {\n            protoKeys = Object.getOwnPropertyNames(Object.getPrototypeOf(value)).filter(f => f.indexOf(\"__\") !== 0);\n        }\n\n        keys = Object.getOwnPropertyNames(value).concat(protoKeys);\n\n        filteredObjectKeys = objectKeys.filter(function(key) {\n            return keys.indexOf(key) < 0;\n        });\n\n        while (value) {\n            Object.getOwnPropertyNames(value).forEach(function(prop) {\n                if (props.indexOf(prop) === -1 && (!ignoreObjectKeys || filteredObjectKeys.indexOf(prop) < 0)) {\n                    props.push(prop);\n                }\n            });\n            value = Object.getPrototypeOf(value);\n        }\n\n        return props;\n    }\n\n    objectKeys = ownKeys({}, false);\n\n    var ObservableObject = Observable.extend({\n        init: function(value) {\n            var that = this,\n                member,\n                keys = ownKeys(value, true),\n                parent = function() {\n                    return that;\n                };\n\n            Observable.fn.init.call(this);\n\n            this._handlers = {};\n\n            keys.forEach(function(field) {\n                member = value[field];\n\n                if (typeof member === \"object\" && member && !member.getTime && field.charAt(0) != \"_\") {\n                    member = that.wrap(member, field, parent);\n                }\n\n                that[field] = member;\n            });\n\n            that.uid = kendo.guid();\n        },\n\n        shouldSerialize: function(field, serializeFunctions) {\n            // This way we cover both if the serializeFunctions parameter is an object OR a boolean.\n            if (typeof serializeFunctions === \"object\") {\n                serializeFunctions = (serializeFunctions && serializeFunctions[field]);\n            }\n            return this.hasOwnProperty(field) && field !== \"_handlers\" && field !== \"_events\" && (serializeFunctions || typeof this[field] !== FUNCTION) && field !== \"uid\";\n        },\n\n        forEach: function(f) {\n            for (var i in this) {\n                if (this.shouldSerialize(i)) {\n                    f(this[i], i);\n                }\n            }\n        },\n\n        toJSON: function(serializeFunctions) {\n            var result = {}, value, field;\n\n            for (field in this) {\n                if (this.shouldSerialize(field, serializeFunctions)) {\n                    value = this[field];\n\n                    if (value instanceof ObservableObject || value instanceof ObservableArray) {\n                        value = value.toJSON(serializeFunctions);\n                    }\n\n                    result[field] = value;\n                }\n            }\n\n            return result;\n        },\n\n        get: function(field) {\n            var that = this, result;\n\n            that.trigger(GET, { field: field });\n\n            if (field === \"this\") {\n                result = that;\n            } else {\n                result = kendo.getter(field, true)(that);\n            }\n\n            return result;\n        },\n\n        _set: function(field, value) {\n            var that = this;\n            var composite = field.indexOf(\".\") >= 0;\n\n            if (composite) {\n                var paths = field.split(\".\"),\n                    path = \"\";\n\n                while (paths.length > 1) {\n                    path += paths.shift();\n                    var obj = kendo.getter(path, true)(that);\n                    if (obj instanceof ObservableObject) {\n                        obj.set(paths.join(\".\"), value);\n                        return composite;\n                    }\n                    path += \".\";\n                }\n            }\n\n            kendo.setter(field)(that, value);\n\n            return composite;\n        },\n\n        set: function(field, value) {\n            var that = this,\n                isSetPrevented = false,\n                composite = field.indexOf(\".\") >= 0,\n                current = kendo.getter(field, true)(that);\n\n            if (current !== value) {\n                if (current instanceof Observable && this._handlers[field]) {\n                    if (this._handlers[field].get) {\n                       current.unbind(GET, this._handlers[field].get);\n                    }\n                    current.unbind(CHANGE, this._handlers[field].change);\n                }\n\n                isSetPrevented = that.trigger(\"set\", { field: field, value: value });\n\n                if (!isSetPrevented) {\n                    if (!composite) {\n                        value = that.wrap(value, field, function() { return that; });\n                    }\n                    if ((!that._set(field, value) || field.indexOf(\"(\") >= 0 || field.indexOf(\"[\") >= 0)) {\n                        that.trigger(CHANGE, { field: field });\n                    }\n                }\n            }\n\n            return isSetPrevented;\n        },\n\n        parent: noop,\n\n        wrap: function(object, field, parent) {\n            var that = this;\n            var get;\n            var change;\n            var type = toString.call(object);\n\n            if (object != null && (type === \"[object Object]\" || type === \"[object Array]\")) {\n                var isObservableArray = object instanceof ObservableArray;\n                var isDataSource = object instanceof DataSource;\n\n                if (type === \"[object Object]\" && !isDataSource && !isObservableArray) {\n                    if (!(object instanceof ObservableObject)) {\n                        object = new ObservableObject(object);\n                    }\n\n                    get = eventHandler(that, GET, field, true);\n                    object.bind(GET, get);\n                    change = eventHandler(that, CHANGE, field, true);\n                    object.bind(CHANGE, change);\n\n                    that._handlers[field] = { get: get, change: change };\n                } else if (type === \"[object Array]\" || isObservableArray || isDataSource) {\n                    if (!isObservableArray && !isDataSource) {\n                        object = new ObservableArray(object);\n                    }\n\n                    change = eventHandler(that, CHANGE, field, false);\n\n                    object.bind(CHANGE, change);\n\n                    that._handlers[field] = { change: change };\n                }\n\n                object.parent = parent;\n            }\n\n            return object;\n        }\n    });\n\n    function equal(x, y) {\n        if (x === y) {\n            return true;\n        }\n\n        var xtype = kendo.type(x), ytype = kendo.type(y), field;\n\n        if (xtype !== ytype) {\n            return false;\n        }\n\n        if (xtype === \"date\") {\n            return x.getTime() === y.getTime();\n        }\n\n        if (xtype !== \"object\" && xtype !== \"array\") {\n            return false;\n        }\n\n        for (field in x) {\n            if (!equal(x[field], y[field])) {\n                return false;\n            }\n        }\n\n        return true;\n    }\n\n    var parsers = {\n        \"number\": function(value) {\n            if (typeof value === STRING && value.toLowerCase() === \"null\") {\n                return null;\n            }\n            return kendo.parseFloat(value);\n        },\n\n        \"date\": function(value) {\n            if (typeof value === STRING && value.toLowerCase() === \"null\") {\n                return null;\n            }\n            return kendo.parseDate(value);\n        },\n\n        \"boolean\": function(value) {\n            if (typeof value === STRING) {\n                if (value.toLowerCase() === \"null\") {\n                    return null;\n                } else {\n                    return value.toLowerCase() === \"true\";\n                }\n            }\n            return value != null ? !!value : value;\n        },\n\n        \"string\": function(value) {\n            if (typeof value === STRING && value.toLowerCase() === \"null\") {\n                return null;\n            }\n            return value != null ? (value + \"\") : value;\n        },\n\n        \"default\": function(value) {\n            return value;\n        }\n    };\n\n    var defaultValues = {\n        \"string\": \"\",\n        \"number\": 0,\n        \"date\": new Date(),\n        \"boolean\": false,\n        \"default\": \"\"\n    };\n\n    function getFieldByName(obj, name) {\n        var field,\n            fieldName;\n\n        for (fieldName in obj) {\n            field = obj[fieldName];\n            if (isPlainObject(field) && field.field && field.field === name) {\n                return field;\n            } else if (field === name) {\n                return field;\n            }\n        }\n        return null;\n    }\n\n    var Model = ObservableObject.extend({\n        init: function(data) {\n            var that = this;\n\n            if (!data || $.isEmptyObject(data)) {\n                data = $.extend({}, that.defaults, data);\n\n                if (that._initializers) {\n                    for (var idx = 0; idx < that._initializers.length; idx++) {\n                         var name = that._initializers[idx];\n                         data[name] = that.defaults[name]();\n                    }\n                }\n            }\n\n            ObservableObject.fn.init.call(that, data);\n\n            that.dirty = false;\n            that.dirtyFields = {};\n\n            if (that.idField) {\n                that.id = that.get(that.idField);\n\n                if (that.id === undefined$1) {\n                    that.id = that._defaultId;\n                }\n            }\n        },\n\n        shouldSerialize: function(field) {\n            return ObservableObject.fn.shouldSerialize.call(this, field) &&\n                field !== \"uid\" && !(this.idField !== \"id\" && field === \"id\") &&\n                field !== \"dirty\" && field !== \"dirtyFields\" && field !== \"_accessors\";\n        },\n\n        _parse: function(field, value) {\n            var that = this,\n                fieldName = field,\n                fields = (that.fields || {}),\n                parse;\n\n            field = fields[field];\n            if (!field) {\n                field = getFieldByName(fields, fieldName);\n            }\n            if (field) {\n                parse = field.parse;\n                if (!parse && field.type) {\n                    parse = parsers[field.type.toLowerCase()];\n                }\n            }\n\n            return parse ? parse(value) : value;\n        },\n\n        _notifyChange: function(e) {\n            var action = e.action;\n\n            if (action == \"add\" || action == \"remove\") {\n                this.dirty = true;\n                this.dirtyFields[e.field] = true;\n            }\n        },\n\n        editable: function(field) {\n            field = (this.fields || {})[field];\n            return field ? field.editable !== false : true;\n        },\n\n        set: function(field, value) {\n            var that = this;\n            var dirty = that.dirty;\n\n            if (that.editable(field)) {\n                value = that._parse(field, value);\n\n                if (!equal(value, that.get(field))) {\n                    that.dirty = true;\n                    that.dirtyFields[field] = true;\n\n                    if (ObservableObject.fn.set.call(that, field, value) && !dirty) {\n                        that.dirty = dirty;\n\n                        if (!that.dirty) {\n                            that.dirtyFields[field] = false;\n                        }\n                    }\n                } else {\n                    that.trigger(\"equalSet\", { field: field, value: value });\n                }\n            }\n        },\n\n        accept: function(data) {\n            var that = this,\n                parent = function() { return that; },\n                field;\n\n            for (field in data) {\n                var value = data[field];\n\n                if (field.charAt(0) != \"_\") {\n                    value = that.wrap(data[field], field, parent);\n                }\n\n                that._set(field, value);\n            }\n\n            if (that.idField) {\n                that.id = that.get(that.idField);\n            }\n\n            that.dirty = false;\n            that.dirtyFields = {};\n        },\n\n        isNew: function() {\n            return this.id === this._defaultId;\n        }\n    });\n\n    Model.define = function(base, options) {\n        if (options === undefined$1) {\n            options = base;\n            base = Model;\n        }\n\n        var model,\n            proto = extend({ defaults: {} }, options),\n            name,\n            field,\n            type,\n            value,\n            idx,\n            length,\n            fields = {},\n            originalName,\n            id = proto.id,\n            functionFields = [];\n\n        if (id) {\n            proto.idField = id;\n        }\n\n        if (proto.id) {\n            delete proto.id;\n        }\n\n        if (id) {\n            proto.defaults[id] = proto._defaultId = \"\";\n        }\n\n        if (toString.call(proto.fields) === \"[object Array]\") {\n            for (idx = 0, length = proto.fields.length; idx < length; idx++) {\n                field = proto.fields[idx];\n                if (typeof field === STRING) {\n                    fields[field] = {};\n                } else if (field.field) {\n                    fields[field.field] = field;\n                }\n            }\n            proto.fields = fields;\n        }\n\n        for (name in proto.fields) {\n            field = proto.fields[name];\n            type = field.type || \"default\";\n            value = null;\n            originalName = name;\n\n            let nameToUse = typeof (field.field) === STRING ? field.field : name;\n\n            if (!field.nullable || field.defaultValue) {\n                value = proto.defaults[originalName !== nameToUse ? originalName : nameToUse] = field.defaultValue !== undefined$1 ? field.defaultValue : defaultValues[type.toLowerCase()];\n\n                if (typeof value === \"function\") {\n                    functionFields.push(nameToUse);\n                }\n            }\n\n            if (options.id === nameToUse) {\n                proto._defaultId = value;\n            }\n\n            proto.defaults[originalName !== nameToUse ? originalName : nameToUse] = value;\n\n            if ($.isPlainObject(field)) {\n                field.parse = field.parse || parsers[type];\n            } else {\n                field = {\n                    parse: parsers[type]\n                };\n            }\n        }\n\n        if (functionFields.length > 0) {\n            proto._initializers = functionFields;\n        }\n\n        model = base.extend(proto);\n        model.define = function(options) {\n            return Model.define(model, options);\n        };\n\n        if (proto.fields) {\n            model.fields = proto.fields;\n            model.idField = proto.idField;\n        }\n\n        return model;\n    };\n\n    var Comparer = {\n        selector: function(field) {\n            return isFunction(field) ? field : getter(field);\n        },\n\n        compare: function(field) {\n            var selector = this.selector(field);\n            return function(a, b) {\n                a = selector(a);\n                b = selector(b);\n\n                if (a == null && b == null) {\n                    return 0;\n                }\n\n                if (a == null) {\n                    return -1;\n                }\n\n                if (b == null) {\n                    return 1;\n                }\n\n                if (a.localeCompare) {\n                    return a.localeCompare(b);\n                }\n\n                return a > b ? 1 : (a < b ? -1 : 0);\n            };\n        },\n\n        create: function(sort) {\n            var compare = sort.compare || this.compare(sort.field);\n\n            if (sort.dir == \"desc\") {\n                return function(a, b) {\n                    return compare(b, a, true);\n                };\n            }\n\n            return compare;\n        },\n\n        combine: function(comparers) {\n            return function(a, b) {\n                var result = comparers[0](a, b),\n                    idx,\n                    length;\n\n                for (idx = 1, length = comparers.length; idx < length; idx ++) {\n                    result = result || comparers[idx](a, b);\n                }\n\n                return result;\n            };\n        }\n    };\n\n    var StableComparer = extend({}, Comparer, {\n        asc: function(field) {\n            var selector = this.selector(field);\n            return function(a, b) {\n                var valueA = selector(a);\n                var valueB = selector(b);\n\n                if (valueA && valueA.getTime && valueB && valueB.getTime) {\n                    valueA = valueA.getTime();\n                    valueB = valueB.getTime();\n                }\n\n                if (valueA === valueB) {\n                    return a.__position - b.__position;\n                }\n\n                if (valueA == null) {\n                    return -1;\n                }\n\n                if (valueB == null) {\n                    return 1;\n                }\n\n                if (valueA.localeCompare) {\n                    return valueA.localeCompare(valueB);\n                }\n\n                return valueA > valueB ? 1 : -1;\n            };\n        },\n\n        desc: function(field) {\n            var selector = this.selector(field);\n            return function(a, b) {\n                var valueA = selector(a);\n                var valueB = selector(b);\n\n                if (valueA && valueA.getTime && valueB && valueB.getTime) {\n                    valueA = valueA.getTime();\n                    valueB = valueB.getTime();\n                }\n\n                if (valueA === valueB) {\n                    return a.__position - b.__position;\n                }\n\n                if (valueA == null) {\n                    return 1;\n                }\n\n                if (valueB == null) {\n                    return -1;\n                }\n\n                if (valueB.localeCompare) {\n                    return valueB.localeCompare(valueA);\n                }\n\n                return valueA < valueB ? 1 : -1;\n            };\n        },\n        create: function(sort) {\n           return this[sort.dir](sort.field);\n        }\n    });\n\n    map = function(array, callback) {\n        var idx, length = array.length, result = new Array(length);\n\n        for (idx = 0; idx < length; idx++) {\n            result[idx] = callback(array[idx], idx, array);\n        }\n\n        return result;\n    };\n\n    var operators = (function() {\n\n        function quote(str) {\n            if (typeof str == \"string\") {\n                str = str.replace(/[\\r\\n]+/g, \"\");\n            }\n            return JSON.stringify(str);\n        }\n\n        function textOp(impl) {\n            return function(a, b, ignore, accentFoldingFiltering) {\n                b += \"\";\n                if (ignore) {\n                    a = \"(\" + a + \" + '').toString()\" + ((accentFoldingFiltering) ? \".toLocaleLowerCase('\" + accentFoldingFiltering + \"')\" : \".toLowerCase()\");\n                    b = ((accentFoldingFiltering) ? b.toLocaleLowerCase(accentFoldingFiltering) : b.toLowerCase());\n                }\n                return impl(a, quote(b), ignore);\n            };\n        }\n\n        function operator(op, a, b, ignore, accentFoldingFiltering) {\n            if (b != null) {\n                if (typeof b === STRING) {\n                    var date = dateRegExp.exec(b);\n                    if (date) {\n                        b = new Date(+date[1]);\n                    } else if (ignore) {\n                        b = quote(((accentFoldingFiltering) ? b.toLocaleLowerCase(accentFoldingFiltering) : b.toLowerCase()));\n                        a = \"((\" + a + \" || '')+'')\" + ((accentFoldingFiltering) ? \".toLocaleLowerCase('\" + accentFoldingFiltering + \"')\" : \".toLowerCase()\");\n                    } else {\n                        b = quote(b);\n                    }\n                }\n\n                if (b.getTime) {\n                    //b looks like a Date\n                    a = \"(\" + a + \"&&\" + a + \".getTime?\" + a + \".getTime():\" + a + \")\";\n                    b = b.getTime();\n                }\n            }\n\n            return a + \" \" + op + \" \" + b;\n        }\n\n        function getMatchRegexp(pattern) {\n            // take a pattern, as supported by Excel match filter, and\n            // convert it to the equivalent JS regular expression.\n            // Excel patterns support:\n            //\n            //   * - match any sequence of characters\n            //   ? - match a single character\n            //\n            // to match a literal * or ?, they must be prefixed by a tilde (~)\n            for (var rx = \"/^\", esc = false, i = 0; i < pattern.length; ++i) {\n                var ch = pattern.charAt(i);\n                if (esc) {\n                    rx += \"\\\\\" + ch;\n                } else if (ch == \"~\") {\n                    esc = true;\n                    continue;\n                } else if (ch == \"*\") {\n                    rx += \".*\";\n                } else if (ch == \"?\") {\n                    rx += \".\";\n                } else if (\".+^$()[]{}|\\\\/\\n\\r\\u2028\\u2029\\xA0\".indexOf(ch) >= 0) {\n                    rx += \"\\\\\" + ch;\n                } else {\n                    rx += ch;\n                }\n                esc = false;\n            }\n            return rx + \"$/\";\n        }\n\n        return {\n            quote: function(value) {\n                if (value && value.getTime) {\n                    return \"new Date(\" + value.getTime() + \")\";\n                }\n                return quote(value);\n            },\n            eq: function(a, b, ignore, accentFoldingFiltering) {\n                return operator(\"==\", a, b, ignore, accentFoldingFiltering);\n            },\n            neq: function(a, b, ignore, accentFoldingFiltering) {\n                return operator(\"!=\", a, b, ignore, accentFoldingFiltering);\n            },\n            gt: function(a, b, ignore) {\n                return operator(\">\", a, b, ignore);\n            },\n            gte: function(a, b, ignore) {\n                return operator(\">=\", a, b, ignore);\n            },\n            lt: function(a, b, ignore) {\n                return operator(\"<\", a, b, ignore);\n            },\n            lte: function(a, b, ignore) {\n                return operator(\"<=\", a, b, ignore);\n            },\n            startswith: textOp(function(a, b) {\n                return a + \".lastIndexOf(\" + b + \", 0) == 0\";\n            }),\n            doesnotstartwith: textOp(function(a, b) {\n                return a + \".lastIndexOf(\" + b + \", 0) == -1\";\n            }),\n            endswith: textOp(function(a, b) {\n                var n = b ? b.length - 2 : 0;\n                return a + \".indexOf(\" + b + \", \" + a + \".length - \" + n + \") >= 0\";\n            }),\n            doesnotendwith: textOp(function(a, b) {\n                var n = b ? b.length - 2 : 0;\n                return a + \".indexOf(\" + b + \", \" + a + \".length - \" + n + \") < 0\";\n            }),\n            contains: textOp(function(a, b) {\n                return a + \".indexOf(\" + b + \") >= 0\";\n            }),\n            doesnotcontain: textOp(function(a, b) {\n                return a + \".indexOf(\" + b + \") == -1\";\n            }),\n            matches: textOp(function(a, b) {\n                b = b.substring(1, b.length - 1);\n                return getMatchRegexp(b) + \".test(\" + a + \")\";\n            }),\n            doesnotmatch: textOp(function(a, b) {\n                b = b.substring(1, b.length - 1);\n                return \"!\" + getMatchRegexp(b) + \".test(\" + a + \")\";\n            }),\n            isempty: function(a) {\n                return a + \" === ''\";\n            },\n            isnotempty: function(a) {\n                return a + \" !== ''\";\n            },\n            isnull: function(a) {\n                return \"(\" + a + \" == null)\";\n            },\n            isnotnull: function(a) {\n                return \"(\" + a + \" != null)\";\n            },\n            isnullorempty: function(a) {\n                return \"(\" + a + \" === null) || (\" + a + \" === '')\";\n            },\n            isnotnullorempty: function(a) {\n                return \"(\" + a + \" !== null) && (\" + a + \" !== '')\";\n            }\n        };\n    })();\n\n    function Query(data) {\n        this.data = data || [];\n    }\n\n    // Continue to support legacy unsafe-eval for the spreadsheet\n    Query.filterExpr = function(expression, options = { noEval: false }) {\n        if (options.noEval) {\n            // using no-eval for most cases\n            return filterExprNoEval(expression);\n        }\n\n        var expressions = [],\n            logic = { and: \" && \", or: \" || \" },\n            idx,\n            length,\n            filter,\n            expr,\n            fieldFunctions = [],\n            operatorFunctions = [],\n            field,\n            operator,\n            filters = expression.filters;\n\n        for (idx = 0, length = filters.length; idx < length; idx++) {\n            filter = filters[idx];\n            field = filter.field;\n            operator = filter.operator;\n\n            if (filter.filters) {\n                expr = Query.filterExpr(filter);\n                //Nested function fields or operators - update their index e.g. __o[0] -> __o[1]\n                filter = expr.expression\n                .replace(/__o\\[(\\d+)\\]/g, function(match, index) {\n                    index = +index;\n                    return \"__o[\" + (operatorFunctions.length + index) + \"]\";\n                })\n                .replace(/__f\\[(\\d+)\\]/g, function(match, index) {\n                    index = +index;\n                    return \"__f[\" + (fieldFunctions.length + index) + \"]\";\n                });\n\n                operatorFunctions.push.apply(operatorFunctions, expr.operators);\n                fieldFunctions.push.apply(fieldFunctions, expr.fields);\n            } else {\n                if (typeof field === FUNCTION) {\n                    expr = \"__f[\" + fieldFunctions.length + \"](d)\";\n                    fieldFunctions.push(field);\n                } else {\n                    expr = kendo.expr(field);\n                }\n\n                if (typeof operator === FUNCTION) {\n                    filter = \"__o[\" + operatorFunctions.length + \"](\" + expr + \", \" + operators.quote(filter.value) + \")\";\n                    operatorFunctions.push(operator);\n                } else {\n                    filter = operators[(operator || \"eq\").toLowerCase()](expr, filter.value, filter.ignoreCase !== undefined$1 ? filter.ignoreCase : true, expression.accentFoldingFiltering);\n                }\n            }\n\n            expressions.push(filter);\n        }\n\n        return { expression: \"(\" + expressions.join(logic[expression.logic]) + \")\", fields: fieldFunctions, operators: operatorFunctions };\n    };\n\n    function normalizeSort(field, dir) {\n        if (field) {\n            var descriptor = typeof field === STRING ? { field: field, dir: dir } : field,\n            descriptors = isArray(descriptor) ? descriptor : (descriptor !== undefined$1 ? [descriptor] : []);\n\n            return grep(descriptors, function(d) { return !!d.dir; });\n        }\n    }\n\n    function sortFields(sorts, dir) {\n        var sortObject = {};\n\n        if (sorts) {\n            var descriptor = typeof sorts === STRING ? { field: sorts, dir: dir } : sorts,\n            descriptors = isArray(descriptor) ? descriptor : (descriptor !== undefined$1 ? [descriptor] : []);\n\n            for (var i = 0; i < descriptors.length; i++) {\n                sortObject[descriptors[i].field] = { dir: descriptors[i].dir, index: i + 1 };\n            }\n        }\n\n        return sortObject;\n    }\n\n    var operatorMap = {\n        \"==\": \"eq\",\n        equals: \"eq\",\n        isequalto: \"eq\",\n        equalto: \"eq\",\n        equal: \"eq\",\n        \"!=\": \"neq\",\n        ne: \"neq\",\n        notequals: \"neq\",\n        isnotequalto: \"neq\",\n        notequalto: \"neq\",\n        notequal: \"neq\",\n        \"<\": \"lt\",\n        islessthan: \"lt\",\n        lessthan: \"lt\",\n        less: \"lt\",\n        \"<=\": \"lte\",\n        le: \"lte\",\n        islessthanorequalto: \"lte\",\n        lessthanequal: \"lte\",\n        \">\": \"gt\",\n        isgreaterthan: \"gt\",\n        greaterthan: \"gt\",\n        greater: \"gt\",\n        \">=\": \"gte\",\n        isgreaterthanorequalto: \"gte\",\n        greaterthanequal: \"gte\",\n        ge: \"gte\",\n        notsubstringof: \"doesnotcontain\",\n        isnull: \"isnull\",\n        isempty: \"isempty\",\n        isnotempty: \"isnotempty\"\n    };\n\n    function normalizeOperator(expression) {\n        var idx,\n        length,\n        filter,\n        operator,\n        filters = expression.filters;\n\n        if (filters) {\n            for (idx = 0, length = filters.length; idx < length; idx++) {\n                filter = filters[idx];\n                operator = filter.operator;\n\n                if (operator && typeof operator === STRING) {\n                    filter.operator = operatorMap[operator.toLowerCase()] || operator;\n                }\n\n                normalizeOperator(filter);\n            }\n        }\n    }\n\n    function normalizeFilter(expression) {\n        if (expression && !isEmptyObject(expression)) {\n            if (isArray(expression) || !expression.filters) {\n                expression = {\n                    logic: \"and\",\n                    filters: isArray(expression) ? expression : [expression]\n                };\n            }\n\n            normalizeOperator(expression);\n\n            return expression;\n        }\n    }\n\n    Query.normalizeFilter = normalizeFilter;\n\n    function compareDescriptor(f1, f2) {\n        if (f1.logic || f2.logic) {\n            return false;\n        }\n\n        return f1.field === f2.field && f1.value === f2.value && f1.operator === f2.operator;\n    }\n\n    function normalizeDescriptor(filter) {\n        filter = filter || {};\n\n        if (isEmptyObject(filter)) {\n            return { logic: \"and\", filters: [] };\n        }\n\n        return normalizeFilter(filter);\n    }\n\n    function fieldComparer(a, b) {\n        if (b.logic || (a.field > b.field)) {\n            return 1;\n        } else if (a.field < b.field) {\n            return -1;\n        } else {\n            return 0;\n        }\n    }\n\n    function hasNotFetchedItems(items, start, end) {\n        for (let idx = start; idx < end; idx++) {\n            if (items[idx].notFetched) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    function compareFilters(expr1, expr2) {\n        expr1 = normalizeDescriptor(expr1);\n        expr2 = normalizeDescriptor(expr2);\n\n        if (expr1.logic !== expr2.logic) {\n            return false;\n        }\n\n        var f1, f2;\n        var filters1 = (expr1.filters || []).slice();\n        var filters2 = (expr2.filters || []).slice();\n\n        if (filters1.length !== filters2.length) {\n            return false;\n        }\n\n        filters1 = filters1.sort(fieldComparer);\n        filters2 = filters2.sort(fieldComparer);\n\n        for (var idx = 0; idx < filters1.length; idx++) {\n            f1 = filters1[idx];\n            f2 = filters2[idx];\n\n            if (f1.logic && f2.logic) {\n                if (!compareFilters(f1, f2)) {\n                    return false;\n                }\n            } else if (!compareDescriptor(f1, f2)) {\n                return false;\n            }\n        }\n\n        return true;\n    }\n\n    Query.compareFilters = compareFilters;\n\n    function normalizeAggregate(expressions) {\n        return isArray(expressions) ? expressions : [expressions];\n    }\n\n    function normalizeGroup(field, dir, compare, skipItemSorting) {\n        var descriptor = typeof field === STRING ? { field: field, dir: dir, compare: compare, skipItemSorting: skipItemSorting } : field,\n        descriptors = isArray(descriptor) ? descriptor : (descriptor !== undefined$1 ? [descriptor] : []);\n\n        return map(descriptors, function(d) {\n            return {\n                field: d.field,\n                dir: d.dir || \"asc\",\n                aggregates: d.aggregates,\n                compare: d.compare,\n                skipItemSorting: d.skipItemSorting\n            };\n        });\n    }\n\n    function normalizeGroupWithoutCompare(field, dir, compare) {\n        var descriptors = normalizeGroup(field, dir, compare);\n\n        for (var i = 0; i < descriptors.length; i++) {\n            delete descriptors[i].compare;\n        }\n\n        return descriptors;\n    }\n\n    function anyGroupDescriptorHasCompare(groupDescriptors) {\n        var descriptors = isArray(groupDescriptors) ? groupDescriptors : [groupDescriptors];\n\n        for (var i = 0; i < descriptors.length; i++) {\n            if (descriptors[i] && isFunction(descriptors[i].compare)) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    Query.prototype = {\n        toArray: function() {\n            return this.data;\n        },\n        range: function(index, count) {\n            return new Query(this.data.slice(index, index + count));\n        },\n        skip: function(count) {\n            return new Query(this.data.slice(count));\n        },\n        take: function(count) {\n            return new Query(this.data.slice(0, count));\n        },\n        select: function(selector) {\n            return new Query(map(this.data, selector));\n        },\n        order: function(selector, dir, inPlace) {\n            var sort = { dir: dir };\n\n            if (selector) {\n                if (selector.compare) {\n                    sort.compare = selector.compare;\n                } else {\n                    sort.field = selector;\n                }\n            }\n\n            if (inPlace) {\n                return new Query(this.data.sort(Comparer.create(sort)));\n            }\n\n            return new Query(this.data.slice(0).sort(Comparer.create(sort)));\n        },\n        orderBy: function(selector, inPlace) {\n            return this.order(selector, \"asc\", inPlace);\n        },\n        orderByDescending: function(selector, inPlace) {\n            return this.order(selector, \"desc\", inPlace);\n        },\n        sort: function(field, dir, comparer, inPlace) {\n            var idx,\n            length,\n            descriptors = normalizeSort(field, dir),\n            comparers = [];\n\n            comparer = comparer || Comparer;\n\n            if (descriptors.length) {\n                for (idx = 0, length = descriptors.length; idx < length; idx++) {\n                    comparers.push(comparer.create(descriptors[idx]));\n                }\n\n                return this.orderBy({ compare: comparer.combine(comparers) }, inPlace);\n            }\n\n            return this;\n        },\n\n        filter: function(expressions) {\n            var compiled,\n            data = this.data,\n            result = [];\n\n            expressions = normalizeFilter(expressions);\n\n            if (!expressions || expressions.filters.length === 0) {\n                return this;\n            }\n\n            compiled = Query.filterExpr(expressions, { noEval: true });\n\n            result = data.filter(compiled);\n            return new Query(result);\n        },\n\n        group: function(descriptors, allData, options) {\n            descriptors = normalizeGroup(descriptors || []);\n            allData = allData || this.data;\n\n            var that = this,\n            result = new Query(that.data),\n            descriptor;\n\n            var getFilteredData = (g, data) => {\n                data = data || new Query(allData).filter([{\n                    field: g.field,\n                    operator: \"eq\",\n                    value: g.value,\n                    ignoreCase: false\n                }]);\n\n                return data;\n            };\n\n            if (descriptors.length > 0) {\n                descriptor = descriptors[0];\n\n                if (options && options.groupPaging) {\n                    result = new Query(allData).groupAllData(descriptor, allData).select(function(group) {\n                        var cachedFilteredData;\n\n                        var items = descriptors.length > 1 ? new Query(group.items).group(descriptors.slice(1), getFilteredData(group, cachedFilteredData).toArray(), options).toArray() : group.items;\n\n                        return {\n                            field: group.field,\n                            value: group.value,\n                            hasSubgroups: descriptors.length > 1,\n                            items: items,\n                            aggregates: descriptor.aggregates && descriptor.aggregates.length ? getFilteredData(group, cachedFilteredData).aggregate(descriptor.aggregates) : {},\n                            uid: kendo.guid(),\n                            itemCount: items.length,\n                            subgroupCount: items.length\n                        };\n                    });\n\n                } else {\n                    result = result.groupBy(descriptor).select(function(group) {\n                        var cachedFilteredData;\n                        return {\n                            field: group.field,\n                            value: group.value,\n                            items: descriptors.length > 1 ? new Query(group.items).group(descriptors.slice(1), getFilteredData(group, cachedFilteredData).toArray()).toArray() : group.items,\n                            hasSubgroups: descriptors.length > 1,\n                            aggregates: descriptor.aggregates && descriptor.aggregates.length ? getFilteredData(group, cachedFilteredData).aggregate(descriptor.aggregates) : {},\n                        };\n                    });\n                }\n            }\n            return result;\n        },\n\n        groupBy: function(descriptor) {\n            var that = this;\n\n            if (isEmptyObject(descriptor) || !this.data.length) {\n                return new Query([]);\n            }\n\n            var field = descriptor.field,\n                sorted = descriptor.skipItemSorting ? this.data : this._sortForGrouping(field, descriptor.dir || \"asc\"),\n                accessor = kendo.accessor(field),\n                item,\n                groupValue = accessor.get(sorted[0], field),\n                group = {\n                    field: field,\n                    value: groupValue,\n                    items: []\n                },\n                currentValue,\n                idx,\n                len,\n                result = [group];\n\n            for (idx = 0, len = sorted.length; idx < len; idx++) {\n                item = sorted[idx];\n                currentValue = accessor.get(item, field);\n                if (!groupValueComparer(groupValue, currentValue)) {\n                    groupValue = currentValue;\n                    group = {\n                        field: field,\n                        value: groupValue,\n                        items: []\n                    };\n                    result.push(group);\n                }\n                group.items.push(item);\n            }\n\n            result = that._sortGroups(result, descriptor);\n\n            return new Query(result);\n        },\n\n        groupAllData: function(descriptor, allData) {\n            if (isEmptyObject(descriptor) || this.data && !this.data.length) {\n                return new Query([]);\n            }\n\n            var field = descriptor.field,\n                sorted = descriptor.skipItemSorting ? allData : new Query(allData).sort(field, descriptor.dir || \"asc\", StableComparer).toArray(),\n                accessor = kendo.accessor(field),\n                item,\n                groupValue = accessor.get(sorted[0], field),\n                group = {\n                    field: field,\n                    value: groupValue,\n                    items: []\n                },\n                currentValue,\n                idx,\n                len,\n                result = [group];\n\n            for (idx = 0, len = sorted.length; idx < len; idx++) {\n                item = sorted[idx];\n                currentValue = accessor.get(item, field);\n                if (!groupValueComparer(groupValue, currentValue)) {\n                    groupValue = currentValue;\n                    group = {\n                        field: field,\n                        value: groupValue,\n                        items: []\n                    };\n                    result.push(group);\n                }\n                group.items.push(item);\n            }\n\n            result = this._sortGroups(result, descriptor);\n\n            return new Query(result);\n        },\n\n        _sortForGrouping: function(field, dir) {\n            var idx, length,\n                data = this.data;\n\n            if (!stableSort) {\n                for (idx = 0, length = data.length; idx < length; idx++) {\n                    data[idx].__position = idx;\n                }\n\n                data = new Query(data).sort(field, dir, StableComparer).toArray();\n\n                for (idx = 0, length = data.length; idx < length; idx++) {\n                    delete data[idx].__position;\n                }\n                return data;\n            }\n\n            return this.sort(field, dir).toArray();\n        },\n\n        _sortGroups: function(groups, descriptor) {\n            var result = groups;\n\n            if (descriptor && isFunction(descriptor.compare)) {\n                result = new Query(result).order({ compare: descriptor.compare }, descriptor.dir || ASCENDING).toArray();\n            }\n\n            return result;\n        },\n\n        aggregate: function(aggregates) {\n            var idx,\n                len,\n                result = {},\n                state = {};\n\n            if (aggregates && aggregates.length) {\n                for (idx = 0, len = this.data.length; idx < len; idx++) {\n                    calculateAggregate(result, aggregates, this.data[idx], idx, len, state);\n                }\n            }\n            return result;\n        }\n    };\n\n    function groupValueComparer(a, b) {\n        if (a && a.getTime && b && b.getTime) {\n            return a.getTime() === b.getTime();\n        }\n        return a === b;\n    }\n\n    function calculateAggregate(accumulator, aggregates, item, index, length, state) {\n        aggregates = aggregates || [];\n        var idx,\n            aggr,\n            functionName,\n            len = aggregates.length;\n\n        for (idx = 0; idx < len; idx++) {\n            aggr = aggregates[idx];\n            functionName = aggr.aggregate;\n            var field = aggr.field;\n            accumulator[field] = accumulator[field] || {};\n            state[field] = state[field] || {};\n            state[field][functionName] = state[field][functionName] || {};\n            accumulator[field][functionName] = functions[functionName.toLowerCase()](accumulator[field][functionName], item, kendo.accessor(field), index, length, state[field][functionName]);\n        }\n    }\n\n    var functions = {\n        sum: function(accumulator, item, accessor) {\n            var value = accessor.get(item);\n\n            if (!isNumber(accumulator)) {\n                accumulator = value;\n            } else if (isNumber(value)) {\n                accumulator += value;\n            }\n\n            return accumulator;\n        },\n        count: function(accumulator) {\n            return (accumulator || 0) + 1;\n        },\n        average: function(accumulator, item, accessor, index, length, state) {\n            var value = accessor.get(item);\n\n            if (state.count === undefined$1) {\n                state.count = 0;\n            }\n\n            if (!isNumber(accumulator)) {\n                accumulator = value;\n            } else if (isNumber(value)) {\n                accumulator += value;\n            }\n\n            if (isNumber(value)) {\n                state.count++;\n            }\n\n            if (index == length - 1 && isNumber(accumulator)) {\n                accumulator = accumulator / state.count;\n            }\n            return accumulator;\n        },\n        max: function(accumulator, item, accessor) {\n            var value = accessor.get(item);\n\n            if (!isNumber(accumulator) && !isDate(accumulator)) {\n                accumulator = value;\n            }\n\n            if (accumulator < value && (isNumber(value) || isDate(value))) {\n                accumulator = value;\n            }\n            return accumulator;\n        },\n        min: function(accumulator, item, accessor) {\n            var value = accessor.get(item);\n\n            if (!isNumber(accumulator) && !isDate(accumulator)) {\n                accumulator = value;\n            }\n\n            if (accumulator > value && (isNumber(value) || isDate(value))) {\n                accumulator = value;\n            }\n            return accumulator;\n        }\n    };\n\n    function isNumber(val) {\n        return typeof val === \"number\" && !isNaN(val);\n    }\n\n    function isDate(val) {\n        return val && val.getTime;\n    }\n\n    function toJSON(array) {\n        var idx, length = array.length, result = new Array(length);\n\n        for (idx = 0; idx < length; idx++) {\n            result[idx] = array[idx].toJSON();\n        }\n\n        return result;\n    }\n\n    Query.normalizeGroup = normalizeGroup;\n    Query.normalizeSort = normalizeSort;\n\n    Query.process = function(data, options, inPlace) {\n        options = options || {};\n\n        var group = options.group;\n        var customGroupSort = anyGroupDescriptorHasCompare(normalizeGroup(group || []));\n        var query = new Query(data),\n            groupDescriptorsWithoutCompare = normalizeGroupWithoutCompare(group || []),\n            normalizedSort = normalizeSort(options.sort || []),\n            sort = customGroupSort ? normalizedSort : groupDescriptorsWithoutCompare.concat(normalizedSort),\n            groupDescriptorsWithoutSort,\n            total,\n            filterCallback = options.filterCallback,\n            filter = options.filter,\n            skip = options.skip,\n            take = options.take;\n\n        if (sort && inPlace) {\n            query = query.sort(sort, undefined$1, undefined$1, inPlace);\n        }\n\n        if (filter) {\n            query = query.filter(filter);\n\n            if (filterCallback) {\n                query = filterCallback(query);\n            }\n\n            total = query.toArray().length;\n        }\n\n        if (sort) {\n            if (!inPlace) {\n                query = query.sort(sort);\n            }\n\n            if (group) {\n                data = query.toArray();\n            }\n        }\n\n        if (customGroupSort) {\n            query = query.group(group, data, options);\n\n            if (skip !== undefined$1 && take !== undefined$1 && !options.groupPaging) {\n                query = new Query(flatGroups(query.toArray())).range(skip, take);\n\n                groupDescriptorsWithoutSort = map(groupDescriptorsWithoutCompare, function(groupDescriptor) {\n                    return extend({}, groupDescriptor, {\n                        skipItemSorting: true\n                    });\n                });\n\n                query = query.group(groupDescriptorsWithoutSort, data, options);\n            }\n        } else {\n            if (skip !== undefined$1 && take !== undefined$1) {\n                total = query.data.length;\n\n                if (skip + take > total && options.virtual) {\n                    skip -= skip + take - total;\n                    skip = skip < 0 ? 0 : skip;\n                }\n                query = query.range(skip, take);\n            }\n\n            if (group && (!isEmptyObject(group) || group.length !== 0)) {\n                query = query.group(group, data, options);\n            }\n        }\n\n        return {\n            total: total,\n            data: query.toArray()\n        };\n    };\n\n    var LocalTransport = Class.extend({\n        init: function(options) {\n            this.data = options.data;\n        },\n\n        read: function(options) {\n            options.success(this.data);\n        },\n        update: function(options) {\n            options.success(options.data);\n        },\n        create: function(options) {\n            options.success(options.data);\n        },\n        destroy: function(options) {\n            options.success(options.data);\n        }\n    });\n\n    var RemoteTransport = Class.extend( {\n        init: function(options) {\n            var that = this, parameterMap;\n\n            options = that.options = extend({}, that.options, options);\n\n            each(crud, function(index, type) {\n                if (typeof options[type] === STRING) {\n                    options[type] = {\n                        url: options[type]\n                    };\n                }\n            });\n\n            that.cache = options.cache ? Cache.create(options.cache) : {\n                find: noop,\n                add: noop\n            };\n\n            parameterMap = options.parameterMap;\n\n            if (options.submit) {\n                that.submit = options.submit;\n            }\n\n            if (isFunction(options.push)) {\n                that.push = options.push;\n            }\n\n            if (!that.push) {\n                that.push = identity;\n            }\n\n            that.parameterMap = isFunction(parameterMap) ? parameterMap : function(options) {\n                var result = {};\n\n                each(options, function(option, value) {\n                    if (option in parameterMap) {\n                        option = parameterMap[option];\n                        if (isPlainObject(option)) {\n                            value = option.value(value);\n                            option = option.key;\n                        }\n                    }\n\n                    result[option] = value;\n                });\n\n                return result;\n            };\n        },\n\n        options: {\n            parameterMap: identity\n        },\n\n        create: function(options) {\n            return ajax(this.setup(options, CREATE));\n        },\n\n        read: function(options) {\n            var that = this,\n                success,\n                error,\n                result,\n                cache = that.cache;\n\n            options = that.setup(options, READ);\n\n            success = options.success || noop;\n            error = options.error || noop;\n\n            result = cache.find(options.data);\n\n            if (result !== undefined$1) {\n                success(result);\n            } else {\n                options.success = function(result) {\n                    cache.add(options.data, result);\n\n                    success(result);\n                };\n\n                $.ajax(options);\n            }\n        },\n\n        update: function(options) {\n            return ajax(this.setup(options, UPDATE));\n        },\n\n        destroy: function(options) {\n            return ajax(this.setup(options, DESTROY));\n        },\n\n        setup: function(options, type) {\n            options = options || {};\n\n            var that = this,\n                parameters,\n                operation = that.options[type],\n                data = isFunction(operation.data) ? operation.data(options.data) : operation.data;\n\n            options = extend(true, {}, operation, options);\n            parameters = extend(true, {}, data, options.data);\n\n            options.data = that.parameterMap(parameters, type);\n\n            if (isFunction(options.url)) {\n                options.url = options.url(parameters);\n            }\n\n            return options;\n        }\n    });\n\n    var Cache = Class.extend({\n        init: function() {\n            this._store = {};\n        },\n        add: function(key, data) {\n            if (key !== undefined$1) {\n                this._store[stringify(key)] = data;\n            }\n        },\n        find: function(key) {\n            return this._store[stringify(key)];\n        },\n        clear: function() {\n            this._store = {};\n        },\n        remove: function(key) {\n            delete this._store[stringify(key)];\n        }\n    });\n\n    Cache.create = function(options) {\n        var store = {\n            \"inmemory\": function() { return new Cache(); }\n        };\n\n        if (isPlainObject(options) && isFunction(options.find)) {\n            return options;\n        }\n\n        if (options === true) {\n            return new Cache();\n        }\n\n        return store[options]();\n    };\n\n    function serializeRecords(data, getters, modelInstance, originalFieldNames, fieldNames) {\n        var record,\n            getter,\n            originalName,\n            idx,\n            setters = {},\n            length;\n\n        for (idx = 0, length = data.length; idx < length; idx++) {\n            record = data[idx];\n            for (getter in getters) {\n                originalName = fieldNames[getter];\n\n                if (originalName && originalName !== getter) {\n                    if (!setters[originalName]) {\n                        setters[originalName] = kendo.setter(originalName);\n                    }\n                    setters[originalName](record, getters[getter](record));\n                    delete record[getter];\n                }\n            }\n        }\n    }\n\n    function convertRecords(data, getters, modelInstance, originalFieldNames, fieldNames) {\n        var record,\n            getter,\n            originalName,\n            idx,\n            length;\n\n        for (idx = 0, length = data.length; idx < length; idx++) {\n            record = data[idx];\n            for (getter in getters) {\n                record[getter] = modelInstance._parse(getter, getters[getter](record));\n\n                originalName = fieldNames[getter];\n                if (originalName && originalName !== getter) {\n                    delete record[originalName];\n                }\n            }\n        }\n    }\n\n    function convertGroup(data, getters, modelInstance, originalFieldNames, fieldNames) {\n        var record,\n            idx,\n            fieldName,\n            length;\n\n        for (idx = 0, length = data.length; idx < length; idx++) {\n            record = data[idx];\n\n            fieldName = originalFieldNames[record.field];\n            if (fieldName && fieldName != record.field) {\n                record.field = fieldName;\n            }\n\n            record.value = modelInstance._parse(record.field, record.value);\n\n            if (record.items) {\n                if (record.hasSubgroups) {\n                    convertGroup(record.items, getters, modelInstance, originalFieldNames, fieldNames);\n                } else {\n                    convertRecords(record.items, getters, modelInstance, originalFieldNames, fieldNames);\n                }\n            }\n        }\n    }\n\n    function wrapDataAccess(originalFunction, model, converter, getters, originalFieldNames, fieldNames) {\n        return function(data) {\n            data = originalFunction(data);\n\n            return wrapDataAccessBase(model, converter, getters, originalFieldNames, fieldNames)(data);\n        };\n    }\n\n    function wrapDataAccessBase(model, converter, getters, originalFieldNames, fieldNames) {\n        return function(data) {\n\n            if (data && !isEmptyObject(getters)) {\n                if (toString.call(data) !== \"[object Array]\" && !(data instanceof ObservableArray)) {\n                    data = [data];\n                }\n\n                converter(data, getters, new model(), originalFieldNames, fieldNames);\n            }\n\n            return data || [];\n        };\n    }\n\n    var DataReader = Class.extend({\n        init: function(schema) {\n            var that = this, member, get, model, base;\n\n            schema = schema || {};\n\n            for (member in schema) {\n                get = schema[member];\n\n                that[member] = typeof get === STRING ? getter(get) : get;\n            }\n\n            base = schema.modelBase || Model;\n\n            if (isPlainObject(that.model)) {\n                that.model = model = base.define(that.model);\n            }\n\n            var dataFunction = that.data.bind(that);\n\n            that._dataAccessFunction = dataFunction;\n\n            if (that.model) {\n                var groupsFunction = that.groups.bind(that),\n                    serializeFunction = that.serialize.bind(that),\n                    originalFieldNames = {},\n                    getters = {},\n                    serializeGetters = {},\n                    fieldNames = {},\n                    shouldSerialize = false,\n                    fieldName,\n                    name;\n\n                model = that.model;\n\n                if (model.fields) {\n                    each(model.fields, function(field, value) {\n                        var fromName;\n\n                        fieldName = field;\n\n                        if (isPlainObject(value) && value.field) {\n                            fieldName = value.field;\n                        } else if (typeof value === STRING) {\n                            fieldName = value;\n                        }\n\n                        if (isPlainObject(value) && value.from) {\n                            fromName = value.from;\n                        }\n\n                        shouldSerialize = shouldSerialize || (fromName && fromName !== field) || fieldName !== field;\n                        name = fromName || fieldName;\n                        getters[field] = name.indexOf(\".\") !== -1 ? getter(name, true) : getter(name);\n                        serializeGetters[field] = getter(field);\n                        originalFieldNames[fromName || fieldName] = field;\n                        fieldNames[field] = fromName || fieldName;\n                    });\n\n                    if (!schema.serialize && shouldSerialize) {\n                        that.serialize = wrapDataAccess(serializeFunction, model, serializeRecords, serializeGetters, originalFieldNames, fieldNames);\n                    }\n                }\n\n                that._dataAccessFunction = dataFunction;\n                that._wrapDataAccessBase = wrapDataAccessBase(model, convertRecords, getters, originalFieldNames, fieldNames);\n                that.data = wrapDataAccess(dataFunction, model, convertRecords, getters, originalFieldNames, fieldNames);\n                that.groups = wrapDataAccess(groupsFunction, model, convertGroup, getters, originalFieldNames, fieldNames);\n            }\n        },\n        errors: function(data) {\n            return data ? data.errors : null;\n        },\n        parse: identity,\n        data: identity,\n        total: function(data) {\n            return data.length;\n        },\n        groups: identity,\n        aggregates: function() {\n            return {};\n        },\n        serialize: function(data) {\n            return data;\n        }\n    });\n\n    function fillLastGroup(originalGroup, newGroup) {\n        var currOriginal;\n        var currentNew;\n\n        if (newGroup.items && newGroup.items.length) {\n            for (var i = 0; i < newGroup.items.length; i++) {\n                currOriginal = originalGroup.items[originalGroup.items.length - 1];\n                currentNew = newGroup.items[i];\n                if (currOriginal && currentNew) {\n                    if (currOriginal.hasSubgroups && currOriginal.value == currentNew.value) {\n                        fillLastGroup(currOriginal, currentNew);\n                    } else if (currOriginal.field && currOriginal.value == currentNew.value) {\n                        currOriginal.items.omitChangeEvent = true;\n                        currOriginal.items.push.apply(currOriginal.items, currentNew.items);\n                        currOriginal.items.omitChangeEvent = false;\n                    } else {\n                        originalGroup.items.omitChangeEvent = true;\n                        originalGroup.items.push.apply(originalGroup.items, [currentNew]);\n                        originalGroup.items.omitChangeEvent = false;\n                    }\n                } else if (currentNew) {\n                    originalGroup.items.omitChangeEvent = true;\n                    originalGroup.items.push.apply(originalGroup.items, [currentNew]);\n                    originalGroup.items.omitChangeEvent = false;\n                }\n            }\n        }\n    }\n    function mergeGroups(target, dest, skip, take) {\n        var group,\n            idx = 0,\n            items;\n\n        while (dest.length && take) {\n            group = dest[idx];\n            items = group.items;\n\n            var length = items.length;\n\n            if (target && target.field === group.field && target.value === group.value) {\n                if (target.hasSubgroups && target.items.length) {\n                    mergeGroups(target.items[target.items.length - 1], group.items, skip, take);\n                } else {\n                    items = items.slice(skip, skip + take);\n                    target.items = target.items.concat(items);\n                }\n                dest.splice(idx--, 1);\n            } else if (group.hasSubgroups && items.length) {\n                mergeGroups(group, items, skip, take);\n                if (!group.items.length) {\n                    dest.splice(idx--, 1);\n                }\n            } else {\n                items = items.slice(skip, skip + take);\n                group.items = items;\n\n                if (!group.items.length) {\n                    dest.splice(idx--, 1);\n                }\n            }\n\n            if (items.length === 0) {\n                skip -= length;\n            } else {\n                skip = 0;\n                take -= items.length;\n            }\n\n            if (++idx >= dest.length) {\n                break;\n            }\n        }\n\n        if (idx < dest.length) {\n            dest.splice(idx, dest.length - idx);\n        }\n    }\n\n    function flatGroups(groups, indexFunction) {\n        var result = [];\n        var groupsLength = (groups || []).length;\n        var group;\n        var items;\n        var indexFn = isFunction(indexFunction) ? indexFunction : function(array, index) {\n            return array[index];\n        };\n\n        for (var groupIndex = 0; groupIndex < groupsLength; groupIndex++) {\n            group = indexFn(groups, groupIndex);\n\n            if (group.hasSubgroups) {\n                result = result.concat(flatGroups(group.items));\n            } else {\n                items = group.items;\n\n                for (var itemIndex = 0; itemIndex < items.length; itemIndex++) {\n                    result.push(indexFn(items, itemIndex));\n                }\n            }\n        }\n        return result;\n    }\n\n    function flattenGroups(data) {\n        var idx,\n            result = [],\n            length,\n            items,\n            itemIndex;\n\n        for (idx = 0, length = data.length; idx < length; idx++) {\n            var group = data.at(idx);\n            if (group.items) {\n                if (group.hasSubgroups) {\n                    result = result.concat(flattenGroups(group.items));\n                } else {\n                    items = group.items;\n                    for (itemIndex = 0; itemIndex < items.length; itemIndex++) {\n                        result.push(items.at(itemIndex));\n                    }\n                }\n            }\n        }\n        return result;\n    }\n\n    function wrapGroupItems(data, model) {\n        var idx, length, group;\n        if (model) {\n            for (idx = 0, length = data.length; idx < length; idx++) {\n                group = data.at(idx);\n                if (group.items) {\n                    if (group.hasSubgroups) {\n                        wrapGroupItems(group.items, model);\n                    } else {\n                        group.items = new LazyObservableArray(group.items, model, group.items._events);\n                    }\n                }\n            }\n        }\n    }\n\n    function eachGroupItems(data, func) {\n        for (var idx = 0; idx < data.length; idx++) {\n            if (data[idx].hasSubgroups) {\n                if (eachGroupItems(data[idx].items, func)) {\n                    return true;\n                }\n            } else if (func(data[idx].items, data[idx])) {\n                return true;\n            }\n        }\n    }\n\n    function replaceInRanges(ranges, data, item, observable) {\n        for (var idx = 0; idx < ranges.length; idx++) {\n            if (ranges[idx].data === data) {\n                break;\n            }\n            if (replaceInRange(ranges[idx].data, item, observable)) {\n                break;\n            }\n        }\n    }\n\n    function replaceInRange(items, item, observable) {\n        for (var idx = 0, length = items.length; idx < length; idx++) {\n            if (items[idx] && items[idx].hasSubgroups) {\n                return replaceInRange(items[idx].items, item, observable);\n            } else if (items[idx] === item || items[idx] === observable) {\n               items[idx] = observable;\n               return true;\n            }\n        }\n    }\n\n    function replaceWithObservable(view, data, ranges, type, serverGrouping) {\n        for (var viewIndex = 0, length = view.length; viewIndex < length; viewIndex++) {\n            var item = view[viewIndex];\n\n            if (!item || item instanceof type) {\n                continue;\n            }\n\n            if (item.hasSubgroups !== undefined$1 && !serverGrouping) {\n                replaceWithObservable(item.items, data, ranges, type, serverGrouping);\n            } else {\n                for (var idx = 0; idx < data.length; idx++) {\n                    if (data[idx] === item) {\n                        view[viewIndex] = data.at(idx);\n                        replaceInRanges(ranges, data, item, view[viewIndex]);\n                        break;\n                    }\n                }\n            }\n        }\n    }\n\n    function removeModel(data, model) {\n        if (!data) {\n            return;\n        }\n        var length = data.length;\n        var dataItem;\n        var idx;\n\n        for (idx = 0; idx < length; idx++) {\n            dataItem = data[idx];\n\n            if (dataItem.uid && dataItem.uid == model.uid) {\n                data.splice(idx, 1);\n                return dataItem;\n            }\n        }\n    }\n\n    function indexOfPristineModel(data, model) {\n        if (model) {\n            return indexOf(data, function(item) {\n                return (item.uid && item.uid == model.uid) || (item[model.idField] === model.id && model.id !== model._defaultId);\n            });\n        }\n        return -1;\n    }\n\n    function indexOfModel(data, model) {\n        if (model) {\n            return indexOf(data, function(item) {\n                return item.uid == model.uid;\n            });\n        }\n        return -1;\n    }\n\n    function indexOf(data, comparer) {\n        var idx, length;\n        if (!data) {\n            return;\n        }\n\n        for (idx = 0, length = data.length; idx < length; idx++) {\n            if (comparer(data[idx])) {\n                return idx;\n            }\n        }\n\n        return -1;\n    }\n\n    function fieldNameFromModel(fields, name) {\n        if (fields && !isEmptyObject(fields)) {\n            var descriptor = fields[name];\n            var fieldName;\n            if (isPlainObject(descriptor)) {\n                fieldName = descriptor.from || descriptor.field || name;\n            } else {\n                fieldName = fields[name] || name;\n            }\n\n            if (isFunction(fieldName)) {\n                return name;\n            }\n\n            return fieldName;\n        }\n        return name;\n    }\n\n    function convertFilterDescriptorsField(descriptor, model) {\n        var idx,\n            length,\n            target = {};\n\n        for (var field in descriptor) {\n            if (field !== \"filters\") {\n                target[field] = descriptor[field];\n            }\n        }\n\n        if (descriptor.filters) {\n            target.filters = [];\n            for (idx = 0, length = descriptor.filters.length; idx < length; idx++) {\n                target.filters[idx] = convertFilterDescriptorsField(descriptor.filters[idx], model);\n            }\n        } else {\n            target.field = fieldNameFromModel(model.fields, target.field);\n        }\n        return target;\n    }\n\n    function convertDescriptorsField(descriptors, model) {\n        var idx,\n            length,\n            result = [],\n            target,\n            descriptor;\n\n        for (idx = 0, length = descriptors.length; idx < length; idx ++) {\n            target = {};\n\n            descriptor = descriptors[idx];\n\n            for (var field in descriptor) {\n                target[field] = descriptor[field];\n            }\n\n            target.field = fieldNameFromModel(model.fields, target.field);\n\n            if (target.aggregates && isArray(target.aggregates)) {\n                target.aggregates = convertDescriptorsField(target.aggregates, model);\n            }\n            result.push(target);\n        }\n        return result;\n    }\n\n    var DataSource = Observable.extend({\n        init: function(options) {\n            var that = this, model, data;\n\n            if (options) {\n                data = options.data;\n            }\n\n            options = that.options = extend({}, that.options, options);\n\n            that._map = {};\n            that._prefetch = {};\n            that._data = [];\n            that._pristineData = [];\n            that._ranges = [];\n            that._view = [];\n            that._pristineTotal = 0;\n            that._destroyed = [];\n            that._pageSize = options.pageSize;\n            that._page = options.page || (options.pageSize ? 1 : undefined$1);\n            that._sort = normalizeSort(options.sort);\n            that._sortFields = sortFields(options.sort);\n            that._filter = normalizeFilter(options.filter);\n            that._group = normalizeGroup(options.group);\n            that._aggregate = options.aggregate;\n            that._total = options.total;\n            that._groupPaging = options.groupPaging;\n\n            if (that._groupPaging) {\n                that._groupsState = {};\n            }\n            that._shouldDetachObservableParents = true;\n\n            Observable.fn.init.call(that);\n\n            that.transport = Transport.create(options, data, that);\n\n            if (isFunction(that.transport.push)) {\n                that.transport.push({\n                    pushCreate: that._pushCreate.bind(that),\n                    pushUpdate: that._pushUpdate.bind(that),\n                    pushDestroy: that._pushDestroy.bind(that)\n                });\n            }\n\n            if (options.offlineStorage != null) {\n                if (typeof options.offlineStorage == \"string\") {\n                    var key = options.offlineStorage;\n\n                    that._storage = {\n                        getItem: function() {\n                            return JSON.parse(localStorage.getItem(key));\n                        },\n                        setItem: function(item) {\n                            localStorage.setItem(key, stringify(that.reader.serialize(item)));\n                        }\n                    };\n                } else {\n                    that._storage = options.offlineStorage;\n                }\n            }\n\n            that.reader = new kendo.data.readers[options.schema.type || \"json\" ](options.schema);\n\n            model = that.reader.model || {};\n\n            that._detachObservableParents();\n\n            that._data = that._observe(that._data);\n            that._online = true;\n\n            that.bind([\"push\", ERROR, CHANGE, REQUESTSTART, SYNC, REQUESTEND, PROGRESS], options);\n        },\n\n        options: {\n            data: null,\n            schema: {\n               modelBase: Model\n            },\n            offlineStorage: null,\n            serverSorting: false,\n            serverPaging: false,\n            serverFiltering: false,\n            serverGrouping: false,\n            serverAggregates: false,\n            batch: false,\n            inPlaceSort: false\n        },\n\n        clone: function() {\n            return this;\n        },\n\n        online: function(value) {\n            if (value !== undefined$1) {\n                if (this._online != value) {\n                    this._online = value;\n\n                    if (value) {\n                        return this.sync();\n                    }\n                }\n\n                return $.Deferred().resolve().promise();\n            } else {\n                return this._online;\n            }\n        },\n\n        offlineData: function(state) {\n            if (this.options.offlineStorage == null) {\n                return null;\n            }\n\n            if (state !== undefined$1) {\n                return this._storage.setItem(state);\n            }\n\n            return this._storage.getItem() || [];\n        },\n\n        _isGrouped: function() {\n            var group = this.group() || [];\n\n            return group.length;\n        },\n\n        _isServerGrouped: function() {\n            var group = this.group() || [];\n\n            return this.options.serverGrouping && group.length;\n        },\n\n        _isServerGroupPaged: function() {\n            return this._isServerGrouped() && this._groupPaging;\n        },\n\n        _isGroupPaged: function() {\n            var group = this._group || [];\n\n            return this._groupPaging && group.length;\n        },\n\n        _pushCreate: function(result) {\n            this._push(result, \"pushCreate\");\n        },\n\n        _pushUpdate: function(result) {\n            this._push(result, \"pushUpdate\");\n        },\n\n        _pushDestroy: function(result) {\n            this._push(result, \"pushDestroy\");\n        },\n\n        _push: function(result, operation) {\n            var data = this._readData(result);\n\n            if (!data) {\n                data = result;\n            }\n\n            this[operation](data);\n        },\n\n        _flatData: function(data, skip) {\n            if (data) {\n                if (this._isServerGrouped()) {\n                    return flattenGroups(data);\n                }\n\n                if (!skip) {\n                    for (var idx = 0; idx < data.length; idx++) {\n                        data.at(idx);\n                    }\n                }\n            }\n\n            return data;\n        },\n\n        parent: noop,\n\n        get: function(id) {\n            var idx, length, data = this._flatData(this._data, this.options.useRanges);\n\n            for (idx = 0, length = data.length; idx < length; idx++) {\n                if (data[idx].id == id) {\n                    return data[idx];\n                }\n            }\n        },\n\n        getByUid: function(id) {\n            return this._getByUid(id, this._data);\n        },\n\n        _getByUid: function(id, dataItems) {\n            var idx, length, data = this._flatData(dataItems, this.options.useRanges);\n\n            if (!data) {\n                return;\n            }\n\n            for (idx = 0, length = data.length; idx < length; idx++) {\n                if (data[idx].uid == id) {\n                    return data[idx];\n                }\n            }\n        },\n\n        indexOf: function(model) {\n            return indexOfModel(this._data, model);\n        },\n\n        at: function(index) {\n            return this._data.at(index);\n        },\n\n        data: function(value) {\n            var that = this;\n            if (value !== undefined$1) {\n                that._detachObservableParents();\n                that._data = this._observe(value);\n\n                that._pristineData = value.slice(0);\n\n                that._storeData();\n\n                that._ranges = [];\n                that.trigger(\"reset\");\n                that._addRange(that._data);\n\n                that._total = that._data.length;\n                that._pristineTotal = that._total;\n\n                that._process(that._data);\n            } else {\n                if (that._data) {\n                    for (var idx = 0; idx < that._data.length; idx++) {\n                        that._data.at(idx);\n                    }\n                }\n\n                return that._data;\n            }\n        },\n\n        view: function(value) {\n            if (value === undefined$1) {\n                return this._view;\n            } else {\n                this._view = this._observeView(value);\n            }\n        },\n\n        _observeView: function(data) {\n            var that = this;\n            replaceWithObservable(data, that._data, that._ranges, that.reader.model || ObservableObject, that._isServerGrouped());\n\n            var view = new LazyObservableArray(data, that.reader.model);\n            view.parent = function() { return that.parent(); };\n            return view;\n        },\n\n        flatView: function() {\n            var groups = this.group() || [];\n\n            if (groups.length) {\n                return flattenGroups(this._view);\n            } else {\n                return this._view;\n            }\n        },\n\n        add: function(model) {\n            return this.insert(this._data.length, model);\n        },\n\n        _createNewModel: function(model) {\n            if (this.reader.model) {\n                return new this.reader.model(model);\n            }\n\n            if (model instanceof ObservableObject) {\n                return model;\n            }\n\n            return new ObservableObject(model);\n        },\n\n        insert: function(index, model) {\n            if (!model) {\n                model = index;\n                index = 0;\n            }\n\n            if (!(model instanceof Model)) {\n                model = this._createNewModel(model);\n            }\n\n            if (this._isServerGrouped()) {\n                this._data.splice(index, 0, this._wrapInEmptyGroup(model));\n            } else {\n                this._data.splice(index, 0, model);\n            }\n\n            this._insertModelInRange(index, model);\n\n            return model;\n        },\n\n        pushInsert: function(index, items) {\n            var that = this;\n            var rangeSpan = that._getCurrentRangeSpan();\n\n            if (!items) {\n                items = index;\n                index = 0;\n            }\n\n            if (!isArray(items)) {\n                items = [items];\n            }\n\n            var pushed = [];\n            var autoSync = this.options.autoSync;\n            this.options.autoSync = false;\n\n            try {\n                for (var idx = 0; idx < items.length; idx ++) {\n                    var item = items[idx];\n\n                    var result = this.insert(index, item);\n\n                    pushed.push(result);\n\n                    var pristine = result.toJSON();\n\n                    if (this._isServerGrouped()) {\n                        pristine = this._wrapInEmptyGroup(pristine);\n                    }\n\n                    this._pristineData.push(pristine);\n\n                    if (rangeSpan && rangeSpan.length) {\n                        $(rangeSpan).last()[0].pristineData.push(pristine);\n                    }\n\n                    index++;\n                }\n            } finally {\n                this.options.autoSync = autoSync;\n            }\n\n            if (pushed.length) {\n                this.trigger(\"push\", {\n                    type: \"create\",\n                    items: pushed\n                });\n            }\n        },\n\n        pushCreate: function(items) {\n            this.pushInsert(this._data.length, items);\n        },\n\n        pushUpdate: function(items) {\n            if (!isArray(items)) {\n                items = [items];\n            }\n\n            var pushed = [];\n\n            for (var idx = 0; idx < items.length; idx ++) {\n                var item = items[idx];\n                var model = this._createNewModel(item);\n\n                var target = this.get(model.id);\n\n                if (target) {\n                    pushed.push(target);\n\n                    target.accept(item);\n\n                    target.trigger(CHANGE);\n\n                    this._updatePristineForModel(target, item);\n                } else {\n                    this.pushCreate(item);\n                }\n            }\n\n            if (pushed.length) {\n                this.trigger(\"push\", {\n                    type: \"update\",\n                    items: pushed\n                });\n            }\n        },\n\n        pushDestroy: function(items) {\n            var pushed = this._removeItems(items);\n\n            if (pushed.length) {\n                this.trigger(\"push\", {\n                    type: \"destroy\",\n                    items: pushed\n                });\n            }\n        },\n\n        _removeItems: function(itemsToRemove, removePristine) {\n            if (!isArray(itemsToRemove)) {\n                itemsToRemove = [itemsToRemove];\n            }\n\n            var shouldRemovePristine = typeof removePristine !== \"undefined\" ? removePristine : true;\n\n            var destroyed = [];\n            var autoSync = this.options.autoSync;\n            this.options.autoSync = false;\n            try {\n                for (var idx = 0; idx < itemsToRemove.length; idx ++) {\n                    var item = itemsToRemove[idx];\n                    var model = this._createNewModel(item);\n                    var found = false;\n                    var index = idx;\n\n                    this._eachItem(this._data, function(items) {\n                        // Ensure all children of a parent are removed before the change event is triggered.\n                        if (index !== itemsToRemove.length - 1) {\n                            items.omitChangeEvent = true;\n                            items.omitCache = [];\n                        } else {\n                            items.omitChangeEvent = false;\n                        }\n\n                        for (var idx = 0; idx < items.length; idx++) {\n                            var item = items.at(idx);\n                            if (item.id === model.id) {\n                                /* When the change event is omitted, certain calculations such as 'total' are broken because only the last item reaches the change handler.\n                                   Keep track of all child items that had their change event omitted and when the change is finally triggered, concat them to the result.*/\n                                if (items.omitChangeEvent) {\n                                    items.omitCache.push(item);\n                                }\n                                destroyed.push(item);\n                                items.splice(idx, 1);\n                                found = true;\n                                break;\n                            }\n                        }\n                    });\n\n                    if (found && shouldRemovePristine) {\n                        this._removePristineForModel(model);\n                        this._destroyed.pop();\n                    }\n                }\n            } finally {\n                this.options.autoSync = autoSync;\n            }\n\n            return destroyed;\n        },\n\n        pushMove: function(index, items) {\n            var pushed = this._moveItems(index, items);\n\n            if (pushed.length) {\n                this.trigger(\"push\", {\n                    type: \"update\",\n                    items: pushed\n                });\n            }\n        },\n\n        _moveItems: function(index, items) {\n            if (!isArray(items)) {\n                items = [items];\n            }\n\n            var moved = [];\n            var autoSync = this.options.autoSync;\n            this.options.autoSync = false;\n\n            try {\n                for (var i = 0; i < items.length; i ++) {\n                    var item = items[i];\n\n                    this._eachItem(this._data, function(dataItems) {\n                        for (var idx = 0; idx < dataItems.length; idx++) {\n                            var dataItem = dataItems.at(idx);\n                            if (dataItem.uid === item.uid) {\n                                moved.push(dataItem);\n                                dataItems.splice(index >= idx ? --index : index, 0, dataItems.splice(idx, 1)[0]);\n                                index++;\n                                break;\n                            }\n                        }\n                    });\n                }\n            } finally {\n                this.options.autoSync = autoSync;\n            }\n\n            return moved;\n        },\n\n        remove: function(model) {\n            var result,\n                that = this,\n                hasGroups = that._isServerGrouped();\n\n            if (hasGroups && model.uid && (!model.isNew || !model.isNew())) {\n                that._pushInDestroyed(model);\n            }\n\n            this._eachItem(that._data, function(items) {\n                result = removeModel(items, model);\n\n                if (result && hasGroups) {\n                    return true;\n                }\n            });\n\n            this._removeModelFromRanges(model);\n\n            return model;\n        },\n\n        destroyed: function() {\n            return this._destroyed;\n        },\n\n        created: function() {\n            var idx,\n                length,\n                result = [],\n                data = this._flatData(this._data, this.options.useRanges);\n\n            for (idx = 0, length = data.length; idx < length; idx++) {\n                if (data[idx].isNew && data[idx].isNew() && !data[idx].notFetched) {\n                    result.push(data[idx]);\n                }\n            }\n            return result;\n        },\n\n        updated: function() {\n            var idx,\n                length,\n                result = [],\n                data = this._flatData(this._data, this.options.useRanges);\n\n            for (idx = 0, length = data.length; idx < length; idx++) {\n                if ((data[idx].isNew && !data[idx].isNew()) && data[idx].dirty) {\n                    result.push(data[idx]);\n                }\n            }\n            return result;\n        },\n\n        sync: function() {\n            var that = this,\n                created = [],\n                updated = [],\n                destroyed = that._destroyed;\n\n            var promise = $.Deferred().resolve().promise();\n\n            if (that.online()) {\n\n                if (!that.reader.model) {\n                    return promise;\n                }\n\n                created = that.created();\n                updated = that.updated();\n\n                var promises = [];\n\n                if (that.options.batch && that.transport.submit) {\n                    promises = that._sendSubmit(created, updated, destroyed);\n                } else {\n                    promises.push.apply(promises, that._send(\"create\", created));\n                    promises.push.apply(promises, that._send(\"update\", updated));\n                    promises.push.apply(promises, that._send(\"destroy\", destroyed));\n                }\n\n                promise = $.when\n                 .apply(null, promises)\n                 .then(function() {\n                    var idx, length, changedItems = [];\n\n                    for (idx = 0, length = arguments.length; idx < length; idx++) {\n                        if (arguments[idx]) {\n                            that._accept(arguments[idx]);\n                            changedItems.push(...arguments[idx].models);\n                        }\n                    }\n\n                    that._storeData(true);\n\n                    that._syncEnd();\n\n                    that._change({ action: \"sync\", changedItems: changedItems });\n\n                    that.trigger(SYNC);\n\n                    if (that._isServerGroupPaged()) {\n                        that.read();\n                    }\n                });\n            } else {\n                that._storeData(true);\n\n                that._syncEnd();\n\n                that._change({ action: \"sync\" });\n            }\n\n            return promise;\n        },\n\n        _syncEnd: noop,\n\n        cancelChanges: function(model) {\n            var that = this;\n\n            if (model instanceof kendo.data.Model) {\n                that._cancelModel(model);\n            } else {\n                that._destroyed = [];\n                that._detachObservableParents();\n                that._data = that._observe(that._pristineData);\n                if (that.options.serverPaging) {\n                    that._total = that._pristineTotal;\n                }\n\n                that._ranges = [];\n                that._addRange(that._data, 0);\n\n                that._changesCanceled();\n\n                that._change();\n\n                that._markOfflineUpdatesAsDirty();\n\n                if (that._isServerGrouped()) {\n                    that.read();\n                }\n            }\n        },\n\n        _changesCanceled: noop,\n\n        _markOfflineUpdatesAsDirty: function() {\n            var that = this;\n\n            if (that.options.offlineStorage != null) {\n                that._eachItem(that._data, function(items) {\n                    for (var idx = 0; idx < items.length; idx++) {\n                        var item = items.at(idx);\n                        if (item.__state__ == \"update\" || item.__state__ == \"create\") {\n                            item.dirty = true;\n                        }\n                    }\n                });\n            }\n        },\n\n        hasChanges: function() {\n            var idx,\n                length,\n                data = this._flatData(this._data, this.options.useRanges);\n\n            if (this._destroyed.length) {\n                return true;\n            }\n\n            for (idx = 0, length = data.length; idx < length; idx++) {\n                if ((data[idx].isNew && data[idx].isNew()) || data[idx].dirty) {\n                    return true;\n                }\n            }\n\n            return false;\n        },\n\n        _accept: function(result) {\n            var that = this,\n                models = result.models,\n                response = result.response,\n                idx = 0,\n                serverGroup = that._isServerGrouped(),\n                pristine = that._pristineData,\n                type = result.type,\n                length;\n\n            that.trigger(REQUESTEND, { response: response, type: type });\n\n            if (response && !isEmptyObject(response)) {\n                response = that.reader.parse(response);\n\n                if (that._handleCustomErrors(response)) {\n                    return;\n                }\n\n                response = that.reader.data(response);\n\n                if (!isArray(response)) {\n                    response = [response];\n                }\n            } else {\n                response = $.map(models, function(model) { return model.toJSON(); } );\n            }\n\n            if (type === \"destroy\") {\n                that._destroyed = [];\n            }\n\n            for (idx = 0, length = models.length; idx < length; idx++) {\n                if (type !== \"destroy\") {\n                    models[idx].accept(response[idx]);\n\n                    if (type === \"create\") {\n                        pristine.push(serverGroup ? that._wrapInEmptyGroup(models[idx].toJSON()) : response[idx]);\n                    } else if (type === \"update\") {\n                        that._updatePristineForModel(models[idx], response[idx]);\n                    }\n                } else {\n                    that._removePristineForModel(models[idx]);\n                }\n            }\n        },\n\n        _updatePristineForModel: function(model, values) {\n            this._executeOnPristineForModel(model, function(index, items) {\n                kendo.deepExtend(items[index], values);\n            });\n        },\n\n        _executeOnPristineForModel: function(model, callback) {\n            this._eachPristineItem(\n                function(items) {\n                    var index = indexOfPristineModel(items, model);\n                    if (index > -1) {\n                        callback(index, items);\n                        return true;\n                    }\n                });\n        },\n\n        _removePristineForModel: function(model) {\n            this._executeOnPristineForModel(model, function(index, items) {\n                items.splice(index, 1);\n            });\n        },\n\n        _readData: function(data) {\n            var read = !this._isServerGrouped() ? this.reader.data : this.reader.groups;\n            return read.call(this.reader, data);\n        },\n\n        _eachPristineItem: function(callback) {\n            var that = this;\n            var options = that.options;\n            var rangeSpan = that._getCurrentRangeSpan();\n\n            that._eachItem(that._pristineData, callback);\n\n            if (options.serverPaging && options.useRanges) {\n                each(rangeSpan, function(i, range) {\n                    that._eachItem(range.pristineData, callback);\n                });\n            }\n        },\n\n       _eachItem: function(data, callback) {\n            if (data && data.length) {\n                if (this._isServerGrouped()) {\n                    eachGroupItems(data, callback);\n                } else {\n                    callback(data);\n                }\n            }\n        },\n\n        _pristineForModel: function(model) {\n            var pristine,\n                idx,\n                callback = function(items) {\n                    idx = indexOfPristineModel(items, model);\n                    if (idx > -1) {\n                        pristine = items[idx];\n                        return true;\n                    }\n                };\n\n            this._eachPristineItem(callback);\n\n            return pristine;\n        },\n\n        _cancelModel: function(model) {\n            var that = this;\n            var pristine = this._pristineForModel(model);\n\n            this._eachItem(this._data, function(items) {\n                var idx = indexOfModel(items, model);\n                if (idx >= 0) {\n                    if (pristine && (!model.isNew() || pristine.__state__)) {\n                        items[idx].accept(pristine);\n\n                        if (pristine.__state__ == \"update\") {\n                            items[idx].dirty = true;\n                        }\n\n                    } else {\n                        that._modelCanceled(model);\n\n                        items.splice(idx, 1);\n\n                        that._removeModelFromRanges(model);\n                    }\n                }\n            });\n        },\n\n        _modelCanceled: noop,\n\n        _submit: function(promises, data) {\n            var that = this;\n\n            that.trigger(REQUESTSTART, { type: \"submit\" });\n\n            that.trigger(PROGRESS);\n\n            that.transport.submit(extend({\n                success: function(response, type) {\n                    var promise = $.grep(promises, function(x) {\n                        return x.type == type;\n                    })[0];\n\n                    if (promise) {\n                        promise.resolve({\n                            response: response,\n                            models: promise.models,\n                            type: type\n                        });\n                    }\n                },\n                error: function(response, status, error) {\n                    for (var idx = 0; idx < promises.length; idx++) {\n                        promises[idx].reject(response);\n                    }\n\n                    that.error(response, status, error);\n                }\n            }, data));\n        },\n\n        _sendSubmit: function(created, updated, destroyed) {\n            var that = this,\n                promises = [];\n\n            if (that.options.batch) {\n                if (created.length) {\n                    promises.push($.Deferred(function(deferred) {\n                        deferred.type = \"create\";\n                        deferred.models = created;\n                    }));\n                }\n\n                if (updated.length) {\n                    promises.push($.Deferred(function(deferred) {\n                        deferred.type = \"update\";\n                        deferred.models = updated;\n                    }));\n                }\n\n                if (destroyed.length) {\n                    promises.push($.Deferred(function(deferred) {\n                        deferred.type = \"destroy\";\n                        deferred.models = destroyed;\n                    }));\n                }\n\n                that._submit(promises, {\n                    data: {\n                        created: that.reader.serialize(toJSON(created)),\n                        updated: that.reader.serialize(toJSON(updated)),\n                        destroyed: that.reader.serialize(toJSON(destroyed))\n                    }\n                });\n            }\n\n            return promises;\n        },\n\n        _promise: function(data, models, type) {\n            var that = this;\n\n            return $.Deferred(function(deferred) {\n                that.trigger(REQUESTSTART, { type: type });\n\n                that.trigger(PROGRESS);\n\n                that.transport[type].call(that.transport, extend({\n                    success: function(response) {\n                        deferred.resolve({\n                            response: response,\n                            models: models,\n                            type: type\n                        });\n                    },\n                    error: function(response, status, error) {\n                        deferred.reject(response);\n                        that.error(response, status, error);\n                    }\n                }, data));\n            }).promise();\n        },\n\n        _send: function(method, data) {\n            var that = this,\n                idx,\n                length,\n                promises = [],\n                converted = that.reader.serialize(toJSON(data));\n\n            if (that.options.batch) {\n                if (data.length) {\n                    promises.push(that._promise( { data: { models: converted } }, data , method));\n                }\n            } else {\n                for (idx = 0, length = data.length; idx < length; idx++) {\n                    promises.push(that._promise( { data: converted[idx] }, [ data[idx] ], method));\n                }\n            }\n\n            return promises;\n        },\n\n        read: function(data) {\n            var that = this, params = that._params(data);\n            var deferred = $.Deferred();\n\n            that._queueRequest(params, function() {\n                var isPrevented = that.trigger(REQUESTSTART, { type: \"read\" });\n                if (!isPrevented) {\n                    that.trigger(PROGRESS);\n\n                    that._ranges = [];\n                    that.trigger(\"reset\");\n                    if (that.online()) {\n                        that.transport.read({\n                            data: params,\n                            success: function(data) {\n                                that._ranges = [];\n                                that.success(data, params);\n\n                                deferred.resolve();\n                            },\n                            error: function() {\n                                var args = slice.call(arguments);\n\n                                that.error.apply(that, args);\n\n                                deferred.reject.apply(deferred, args);\n                            }\n                        });\n                    } else if (that.options.offlineStorage != null) {\n                        that.success(that.offlineData(), params);\n\n                        deferred.resolve();\n                    }\n                } else {\n                    that._dequeueRequest();\n\n                    deferred.resolve(isPrevented);\n                }\n            });\n\n            return deferred.promise();\n        },\n\n        _readAggregates: function(data) {\n            return this.reader.aggregates(data);\n        },\n\n        success: function(data) {\n            var that = this,\n                options = that.options,\n                items,\n                replaceSubset;\n\n            that.trigger(REQUESTEND, { response: data, type: \"read\" });\n\n            if (that.online()) {\n                data = that.reader.parse(data);\n\n                if (that._handleCustomErrors(data)) {\n                    that._dequeueRequest();\n                    return;\n                }\n\n                that._total = that.reader.total(data);\n\n                if (that._isServerGroupPaged()) {\n                    that._serverGroupsTotal = that._total;\n                }\n\n                if (that._pageSize > that._total) {\n                    that._pageSize = that._total;\n                    if (that.options.pageSize && that.options.pageSize > that._pageSize) {\n                        that._pageSize = that.options.pageSize;\n                    }\n                }\n\n                if (that._aggregate && options.serverAggregates) {\n                    that._aggregateResult = that._readAggregates(data);\n                }\n\n                data = that._readData(data);\n\n                that._destroyed = [];\n            } else {\n                data = that._readData(data);\n\n                items = [];\n                var itemIds = {};\n                var model = that.reader.model;\n                var idField = model ? model.idField : \"id\";\n                var idx;\n\n                for (idx = 0; idx < this._destroyed.length; idx++) {\n                    var id = this._destroyed[idx][idField];\n                    itemIds[id] = id;\n                }\n\n                for (idx = 0; idx < data.length; idx++) {\n                    var item = data[idx];\n                    var state = item.__state__;\n                    if (state == \"destroy\") {\n                        if (!itemIds[item[idField]]) {\n                            this._pushInDestroyed(this._createNewModel(item));\n                        }\n                    } else {\n                        items.push(item);\n                    }\n                }\n\n                data = items;\n\n                that._total = data.length;\n            }\n\n            that._pristineTotal = that._total;\n            replaceSubset = that._skip && that._data.length && that._skip < that._data.length;\n\n            if (that.options.endless) {\n                if (replaceSubset) {\n                    that._pristineData.splice(that._skip, that._pristineData.length);\n                }\n                items = data.slice(0);\n                for (var j = 0; j < items.length; j++) {\n                    that._pristineData.push(items[j]);\n                }\n            } else {\n                that._pristineData = data.slice(0);\n            }\n\n            that._detachObservableParents();\n\n            if (that.options.endless) {\n                that._data.unbind(CHANGE, that._changeHandler);\n\n                if (that._isServerGrouped() && that._data[that._data.length - 1].value === data[0].value) {\n                    fillLastGroup(that._data[that._data.length - 1], data[0]);\n                    data.shift();\n                }\n\n                data = that._observe(data);\n                if (replaceSubset) {\n                    that._data.splice(that._skip, that._data.length);\n                }\n                for (var i = 0; i < data.length; i++) {\n                    that._data.push(data[i]);\n                }\n                that._data.bind(CHANGE, that._changeHandler);\n            } else {\n                that._data = that._observe(data);\n            }\n\n            that._markOfflineUpdatesAsDirty();\n\n            that._storeData();\n\n            that._addRange(that._data);\n\n            that._process(that._data);\n\n            that._dequeueRequest();\n        },\n\n        _detachObservableParents: function() {\n            if (this._data && this._shouldDetachObservableParents) {\n                for (var idx = 0; idx < this._data.length; idx++) {\n                    if (this._data[idx].parent) {\n                        this._data[idx].parent = noop;\n                    }\n                }\n            }\n        },\n\n        _storeData: function(updatePristine) {\n            var serverGrouping = this._isServerGrouped();\n            var model = this.reader.model;\n\n            function items(data) {\n                var state = [];\n\n                for (var idx = 0; idx < data.length; idx++) {\n                    var dataItem = data.at(idx);\n                    var item = dataItem.toJSON();\n\n                    if (serverGrouping && dataItem.items) {\n                        item.items = items(dataItem.items);\n                    } else {\n                        item.uid = dataItem.uid;\n\n                        if (model) {\n                            if (dataItem.isNew()) {\n                                item.__state__ = \"create\";\n                            } else if (dataItem.dirty) {\n                                item.__state__ = \"update\";\n                            }\n                        }\n                    }\n                    state.push(item);\n                }\n\n                return state;\n            }\n\n            if (this.options.offlineStorage != null) {\n                var state = items(this._data);\n\n                var destroyed = [];\n\n                for (var idx = 0; idx < this._destroyed.length; idx++) {\n                    var item = this._destroyed[idx].toJSON();\n                    item.__state__ = \"destroy\";\n                    destroyed.push(item);\n                }\n\n                this.offlineData(state.concat(destroyed));\n\n                if (updatePristine) {\n                    this._pristineData = this.reader.reader ? this.reader.reader._wrapDataAccessBase(state) : this.reader._wrapDataAccessBase(state);\n                }\n            }\n        },\n\n        _addRange: function(data, skip) {\n            var that = this,\n                start = typeof (skip) !== \"undefined\" ? skip : (that._skip || 0),\n                end,\n                range = {\n                    data: data,\n                    pristineData: data.toJSON(),\n                    timestamp: that._timeStamp()\n                };\n\n            if (this._isGroupPaged()) {\n                end = start + data.length;\n                range.outerStart = start;\n                range.outerEnd = end;\n            } else {\n                end = start + that._flatData(data, true).length;\n            }\n\n            range.start = start;\n            range.end = end;\n            that._ranges.push(range);\n            that._sortRanges();\n\n            if (that._isGroupPaged()) {\n                if (!that._groupsFlat) {\n                    that._groupsFlat = [];\n                }\n                that._appendToGroupsFlat(range.data);\n                that._updateOuterRangesLength();\n            }\n        },\n\n        _appendToGroupsFlat: function(data) {\n            var length = data.length;\n\n            for (var i = 0; i < length; i++) {\n                this._groupsFlat.push(data[i]);\n            }\n        },\n\n        _getGroupByUid: function(uid) {\n            var length = this._groupsFlat.length;\n            var group;\n\n            for (var i = 0; i < length; i++) {\n                group = this._groupsFlat[i];\n                if (group.uid === uid) {\n                    return group;\n                }\n            }\n        },\n\n        _sortRanges: function() {\n            this._ranges.sort(function(x, y) {\n                return x.start - y.start;\n            });\n        },\n\n        error: function(xhr, status, errorThrown) {\n            this._dequeueRequest();\n            this.trigger(REQUESTEND, { });\n            this.trigger(ERROR, { xhr: xhr, status: status, errorThrown: errorThrown });\n        },\n\n        _params: function(data) {\n            var that = this,\n                options = extend({\n                    take: that.take(),\n                    skip: that.skip(),\n                    page: that.page(),\n                    pageSize: that.pageSize(),\n                    sort: that._sort,\n                    filter: that._filter,\n                    group: that._group,\n                    aggregate: that._aggregate,\n                    groupPaging: !!that._groupPaging,\n                    isExcelExportRequest: that.options.isExcelExportRequest\n                }, data);\n\n            if (!that.options.serverPaging) {\n                delete options.take;\n                delete options.skip;\n                delete options.page;\n                delete options.pageSize;\n            }\n\n            if (!that.options.serverGrouping) {\n                delete options.group;\n            } else if (that.reader.model && options.group) {\n                options.group = convertDescriptorsField(options.group, that.reader.model);\n            }\n\n            if (!that.options.serverFiltering) {\n                delete options.filter;\n            } else if (that.reader.model && options.filter) {\n               options.filter = convertFilterDescriptorsField(options.filter, that.reader.model);\n            }\n\n            if (!that.options.serverSorting) {\n                delete options.sort;\n            } else if (that.reader.model && options.sort) {\n                options.sort = convertDescriptorsField(options.sort, that.reader.model);\n            }\n\n            if (!that.options.serverAggregates) {\n                delete options.aggregate;\n            } else if (that.reader.model && options.aggregate) {\n                options.aggregate = convertDescriptorsField(options.aggregate, that.reader.model);\n            }\n\n            if (!that.options.groupPaging || !(that.options.serverPaging && that.options.serverGrouping)) {\n                delete options.groupPaging;\n            }\n\n            if (!that.options.isExcelExportRequest) {\n                delete options.isExcelExportRequest;\n            }\n\n            return options;\n        },\n\n        _queueRequest: function(options, callback) {\n            var that = this;\n            if (!that._requestInProgress) {\n                that._requestInProgress = true;\n                that._pending = undefined$1;\n                callback();\n            } else {\n                that._pending = { callback: callback.bind(that), options: options };\n            }\n        },\n\n        _dequeueRequest: function() {\n            var that = this;\n            that._requestInProgress = false;\n            if (that._pending) {\n                that._queueRequest(that._pending.options, that._pending.callback);\n            }\n        },\n\n        _handleCustomErrors: function(response) {\n            if (this.reader.errors) {\n                var errors = this.reader.errors(response);\n                if (errors) {\n                    this.trigger(ERROR, { xhr: null, status: \"customerror\", errorThrown: \"custom error\", errors: errors });\n                    return true;\n                }\n            }\n            return false;\n        },\n\n        _shouldWrap: function(data) {\n            var model = this.reader.model;\n\n            if (model && data.length) {\n                return !(data[0] instanceof model);\n            }\n\n            return false;\n        },\n\n        _observe: function(data) {\n            var that = this,\n                model = that.reader.model;\n\n            that._shouldDetachObservableParents = true;\n\n            if (data instanceof ObservableArray) {\n                that._shouldDetachObservableParents = false;\n                if (that._shouldWrap(data)) {\n                    data.type = that.reader.model;\n                    data.wrapAll(data, data);\n                }\n            } else {\n                var arrayType = that.pageSize() && !that.options.serverPaging ? LazyObservableArray : ObservableArray;\n                data = new arrayType(data, that.reader.model);\n                data.parent = function() { return that.parent(); };\n            }\n\n            if (that._isServerGrouped()) {\n                wrapGroupItems(data, model);\n            }\n\n            if (that._changeHandler && that._data && that._data instanceof ObservableArray &&\n                !(that.options.useRanges && that.options.serverPaging)) {\n                that._data.unbind(CHANGE, that._changeHandler);\n            } else {\n                that._changeHandler = that._change.bind(that);\n            }\n\n            return data.bind(CHANGE, that._changeHandler);\n        },\n\n        _updateTotalForAction: function(action, items) {\n            var that = this;\n\n            var total = parseInt(that._total, 10);\n\n            if (!isNumber(that._total)) {\n                total = parseInt(that._pristineTotal, 10);\n            }\n            if (action === \"add\") {\n                total += items.length;\n            } else if (action === \"remove\") {\n                total -= items.length;\n            } else if (action !== \"itemchange\" && action !== \"sync\" && !that.options.serverPaging) {\n                total = that._pristineTotal;\n            } else if (action === \"sync\") {\n                total = that._pristineTotal = parseInt(that._total, 10);\n            }\n\n            that._total = total;\n        },\n\n        _operationsForUpdatedFields: function() {\n            const that = this,\n                updatedFields = that._updatedFields || [],\n                operations = {};\n\n            let found = false,\n                stringified;\n\n            operations.sort = that._sort;\n            operations.filter = that._filter;\n            operations.group = that._group;\n            operations.aggregate = that._aggregate;\n\n            stringified = stringify(operations);\n            found = updatedFields.some(u => stringified.indexOf((`\"field\":\"${u}\"`)) > -1);\n\n            return !found;\n        },\n\n        _pushInDestroyed: function(model) {\n            var isPushed = this._destroyed.find(function(item) {\n                return item.uid === model.uid;\n            });\n            if (!isPushed) {\n                this._destroyed.push(model);\n            }\n        },\n\n        _change: function(e) {\n            let that = this, idx, items, length, action = e ? e.action : \"\";\n\n            if (action === \"remove\") {\n                for (idx = 0, length = e.items.length; idx < length; idx++) {\n                    if (!e.items[idx].isNew || !e.items[idx].isNew()) {\n                        that._pushInDestroyed(e.items[idx]);\n                    }\n                }\n            }\n\n            if (e) {\n                items = e.items || [];\n                e.partialUpdate = that._operationsForUpdatedFields() && !that._preventPartialUpdate;\n\n                if (e.action === \"itemchange\" && items.some(i => i.dirtyFields)) {\n                    let item = e.items[0],\n                        keys = Object.keys(item.dirtyFields),\n                        result = keys;\n\n                    for (const key of keys) {\n                        if (item[key] instanceof Object) {\n                            let stringifiedKey = kendo.stringify(item[key]);\n\n                            if (stringifiedKey) {\n                                let cleanObject = JSON.parse(stringifiedKey),\n                                cleanObjectKeys = Object.keys(cleanObject).map((k) => key + \".\" + k);\n\n                                result.push(...cleanObjectKeys);\n                            }\n                        }\n                    }\n\n                    that._updatedFields = result;\n                }\n            }\n\n            if (that.options.autoSync && (action === \"add\" || action === \"remove\" || action === \"itemchange\")) {\n                if (action === \"add\") {\n                    that._preventPartialUpdate = true;\n                }\n\n                var handler = function(args) {\n                    if (args.action === \"sync\") {\n                        that._preventPartialUpdate = false;\n                        that.unbind(\"change\", handler);\n                        that._updateTotalForAction(action, e.items);\n                    }\n                };\n\n                that.first(\"change\", handler);\n\n                that.sync();\n\n            } else {\n                that._updateTotalForAction(action, e ? e.items : []);\n\n                that._process(that._data, e);\n            }\n        },\n\n        _calculateAggregates: function(data, options) {\n            options = options || {};\n\n            var query = new Query(data),\n                aggregates = options.aggregate,\n                filter = options.filter;\n\n            if (filter) {\n                query = query.filter(filter);\n            }\n\n            return query.aggregate(aggregates);\n        },\n\n        _process: function(data, e) {\n            var that = this,\n                options = {},\n                result;\n\n            if (that.options.serverPaging !== true) {\n                options.skip = that._skip;\n                options.take = that._take || that._pageSize;\n\n                if (options.skip === undefined$1 && that._page !== undefined$1 && that._pageSize !== undefined$1) {\n                    options.skip = (that._page - 1) * that._pageSize;\n                }\n\n                if (that.options.useRanges) {\n                    options.skip = that.currentRangeStart();\n                }\n            }\n\n            if (that.options.serverSorting !== true) {\n                options.sort = that._sort;\n            }\n\n            if (that.options.serverFiltering !== true) {\n                options.filter = that._filter;\n            }\n\n            if (that.options.serverGrouping !== true) {\n                options.group = that._group;\n            }\n\n            if (that.options.serverAggregates !== true) {\n                options.aggregate = that._aggregate;\n            }\n\n            if (that.options.serverGrouping) {\n                that._clearEmptyGroups(data);\n            }\n\n            options.groupPaging = that._groupPaging;\n\n            if (that._isGroupPaged() && e && (e.action === \"page\" || e.action === \"expandGroup\" || e.action === \"collapseGroup\")) {\n                result = that._queryProcess(data, {\n                    aggregate: that._aggregate\n                });\n            } else {\n                result = that._queryProcess(data, options);\n            }\n\n            if (that._filter && e && e.action === \"add\") {\n                var model = e.items[0],\n                    resultData = result.data;\n\n                if (that._isGrouped() && !this._isServerGrouped()) {\n                    resultData = flattenGroups(resultData);\n                }\n\n                var modelIsInView = resultData.find(function(item) {\n                    return item.uid === model.uid;\n                });\n\n                if (!modelIsInView) {\n                    result.data.splice(model.index, 0, that._isGrouped() ? that._wrapInEmptyGroup(model) : model);\n                    result.total++;\n                }\n            }\n\n            if (that.options.serverAggregates !== true) {\n                // for performance reasons, calculate aggregates for part of the data only after query process\n                // this is necessary in the TreeList when paging\n                that._aggregateResult = that._calculateAggregates(result.dataToAggregate || data, options);\n            }\n\n            that._setView(result, options, e);\n\n            that._setFilterTotal(result.total, false);\n\n            e = e || {};\n\n            e.items = e.items || that._view;\n\n            that.trigger(CHANGE, e);\n        },\n\n        _setView: function(result, options, e) {\n            var that = this;\n\n            if (that._isGroupPaged() && !that._isServerGrouped()) {\n                if (e && (e.action === \"page\" || e.action === \"expandGroup\" || e.action === \"collapseGroup\")) {\n                    that.view(result.data);\n                    that._updateOuterRangesLength();\n                } else {\n                    that._ranges = [];\n                    var query = new Query(result.data);\n                    that._addRange(that._observe(result.data));\n\n                    if (options.skip + options.take > result.data.length) {\n                        options.skip = Math.max(0, result.data.length - options.take);\n                    }\n\n                    that.view(query.range(options.skip, options.take).toArray());\n                }\n\n            } else {\n                that.view(result.data);\n            }\n        },\n\n        _clearEmptyGroups: function(data) {\n            for (var idx = data.length - 1; idx >= 0; idx--) {\n                var group = data[idx];\n                if (group.hasSubgroups) {\n                    this._clearEmptyGroups(group.items);\n                }\n\n                if (group.items && !group.items.length && !group.itemCount) {\n                    splice.apply(group.parent(), [idx, 1]);\n                }\n            }\n        },\n\n        _queryProcess: function(data, options) {\n            if (this.options.inPlaceSort) {\n                return Query.process(data, options, this.options.inPlaceSort);\n            }\n            else {\n                return Query.process(data, options);\n            }\n        },\n\n        _mergeState: function(options) {\n            var that = this;\n\n            if (options !== undefined$1) {\n                that._pageSize = options.pageSize;\n                that._page = options.page;\n                that._sort = options.sort;\n                that._filter = options.filter;\n                that._group = options.group;\n                that._aggregate = options.aggregate;\n                that._skip = that._currentRangeStart = options.skip;\n                that._take = options.take;\n\n                if (that._skip === undefined$1) {\n                    that._skip = that._currentRangeStart = that.skip();\n                    options.skip = that.skip();\n                }\n\n                if (that._take === undefined$1 && that._pageSize !== undefined$1) {\n                    that._take = that._pageSize;\n                    options.take = that._take;\n                }\n\n                if (that.options.virtual) {\n                    options.virtual = that.options.virtual;\n                }\n\n                if (options.sort) {\n                    that._sort = options.sort = normalizeSort(options.sort);\n                    that._sortFields = sortFields(options.sort);\n                }\n\n                if (options.filter) {\n                    that._filter = options.filter = (that.options.accentFoldingFiltering && !$.isEmptyObject(options.filter)) ? $.extend({}, normalizeFilter(options.filter), { accentFoldingFiltering: that.options.accentFoldingFiltering }) : normalizeFilter(options.filter);\n                }\n\n                if (options.group) {\n                    that._group = options.group = normalizeGroup(options.group);\n                }\n                if (options.aggregate) {\n                    that._aggregate = options.aggregate = normalizeAggregate(options.aggregate);\n                }\n            }\n            return options;\n        },\n\n        query: function(options) {\n            var result;\n            var remote = this.options.serverSorting || this.options.serverPaging || this.options.serverFiltering || this.options.serverGrouping || this.options.serverAggregates;\n\n            if (remote || ((this._data === undefined$1 || this._data.length === 0) && !this._destroyed.length)) {\n                if (this.options.endless) {\n                    var moreItemsCount = options.pageSize - this.pageSize();\n                    if (moreItemsCount > 0) {\n                        moreItemsCount = this.pageSize();\n                        options.page = options.pageSize / moreItemsCount;\n                        options.pageSize = moreItemsCount;\n                    } else {\n                        options.page = 1;\n                        this.options.endless = false;\n                    }\n                }\n                return this.read(this._mergeState(options));\n            }\n\n            var isPrevented = this.trigger(REQUESTSTART, { type: \"read\" });\n            if (!isPrevented) {\n                this.trigger(PROGRESS);\n                if (options) {\n                    options.groupPaging = this._groupPaging;\n                }\n                result = this._queryProcess(this._data, this._mergeState(options));\n\n                this._setFilterTotal(result.total, true);\n\n                this._aggregateResult = this._calculateAggregates(result.dataToAggregate || this._data, options);\n                this._setView(result, options);\n                this.trigger(REQUESTEND, { type: \"read\" });\n                this.trigger(CHANGE, { items: result.data, action: options ? options.action : \"\" });\n            }\n\n            return $.Deferred().resolve(isPrevented).promise();\n        },\n\n        _hasExpandedSubGroups: function(group) {\n            var result = false;\n            var length = group.items ? group.items.length : 0;\n\n            if (!group.hasSubgroups) {\n                return false;\n            }\n\n            for (var i = 0; i < length; i++) {\n                if (this._groupsState[group.items[i].uid]) {\n                    result = true;\n                    break;\n                }\n            }\n            return result;\n        },\n\n        _findGroupedRange: function(data, result, options, parents, callback) {\n            var that = this;\n            var length = data.length;\n            var group;\n            var current;\n            var itemsLength;\n            var groupCount;\n            var itemsToSkip;\n\n            for (var i = 0; i < length; i++) {\n                group = data[i];\n\n                if (options.taken >= options.take) {\n                    break;\n                }\n\n                if (!that._getGroupByUid(group.uid)) {\n                    that._groupsFlat.push(group);\n                }\n\n                if (that._groupsState[group.uid]) {\n                    if (that._isServerGroupPaged()) {\n                       if (that._fetchGroupItems(group, options, parents, callback)) {\n                            that._fetchingGroupItems = true;\n                            return;\n                       }\n                       groupCount = (group.subgroupCount || group.itemCount) + 1;\n                       itemsToSkip = options.skip - options.skipped;\n                       if (!that._hasExpandedSubGroups(group) && itemsToSkip > groupCount) {\n                           options.skipped += groupCount;\n                           continue;\n                       }\n                    }\n\n                    if (options.includeParents && options.skipped < options.skip) {\n                        options.skipped++;\n                        group.excludeHeader = true;\n                    } else if (options.includeParents) {\n                        options.taken++;\n                        group.excludeHeader = false;\n                    }\n\n                    if (group.hasSubgroups && group.items && group.items.length) {\n                        group.currentItems = [];\n\n                        if (!parents) {\n                            parents = [];\n                        }\n                        parents.push(group);\n\n                        that._findGroupedRange(group.items, group.currentItems, options, parents, callback);\n                        parents.pop();\n\n                        if (group.currentItems.length || options.taken > 0) {\n                            result.push(group);\n                        } else {\n                            group.excludeHeader = false;\n                        }\n                    } else {\n                        current = [];\n                        itemsLength = group.items.length;\n\n                        for (var j = 0; j < itemsLength; j++) {\n                            if (options.skipped < options.skip) {\n                                options.skipped++;\n                                continue;\n                            }\n\n                            if (options.taken >= options.take) {\n                                break;\n                            }\n                            current.push(group.items[j]);\n                            options.taken++;\n                        }\n\n                        if (current.length || options.taken > 0) {\n                            group.currentItems = current;\n                            result.push(group);\n                        } else {\n                            group.excludeHeader = false;\n                        }\n                    }\n                } else {\n                    if (options.skipped < options.skip) {\n                        options.skipped++;\n                        continue;\n                    }\n                    result.push(group);\n                    options.taken++;\n                }\n            }\n        },\n\n        _expandedSubGroupItemsCount: function(group, end, includeCurrentItems) {\n            var that = this;\n            var result = 0;\n            var subGroup;\n            var endSpecified = typeof end === \"number\";\n            var length = endSpecified ? end : group.subgroupCount;\n            var temp;\n\n            if (!group.hasSubgroups) {\n                return result;\n            }\n\n            for (var i = 0; i < length; i++) {\n                subGroup = group.items[i];\n\n                if (!subGroup) {\n                    break;\n                }\n\n                if (subGroup.hasSubgroups && that._groupsState[group.uid]) {\n                    temp = that._expandedSubGroupItemsCount(subGroup, length, true);\n                    result += temp;\n\n                    if (endSpecified) {\n                        length -= temp;\n                    }\n                } else if (!subGroup.hasSubgroups && that._groupsState[subGroup.uid]) {\n                    temp = subGroup.items ? subGroup.items.length : 0;\n                    result += temp;\n                    if (endSpecified) {\n                        length -= temp;\n                    }\n                }\n\n                if (includeCurrentItems) {\n                    result += 1;\n                    if (endSpecified) {\n                        length -= 1;\n                    }\n                }\n\n                if (endSpecified && result > length) {\n                    return result;\n                }\n            }\n\n            return result;\n        },\n\n        _fetchGroupItems: function(group, options, parents, callback) {\n            let that = this;\n            let groupItemsSkip;\n            let firstItem;\n            let lastItem;\n            let groupItemCount = group.hasSubgroups ? group.subgroupCount : group.itemCount;\n            let take = options.take;\n            let skipped = options.skipped;\n            let pageSize = that.take();\n            let expandedSubGroupItemsCount;\n\n            if (options.includeParents) {\n                if (skipped < options.skip) {\n                    skipped += 1;\n                } else {\n                    take -= 1;\n                }\n            }\n\n            if (!group.items || (group.items && !group.items.length)) {\n                that.getGroupItems(group, options, parents, callback, 0);\n                return true;\n            } else {\n                expandedSubGroupItemsCount = this._expandedSubGroupItemsCount(group, options.skip - skipped);\n                groupItemsSkip = Math.max(options.skip - (skipped + expandedSubGroupItemsCount), 0);\n\n                if (groupItemsSkip >= groupItemCount) {\n                    return false;\n                }\n\n                let lastItemIndex = Math.min(groupItemsSkip + take, groupItemCount - 1);\n                firstItem = group.items[groupItemsSkip];\n                lastItem = group.items[lastItemIndex];\n\n                if (firstItem.notFetched) {\n                    that.getGroupItems(group, options, parents, callback, groupItemsSkip, math.round((groupItemsSkip + pageSize) / pageSize));\n                    return true;\n                }\n\n                if (lastItem.notFetched) {\n                    that.getGroupItems(group, options, parents, callback, math.max(math.floor((groupItemsSkip + pageSize) / pageSize), 0) * pageSize, math.round((groupItemsSkip + pageSize) / pageSize));\n                    return true;\n                }\n\n                if (!firstItem.notFetched && !lastItem.notFetched && hasNotFetchedItems(group.items, groupItemsSkip, lastItemIndex)) {\n                    that.getGroupItems(group, options, parents, callback, groupItemsSkip, lastItemIndex);\n                    return true;\n                }\n            }\n        },\n\n        getGroupItems: function(group, options, parents, callback, groupItemsSkip, page) {\n            var that = this;\n            var take;\n            var filter;\n            var data;\n            var subgroups;\n\n            if (!group.items) {\n                group.items = [];\n            }\n\n            take = that.take();\n            filter = this._composeItemsFilter(group, parents);\n            data = {\n                page: page || 1,\n                pageSize: take,\n                skip: groupItemsSkip,\n                take: take,\n                filter: filter,\n                aggregate: that._aggregate,\n                sort: that._sort\n            };\n            subgroups = that.findSubgroups(group);\n\n            if (subgroups && subgroups.length) {\n                data.group = subgroups;\n            }\n\n            data.groupPaging = true;\n            that._queueWithTimeout(data, function() {\n                if (!that.trigger(REQUESTSTART, {\n                        type: \"read\"\n                    })) {\n                    that.transport.read({\n                        data: data,\n                        success: that._groupItemsSuccessHandler(group, options.skip, that.take(), callback, groupItemsSkip),\n                        error: function() {\n                            var args = slice.call(arguments);\n                            that.error.apply(that, args);\n                        }\n                    });\n                } else {\n                    that._dequeueRequest();\n                }\n            }, 100);\n        },\n\n        _queueWithTimeout: function(options, callback, delay) {\n            let that = this;\n\n            clearTimeout(that._timeout);\n            that._timeout = setTimeout(function() {\n                that._queueRequest(options, callback);\n            }, delay);\n        },\n\n        _groupItemsSuccessHandler: function(group, skip, take, callback, groupItemsSkip) {\n            var that = this;\n            var timestamp = that._timeStamp();\n            callback = isFunction(callback) ? callback : noop;\n            var totalField = that.options.schema && that.options.schema.total ? that.options.schema.total : \"Total\";\n\n            return function(data) {\n                var temp;\n                var model = Model.define(that.options.schema.model);\n                var totalCount;\n\n                that._dequeueRequest();\n\n                that.trigger(REQUESTEND, {\n                    response: data,\n                    type: \"read\"\n                });\n\n                if (isFunction(totalField)) {\n                    totalCount = totalField(data);\n                } else {\n                    totalCount = data[totalField];\n                }\n\n                data = that.reader.parse(data);\n\n                if (group.hasSubgroups) {\n                    temp = that.reader.groups(data);\n                    group.subgroupCount = totalCount;\n                } else {\n                    temp = that.reader.data(data);\n                    temp = temp.map(function(item) {\n                        return new model(item);\n                    });\n                }\n\n                group.items.omitChangeEvent = true;\n                for (var i = 0; i < totalCount; i++) {\n                    if (i >= groupItemsSkip && i < (groupItemsSkip + take) ) {\n                        group.items.splice(i, 1, temp[i - groupItemsSkip]);\n                    } else {\n                        if (!group.items[i]) {\n                            group.items.splice(i, 0, { notFetched: true });\n                        }\n                    }\n                }\n                group.items.omitChangeEvent = false;\n\n                that._updateRangePristineData(group);\n                that._fetchingGroupItems = false;\n\n                if (!group.countAdded) {\n                    that._serverGroupsTotal += totalCount;\n                    group.countAdded = true;\n                }\n\n                that.range(skip, take, callback, \"expandGroup\");\n\n                if (timestamp >= that._currentRequestTimeStamp || !that._skipRequestsInProgress) {\n                    that.trigger(CHANGE, {});\n                }\n            };\n        },\n\n        findSubgroups: function(group) {\n            var indexOfCurrentGroup = this._group.map(function(g) {\n                return g.field;\n            }).indexOf(group.field);\n\n            return this._group.slice(indexOfCurrentGroup + 1, this._group.length);\n        },\n\n        _composeItemsFilter: function(group, parents) {\n            var filter = {\n                logic: \"and\",\n                filters: []\n            };\n\n            if (this.filter()) {\n                filter.filters.push(this.filter());\n            }\n\n            filter = extend(true, {}, filter);\n            filter.filters.push({\n                field: group.field,\n                operator: \"eq\",\n                value: group.value\n            });\n\n            if (parents) {\n                for (var i = 0; i < parents.length; i++) {\n                    filter.filters.push({\n                        field: parents[i].field,\n                        operator: \"eq\",\n                        value: parents[i].value\n                    });\n                }\n            }\n\n            return filter;\n        },\n\n        _updateRangePristineData: function(group) {\n            var that = this;\n            var ranges = that._ranges;\n            var rangesLength = ranges.length;\n            var temp;\n            var currentGroup;\n            var range;\n            var dataLength;\n            var indexes;\n            var currIdx;\n\n            for (var i = 0; i < rangesLength; i++) {\n                range = ranges[i];\n                dataLength = range.data.length;\n                indexes = [];\n                temp = null;\n\n                for (var j = 0; j < dataLength; j++) {\n                    currentGroup = range.data[j];\n                    indexes.push(j);\n\n                    if ((currentGroup.uid === group.uid) || (currentGroup.hasSubgroups && currentGroup.items.length && that._containsSubGroup(currentGroup, group, indexes))) {\n                        break;\n                    }\n                    indexes.pop();\n                }\n\n                if (indexes.length) {\n                    temp = ranges[i].pristineData;\n\n                    while (indexes.length > 1) {\n                        currIdx = indexes.splice(0, 1)[0];\n                        temp = temp[currIdx].items;\n                    }\n                    temp[indexes[0]] = that._cloneGroup(group);\n                    break;\n                }\n            }\n        },\n\n        _containsSubGroup: function(group, subgroup, indexes) {\n            var that = this;\n            var length = group.items.length;\n            var currentSubGroup;\n\n            if (group.hasSubgroups && length) {\n                for (var i = 0; i < length; i++) {\n                    currentSubGroup = group.items[i];\n                    indexes.push(i);\n                    if (currentSubGroup.uid === subgroup.uid ||\n                            (currentSubGroup.hasSubgroups &&\n                            currentSubGroup.items.length &&\n                            that._containsSubGroup(currentSubGroup, subgroup, indexes))) {\n                        return true;\n                    }\n                    indexes.pop();\n                }\n            }\n\n        },\n\n        _cloneGroup: function(group) {\n            var that = this;\n            group = typeof group.toJSON == \"function\" ? group.toJSON() : group;\n\n            if (group.items && group.items.length) {\n                group.items = group.items.map(function(item) {\n                    return that._cloneGroup(item);\n                });\n            }\n\n            return group;\n        },\n\n        _setFilterTotal: function(filterTotal, setDefaultValue) {\n            var that = this;\n\n            if (!that.options.serverFiltering) {\n                if (filterTotal !== undefined$1) {\n                    that._total = filterTotal;\n                } else if (setDefaultValue) {\n                    that._total = that._data.length;\n                }\n            }\n        },\n\n        fetch: function(callback) {\n            var that = this;\n            var fn = function(isPrevented) {\n                if (isPrevented !== true && isFunction(callback)) {\n                    callback.call(that);\n                }\n            };\n\n            return this._query().done(fn);\n        },\n\n        _query: function(options) {\n            var that = this;\n\n            return that.query(extend({}, {\n                page: that.page(),\n                pageSize: that.pageSize(),\n                sort: that.sort(),\n                filter: that.filter(),\n                group: that.group(),\n                aggregate: that.aggregate()\n            }, options));\n        },\n\n        next: function(options) {\n            var that = this,\n                page = that.page(),\n                total = that.total();\n\n            options = options || {};\n\n            if (!page || (total && page + 1 > that.totalPages())) {\n                return;\n            }\n\n            that._skip = that._currentRangeStart = page * that.take();\n\n            page += 1;\n            options.page = page;\n\n            that._query(options);\n\n            return page;\n        },\n\n        prev: function(options) {\n            var that = this,\n                page = that.page();\n\n            options = options || {};\n\n            if (!page || page === 1) {\n                return;\n            }\n\n            that._skip = that._currentRangeStart = that._skip - that.take();\n\n            page -= 1;\n            options.page = page;\n\n            that._query(options);\n\n            return page;\n        },\n\n        page: function(val) {\n            var that = this,\n            skip;\n\n            if (val !== undefined$1) {\n                val = math.max(math.min(math.max(val, 1), that.totalPages()), 1);\n                var take = that.take();\n\n                if (that._isGroupPaged()) {\n                    val -= 1;\n                    that.range(val * take, take, null, \"page\");\n                    return;\n                }\n                that._query(that._pageableQueryOptions({ page: val }));\n                return;\n            }\n            skip = that.skip();\n\n            return skip !== undefined$1 ? math.round((skip || 0) / (that.take() || 1)) + 1 : undefined$1;\n        },\n\n        pageSize: function(val) {\n            var that = this;\n\n            if (val !== undefined$1) {\n                that._query(that._pageableQueryOptions({ pageSize: val, page: 1 }));\n                return;\n            }\n\n            return that.take();\n        },\n\n        sort: function(val) {\n            var that = this;\n\n            if (val !== undefined$1) {\n                that.trigger(\"sort\");\n                that._query({ sort: val });\n                return;\n            }\n\n            return that._sort;\n        },\n\n        filter: function(val) {\n            var that = this;\n\n            if (val === undefined$1) {\n                return that._filter;\n            }\n\n            that.trigger(\"reset\");\n            that._query({ filter: val, page: 1 });\n        },\n\n        group: function(val) {\n            var that = this;\n            var options = { group: val };\n\n            if (that._groupPaging) {\n                // clear ranges if ungrouping is performed\n                if (val !== undefined$1 && (!val || !val.length) ) {\n                    that._ranges = [];\n                }\n                options.page = 1;\n            }\n\n            if (val !== undefined$1) {\n                that._query(options);\n                return;\n            }\n\n            return that._group;\n        },\n\n        getGroupsFlat: function(data) {\n            var idx,\n                result = [],\n                length;\n\n            for (idx = 0, length = data.length; idx < length; idx++) {\n                var group = data[idx];\n                if (group.hasSubgroups) {\n                    result = result.concat(this.getGroupsFlat(group.items));\n                }\n\n                result.push(group);\n            }\n\n            return result;\n        },\n\n        total: function() {\n            return parseInt(this._total || 0, 10);\n        },\n\n        groupsTotal: function(includeExpanded) {\n            var that = this;\n\n            if (!that._group.length) {\n                return that.total();\n            }\n\n            if (that._isServerGrouped()) {\n                if (that._serverGroupsTotal) {\n                    return that._serverGroupsTotal;\n                }\n                that._serverGroupsTotal = that.total();\n\n                return that._serverGroupsTotal;\n            }\n\n            return that._calculateGroupsTotal(that._ranges.length ? that._ranges[0].data : [], includeExpanded);\n        },\n\n        _calculateGroupsTotal: function(groups, includeExpanded, itemsField, ignoreState) {\n            var that = this;\n            itemsField = itemsField || \"items\";\n            var total;\n            var length;\n\n            if (that._group.length && groups) {\n                total = 0;\n                length = groups.length;\n\n                for (var i = 0; i < length; i++) {\n                    total += that.groupCount(groups[i], includeExpanded, itemsField, ignoreState);\n                }\n                that._groupsTotal = total;\n                return total;\n            }\n\n            that._groupsTotal = that._data.length;\n            return that._groupsTotal;\n        },\n\n        groupCount: function(group, includeExpanded, itemsField, ignoreState) {\n            var that = this;\n            var total = 0;\n\n            if (group.hasSubgroups && that._groupsState[group.uid]) {\n                if (includeExpanded && !group.excludeHeader || ignoreState) {\n                    total += 1;\n                }\n\n                group[itemsField].forEach(function(subgroup) {\n                    total += that.groupCount(subgroup, includeExpanded, itemsField, ignoreState);\n                });\n            } else {\n                if (that._groupsState[group.uid]) {\n                    if (includeExpanded && !group.excludeHeader || ignoreState) {\n                        total++;\n                    }\n                    total += group[itemsField] ? group[itemsField].length : 0;\n                } else {\n                    total++;\n                }\n            }\n            return total;\n        },\n\n        countGroupRange: function(range) {\n            var total = 0;\n            var length = range.length;\n\n            for (var i = 0; i < length; i++) {\n                total += this.groupCount(range[i], true);\n            }\n\n            return total;\n        },\n\n        aggregate: function(val) {\n            var that = this;\n\n            if (val !== undefined$1) {\n                that._query({ aggregate: val });\n                return;\n            }\n\n            return that._aggregate;\n        },\n\n        aggregates: function() {\n            var result = this._aggregateResult;\n\n            if (isEmptyObject(result)) {\n                result = this._emptyAggregates(this.aggregate());\n            }\n\n            return result;\n        },\n\n        _emptyAggregates: function(aggregates) {\n            var result = {};\n\n            if (!isEmptyObject(aggregates)) {\n                var aggregate = {};\n\n                if (!isArray(aggregates)) {\n                    aggregates = [aggregates];\n                }\n\n                for (var idx = 0; idx < aggregates.length; idx++) {\n                    aggregate[aggregates[idx].aggregate] = 0;\n                    result[aggregates[idx].field] = aggregate;\n                }\n            }\n\n            return result;\n        },\n\n        _pageableQueryOptions: function(options) {\n            return options;\n        },\n\n        _wrapInEmptyGroup: function(model) {\n            var groups = this.group(),\n                parent,\n                group,\n                idx,\n                length;\n\n            for (idx = groups.length - 1, length = 0; idx >= length; idx--) {\n                group = groups[idx];\n                parent = {\n                    value: model.get ? model.get(group.field) : model[group.field],\n                    field: group.field,\n                    items: parent ? [parent] : [model],\n                    hasSubgroups: !!parent,\n                    aggregates: this._emptyAggregates(group.aggregates)\n                };\n            }\n\n            return parent;\n        },\n\n        totalPages: function() {\n            var that = this,\n                pageSize = that.pageSize() || that.total(),\n                total = that._isGroupPaged() ? that.groupsTotal(true) : that.total();\n\n            return math.ceil((total || 0) / pageSize);\n        },\n\n        inRange: function(skip, take) {\n            var that = this,\n                end = math.min(skip + take, that.total());\n\n            if (!that.options.serverPaging && that._data.length > 0) {\n                return true;\n            }\n\n            return that._findRange(skip, end).length > 0;\n        },\n\n        lastRange: function() {\n            var ranges = this._ranges;\n            return ranges[ranges.length - 1] || { start: 0, end: 0, data: [] };\n        },\n\n        firstItemUid: function() {\n            var ranges = this._ranges;\n            return ranges.length && ranges[0].data.length && ranges[0].data[0].uid;\n        },\n\n        enableRequestsInProgress: function() {\n            this._skipRequestsInProgress = false;\n        },\n\n        _timeStamp: function() {\n            return new Date().getTime();\n        },\n\n        range: function(skip, take, callback, action) {\n            this._currentRequestTimeStamp = this._timeStamp();\n            this._skipRequestsInProgress = true;\n            var total = this._isGroupPaged() ? this.groupsTotal(true) : this.total();\n\n            if (action === \"expandGroup\" || action === \"collapseGroup\") {\n                this._updateOuterRangesLength();\n            }\n\n            skip = math.min(skip || 0, total);\n            callback = isFunction(callback) ? callback : noop;\n\n            var that = this,\n                pageSkip = math.max(math.floor(skip / take), 0) * take,\n                size = math.min(pageSkip + take, total),\n                data;\n\n            data = that._findRange(skip, math.min(skip + take, total), callback);\n\n            if ((data.length || total === 0) && !that._fetchingGroupItems) {\n                that._processRangeData(data, skip, take, that._originalPageSkip || pageSkip, that._originalSize || size, {\n                    action: action\n                });\n                that._originalPageSkip = null;\n                that._originalSize = null;\n                callback();\n                return;\n            }\n\n            if (that._isGroupPaged()) {\n                that._originalPageSkip = pageSkip;\n                that._originalSize = size;\n\n                pageSkip = math.max(math.floor(that._adjustPageSkip(skip, take) / take), 0) * take;\n                size = math.min(pageSkip + take, total);\n            }\n\n            if (take !== undefined$1 && !that._fetchingGroupItems) {\n                if ((that._isGroupPaged() && !that._groupRangeExists(pageSkip, take)) || !that._rangeExists(pageSkip, size)) {\n                    that.prefetch(pageSkip, take, function() {\n                        if (skip > pageSkip && size < that.total() && !that._rangeExists(size, math.min(size + take, that.total()))) {\n                            that.prefetch(size, take, function() {\n                                that.range(skip, take, callback );\n                            });\n                        } else {\n                            that.range(skip, take, callback);\n                        }\n                    });\n                } else if (pageSkip < skip) {\n                    that.prefetch(size, take, function() {\n                        that.range(skip, take, callback );\n                    });\n                }\n            }\n        },\n\n        _findRange: function(start, end, callback) {\n            var that = this,\n                ranges = that._ranges,\n                range,\n                data = [],\n                skipIdx,\n                takeIdx,\n                startIndex,\n                endIndex,\n                rangeData,\n                rangeEnd,\n                processed,\n                options = that.options,\n                remote = options.serverSorting || options.serverPaging || options.serverFiltering || options.serverGrouping || options.serverAggregates,\n                flatData,\n                count,\n                length,\n                groupMapOptions = {\n                        take: end - start,\n                        skip: start,\n                        skipped: 0,\n                        taken: 0,\n                        includeParents: true\n                    },\n                prevRangeEnd,\n                isGroupPaged = that._isGroupPaged(),\n                startField = isGroupPaged ? \"outerStart\" : \"start\",\n                endField = isGroupPaged ? \"outerEnd\" : \"end\",\n                currentDataLength;\n\n            for (skipIdx = 0, length = ranges.length; skipIdx < length; skipIdx++) {\n                range = ranges[skipIdx];\n\n                if (isGroupPaged) {\n                    if (range.outerStart >= end) {\n                        return [];\n                    }\n\n                    if (start > range.outerEnd) {\n                        groupMapOptions.skipped += range.outerEnd - (prevRangeEnd || 0);\n                        prevRangeEnd = range.outerEnd;\n                        continue;\n                    }\n\n                    if (typeof prevRangeEnd !== \"undefined\" && prevRangeEnd != range.outerStart) {\n                        groupMapOptions.skipped += range.outerStart - prevRangeEnd;\n                    }\n\n                    if (groupMapOptions.skipped > groupMapOptions.skip) {\n                        return [];\n                    }\n\n                    if (typeof prevRangeEnd === \"undefined\" && start > 0 && range.start > 0) {\n                        groupMapOptions.skipped = range.outerStart;\n                    }\n\n                    takeIdx = skipIdx;\n                    while (true) {\n                        this._findGroupedRange(range.data, data, groupMapOptions, null, callback);\n                        currentDataLength = that._calculateGroupsTotal(data, true, \"currentItems\");\n\n                        if (currentDataLength >= groupMapOptions.take) {\n                            return data;\n                        }\n\n                        if (that._fetchingGroupItems) {\n                            return [];\n                        }\n                        takeIdx++;\n\n                        if (ranges[takeIdx] && ranges[takeIdx].outerStart === range.outerEnd) {\n                            range = ranges[takeIdx];\n                        } else {\n                            break;\n                        }\n                    }\n                } else if (start >= range[startField] && start <= range[endField]) {\n                    count = 0;\n\n                    for (takeIdx = skipIdx; takeIdx < length; takeIdx++) {\n                        range = ranges[takeIdx];\n                        flatData = that._flatData(range.data, true);\n\n                        if (flatData.length && start + count >= range.start) {\n                            rangeData = range.data;\n                            rangeEnd = range.end;\n\n                            if (!remote) {\n                                if (options.inPlaceSort) {\n                                    processed = that._queryProcess(range.data, { filter: that.filter() });\n                                } else {\n                                    var sort = normalizeGroupWithoutCompare(that.group() || []).concat(normalizeSort(that.sort() || []));\n                                    processed = that._queryProcess(range.data, { sort: sort, filter: that.filter() });\n                                }\n                                flatData = rangeData = processed.data;\n\n                                if (processed.total !== undefined$1) {\n                                    rangeEnd = processed.total;\n                                }\n                            }\n\n                            startIndex = 0;\n                            if (start + count > range.start) {\n                                startIndex = (start + count) - range.start;\n                            }\n                            endIndex = flatData.length;\n                            if (rangeEnd > end) {\n                                endIndex = endIndex - (rangeEnd - end);\n                            }\n                            count += endIndex - startIndex;\n                            data = that._mergeGroups(data, rangeData, startIndex, endIndex);\n\n                            if (end <= range.end && count == end - start) {\n                                return data;\n                            }\n                        }\n                    }\n                    break;\n                }\n                prevRangeEnd = range.outerEnd;\n            }\n            return [];\n        },\n\n        _getRangesMismatch: function(pageSkip) {\n            var that = this;\n            var ranges = that._ranges;\n            var mismatch = 0;\n            var i = 0;\n\n            while (true) {\n                var range = ranges[i];\n                if (!range || range.outerStart > pageSkip) {\n                    break;\n                }\n\n                if (range.outerEnd != range.end) {\n                    mismatch = range.outerEnd - range.end;\n                }\n                i++;\n            }\n\n            return mismatch;\n        },\n\n        _mergeGroups: function(data, range, skip, take) {\n            if (this._isServerGrouped()) {\n                var temp = range.toJSON(),\n                    prevGroup;\n\n                if (data.length) {\n                    prevGroup = data[data.length - 1];\n                }\n\n                mergeGroups(prevGroup, temp, skip, take);\n\n                return data.concat(temp);\n            }\n            return data.concat(range.slice(skip, take));\n        },\n\n        _processRangeData: function(data, skip, take, pageSkip, size, eventData) {\n            var that = this;\n\n            that._pending = undefined$1;\n\n            that._skip = skip > that.skip() && !that._omitPrefetch ? math.min(size, (that.totalPages() - 1) * that.take()) : pageSkip;\n\n            that._currentRangeStart = skip;\n\n            that._take = take;\n\n            var paging = that.options.serverPaging;\n            var sorting = that.options.serverSorting;\n            var filtering = that.options.serverFiltering;\n            var aggregates = that.options.serverAggregates;\n            try {\n                that.options.serverPaging = true;\n                if (!that._isServerGrouped() && !(that.group() && that.group().length)) {\n                    that.options.serverSorting = true;\n                }\n                that.options.serverFiltering = true;\n                that.options.serverPaging = true;\n                that.options.serverAggregates = true;\n\n                if (paging) {\n                    that._detachObservableParents();\n                    that._data = data = that._observe(data);\n                }\n                that._process(data, eventData);\n            } finally {\n                that.options.serverPaging = paging;\n                that.options.serverSorting = sorting;\n                that.options.serverFiltering = filtering;\n                that.options.serverAggregates = aggregates;\n            }\n        },\n\n        skip: function() {\n            var that = this;\n\n            if (that._skip === undefined$1) {\n                return (that._page !== undefined$1 ? (that._page - 1) * (that.take() || 1) : undefined$1);\n            }\n            return that._skip;\n        },\n\n        currentRangeStart: function() {\n            return this._currentRangeStart || 0;\n        },\n\n        take: function() {\n            return this._take || this._pageSize;\n        },\n\n        _prefetchSuccessHandler: function(skip, size, callback, force) {\n            var that = this;\n            var timestamp = that._timeStamp();\n\n            return function(data) {\n                var found = false,\n                    range = { start: skip, end: size, data: [], timestamp: that._timeStamp() },\n                    idx,\n                    length,\n                    temp;\n\n                that._dequeueRequest();\n\n                that.trigger(REQUESTEND, { response: data, type: \"read\" });\n\n                data = that.reader.parse(data);\n\n                temp = that._readData(data);\n\n                if (temp.length) {\n                    for (idx = 0, length = that._ranges.length; idx < length; idx++) {\n                        if (that._ranges[idx].start === skip) {\n                            found = true;\n                            range = that._ranges[idx];\n\n                            if (!that._isGroupPaged()) {\n                                range.pristineData = temp;\n                                range.data = that._observe(temp);\n                                range.end = range.start + that._flatData(range.data, true).length;\n                                that._sortRanges();\n                            }\n\n                            break;\n                        }\n                    }\n\n                    if (!found) {\n                        that._addRange(that._observe(temp), skip);\n                    }\n                }\n\n                that._total = that.reader.total(data);\n\n                if (force || (timestamp >= that._currentRequestTimeStamp || !that._skipRequestsInProgress)) {\n                    if (callback && temp.length) {\n                        callback();\n                    } else {\n                        that.trigger(CHANGE, {});\n                    }\n                }\n            };\n        },\n\n        prefetch: function(skip, take, callback) {\n            var that = this,\n                size = math.min(skip + take, that.total()),\n                options = {\n                    take: take,\n                    skip: skip,\n                    page: skip / take + 1,\n                    pageSize: take,\n                    sort: that._sort,\n                    filter: that._filter,\n                    group: that._group,\n                    aggregate: that._aggregate\n                };\n\n\n            if ((that._isGroupPaged() && !that._isServerGrouped() && that._groupRangeExists(skip, size))) {\n                if (callback) {\n                    callback();\n                }\n                return;\n            }\n\n            if ((that._isServerGroupPaged() && !that._groupRangeExists(skip, size)) || !that._rangeExists(skip, size)) {\n                that._queueWithTimeout(options, function() {\n                    if (!that.trigger(REQUESTSTART, { type: \"read\" })) {\n                        if (that._omitPrefetch) {\n                            that.trigger(PROGRESS);\n                        }\n                        that.transport.read({\n                            data: that._params(options),\n                            success: that._prefetchSuccessHandler(skip, size, callback),\n                            error: function() {\n                                var args = slice.call(arguments);\n                                that.error.apply(that, args);\n                            }\n                        });\n                    } else {\n                        that._dequeueRequest();\n                    }\n                }, 100);\n            } else if (callback) {\n                callback();\n            }\n        },\n\n        _multiplePrefetch: function(skip, take, callback) {\n            var that = this,\n                size = math.min(skip + take, that.total()),\n                options = {\n                    take: take,\n                    skip: skip,\n                    page: skip / take + 1,\n                    pageSize: take,\n                    sort: that._sort,\n                    filter: that._filter,\n                    group: that._group,\n                    aggregate: that._aggregate\n                };\n\n            if (!that._rangeExists(skip, size)) {\n                if (!that.trigger(REQUESTSTART, { type: \"read\" })) {\n                    that.transport.read({\n                        data: that._params(options),\n                        success: that._prefetchSuccessHandler(skip, size, callback, true)\n                    });\n                }\n            } else if (callback) {\n                callback();\n            }\n        },\n\n        _adjustPageSkip: function(start, take) {\n            var that = this;\n            var prevRange = that._getPrevRange(start);\n            var result;\n            var total = that.total();\n            var mismatch;\n\n            if (prevRange) {\n                mismatch = that._getRangesMismatch(start);\n\n                if (!mismatch) {\n                    return start;\n                }\n                start -= mismatch;\n            }\n            result = math.max(math.floor(start / take), 0) * take;\n\n            if (result > total) {\n                while (true) {\n                    result -= take;\n                    if (result < total) {\n                        break;\n                    }\n                }\n            }\n            return result;\n        },\n\n        _getNextRange: function(end) {\n            var that = this,\n                ranges = that._ranges,\n                idx,\n                length;\n\n            for (idx = 0, length = ranges.length; idx < length; idx++) {\n                if (ranges[idx].start <= end && ranges[idx].end >= end) {\n                    return ranges[idx];\n                }\n            }\n        },\n\n        _getPrevRange: function(start) {\n            var that = this,\n                ranges = that._ranges,\n                idx,\n                range,\n                length = ranges.length;\n\n            for (idx = length - 1; idx >= 0; idx--) {\n                if (ranges[idx].outerStart <= start) {\n                    range = ranges[idx];\n                    break;\n                }\n\n            }\n\n            return range;\n        },\n\n        _rangeExists: function(start, end) {\n            var that = this,\n                ranges = that._ranges,\n                idx,\n                length;\n\n            for (idx = 0, length = ranges.length; idx < length; idx++) {\n                if (ranges[idx].start <= start && ranges[idx].end >= end) {\n                    return true;\n                }\n            }\n\n            return false;\n        },\n\n        _groupRangeExists: function(start, end) {\n            var that = this,\n                ranges = that._ranges,\n                idx,\n                length,\n                availableItemsCount = 0,\n                total = that.groupsTotal(true);\n\n            if (end > total && !that._isServerGrouped()) {\n                end = total;\n            }\n\n            for (idx = 0, length = ranges.length; idx < length; idx++) {\n                var range = ranges[idx];\n                if (range.outerStart <= start && range.outerEnd >= start) {\n                    availableItemsCount += range.outerEnd - start;\n                } else if (range.outerStart <= end && range.outerEnd >= end) {\n                    availableItemsCount += end - range.outerStart;\n                }\n            }\n\n            return availableItemsCount >= end - start;\n        },\n\n        _getCurrentRangeSpan: function() {\n            var that = this;\n            var ranges = that._ranges;\n            var start = that.currentRangeStart();\n            var end = start + (that.take() || 0);\n            var rangeSpan = [];\n            var range;\n            var idx;\n            var length = ranges.length;\n\n            for (idx = 0; idx < length; idx++) {\n                range = ranges[idx];\n\n                if ((range.start <= start && range.end >= start) || (range.start >= start && range.start <= end)) {\n                    rangeSpan.push(range);\n                }\n            }\n\n            return rangeSpan;\n        },\n\n        _removeModelFromRanges: function(model) {\n            var that = this;\n            var range;\n\n            for (var idx = 0, length = this._ranges.length; idx < length; idx++) {\n                range = this._ranges[idx];\n\n                that._removeModelFromRange(range, model);\n            }\n\n            that._updateRangesLength();\n        },\n\n        _removeModelFromRange: function(range, model) {\n            this._eachItem(range.data, function(data) {\n                if (!data) {\n                    return;\n                }\n                for (var idx = 0; idx < data.length; idx++) {\n                    var dataItem = data[idx];\n\n                    if (dataItem.uid && dataItem.uid == model.uid) {\n                        [].splice.call(data, idx, 1);\n                        break;\n                    }\n                }\n            });\n        },\n\n        _insertModelInRange: function(index, model) {\n            var that = this;\n            var ranges = that._ranges || [];\n            var rangesLength = ranges.length;\n            var range;\n            var i;\n\n            for (i = 0; i < rangesLength; i++) {\n                range = ranges[i];\n\n                if (range.start <= index && range.end >= index) {\n                    if (!that._getByUid(model.uid, range.data)) {\n                        if (that._isServerGrouped()) {\n                            range.data.splice(index, 0, that._wrapInEmptyGroup(model));\n                        } else {\n                            range.data.splice(index, 0, model);\n                        }\n                    }\n\n                    break;\n                }\n            }\n\n            that._updateRangesLength();\n        },\n\n        _updateRangesLength: function() {\n            var that = this;\n            var ranges = that._ranges || [];\n            var rangesLength = ranges.length;\n            var mismatchFound = false;\n            var mismatchLength = 0;\n            var lengthDifference = 0;\n            var rangeLength;\n            var range;\n            var i;\n\n            for (i = 0; i < rangesLength; i++) {\n                range = ranges[i];\n                rangeLength = that._isGroupPaged() ? range.data.length : that._flatData(range.data, true).length;\n                lengthDifference = rangeLength - math.abs(range.end - range.start);\n\n                if (!mismatchFound && lengthDifference !== 0) {\n                    mismatchFound = true;\n                    mismatchLength = lengthDifference;\n                    range.end += mismatchLength;\n                    continue;\n                }\n\n                if (mismatchFound) {\n                    range.start += mismatchLength;\n                    range.end += mismatchLength;\n                }\n            }\n        },\n\n        _updateOuterRangesLength: function() {\n            var that = this;\n            var ranges = that._ranges || [];\n            var rangesLength = ranges.length;\n            var mismatchLength = 0;\n            var range;\n            var i;\n            var prevRange;\n            var rangeLength;\n\n            for (i = 0; i < rangesLength; i++) {\n                range = ranges[i];\n                rangeLength = that._isGroupPaged() ? that._calculateGroupsTotal(range.data, true, \"items\", true) : that._flatData(range.data, true).length;\n\n                if (prevRange) {\n                    if (prevRange.end != range.start) {\n                        mismatchLength = range.start - prevRange.end;\n                    }\n                    range.outerStart = prevRange.outerEnd + mismatchLength;\n                    mismatchLength = 0;\n                } else {\n                    range.outerStart = range.start;\n                }\n\n                range.outerEnd = range.outerStart + rangeLength;\n                prevRange = range;\n            }\n        }\n    });\n\n    var Transport = {};\n\n    Transport.create = function(options, data, dataSource) {\n        var transport,\n            transportOptions = options.transport ? $.extend({}, options.transport) : null;\n\n        if (transportOptions) {\n            transportOptions.read = typeof transportOptions.read === STRING ? { url: transportOptions.read } : transportOptions.read;\n\n            if (options.type === \"jsdo\") {\n                transportOptions.dataSource = dataSource;\n            }\n\n            if (options.type) {\n                kendo.data.transports = kendo.data.transports || {};\n                kendo.data.schemas = kendo.data.schemas || {};\n\n                if (!kendo.data.transports[options.type]) {\n                    kendo.logToConsole(\"Unknown DataSource transport type '\" + options.type + \"'.\\nVerify that registration scripts for this type are included after Kendo UI on the page.\", \"warn\");\n                } else if (!isPlainObject(kendo.data.transports[options.type])) {\n                    transport = new kendo.data.transports[options.type](extend(transportOptions, { data: data }));\n                } else {\n                    transportOptions = extend(true, {}, kendo.data.transports[options.type], transportOptions);\n                }\n\n                options.schema = extend(true, {}, kendo.data.schemas[options.type], options.schema);\n            }\n\n            if (!transport) {\n                transport = isFunction(transportOptions.read) ? transportOptions : new RemoteTransport(transportOptions);\n            }\n        } else {\n            transport = new LocalTransport({ data: options.data || [] });\n        }\n        return transport;\n    };\n\n    DataSource.create = function(options) {\n        if (isArray(options) || options instanceof ObservableArray) {\n           options = { data: options };\n        }\n\n        var dataSource = options || {},\n            data = dataSource.data,\n            fields = dataSource.fields,\n            table = dataSource.table,\n            select = dataSource.select,\n            idx,\n            length,\n            model = {},\n            field;\n\n        if (!data && fields && !dataSource.transport) {\n            if (table) {\n                data = inferTable(table, fields);\n            } else if (select) {\n                data = inferSelect(select, fields);\n\n                if (dataSource.group === undefined$1 && data[0] && data[0].optgroup !== undefined$1) {\n                    dataSource.group = \"optgroup\";\n                }\n            }\n        }\n\n        if (kendo.data.Model && fields && (!dataSource.schema || !dataSource.schema.model)) {\n            for (idx = 0, length = fields.length; idx < length; idx++) {\n                field = fields[idx];\n                if (field.type) {\n                    model[field.field] = field;\n                }\n            }\n\n            if (!isEmptyObject(model)) {\n                dataSource.schema = extend(true, dataSource.schema, { model: { fields: model } });\n            }\n        }\n\n        dataSource.data = data;\n\n        select = null;\n        dataSource.select = null;\n        table = null;\n        dataSource.table = null;\n\n        return dataSource instanceof DataSource ? dataSource : new DataSource(dataSource);\n    };\n\n    function inferSelect(select, fields) {\n        select = $(select)[0];\n        var options = select.options;\n        var firstField = fields[0];\n        var secondField = fields[1];\n\n        var data = [];\n        var idx, length;\n        var optgroup;\n        var option;\n        var record;\n        var value;\n\n        for (idx = 0, length = options.length; idx < length; idx++) {\n            record = {};\n            option = options[idx];\n            optgroup = option.parentNode;\n\n            if (optgroup === select) {\n                optgroup = null;\n            }\n\n            if (option.disabled || (optgroup && optgroup.disabled)) {\n                continue;\n            }\n\n            if (optgroup) {\n                record.optgroup = optgroup.label;\n            }\n\n            record[firstField.field] = option.text;\n\n            value = option.attributes.value;\n\n            if (value && value.specified) {\n                value = option.value;\n            } else {\n                value = option.text;\n            }\n\n            record[secondField.field] = value;\n\n            data.push(record);\n        }\n\n        return data;\n    }\n\n    function inferTable(table, fields) {\n        var tbody = $(table)[0].tBodies[0],\n        rows = tbody ? tbody.rows : [],\n        idx,\n        length,\n        fieldIndex,\n        fieldCount = fields.length,\n        data = [],\n        cells,\n        record,\n        cell,\n        empty;\n\n        for (idx = 0, length = rows.length; idx < length; idx++) {\n            record = {};\n            empty = true;\n            cells = rows[idx].cells;\n\n            for (fieldIndex = 0; fieldIndex < fieldCount; fieldIndex++) {\n                cell = cells[fieldIndex];\n                if (cell.nodeName.toLowerCase() !== \"th\") {\n                    empty = false;\n                    record[fields[fieldIndex].field] = cell.innerHTML;\n                }\n            }\n            if (!empty) {\n                data.push(record);\n            }\n        }\n\n        return data;\n    }\n\n    var Node = Model.define({\n        idField: \"id\",\n\n        init: function(value) {\n            var that = this,\n                hasChildren = that.hasChildren || value && value.hasChildren,\n                childrenField = \"items\",\n                childrenOptions = {};\n\n            kendo.data.Model.fn.init.call(that, value);\n\n            if (typeof that.children === STRING) {\n                childrenField = that.children;\n            }\n\n            childrenOptions = {\n                schema: {\n                    data: childrenField,\n                    model: {\n                        hasChildren: hasChildren,\n                        id: that.idField,\n                        fields: that.fields\n                    }\n                }\n            };\n\n            if (typeof that.children !== STRING) {\n                extend(childrenOptions, that.children);\n            }\n\n            childrenOptions.data = value;\n\n            if (!hasChildren) {\n                hasChildren = childrenOptions.schema.data;\n            }\n\n            if (typeof hasChildren === STRING) {\n                hasChildren = kendo.getter(hasChildren);\n            }\n\n            if (isFunction(hasChildren)) {\n                var hasChildrenObject = hasChildren.call(that, that);\n\n                if (hasChildrenObject && hasChildrenObject.length === 0) {\n                    that.hasChildren = false;\n                } else {\n                    that.hasChildren = !!hasChildrenObject;\n                }\n            }\n\n            that._childrenOptions = childrenOptions;\n\n            if (that.hasChildren) {\n                that._initChildren();\n            }\n\n            that._loaded = !!(value && value._loaded);\n        },\n\n        _initChildren: function() {\n            var that = this;\n            var children, transport, parameterMap;\n\n            if (!(that.children instanceof HierarchicalDataSource)) {\n                children = that.children = new HierarchicalDataSource(that._childrenOptions);\n\n                transport = children.transport;\n                parameterMap = transport.parameterMap;\n\n                transport.parameterMap = function(data, type) {\n                    data[that.idField || \"id\"] = that.id;\n\n                    if (parameterMap) {\n                        data = parameterMap.call(that, data, type);\n                    }\n\n                    return data;\n                };\n\n                children.parent = function() {\n                    return that;\n                };\n\n                children.bind(CHANGE, function(e) {\n                    e.node = e.node || that;\n                    that.trigger(CHANGE, e);\n                });\n\n                children.bind(ERROR, function(e) {\n                    var collection = that.parent();\n\n                    if (collection) {\n                        e.node = e.node || that;\n                        collection.trigger(ERROR, e);\n                    }\n                });\n\n                children.bind(ITEMSLOADED, function(e) {\n                    var collection = that.parent();\n\n                    if (collection) {\n                        collection.trigger(ITEMSLOADED, e);\n                    }\n                });\n\n                that._updateChildrenField();\n            }\n        },\n\n        append: function(model) {\n            this._initChildren();\n            this.loaded(true);\n            this.children.add(model);\n        },\n\n        hasChildren: false,\n\n        level: function() {\n            var parentNode = this.parentNode(),\n                level = 0;\n\n            while (parentNode && parentNode.parentNode) {\n                level++;\n                parentNode = parentNode.parentNode ? parentNode.parentNode() : null;\n            }\n\n            return level;\n        },\n\n        _updateChildrenField: function() {\n            var fieldName = this._childrenOptions.schema.data;\n\n            this[fieldName || \"items\"] = this.children.data();\n        },\n\n        _childrenLoaded: function() {\n            this._loaded = true;\n\n            this._updateChildrenField();\n        },\n\n        load: function() {\n            var options = {};\n            var method = \"_query\";\n            var children, promise;\n\n            if (this.hasChildren) {\n                this._initChildren();\n\n                children = this.children;\n\n                options[this.idField || \"id\"] = this.id;\n\n                if (!this._loaded) {\n                    children._data = undefined$1;\n                    method = \"read\";\n                }\n\n                children.one(CHANGE, this._childrenLoaded.bind(this));\n\n                if (this._matchFilter) {\n                    options.filter = { field: '_matchFilter', operator: 'eq', value: true };\n                }\n\n                promise = children[method](options);\n                if (!this._loaded) {\n                    this.trigger(ITEMLOAD, { promise: promise, node: this });\n                }\n            } else {\n                this.loaded(true);\n            }\n\n            return promise || $.Deferred().resolve().promise();\n        },\n\n        parentNode: function() {\n            var array = this.parent();\n\n            return array.parent();\n        },\n\n        loaded: function(value) {\n            if (value !== undefined$1) {\n                this._loaded = value;\n            } else {\n                return this._loaded;\n            }\n        },\n\n        shouldSerialize: function(field) {\n            return Model.fn.shouldSerialize.call(this, field) &&\n                    field !== \"children\" &&\n                    field !== \"_loaded\" &&\n                    field !== \"hasChildren\" &&\n                    field !== \"_childrenOptions\";\n        }\n    });\n\n    function dataMethod(name) {\n        return function() {\n            var data = this._data,\n                result = DataSource.fn[name].apply(this, slice.call(arguments));\n\n            if (this._data != data) {\n                this._attachBubbleHandlers();\n            }\n\n            return result;\n        };\n    }\n\n    var HierarchicalDataSource = DataSource.extend({\n        init: function(options) {\n            var node = Node.define({\n                children: options\n            });\n\n            if (options.filter && !options.serverFiltering) {\n                this._hierarchicalFilter = options.filter;\n                options.filter = null;\n            }\n\n            DataSource.fn.init.call(this, extend(true, {}, { schema: { modelBase: node, model: node } }, options));\n\n            this._attachBubbleHandlers();\n        },\n\n        _attachBubbleHandlers: function() {\n            var that = this;\n\n            that._data.bind(ERROR, function(e) {\n                that.trigger(ERROR, e);\n            });\n\n            that._data.bind(ITEMSLOADED, function(e) {\n                that.trigger(ITEMSLOADED, e);\n            });\n        },\n\n        loading: function() {\n            if (this._data) {\n                return this._data.loading() || this._childrenLoading();\n            }\n            return false;\n        },\n\n        _childrenLoading: function() {\n            var isLoading = false;\n            this._data.forEach(function(node) {\n                if (node.hasChildren && node.children.loading()) {\n                    isLoading = true;\n                }\n            });\n            return isLoading;\n        },\n\n        read: function(data) {\n            var result = DataSource.fn.read.call(this, data);\n\n            if (this._hierarchicalFilter) {\n                if (this._data && this._data.length > 0) {\n                    this.filter(this._hierarchicalFilter);\n                } else {\n                    this.options.filter = this._hierarchicalFilter;\n                    this._filter = normalizeFilter(this.options.filter);\n                    this._hierarchicalFilter = null;\n                }\n            }\n\n            return result;\n        },\n\n        remove: function(node) {\n            var parentNode = node.parentNode(),\n                dataSource = this,\n                result;\n\n            if (parentNode && parentNode._initChildren) {\n                dataSource = parentNode.children;\n            }\n\n            result = DataSource.fn.remove.call(dataSource, node);\n\n            if (parentNode && !dataSource.data().length) {\n                parentNode.hasChildren = false;\n            }\n\n            return result;\n        },\n\n        success: dataMethod(\"success\"),\n\n        data: dataMethod(\"data\"),\n\n        insert: function(index, model) {\n            var parentNode = this.parent();\n\n            if (parentNode && parentNode._initChildren) {\n                parentNode.hasChildren = true;\n                parentNode._initChildren();\n            }\n\n            return DataSource.fn.insert.call(this, index, model);\n        },\n\n        filter: function(val) {\n            if (val === undefined$1) {\n                 return this._filter;\n            }\n\n            if (!this.options.serverFiltering && this._markHierarchicalQuery(val)) {\n                val = { logic: \"or\", filters: [val, { field: '_matchFilter', operator: 'equals', value: true }] };\n            }\n\n            this.trigger(\"reset\");\n            this._query({ filter: val, page: 1 });\n        },\n\n        _markHierarchicalQuery: function(expressions) {\n            var compiled;\n            var accentFoldingFiltering = this.options.accentFoldingFiltering;\n\n            expressions = accentFoldingFiltering ? $.extend({}, normalizeFilter(expressions), { accentFoldingFiltering: accentFoldingFiltering }) : normalizeFilter(expressions);\n\n            if (!expressions || expressions.filters.length === 0) {\n                this._updateHierarchicalFilter(function() {return true;});\n                return false;\n            }\n\n            compiled = Query.filterExpr(expressions, { noEval: true });\n\n            this._updateHierarchicalFilter(compiled);\n            return true;\n        },\n\n         _updateHierarchicalFilter: function(filter) {\n            var current;\n            var data = this._data;\n            var result = false;\n\n            for (var idx = 0; idx < data.length; idx++) {\n                 current = data[idx];\n\n                 if (current.hasChildren) {\n                     current._matchFilter = current.children._updateHierarchicalFilter(filter);\n                    if (!current._matchFilter) {\n                        current._matchFilter = filter(current);\n                    }\n                } else {\n                    current._matchFilter = filter(current);\n                }\n\n                if (current._matchFilter) {\n                    result = true;\n                }\n            }\n            return result;\n        },\n\n        _find: function(method, value) {\n            var idx, length, node, children;\n            var data = this._data;\n\n            if (!data) {\n                return;\n            }\n\n            node = DataSource.fn[method].call(this, value);\n\n            if (node) {\n                return node;\n            }\n\n            data = this._flatData(this._data);\n\n            for (idx = 0, length = data.length; idx < length; idx++) {\n                children = data[idx].children;\n\n                if (!(children instanceof HierarchicalDataSource)) {\n                    continue;\n                }\n\n                node = children[method](value);\n\n                if (node) {\n                    return node;\n                }\n            }\n        },\n\n        get: function(id) {\n            return this._find(\"get\", id);\n        },\n\n        getByUid: function(uid) {\n            return this._find(\"getByUid\", uid);\n        }\n    });\n\n    function inferList(list, fields) {\n        var items = $(list).children(),\n            idx,\n            length,\n            data = [],\n            record,\n            textField = fields[0].field,\n            urlField = fields[1] && fields[1].field,\n            spriteCssClassField = fields[2] && fields[2].field,\n            imageUrlField = fields[3] && fields[3].field,\n            item,\n            id,\n            textChild,\n            className,\n            children;\n\n        function elements(collection, tagName) {\n            return collection.filter(tagName).add(collection.find(tagName));\n        }\n\n        for (idx = 0, length = items.length; idx < length; idx++) {\n            record = { _loaded: true };\n            item = items.eq(idx);\n\n            textChild = item[0].firstChild;\n            children = item.children();\n            list = children.filter(\"ul\");\n            children = children.filter(\":not(ul)\");\n\n            id = item.attr(\"data-id\");\n\n            if (id) {\n                record.id = id;\n            }\n\n            if (textChild) {\n                record[textField] = textChild.nodeType == 3 ? textChild.nodeValue : children.text();\n            }\n\n            if (urlField) {\n                record[urlField] = elements(children, \"a\").attr(\"href\");\n            }\n\n            if (imageUrlField) {\n                record[imageUrlField] = elements(children, \"img\").attr(\"src\");\n            }\n\n            if (spriteCssClassField) {\n                className = elements(children, \".k-sprite\").prop(\"className\");\n                record[spriteCssClassField] = className && kendo.trim(className.replace(\"k-sprite\", \"\"));\n            }\n\n            if (list.length) {\n                record.items = inferList(list.eq(0), fields);\n            }\n\n            if (item.attr(\"data-hasChildren\") == \"true\") {\n                record.hasChildren = true;\n            }\n\n            data.push(record);\n        }\n\n        return data;\n    }\n\n    HierarchicalDataSource.create = function(options) {\n        options = options && options.push ? { data: options } : options;\n\n        var dataSource = options || {},\n            data = dataSource.data,\n            fields = dataSource.fields,\n            list = dataSource.list;\n\n        if (data && data._dataSource) {\n            return data._dataSource;\n        }\n\n        if (!data && fields && !dataSource.transport) {\n            if (list) {\n                data = inferList(list, fields);\n            }\n        }\n\n        dataSource.data = data;\n\n        return dataSource instanceof HierarchicalDataSource ? dataSource : new HierarchicalDataSource(dataSource);\n    };\n\n    var Buffer = kendo.Observable.extend({\n        init: function(dataSource, viewSize, disablePrefetch) {\n            kendo.Observable.fn.init.call(this);\n\n            this._prefetching = false;\n            this.dataSource = dataSource;\n            this.prefetch = !disablePrefetch;\n\n            var buffer = this;\n\n            dataSource.bind(\"change\", function() {\n                buffer._change();\n            });\n\n            dataSource.bind(\"reset\", function() {\n                buffer._reset();\n            });\n\n            this._syncWithDataSource();\n\n            this.setViewSize(viewSize);\n        },\n\n        setViewSize: function(viewSize) {\n            this.viewSize = viewSize;\n            this._recalculate();\n        },\n\n        at: function(index) {\n            var pageSize = this.pageSize,\n                itemPresent = true;\n\n            if (index >= this.total()) {\n                this.trigger(\"endreached\", { index: index });\n                return null;\n            }\n\n            if (!this.useRanges) {\n               return this.dataSource.view()[index];\n            }\n            if (this.useRanges) {\n                // out of range request\n                if (index < this.dataOffset || index >= this.skip + pageSize) {\n                    itemPresent = this.range(Math.floor(index / pageSize) * pageSize);\n                }\n\n                // prefetch\n                if (index === this.prefetchThreshold) {\n                    this._prefetch();\n                }\n\n                // mid-range jump - prefetchThreshold and nextPageThreshold may be equal, do not change to else if\n                if (index === this.midPageThreshold) {\n                    this.range(this.nextMidRange, true);\n                }\n                // next range jump\n                else if (index === this.nextPageThreshold) {\n                    this.range(this.nextFullRange);\n                }\n                // pull-back\n                else if (index === this.pullBackThreshold) {\n                    if (this.offset === this.skip) { // from full range to mid range\n                        this.range(this.previousMidRange);\n                    } else { // from mid range to full range\n                        this.range(this.previousFullRange);\n                    }\n                }\n\n                if (itemPresent) {\n                    return this.dataSource.at(index - this.dataOffset);\n                } else {\n                    this.trigger(\"endreached\", { index: index });\n                    return null;\n                }\n            }\n        },\n\n        indexOf: function(item) {\n            return this.dataSource.data().indexOf(item) + this.dataOffset;\n        },\n\n        total: function() {\n            return parseInt(this.dataSource.total(), 10);\n        },\n\n        next: function() {\n            var buffer = this,\n                pageSize = buffer.pageSize,\n                offset = buffer.skip - buffer.viewSize + pageSize,\n                pageSkip = math.max(math.floor(offset / pageSize), 0) * pageSize;\n\n            this.offset = offset;\n            this.dataSource.prefetch(pageSkip, pageSize, function() {\n                buffer._goToRange(offset, true);\n            });\n        },\n\n        range: function(offset, nextRange) {\n            if (this.offset === offset) {\n                return true;\n            }\n\n            var buffer = this,\n                pageSize = this.pageSize,\n                pageSkip = math.max(math.floor(offset / pageSize), 0) * pageSize,\n                dataSource = this.dataSource;\n\n            if (nextRange) {\n                pageSkip += pageSize;\n            }\n\n            if (dataSource.inRange(offset, pageSize)) {\n                this.offset = offset;\n                this._recalculate();\n                this._goToRange(offset);\n                return true;\n            } else if (this.prefetch) {\n                dataSource.prefetch(pageSkip, pageSize, function() {\n                    buffer.offset = offset;\n                    buffer._recalculate();\n                    buffer._goToRange(offset, true);\n                });\n                return false;\n            }\n\n            return true;\n        },\n\n        syncDataSource: function() {\n            var offset = this.offset;\n            this.offset = null;\n            this.range(offset);\n        },\n\n        destroy: function() {\n            this.unbind();\n        },\n\n        _prefetch: function() {\n            var buffer = this,\n                pageSize = this.pageSize,\n                prefetchOffset = this.skip + pageSize,\n                dataSource = this.dataSource;\n\n            if (!dataSource.inRange(prefetchOffset, pageSize) && !this._prefetching && this.prefetch) {\n                this._prefetching = true;\n                this.trigger(\"prefetching\", { skip: prefetchOffset, take: pageSize });\n\n                dataSource.prefetch(prefetchOffset, pageSize, function() {\n                    buffer._prefetching = false;\n                    buffer.trigger(\"prefetched\", { skip: prefetchOffset, take: pageSize });\n                });\n            }\n        },\n\n        _goToRange: function(offset, expanding) {\n            if (this.offset !== offset) {\n                return;\n            }\n\n            this.dataOffset = offset;\n            this._expanding = expanding;\n            this.dataSource.range(offset, this.pageSize);\n            this.dataSource.enableRequestsInProgress();\n        },\n\n        _reset: function() {\n            this._syncPending = true;\n        },\n\n        _change: function() {\n            var dataSource = this.dataSource;\n\n            this.length = this.useRanges ? dataSource.lastRange().end : dataSource.view().length;\n\n            if (this._syncPending) {\n                this._syncWithDataSource();\n                this._recalculate();\n                this._syncPending = false;\n                this.trigger(\"reset\", { offset: this.offset });\n            }\n\n            this.trigger(\"resize\");\n\n            if (this._expanding) {\n                this.trigger(\"expand\");\n            }\n\n            delete this._expanding;\n        },\n\n        _syncWithDataSource: function() {\n            var dataSource = this.dataSource;\n\n            this._firstItemUid = dataSource.firstItemUid();\n            this.dataOffset = this.offset = dataSource.skip() || 0;\n            this.pageSize = dataSource.pageSize();\n            this.useRanges = dataSource.options.serverPaging;\n        },\n\n        _recalculate: function() {\n            var pageSize = this.pageSize,\n                offset = this.offset,\n                viewSize = this.viewSize,\n                skip = Math.ceil(offset / pageSize) * pageSize;\n\n            this.skip = skip;\n            this.midPageThreshold = skip + pageSize - 1;\n            this.nextPageThreshold = skip + viewSize - 1;\n            this.prefetchThreshold = skip + Math.floor(pageSize / 3 * 2);\n            this.pullBackThreshold = this.offset - 1;\n\n            this.nextMidRange = skip + pageSize - viewSize;\n            this.nextFullRange = skip;\n            this.previousMidRange = offset - viewSize;\n            this.previousFullRange = skip - pageSize;\n        }\n    });\n\n    var BatchBuffer = kendo.Observable.extend({\n        init: function(dataSource, batchSize) {\n            var batchBuffer = this;\n\n            kendo.Observable.fn.init.call(batchBuffer);\n\n            this.dataSource = dataSource;\n            this.batchSize = batchSize;\n            this._total = 0;\n\n            this.buffer = new Buffer(dataSource, batchSize * 3);\n\n            this.buffer.bind({\n                \"endreached\": function(e) {\n                    batchBuffer.trigger(\"endreached\", { index: e.index });\n                },\n                \"prefetching\": function(e) {\n                    batchBuffer.trigger(\"prefetching\", { skip: e.skip, take: e.take });\n                },\n                \"prefetched\": function(e) {\n                    batchBuffer.trigger(\"prefetched\", { skip: e.skip, take: e.take });\n                },\n                \"reset\": function() {\n                    batchBuffer._total = 0;\n                    batchBuffer.trigger(\"reset\");\n                },\n                \"resize\": function() {\n                    batchBuffer._total = Math.ceil(this.length / batchBuffer.batchSize);\n                    batchBuffer.trigger(\"resize\", { total: batchBuffer.total(), offset: this.offset });\n                }\n            });\n        },\n\n        syncDataSource: function() {\n            this.buffer.syncDataSource();\n        },\n\n        at: function(index) {\n            var buffer = this.buffer,\n                skip = index * this.batchSize,\n                take = this.batchSize,\n                view = [],\n                item;\n\n            if (buffer.offset > skip) {\n                buffer.at(buffer.offset - 1);\n            }\n\n            for (var i = 0; i < take; i++) {\n                item = buffer.at(skip + i);\n\n                if (item === null) {\n                    break;\n                }\n\n                view.push(item);\n            }\n\n            return view;\n        },\n\n        total: function() {\n            return this._total;\n        },\n\n        destroy: function() {\n            this.buffer.destroy();\n            this.unbind();\n        }\n    });\n\n    extend(true, kendo.data, {\n        readers: {\n            json: DataReader\n        },\n        Query: Query,\n        DataSource: DataSource,\n        HierarchicalDataSource: HierarchicalDataSource,\n        Node: Node,\n        Comparer: Comparer,\n        ObservableObject: ObservableObject,\n        ObservableArray: ObservableArray,\n        LazyObservableArray: LazyObservableArray,\n        LocalTransport: LocalTransport,\n        RemoteTransport: RemoteTransport,\n        Cache: Cache,\n        DataReader: DataReader,\n        Model: Model,\n        Buffer: Buffer,\n        BatchBuffer: BatchBuffer\n    });\n})(window.kendo.jQuery);\nvar kendo$1 = kendo;\n\nexport { __meta__, kendo$1 as default };\n"]}