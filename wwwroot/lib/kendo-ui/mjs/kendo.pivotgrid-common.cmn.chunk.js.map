{"version":3,"file":"kendo.pivotgrid-common.cmn.chunk.js","names":["compileFilter","__meta__","id","name","category","description","depends","hidden","chunk","filterFunctionFormats","contains","doesnotcontain","endswith","eq","neq","startswith","operators","in","serializeFilters","filters","cube","command","current","idx","length","serializeExpression","expression","value","String","field","operator","formatString","str","values","_i","arguments","forEach","index","replace","RegExp","serializeMembers","members","measures","sort","memberName","parsed","parseDescriptors","expanded","rootNames","getRootNames","root","crossJoinCommands","names","push","crossJoinCommand","mapNames","expandMemberDescriptor","join","concat","measureNames","measure","result","undefined","member","hierarchyName","baseHierarchyPath","some","n","indexOf","found","child","name_1","j","l","expand","rootLength","slice","name_2","rootName","tmp","crossJoin","sortDescriptor","sortDescriptorForMember","dir","length_1","parts","split","pop","shift","createRequestBody","options","_a","columnAxes","_b","rowAxes","_c","measureAxes","_d","_e","filter","measuresRowAxis","measuresAxis","connection","catalog","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","__assign","assign","t","s","i","call","apply","__rest","e","getOwnPropertySymbols","propertyIsEnumerable","__decorate","decorators","target","key","desc","c","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__param","paramIndex","decorator","__metadata","metadataKey","metadataValue","metadata","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","v","op","TypeError","__createBinding","o","m","k","k2","__exportStar","exports","__values","__read","ar","error","__spread","__spreadArrays","il","a","jl","__await","__asyncGenerator","asyncIterator","q","resume","fulfill","settle","__asyncDelegator","__asyncValues","__makeTemplateObject","cooked","raw","__importStar","mod","__esModule","default","__importDefault","__classPrivateFieldGet","receiver","privateMap","has","get","__classPrivateFieldSet","set","parseResponse","response","xmlDoc","DOMParser","parseFromString","axes","from","querySelectorAll","cells","map","cell","fmtValue","getPropertyValue","ordinal","parseInt","getAttribute","columns","tuples","rows","data","axis","translateAxis","indexedData","fill","counter","rowTuple","colTuple","columnTuple","node","querySelector","textContent","tuple","lNum","hasChildren","caption","children","hierarchy","levelName","levelNum","parentName","discoverCommands","schemaCatalogs","schemaCubes","schemaDimensions","schemaHierarchies","schemaKPIs","schemaLevels","schemaMeasures","schemaMembers","createDiscoverBody","properties","serializeOptions","restrictions","Catalog","parentTagName","capitalize","toUpperCase","parseCubes","row","type","parseCatalogs","parseMeasures","uniqueName","aggregator","groupName","displayFolder","defaultFormat","parseKPIs","goal","status","trend","statusGraphic","trendGraphic","parseDimensions","defaultHierarchy","parseHierarchies","dimensionUniqueName","origin","defaultMember","parseLevels","orderingProperty","hierarchyUniqueName","parseMembers","levelUniqueName","childrenCardinality","_this","discoverParser","fetchData","fetchOptions","init","headers","method","fetch","url","text","fetchDiscover","stringResponse","isMeasure","getMaxNesting","Set","add","size","getMaxExpansion","generateNormalizedPath","parent","normalizedPath","Boolean","generatePath","path","toMatrix","rowIndex","colIndex","maxDepth","maxBreadth","matrix","leafs","branchDepth","branchBreadth","depth","breadth","matrixResult","leafsResult","findIndex","level","inject","total","splice","collOffset","newMatrix","newLeafs","childBreadth","withTotal","alt","childIndex","childHierarchy","toTree","every","tupleIndex","copy","_loop_1","memberIndex","parent_1","parentKey","keys","find","intruderIndex","toData","hash","membersNames","columnsIndexes","Map","rowsIndexes","colMembers","rowMembers","item","rotateMatrix","rowSpan","colSpan","toColumns","toRows","cloneDate","date","Date","getTime","clone","obj","cloneObject","cloneValue","nextValue","isArray","cloneArray","newNextValue","JSON","parse","stringify","array","kpiMeasure","kpi","buildKPIMeasures","addKPI","compareAxisWithField","compareAxes","filterField","out","_loop_2","startsWith","duplicatedAxisIndex","ax","insertAxis","toInsert","state","dropTarget","dropDirection","offset","reverseColumnsByMeasures","firstColumn","lastMember","columnsArr","measuresCount","col","result_1","arr","reverse","createDataState","createAxisDescriptors","expandTree","descriptors","HEADERS_ACTION","setSort","setFilter","PIVOT_CONFIGURATOR_ACTION","findPath","matchFn","matched","match","h","headersReducer","action","toggle","existing","payload","collapse","existing_1","nextState","filtered_1","tree","configuratorReducer","newRows","newColumns","newMeasures","newSort","newFilter","newDragitem","newDropZone","newDropDirection","newDropTarget","toggleSelection","payload_1","removeMeasureAxis","addMeasureAxis","removeMeasureAxes","addMeasureAxes","removeColumnAxis","removeRowAxis","addColumnAxis","addRowAxis","addColumnAxes","removeColumnAxes","addRowAxes","removeRowAxes","remove","setDragItem","setDropZone","setDropTarget","setDropDirection","drop","dragItem","dropZone","currentColumn","currentRow","currentMeasure","addFilter","changeFilter","removeFilter","sumAggregate","sum","merge","src","dest","accumulate","acc","format","toFixed","countAggregate","countA","_value","minAggregate","min","Number","POSITIVE_INFINITY","Math","isFinite","NaN","maxAggregate","max","NEGATIVE_INFINITY","averageAggregate","sumA","count","forEachDesc","callbackfn","filterFields","callback","initializeFiltering","compositeFilter","logic","predicate","fieldValues","hasFilter","filteringAxes","filteringFields_1","subNode","initialNode","childNode","separator","createKey","splitKeyValue","keyValue","separatorIndex","substring","calculateColumnData","dataField","childData_1","parentData_1","aggregate","mergeTrees","srcChild","destChild","calculateColumns","columnsData","srcColumns","destColumns","createDataTree","fields","cache","leafNodes","dataItem","filteringDataItem_1","displayValue","dataKey","nodeData","node_1","eachAxis","leaf","cloneDataTree","dataTree","createPath","caption_1","membersNode","axisSettings","cacheData","currentLevel","currentLevelNode","levelField_1","newDest","currentPath","readData","rowTuples","columnTuples","columnSettings","rowSettings","rowsCache","rowNode","rowColumnsNode","measuresMember_1","colNode","getTopMembersTuple","parentFields","axesSettings","allTuple","topField","sortFunc","descriptor","axe","order","sortableA","sortValue","sortableB","mergeData","exclude","childrenByKeys","element","curLevel_1","rootFields","definitions","createTuples","sortDescriptors","excludeFields","flatMembers","topTuple","currDef","keysToAdd","currDefMembers","delete","leafValue","leafTuple","axisCaption","curCaption","measureToMember","addMeasure","measureMember","tupleCopy","addMultipleMeasures","tupleWithMeasure","createLocalDataState","args","colTuples","createFlatSchemaDimensions","dimensions","dim","Navigation","tabIndex","eventHandlers","update","selectors","enumerable","configurable","all","elements","el","matches","start","eventType","this_1","mouseEvents","ev","Element","closest","addEventListener","this_2","keyboardEvents","stop","removeEventListener","focusElement","previous","removeAttribute","classList","setAttribute","focus","preventScroll","scrollableValuesSel","scrollableColumnHeaderSel","scrollableRowHeaderSel","emptyCellSel","tableSel","cellSel","scrollables","selectors$1","onEnter","nav","icon","index_1","click","preventDefault","tryScrollLeft","scrollable","elToScroll","offsetLeft","scrollLeft","tryScrollRight","offsetWidth","tryScrollUp","scrollTop","offsetTop","tryScrollDown","offsetHeight","scrollTo","scrollFunc","scroll","tableMap","table","colsCount","reduce","prev","cur","curColSpan","colSp","rowSp","ind","val","curInd","navigationMap","columnHeader","rowHeader","emptyCell","emptyCellRow","getTargetPos","ctrlKey","metaKey","cellAt","pos","targetPos","nextPos","keyboardEvents$1","keydown","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","_target","_ev","nextElementSibling","HTMLElement","setTimeout","parentNode","confHeader","Enter","Space","Home","ro","x","End","mouseEvents$1","hasAttribute","PivotGridNavigation","_super","onEscape","pivot","previousElementSibling","confButton","pivotCell","navigate","onDelete","Tab","shiftKey","Escape","Delete","Backspace","ConfiguratorNavigation"],"sources":["kendo.pivotgrid-common.cmn.chunk.js"],"mappings":"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","ignoreList":[],"sourcesContent":["import { c as compileFilter } from './kendo.data-query.cmn.chunk.js';\n\nconst __meta__ = {\n    id: \"pivotgrid-common.cmn.chunk\",\n    name: \"PivotgridCommonCmnChunk\",\n    category: \"web\",\n    description: \"A reusable outputed chunk of code\",\n    depends: ['data-query.cmn.chunk'],\n    hidden: true,\n    chunk: true\n};\n\n\n\nvar filterFunctionFormats = {\n    contains: \", InStr({0}.CurrentMember.MEMBER_CAPTION,\\\"{1}\\\") > 0\",\n    doesnotcontain: \", InStr({0}.CurrentMember.MEMBER_CAPTION,\\\"{1}\\\")\",\n    endswith: \", Right({0}.CurrentMember.MEMBER_CAPTION,Len(\\\"{1}\\\"))=\\\"{1}\\\"\",\n    eq: \", {0}.CurrentMember.MEMBER_CAPTION = \\\"{1}\\\"\",\n    neq: \", {0}.CurrentMember.MEMBER_CAPTION = \\\"{1}\\\"\",\n    startswith: \", Left({0}.CurrentMember.MEMBER_CAPTION,Len(\\\"{1}\\\"))=\\\"{1}\\\"\"\n};\nvar operators = {\n    doesnotcontain: 'doesnotcontain',\n    in: 'in',\n    neq: \"neq\"\n};\n/**\n * @hidden\n */\nfunction serializeFilters(filters, cube) {\n    var command = \"\";\n    var current = \"\";\n    for (var idx = filters.length - 1; idx >= 0; idx--) {\n        current = \"SELECT (\";\n        current += serializeExpression(filters[idx]);\n        current += \") ON 0\";\n        if (idx === filters.length - 1) {\n            current += \" FROM [\" + cube + \"]\";\n            command = current;\n        }\n        else {\n            command = current + \" FROM ( \" + command + \" )\";\n        }\n    }\n    return command;\n}\nfunction serializeExpression(expression) {\n    var command = '';\n    var value = String(expression.value);\n    var field = expression.field;\n    var operator = expression.operator;\n    if (operator === operators.in) {\n        command += \"{\";\n        command += value;\n        command += \"}\";\n    }\n    else {\n        command += operator === operators.neq || operator === operators.doesnotcontain ? '-' : '';\n        command += \"Filter(\";\n        command += field + \".MEMBERS\";\n        command += formatString(filterFunctionFormats[operator], field, value);\n        command += \")\";\n    }\n    return command;\n}\nfunction formatString(str) {\n    var values = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        values[_i - 1] = arguments[_i];\n    }\n    values.forEach(function (value, index) {\n        str = str.replace(new RegExp(\"\\\\{\" + index + \"\\\\}\", 'g'), value);\n    });\n    return str;\n}\n\n/**\n * @hidden\n */\nfunction serializeMembers(members, measures, sort) {\n    var command = \"\";\n    members = members || [];\n    var parsed = parseDescriptors(members);\n    var expanded = parsed.expanded;\n    var rootNames = getRootNames(parsed.root);\n    var crossJoinCommands = [];\n    var length = expanded.length;\n    var idx = 0;\n    var memberName;\n    var names = [];\n    if (rootNames.length > 1 || measures.length > 1) {\n        crossJoinCommands.push(crossJoinCommand(rootNames, measures));\n        for (; idx < length; idx++) {\n            memberName = expandMemberDescriptor(expanded[idx].name, sort);\n            names = mapNames(memberName, rootNames);\n            crossJoinCommands.push(crossJoinCommand(names, measures));\n        }\n        command += crossJoinCommands.join(\",\");\n    }\n    else {\n        for (; idx < length; idx++) {\n            memberName = expandMemberDescriptor(expanded[idx].name, sort);\n            names.push(memberName[0]);\n        }\n        command += rootNames.concat(names).join(\",\");\n    }\n    return command;\n}\n/**\n * @hidden\n */\nfunction measureNames(measures) {\n    var length = measures.length;\n    var result = [];\n    var measure;\n    for (var idx = 0; idx < length; idx++) {\n        measure = measures[idx];\n        result.push(measure.name !== undefined ? measure.name : measure);\n    }\n    return result;\n}\nfunction getRootNames(members) {\n    var root = [];\n    members.forEach(function (member) {\n        var name = member.name[0];\n        var hierarchyName = baseHierarchyPath(name);\n        if (!root.some(function (n) { return n.indexOf(hierarchyName) === 0; })) {\n            root.push(name);\n        }\n    });\n    return root;\n}\nfunction parseDescriptors(members) {\n    var expanded = [];\n    var child = [];\n    var root = [];\n    var idx = 0;\n    var found;\n    for (; idx < members.length; idx++) {\n        var member = members[idx];\n        var name_1 = member.name;\n        found = false;\n        if (name_1.length > 1) {\n            child.push(member);\n        }\n        else {\n            var hierarchyName = baseHierarchyPath(name_1[0]);\n            for (var j = 0, l = root.length; j < l; j++) {\n                if (root[j].name[0].indexOf(hierarchyName) === 0) {\n                    found = true;\n                    break;\n                }\n            }\n            if (!found) {\n                root.push(member);\n            }\n            if (member.expand) {\n                expanded.push(member);\n            }\n        }\n    }\n    expanded = expanded.concat(child);\n    return {\n        expanded: expanded,\n        root: root\n    };\n}\nfunction mapNames(names, rootNames) {\n    var rootLength = rootNames.length;\n    rootNames = rootNames.slice(0);\n    for (var idx = 0; idx < names.length; idx++) {\n        var name_2 = names[idx];\n        for (var j = 0; j < rootLength; j++) {\n            var rootName = baseHierarchyPath(rootNames[j]);\n            if (name_2.indexOf(rootName) !== -1) {\n                rootNames[j] = name_2;\n                break;\n            }\n        }\n    }\n    return rootNames;\n}\nfunction crossJoinCommand(members, measures) {\n    var tmp = members.slice(0);\n    if (measures.length > 1) {\n        tmp.push(\"{\" + measureNames(measures).join(\",\") + \"}\");\n    }\n    return crossJoin(tmp);\n}\nfunction expandMemberDescriptor(names, sort) {\n    var idx = names.length - 1;\n    var name = names[idx];\n    var sortDescriptor = sortDescriptorForMember(sort, name);\n    if (sortDescriptor && sortDescriptor.dir) {\n        name = \"ORDER(\" + name + \".Children,\" + sortDescriptor.field + \".CurrentMember.MEMBER_CAPTION,\" + sortDescriptor.dir + \")\";\n    }\n    else {\n        name += \".Children\";\n    }\n    names[idx] = name;\n    return names;\n}\nfunction sortDescriptorForMember(sort, member) {\n    for (var idx = 0, length_1 = sort.length; idx < length_1; idx++) {\n        if (member.indexOf(sort[idx].field) === 0) {\n            return sort[idx];\n        }\n    }\n    return null;\n}\nfunction baseHierarchyPath(memberName) {\n    var parts = memberName.split(\".\");\n    if (parts.length > 2) {\n        return parts[0] + \".\" + parts[1];\n    }\n    return memberName;\n}\nfunction crossJoin(names) {\n    var result = \"CROSSJOIN({\";\n    var name;\n    if (names.length > 2) {\n        name = names.pop();\n        result += crossJoin(names);\n    }\n    else {\n        result += names.shift();\n        name = names.pop();\n    }\n    result += \"},{\";\n    result += name;\n    result += \"})\";\n    return result;\n}\n\n/**\n * @hidden\n */\nfunction createRequestBody(options) {\n    var command = '<Envelope xmlns=\"http://schemas.xmlsoap.org/soap/envelope/\"><Header/><Body><Execute xmlns=\"urn:schemas-microsoft-com:xml-analysis\"><Command><Statement>';\n    var _a = options.columnAxes, columnAxes = _a === void 0 ? [] : _a, _b = options.rowAxes, rowAxes = _b === void 0 ? [] : _b;\n    var _c = options.measureAxes, measureAxes = _c === void 0 ? [] : _c, _d = options.sort, sort = _d === void 0 ? [] : _d, _e = options.filter, filter = _e === void 0 ? [] : _e;\n    var measuresRowAxis = options.measuresAxis === \"rows\";\n    command += \"SELECT NON EMPTY {\";\n    if (!columnAxes.length && rowAxes.length && (!measureAxes.length || (measureAxes.length && measuresRowAxis))) {\n        columnAxes = rowAxes;\n        rowAxes = [];\n        measuresRowAxis = false;\n    }\n    if (!columnAxes.length && !rowAxes.length) {\n        measuresRowAxis = false;\n    }\n    if (columnAxes.length) {\n        command += serializeMembers(columnAxes, !measuresRowAxis ? measureAxes : [], sort);\n    }\n    else if (measureAxes.length && !measuresRowAxis) {\n        command += measureNames(measureAxes).join(\",\");\n    }\n    command += \"} DIMENSION PROPERTIES CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME ON COLUMNS\";\n    if (rowAxes.length || (measuresRowAxis && measureAxes.length > 1)) {\n        command += \", NON EMPTY {\";\n        if (rowAxes.length) {\n            command += serializeMembers(rowAxes, measuresRowAxis ? measureAxes : [], sort);\n        }\n        else {\n            command += measureNames(measureAxes).join(\",\");\n        }\n        command += \"} DIMENSION PROPERTIES CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME ON ROWS\";\n    }\n    if (filter.length) {\n        command += \" FROM \";\n        command += \"(\";\n        command += serializeFilters(filter, options.connection.cube);\n        command += \")\";\n    }\n    else {\n        command += \" FROM [\" + options.connection.cube + \"]\";\n    }\n    if (measureAxes.length === 1 && columnAxes.length) {\n        command += \" WHERE (\" + measureNames(measureAxes).join(\",\") + \")\";\n    }\n    command += '</Statement></Command><Properties><PropertyList><Catalog>' + options.connection.catalog + '</Catalog><Format>Multidimensional</Format></PropertyList></Properties></Execute></Body></Envelope>';\n    return command.replace(/&/g, \"&amp;\");\n}\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nfunction __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nfunction __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nfunction __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nfunction __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nfunction __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nfunction __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nfunction __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nfunction __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nfunction __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nfunction __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nfunction __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nfunction __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nfunction __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nfunction __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nfunction __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nfunction __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nfunction __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nfunction __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nfunction __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\n\n/**\n * @hidden\n */\nfunction parseResponse(response) {\n    var xmlDoc = new DOMParser().parseFromString(response, \"text/xml\");\n    var axes = Array.from(xmlDoc.querySelectorAll(\"Axis\"));\n    var cells = Array.from(xmlDoc.querySelectorAll(\"CellData > Cell\"))\n        .map(function (cell) { return ({\n        fmtValue: getPropertyValue(cell, \"FmtValue\"),\n        ordinal: parseInt(cell.getAttribute(\"CellOrdinal\"), 10),\n        value: getPropertyValue(cell, \"Value\")\n    }); });\n    var columns = { tuples: [] };\n    var rows = { tuples: [] };\n    var data = [];\n    axes.forEach(function (axis) {\n        if (axis.getAttribute('name') !== \"SlicerAxis\") {\n            var tuples = columns.tuples.length === 0 ? columns.tuples : rows.tuples;\n            Array.prototype.push.apply(tuples, translateAxis(axis));\n        }\n    });\n    var indexedData = new Array(rows.tuples.length * columns.tuples.length).fill(null);\n    cells.forEach(function (c) { indexedData[c.ordinal] = c; });\n    var counter = 0;\n    rows.tuples.forEach(function (rowTuple) {\n        columns.tuples.forEach(function (colTuple) {\n            data.push({\n                columnTuple: colTuple,\n                data: indexedData[counter],\n                rowTuple: rowTuple\n            });\n            counter++;\n        });\n    });\n    return { columns: columns, data: data, rows: rows };\n}\n/**\n * @hidden\n */\nfunction getPropertyValue(member, name) {\n    var node = member.querySelector(name);\n    return node ? node.textContent : \"\";\n}\nfunction translateAxis(axis) {\n    var tuples = Array.from(axis.querySelectorAll(\"Tuple\"));\n    return tuples.map(function (tuple) {\n        var memberElements = Array.from(tuple.querySelectorAll(\"Member\"));\n        var members = memberElements.map(function (member) {\n            var lNum = parseInt(getPropertyValue(member, \"LNum\") || \"0\", 10);\n            var hasChildren = parseInt(getPropertyValue(member, \"CHILDREN_CARDINALITY\") || \"0\", 10) > 0;\n            return {\n                caption: getPropertyValue(member, \"Caption\"),\n                children: [],\n                hasChildren: hasChildren,\n                hierarchy: member.getAttribute('Hierarchy'),\n                levelName: getPropertyValue(member, \"LName\"),\n                levelNum: lNum,\n                name: getPropertyValue(member, \"UName\"),\n                parentName: getPropertyValue(member, \"PARENT_UNIQUE_NAME\")\n            };\n        });\n        return { members: members };\n    });\n}\n\n/**\n * @hidden\n */\nvar discoverCommands = {\n    schemaCatalogs: \"DBSCHEMA_CATALOGS\",\n    schemaCubes: \"MDSCHEMA_CUBES\",\n    schemaDimensions: \"MDSCHEMA_DIMENSIONS\",\n    schemaHierarchies: \"MDSCHEMA_HIERARCHIES\",\n    schemaKPIs: \"MDSCHEMA_KPIS\",\n    schemaLevels: \"MDSCHEMA_LEVELS\",\n    schemaMeasures: \"MDSCHEMA_MEASURES\",\n    schemaMembers: \"MDSCHEMA_MEMBERS\"\n};\n/**\n * @hidden\n */\nfunction createDiscoverBody(options) {\n    var properties = {};\n    var command = '<Envelope xmlns=\"http://schemas.xmlsoap.org/soap/envelope/\"><Header/><Body><Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\">';\n    command += \"<RequestType>\" + (discoverCommands[options.command] || options.command) + \"</RequestType>\";\n    command += \"<Restrictions>\" + serializeOptions(\"RestrictionList\", options.restrictions, true) + \"</Restrictions>\";\n    if (options.connection && options.connection.catalog) {\n        properties.Catalog = options.connection.catalog;\n    }\n    command += \"<Properties>\" + serializeOptions(\"PropertyList\", properties, false) + \"</Properties>\";\n    command += '</Discover></Body></Envelope>';\n    return command;\n}\nfunction serializeOptions(parentTagName, options, capitalize) {\n    var result = \"\";\n    if (options) {\n        result += \"<\" + parentTagName + \">\";\n        var value = void 0;\n        for (var key in options) {\n            if (options[key]) {\n                value = options[key];\n                if (capitalize) {\n                    key = key.replace(/([A-Z]+(?=$|[A-Z][a-z])|[A-Z]?[a-z]+)/g, \"$1_\").toUpperCase().replace(/_$/, \"\");\n                }\n                result += \"<\" + key + \">\" + value + \"</\" + key + \">\";\n            }\n        }\n        result += \"</\" + parentTagName + \">\";\n    }\n    else {\n        result += \"<\" + parentTagName + \"/>\";\n    }\n    return result;\n}\n\n/**\n * @hidden\n */\nfunction parseCubes(response) {\n    var xmlDoc = new DOMParser().parseFromString(response, \"text/xml\");\n    var rows = Array.from(xmlDoc.querySelectorAll(\"DiscoverResponse > return > root > row\"))\n        .map(function (row) { return ({\n        name: getPropertyValue(row, \"CUBE_NAME\"),\n        caption: getPropertyValue(row, \"CUBE_CAPTION\"),\n        description: getPropertyValue(row, \"DESCRIPTION\"),\n        type: getPropertyValue(row, \"CUBE_TYPE\")\n    }); });\n    return rows;\n}\n/**\n * @hidden\n */\nfunction parseCatalogs(response) {\n    var xmlDoc = new DOMParser().parseFromString(response, \"text/xml\");\n    var rows = Array.from(xmlDoc.querySelectorAll(\"DiscoverResponse > return > root > row\"))\n        .map(function (row) { return ({\n        name: getPropertyValue(row, \"CATALOG_NAME\"),\n        description: getPropertyValue(row, \"DESCRIPTION\")\n    }); });\n    return rows;\n}\n/**\n * @hidden\n */\nfunction parseMeasures(response) {\n    var xmlDoc = new DOMParser().parseFromString(response, \"text/xml\");\n    var rows = Array.from(xmlDoc.querySelectorAll(\"DiscoverResponse > return > root > row\"))\n        .map(function (row) { return ({\n        name: getPropertyValue(row, \"MEASURE_NAME\"),\n        caption: getPropertyValue(row, \"MEASURE_CAPTION\"),\n        uniqueName: getPropertyValue(row, \"MEASURE_UNIQUE_NAME\"),\n        description: getPropertyValue(row, \"DESCRIPTION\"),\n        aggregator: getPropertyValue(row, \"MEASURE_AGGREGATOR\"),\n        groupName: getPropertyValue(row, \"MEASUREGROUP_NAME\"),\n        displayFolder: getPropertyValue(row, \"MEASURE_DISPLAY_FOLDER\"),\n        defaultFormat: getPropertyValue(row, \"DEFAULT_FORMAT_STRING\")\n    }); });\n    return rows;\n}\n/**\n * @hidden\n */\nfunction parseKPIs(response) {\n    var xmlDoc = new DOMParser().parseFromString(response, \"text/xml\");\n    var rows = Array.from(xmlDoc.querySelectorAll(\"DiscoverResponse > return > root > row\"))\n        .map(function (row) { return ({\n        name: getPropertyValue(row, \"KPI_NAME\"),\n        uniqueName: getPropertyValue(row, \"KPI_NAME\"),\n        caption: getPropertyValue(row, \"KPI_CAPTION\"),\n        value: getPropertyValue(row, \"KPI_VALUE\"),\n        goal: getPropertyValue(row, \"KPI_GOAL\"),\n        status: getPropertyValue(row, \"KPI_STATUS\"),\n        trend: getPropertyValue(row, \"KPI_TREND\"),\n        statusGraphic: getPropertyValue(row, \"KPI_STATUS_GRAPHIC\"),\n        trendGraphic: getPropertyValue(row, \"KPI_TREND_GRAPHIC\"),\n        description: getPropertyValue(row, \"KPI_DESCRIPTION\"),\n        groupName: getPropertyValue(row, \"MEASUREGROUP_NAME\"),\n        type: \"kpi\"\n    }); });\n    return rows;\n}\n/**\n * @hidden\n */\nfunction parseDimensions(response) {\n    var xmlDoc = new DOMParser().parseFromString(response, \"text/xml\");\n    var rows = Array.from(xmlDoc.querySelectorAll(\"DiscoverResponse > return > root > row\"))\n        .map(function (row) { return ({\n        caption: getPropertyValue(row, \"DIMENSION_CAPTION\"),\n        defaultHierarchy: getPropertyValue(row, \"DEFAULT_HIERARCHY\"),\n        description: getPropertyValue(row, \"DESCRIPTION\"),\n        name: getPropertyValue(row, \"DIMENSION_NAME\"),\n        type: parseInt(getPropertyValue(row, \"DIMENSION_TYPE\"), 10),\n        uniqueName: getPropertyValue(row, \"DIMENSION_UNIQUE_NAME\")\n    }); });\n    return rows;\n}\n/**\n * @hidden\n */\nfunction parseHierarchies(response) {\n    var xmlDoc = new DOMParser().parseFromString(response, \"text/xml\");\n    var rows = Array.from(xmlDoc.querySelectorAll(\"DiscoverResponse > return > root > row\"))\n        .map(function (row) { return ({\n        name: getPropertyValue(row, \"HIERARCHY_NAME\"),\n        caption: getPropertyValue(row, \"HIERARCHY_CAPTION\"),\n        description: getPropertyValue(row, \"DESCRIPTION\"),\n        uniqueName: getPropertyValue(row, \"HIERARCHY_UNIQUE_NAME\"),\n        dimensionUniqueName: getPropertyValue(row, \"DIMENSION_UNIQUE_NAME\"),\n        displayFolder: getPropertyValue(row, \"HIERARCHY_DISPLAY_FOLDER\"),\n        origin: getPropertyValue(row, \"HIERARCHY_ORIGIN\"),\n        defaultMember: getPropertyValue(row, \"DEFAULT_MEMBER\")\n    }); });\n    return rows;\n}\n/**\n * @hidden\n */\nfunction parseLevels(response) {\n    var xmlDoc = new DOMParser().parseFromString(response, \"text/xml\");\n    var rows = Array.from(xmlDoc.querySelectorAll(\"DiscoverResponse > return > root > row\"))\n        .map(function (row) { return ({\n        name: getPropertyValue(row, \"LEVEL_NAME\"),\n        caption: getPropertyValue(row, \"LEVEL_CAPTION\"),\n        description: getPropertyValue(row, \"DESCRIPTION\"),\n        uniqueName: getPropertyValue(row, \"LEVEL_UNIQUE_NAME\"),\n        dimensionUniqueName: getPropertyValue(row, \"DIMENSION_UNIQUE_NAME\"),\n        displayFolder: getPropertyValue(row, \"LEVEL_DISPLAY_FOLDER\"),\n        orderingProperty: getPropertyValue(row, \"LEVEL_ORDERING_PROPERTY\"),\n        origin: getPropertyValue(row, \"LEVEL_ORIGIN\"),\n        hierarchyUniqueName: getPropertyValue(row, \"HIERARCHY_UNIQUE_NAME\")\n    }); });\n    return rows;\n}\n/**\n * @hidden\n */\nfunction parseMembers(response) {\n    var xmlDoc = new DOMParser().parseFromString(response, \"text/xml\");\n    var rows = Array.from(xmlDoc.querySelectorAll(\"DiscoverResponse > return > root > row\"))\n        .map(function (row) { return ({\n        name: getPropertyValue(row, \"MEMBER_NAME\"),\n        caption: getPropertyValue(row, \"MEMBER_CAPTION\"),\n        uniqueName: getPropertyValue(row, \"MEMBER_UNIQUE_NAME\"),\n        dimensionUniqueName: getPropertyValue(row, \"DIMENSION_UNIQUE_NAME\"),\n        hierarchyUniqueName: getPropertyValue(row, \"HIERARCHY_UNIQUE_NAME\"),\n        levelUniqueName: getPropertyValue(row, \"LEVEL_UNIQUE_NAME\"),\n        childrenCardinality: getPropertyValue(row, \"CHILDREN_CARDINALITY\")\n    }); });\n    return rows;\n}\n\nvar _this = undefined;\nvar discoverParser = {\n    schemaCatalogs: parseCatalogs,\n    schemaCubes: parseCubes,\n    schemaDimensions: parseDimensions,\n    schemaHierarchies: parseHierarchies,\n    schemaKPIs: parseKPIs,\n    schemaLevels: parseLevels,\n    schemaMeasures: parseMeasures,\n    schemaMembers: parseMembers\n};\n/**\n * Fetches the data.\n *\n * @param options RequestOptions\n * @returns Promise<ResponseData>\n *\n * @example\n * const options: RequestOptions = { ... };\n *\n * fetchData(options).then(createDataState).then((dataState: DataState) => {\n *  // Update the UI\n * });\n */\n/**\n * @hidden\n */\nvar fetchData = function (fetchOptions, options) { return __awaiter(_this, void 0, void 0, function () {\n    var init, response, stringResponse;\n    return __generator(this, function (_a) {\n        switch (_a.label) {\n            case 0:\n                init = __assign({ body: createRequestBody(options), headers: { 'Content-Type': 'text/xml' }, method: 'POST' }, fetchOptions.init);\n                return [4 /*yield*/, fetch(fetchOptions.url, init)];\n            case 1:\n                response = _a.sent();\n                return [4 /*yield*/, response.text()];\n            case 2:\n                stringResponse = _a.sent();\n                return [2 /*return*/, parseResponse(stringResponse)];\n        }\n    });\n}); };\n/**\n * @hidden\n */\nvar fetchDiscover = function (fetchOptions, options) { return __awaiter(_this, void 0, void 0, function () {\n    var init, response, stringResponse;\n    return __generator(this, function (_a) {\n        switch (_a.label) {\n            case 0:\n                init = __assign({ body: createDiscoverBody(options), headers: { 'Content-Type': 'text/xml' }, method: 'POST' }, fetchOptions.init);\n                return [4 /*yield*/, fetch(fetchOptions.url, init)];\n            case 1:\n                response = _a.sent();\n                return [4 /*yield*/, response.text()];\n            case 2:\n                stringResponse = _a.sent();\n                return [2 /*return*/, discoverParser[options.command](stringResponse)];\n        }\n    });\n}); };\n\nvar isMeasure = function (member) { return member.hierarchy === '[Measures]'; };\n// A typical tree depth count won't work for the Pivot,\n// as each branch can have lower number of nodes than the total number of levels\n/**\n * @hidden\n */\nvar getMaxNesting = function (node, set) {\n    if (set === void 0) { set = new Set(); }\n    (node.children || []).forEach(function (child) {\n        set.add(child.levelName);\n        getMaxNesting(child, set);\n    });\n    return set.size;\n};\n/**\n * @hidden\n */\nvar getMaxExpansion = function (node) {\n    var expanded = 0;\n    (node.children || []).forEach(function (child) {\n        expanded += (getMaxExpansion(child) || 1);\n    });\n    return expanded;\n};\n/**\n * @hidden\n */\nvar generateNormalizedPath = function (node, parent) {\n    return (parent && (parent.hierarchy === node.hierarchy)\n        ? (parent.normalizedPath || []).slice(0, -1).concat([node.name || null]) : ((parent && parent.normalizedPath) ? parent.normalizedPath : []).concat([node.name])).filter(Boolean);\n};\n/**\n * @hidden\n */\nvar generatePath = function (node, parent) {\n    return (parent && (parent.hierarchy === node.hierarchy)\n        ? (parent.path || []).slice(0, -1).concat([((node.levelNum === 0 ? node.hierarchy : node.name) || null)]) : ((parent && parent.path) ? parent.path : []).concat([node.levelNum === 0 ? node.hierarchy : node.name])).filter(Boolean);\n};\n/**\n * @hidden\n */\nvar toMatrix = function (node, rowIndex, colIndex, maxDepth, maxBreadth, matrix, leafs, parent) {\n    if (rowIndex === void 0) { rowIndex = -1; }\n    if (colIndex === void 0) { colIndex = 0; }\n    if (maxDepth === void 0) { maxDepth = undefined; }\n    if (maxBreadth === void 0) { maxBreadth = undefined; }\n    if (matrix === void 0) { matrix = undefined; }\n    if (leafs === void 0) { leafs = undefined; }\n    if (parent === void 0) { parent = undefined; }\n    var branchDepth = getMaxNesting(node);\n    var branchBreadth = getMaxExpansion(node);\n    var depth = maxDepth || branchDepth;\n    var breadth = maxBreadth || branchBreadth;\n    var matrixResult = matrix ? matrix.slice() : [];\n    var leafsResult = leafs ? leafs.slice() : new Array(breadth);\n    var index = matrixResult.findIndex(function (l) { return l && l.name === node.levelName && l.level === node.levelNum; });\n    var level = matrixResult[index];\n    var row = {\n        name: node.levelName,\n        level: node.levelNum,\n        index: rowIndex,\n        cells: new Array(breadth).fill(null)\n    };\n    var inject = rowIndex !== -1 && colIndex !== -1;\n    var cell = {\n        caption: node.caption,\n        name: node.name,\n        levelName: node.levelName,\n        levelNum: node.levelNum,\n        hasChildren: node.hasChildren,\n        parentName: node.parentName,\n        hierarchy: node.hierarchy,\n        total: (node.total !== undefined ? node.total : false) || (parent && parent.children.length <= 1 && parent.total),\n        parent: parent,\n        rowIndex: rowIndex,\n        colIndex: colIndex,\n        depth: 1,\n        breadth: 1,\n        path: node.path || [],\n        normalizedPath: node.normalizedPath || [],\n        children: node.children.filter(function (c) { return c.hierarchy === node.hierarchy; })\n    };\n    if (inject) {\n        if (level) {\n            level.cells[colIndex] = cell;\n            if (level.index >= rowIndex) {\n                rowIndex = level.index;\n            }\n        }\n        else {\n            if (matrixResult[rowIndex] && matrixResult[rowIndex].cells.length) {\n                for (var idx = rowIndex; idx < matrixResult.length; idx++) {\n                    var shiftedRow = matrixResult[idx];\n                    shiftedRow.index++;\n                }\n                matrixResult.splice(rowIndex, 0, row);\n                matrixResult[rowIndex].cells[colIndex] = cell;\n            }\n            else {\n                matrixResult[rowIndex] = row;\n                matrixResult[rowIndex].cells[colIndex] = cell;\n            }\n        }\n    }\n    var collOffset = 0;\n    if (node.children && node.children.length) {\n        node.children.forEach(function (child) {\n            var _a = toMatrix(child, rowIndex + 1, colIndex + collOffset, depth, breadth, matrixResult, leafsResult, cell), newMatrix = _a[0], newLeafs = _a[1], childBreadth = _a[3];\n            collOffset += (childBreadth || 1);\n            matrixResult = newMatrix.slice();\n            leafsResult = newLeafs.slice();\n        });\n    }\n    else if (node.normalizedPath) {\n        leafsResult[colIndex] = { total: cell.total, path: node.normalizedPath };\n    }\n    cell.depth = branchDepth;\n    cell.breadth = branchBreadth;\n    return [\n        matrixResult,\n        leafsResult,\n        branchDepth,\n        branchBreadth\n    ];\n};\nvar withTotal = function (root, parent, index) {\n    if (parent === void 0) { parent = null; }\n    if (index === void 0) { index = 0; }\n    var hierarchy;\n    var alt = __assign({}, root, { total: true, hasChildren: false, children: [] });\n    for (var childIndex = 0; childIndex < root.children.length; childIndex++) {\n        var child = withTotal(root.children[childIndex], root, childIndex);\n        hierarchy = hierarchy || child.hierarchy;\n        if (child.hierarchy !== hierarchy\n            && parent\n            && !parent.children.some(function (c) { return c.total && c.name === alt.name; })\n            && !root.total) {\n            alt.children.push(child);\n            root.children.splice(childIndex, 1);\n            childIndex--;\n        }\n    }\n    if (root.children.filter(function (c) { return !c.total; }).length >= 1\n        && parent\n        && !parent.children.some(function (c) { return c.total && c.name === alt.name; })\n        && !root.total) {\n        var childHierarchy = root.children[0].hierarchy;\n        if (root.hierarchy === childHierarchy) {\n            parent.children.splice(index + 1, 0, alt);\n        }\n    }\n    return root;\n};\n/**\n * @hidden\n */\nvar toTree = function (tuples) {\n    var root = { children: [] };\n    var map = {};\n    if (tuples.every(function (t) { return t.members.length === 1 && isMeasure(t.members[0]); })) {\n        // toTree(columnsTuples) - The case where there are only measure(s) and no columns.\n        return {\n            children: tuples.map(function (t) {\n                var member = t.members[0];\n                return __assign({}, member, { normalizedPath: [member.name], parentName: member.name, path: [member.hierarchy] });\n            })\n        };\n    }\n    for (var tupleIndex = 0; tupleIndex < tuples.length; tupleIndex++) {\n        var tuple = copy(tuples[tupleIndex]);\n        var key = \"\";\n        var _loop_1 = function (memberIndex) {\n            var member = tuple.members[memberIndex];\n            var parent_1;\n            if (root.children && root.children.length === 0) {\n                parent_1 = root;\n            }\n            else if (map[key] && !map[key + member.name] && member.levelNum === 0) {\n                parent_1 = map[key];\n            }\n            else if (map[key + member.parentName] && member.levelNum > 0 && !map[key + member.parentName + member.name]) {\n                parent_1 = map[key + member.parentName];\n            }\n            else if (!map[key + member.parentName] && member.levelNum > 0 && !map[key + member.parentName + member.name]) {\n                var parentKey = Object.keys(map).find(function (e) { return member.parentName === map[e].name; });\n                if (parentKey) {\n                    parent_1 = map[parentKey];\n                }\n            }\n            if (parent_1) {\n                member.path = generatePath(member, parent_1);\n                member.normalizedPath = generateNormalizedPath(member, parent_1);\n                var intruderIndex = parent_1.children.findIndex(function (c) { return c.hierarchy !== parent_1.hierarchy; });\n                if (intruderIndex !== -1) {\n                    parent_1.children.splice(intruderIndex, 0, member);\n                }\n                else {\n                    parent_1.children.push(member);\n                }\n            }\n            member.parentName += member.name;\n            key += member.parentName;\n            if (!map[key]) {\n                map[key] = member;\n            }\n        };\n        for (var memberIndex = 0; memberIndex < tuple.members.length; memberIndex++) {\n            _loop_1(memberIndex);\n        }\n    }\n    return copy(withTotal(root));\n};\n/**\n * @hidden\n */\nvar toData = function (data, columns, rows, breadth, depth) {\n    var result = Array.from(new Array(depth), function () { return ({ cells: Array.from(new Array(breadth), function () { return null; }) }); });\n    var hash = function (names) { return names.join('|'); };\n    var membersNames = function (tuple) { return tuple.members.map(function (m) { return m.name; }); };\n    var columnsIndexes = new Map();\n    var rowsIndexes = new Map();\n    columns.forEach(function (colMembers, idx) { columnsIndexes.set(hash(colMembers.path), idx); });\n    rows.forEach(function (rowMembers, idx) { rowsIndexes.set(hash(rowMembers.path), idx); });\n    data.forEach(function (item) {\n        var colIndex = columnsIndexes.get(hash(membersNames(item.columnTuple)));\n        var rowIndex = rowsIndexes.get(hash(membersNames(item.rowTuple)));\n        if (colIndex !== undefined && rowIndex !== undefined) {\n            if (!result[rowIndex].cells[colIndex]) {\n                result[rowIndex].row = rows[rowIndex].path;\n                result[rowIndex].cells[colIndex] = item;\n            }\n        }\n    });\n    return result;\n};\nvar rotateMatrix = function (matrix, leafs, depth, breadth) {\n    var result = new Array(breadth);\n    for (var colIndex = 0; colIndex < breadth; colIndex++) {\n        for (var rowIndex = 0; rowIndex < depth; rowIndex++) {\n            if (matrix[rowIndex] && matrix[rowIndex].cells[colIndex]) {\n                var cell = matrix[rowIndex].cells[colIndex];\n                if (!result[colIndex]) {\n                    result[colIndex] = {\n                        cells: new Array(depth).fill(null)\n                    };\n                }\n                result[colIndex].cells[rowIndex] = __assign({}, cell, { rowSpan: cell.colSpan, colSpan: cell.rowSpan });\n            }\n        }\n    }\n    return [result, leafs, breadth, depth];\n};\n/**\n * @hidden\n */\nvar toColumns = function (root) {\n    var _a = toMatrix(root), matrix = _a[0], leafs = _a[1], depth = _a[2], breadth = _a[3];\n    for (var colIndex = 0; colIndex < breadth; colIndex++) {\n        var cell = null;\n        for (var rowIndex = 0; rowIndex < depth; rowIndex++) {\n            if (matrix[rowIndex]) {\n                var next = matrix[rowIndex].cells[colIndex];\n                if (!next && cell) {\n                    cell.rowSpan = (cell.rowSpan || 1) + 1;\n                }\n                if (cell) {\n                    cell.colSpan = cell.breadth || 1;\n                }\n                if (next) {\n                    cell = next;\n                }\n            }\n        }\n    }\n    return [matrix, leafs, depth, breadth];\n};\n/**\n * @hidden\n */\nvar toRows = function (root) {\n    var _a = toMatrix(root), matrix = _a[0], leafs = _a[1], depth = _a[2], breadth = _a[3];\n    for (var colIndex = 0; colIndex < breadth; colIndex++) {\n        var cell = null;\n        for (var rowIndex = 0; rowIndex < depth; rowIndex++) {\n            if (matrix[rowIndex]) {\n                var next = matrix[rowIndex].cells[colIndex];\n                if (!next && cell) {\n                    cell.rowSpan = (cell.rowSpan || 1) + 1;\n                }\n                if (cell) {\n                    cell.colSpan = cell.breadth;\n                }\n                if (next) {\n                    cell = next;\n                }\n            }\n        }\n    }\n    return rotateMatrix(matrix, leafs, depth, breadth);\n};\n/**\n * @hidden\n */\nvar cloneDate = function (date) { return date ? new Date(date.getTime()) : null; };\n/**\n * @hidden\n */\nfunction clone(obj) {\n    var result = {};\n    cloneObject(obj, result);\n    return result;\n}\n/**\n * @hidden\n */\nfunction cloneObject(obj, result) {\n    for (var field in obj) {\n        if (obj.hasOwnProperty(field)) {\n            var value = obj[field];\n            result[field] = cloneValue(value, result[field]);\n        }\n    }\n}\n/**\n * @hidden\n */\nfunction cloneValue(value, nextValue) {\n    if (Array.isArray(value)) {\n        return cloneArray(value);\n    }\n    else if (value instanceof Date) {\n        return cloneDate(value);\n    }\n    else if (value && typeof value === 'object') {\n        var newNextValue = nextValue || {};\n        cloneObject(value, newNextValue);\n        return newNextValue;\n    }\n    else {\n        return value;\n    }\n}\n/**\n * @hidden\n */\nfunction copy(obj) {\n    return JSON.parse(JSON.stringify(obj));\n}\n/**\n * @hidden\n */\nfunction cloneArray(array) {\n    return array.map(function (value) { return cloneValue(value, undefined); });\n}\nvar kpiMeasure = function (name, measure, type) {\n    return {\n        hierarchyUniqueName: name,\n        uniqueName: measure,\n        caption: measure,\n        measure: measure,\n        name: measure,\n        type: type,\n        kpi: true\n    };\n};\n/**\n * @hidden\n */\nfunction buildKPIMeasures(node) {\n    var name = node.name;\n    return [\n        kpiMeasure(name, node.value, \"value\"),\n        kpiMeasure(name, node.goal, \"goal\"),\n        kpiMeasure(name, node.status, \"status\"),\n        kpiMeasure(name, node.trend, \"trend\")\n    ];\n}\n/**\n * @hidden\n */\nvar addKPI = function (data) {\n    var found;\n    var idx = 0;\n    for (; idx < data.length; idx++) {\n        if (data[idx].type === 2) {\n            found = true;\n            break;\n        }\n    }\n    if (found) {\n        data.splice(idx + 1, 0, {\n            caption: \"KPIs\",\n            defaultHierarchy: \"[KPIs]\",\n            name: \"KPIs\",\n            uniqueName: \"[KPIs]\"\n        });\n    }\n};\n/**\n * @hidden\n */\nvar compareAxisWithField = function (a, b) { return String(a.name) === String([(b.defaultHierarchy\n        ? b.defaultHierarchy\n        : b.uniqueName)]); };\n/**\n * @hidden\n */\nvar compareAxes = function (a, b) { return String(a.name) === String(b.name); };\n/**\n * @hidden\n */\nvar filterField = function (axes, out) {\n    var _loop_2 = function (i) {\n        var axis = axes[i];\n        var index = axis.name.findIndex(function (name) { return compareAxisWithField({ name: [name] }, out) || String(name).startsWith(out.uniqueName); });\n        if (index !== -1) {\n            if (index === axis.name.length - 1 || axis.name.length === 1) {\n                axes.splice(i, 1);\n            }\n            else {\n                axis.name.splice(index, 1);\n                var duplicatedAxisIndex = axes.findIndex(function (ax) { return ax !== axis && String(ax.name) === String(axis.name); });\n                if (duplicatedAxisIndex !== -1) {\n                    axes[duplicatedAxisIndex] = __assign({}, axes[duplicatedAxisIndex], axis, ((axes[duplicatedAxisIndex].expand || axis.expand) ? { expand: true } : {}));\n                    axes.splice(i, 1);\n                }\n            }\n        }\n    };\n    for (var i = axes.length - 1; i >= 0; i--) {\n        _loop_2(i);\n    }\n};\n/**\n * @hidden\n */\nvar insertAxis = function (axes, toInsert, state) {\n    var index = -1;\n    if (state.dropTarget && state.dropDirection) {\n        var offset = state.dropDirection\n            ? (state.dropDirection === 'before'\n                ? 0\n                : 1)\n            : 0;\n        index = axes.findIndex(function (c) { return compareAxes(c, state.dropTarget); }) + offset;\n    }\n    if (index !== -1) {\n        axes.forEach(function (axis) {\n            var _a;\n            if (axis.expand && axis.name.length > 1 && axis.name.length > index) {\n                (_a = axis.name).splice.apply(_a, [index, 0].concat(toInsert.name));\n            }\n        });\n        axes.splice(index, 0, toInsert);\n    }\n    else {\n        axes.push(toInsert);\n    }\n};\n/**\n * @hidden\n */\nvar reverseColumnsByMeasures = function (columns) {\n    var firstColumn = columns.length && columns[0];\n    var lastMember = firstColumn && firstColumn.members[firstColumn.members.length - 1];\n    if (lastMember && isMeasure(lastMember)) {\n        var columnsArr = [];\n        var measuresCount = new Set(columns.map(function (col) { return col.members[col.members.length - 1].caption; })).size;\n        for (var i = 0; i < columns.length; i += measuresCount) {\n            columnsArr.push(columns.slice(i, i + measuresCount));\n        }\n        var result_1 = [];\n        columnsArr.forEach(function (arr) {\n            result_1.push.apply(result_1, arr.reverse());\n        });\n        return result_1;\n    }\n    return columns;\n};\n\n/**\n * Creates the state object. See `fetchData`.\n *\n * @param response - ResponseData\n * @returns DataState\n */\n/**\n * @hidden\n */\nvar createDataState = function (response) {\n    var state = {\n        columns: reverseColumnsByMeasures(response.columns.tuples),\n        data: response.data,\n        rows: response.rows.tuples\n    };\n    return state;\n};\n\n/**\n * Creates a collection of AxisDescriptor base on the expandTree.\n * @param expandTree - { [key: string]: boolean }\n * @returns AxisDescriptor[]\n *\n * @example\n * See `setRowExpand` or `setColumnExpand` functions.\n */\n/**\n * @hidden\n */\nfunction createAxisDescriptors(expandTree) {\n    var descriptors = [];\n    for (var _i = 0, _a = Object.keys(expandTree); _i < _a.length; _i++) {\n        var key = _a[_i];\n        descriptors.push({ name: JSON.parse(key), expand: expandTree[key] });\n    }\n    return descriptors;\n}\n\n/**\n * Sets sort descriptors to request options.\n *\n * @param options - RequestOptions\n * @param sort - SortDescriptor[]\n *\n * @example\n * const options: RequestOptions = { ... };\n * const sort: SortDescriptor[] = [{ ... }, { ... }];\n * setSort(options, sort);\n * // skip the sort parameter to clear current filter - setSort(options);\n *\n * fetchData(options).then(createDataState).then((dataState: DataState) => {\n *  // Update the UI\n * });\n */\n/**\n * @hidden\n */\nvar setSort = function (options, sort) {\n    if (sort === void 0) { sort = []; }\n    options.sort = sort;\n};\n\n/**\n * Sets filter descriptors to request options.\n *\n * @param options - RequestOptions\n * @param filter - FilterDescriptor[]\n *\n * @example\n * const options: RequestOptions = { ... };\n * const filter: FilterDescriptor[] = [{ ... }, { ... }];\n * setFilter(options, filter);\n * // skip the filter parameter to clear current filter - setFilter(options);\n *\n * fetchData(options).then(createDataState).then((dataState: DataState) => {\n *  // Update the UI\n * });\n */\n/**\n * @hidden\n */\nvar setFilter = function (options, filter) {\n    if (filter === void 0) { filter = []; }\n    options.filter = filter;\n};\n\n/**\n * @hidden\n */\nvar HEADERS_ACTION;\n(function (HEADERS_ACTION) {\n    HEADERS_ACTION[\"toggle\"] = \"HEADERS_ACTION_TOGGLE\";\n    HEADERS_ACTION[\"expand\"] = \"HEADERS_ACTION_EXPAND\";\n    HEADERS_ACTION[\"collapse\"] = \"HEADERS_ACTION_COLLAPSE\";\n})(HEADERS_ACTION || (HEADERS_ACTION = {}));\nvar findPath = function (node, matchFn, matched) {\n    var result = new Set();\n    node.children.forEach(function (child) {\n        var match = matchFn(child);\n        if (matched) {\n            result.add(String(child.path));\n        }\n        findPath(child, matchFn, (matched || match)).map(function (h) {\n            result.add(h);\n        });\n    });\n    return Array.from(result.values());\n};\n/**\n * @hidden\n */\nvar headersReducer = function (state, action) {\n    switch (action.type) {\n        case HEADERS_ACTION.toggle: {\n            var existing = state.find((function (s) { return String(s.name) === String(action.payload); }));\n            return headersReducer(state, __assign({}, action, { type: existing && (existing.expand)\n                    ? HEADERS_ACTION.collapse\n                    : HEADERS_ACTION.expand }));\n        }\n        case HEADERS_ACTION.expand: {\n            var existing_1 = state.find((function (s) { return String(s.name) === String(action.payload); }));\n            if (existing_1 && existing_1.expand === true) {\n                return state;\n            }\n            else if (existing_1 && (existing_1.expand === false || existing_1.expand === undefined)) {\n                return state.map(function (s) { return s === existing_1 ? (__assign({}, existing_1, { expand: true })) : s; });\n            }\n            else {\n                var nextState = state.slice();\n                nextState.push({ name: action.payload, expand: true });\n                return nextState;\n            }\n        }\n        case HEADERS_ACTION.collapse: {\n            var filtered_1 = findPath(action.tree, function (node) { return !node.total && String(node.path) === String(action.payload); });\n            var newState = state.slice()\n                .filter(function (h) { return !filtered_1.some(function (f) { return f === String(h.name); }); })\n                .map(function (h) { return (__assign({}, h, { expand: Boolean(h.expand) })); })\n                .map(function (h) { return (String(h.name) === String(action.payload))\n                ? action.payload.length > 1 ? undefined : { name: action.payload, expand: false }\n                : h; })\n                .filter(Boolean);\n            return newState;\n        }\n        default: {\n            return state;\n        }\n    }\n};\n\n/**\n * @hidden\n */\nvar PIVOT_CONFIGURATOR_ACTION;\n(function (PIVOT_CONFIGURATOR_ACTION) {\n    // Selection\n    PIVOT_CONFIGURATOR_ACTION[\"toggleSelection\"] = \"PIVOT_CONFIGURATOR_ACTION_TOGGLE_SELECTION\";\n    PIVOT_CONFIGURATOR_ACTION[\"addColumnAxis\"] = \"PIVOT_CONFIGURATOR_ACTION_ADD_COLUMN_AXIS\";\n    PIVOT_CONFIGURATOR_ACTION[\"addColumnAxes\"] = \"PIVOT_CONFIGURATOR_ACTION_ADD_COLUMN_AXES\";\n    PIVOT_CONFIGURATOR_ACTION[\"removeColumnAxis\"] = \"PIVOT_CONFIGURATOR_ACTION_REMOVE_COLUMN_AXIS\";\n    PIVOT_CONFIGURATOR_ACTION[\"removeColumnAxes\"] = \"PIVOT_CONFIGURATOR_ACTION_REMOVE_COLUMN_AXES\";\n    PIVOT_CONFIGURATOR_ACTION[\"addRowAxis\"] = \"PIVOT_CONFIGURATOR_ACTION_ADD_ROW_AXIS\";\n    PIVOT_CONFIGURATOR_ACTION[\"addRowAxes\"] = \"PIVOT_CONFIGURATOR_ACTION_ADD_ROW_AXES\";\n    PIVOT_CONFIGURATOR_ACTION[\"removeRowAxis\"] = \"PIVOT_CONFIGURATOR_ACTION_REMOVE_ROW_AXIS\";\n    PIVOT_CONFIGURATOR_ACTION[\"removeRowAxes\"] = \"PIVOT_CONFIGURATOR_ACTION_REMOVE_ROW_AXES\";\n    PIVOT_CONFIGURATOR_ACTION[\"addMeasureAxis\"] = \"PIVOT_CONFIGURATOR_ACTION_ADD_MEASURE_AXIS\";\n    PIVOT_CONFIGURATOR_ACTION[\"addMeasureAxes\"] = \"PIVOT_CONFIGURATOR_ACTION_ADD_MEASURE_AXES\";\n    PIVOT_CONFIGURATOR_ACTION[\"removeMeasureAxis\"] = \"PIVOT_CONFIGURATOR_ACTION_REMOVE_MEASURE_AXIS\";\n    PIVOT_CONFIGURATOR_ACTION[\"removeMeasureAxes\"] = \"PIVOT_CONFIGURATOR_ACTION_REMOVE_MEASURE_AXES\";\n    // Removal\n    PIVOT_CONFIGURATOR_ACTION[\"remove\"] = \"PIVOT_CONFIGURATOR_ACTION_REMOVE\";\n    // Sort\n    PIVOT_CONFIGURATOR_ACTION[\"setSort\"] = \"PIVOT_CONFIGURATOR_ACTION_SET_SORT\";\n    // Filter\n    PIVOT_CONFIGURATOR_ACTION[\"setFilter\"] = \"PIVOT_CONFIGURATOR_ACTION_SET_FILTER\";\n    PIVOT_CONFIGURATOR_ACTION[\"addFilter\"] = \"PIVOT_CONFIGURATOR_ACTION_ADD_FILTER\";\n    PIVOT_CONFIGURATOR_ACTION[\"changeFilter\"] = \"PIVOT_CONFIGURATOR_ACTION_CHANGE_FILTER\";\n    PIVOT_CONFIGURATOR_ACTION[\"removeFilter\"] = \"PIVOT_CONFIGURATOR_ACTION_REMOVE_FILTER\";\n    // Drag\n    PIVOT_CONFIGURATOR_ACTION[\"setDragItem\"] = \"PIVOT_CONFIGURATOR_ACTION_SET_DRAGITEM\";\n    PIVOT_CONFIGURATOR_ACTION[\"drop\"] = \"PIVOT_CONFIGURATOR_ACTION_DROP\";\n    PIVOT_CONFIGURATOR_ACTION[\"setDropZone\"] = \"PIVOT_CONFIGURATOR_ACTION_SET_DROP_ZONE\";\n    PIVOT_CONFIGURATOR_ACTION[\"setDropTarget\"] = \"PIVOT_CONFIGURATOR_ACTION_SET_DROP_TARGET\";\n    PIVOT_CONFIGURATOR_ACTION[\"setDropDirection\"] = \"PIVOT_CONFIGURATOR_ACTION_SET_DROP_DIRECTION\";\n})(PIVOT_CONFIGURATOR_ACTION || (PIVOT_CONFIGURATOR_ACTION = {}));\n/**\n * @hidden\n */\nvar configuratorReducer = function (state, action) {\n    var newRows;\n    var newColumns;\n    var newMeasures;\n    var newSort;\n    var newFilter;\n    var newDragitem;\n    var newDropZone;\n    var newDropDirection;\n    var newDropTarget;\n    switch (action.type) {\n        case PIVOT_CONFIGURATOR_ACTION.toggleSelection: {\n            if (Array.isArray(action.payload)) {\n                // TODO;\n            }\n            else {\n                var payload_1 = action.payload;\n                if (payload_1.type === 2 || 'aggregator' in payload_1) {\n                    if (state.measureAxes.some(function (s) { return compareAxisWithField(s, payload_1); })) {\n                        return configuratorReducer(state, __assign({}, action, { type: PIVOT_CONFIGURATOR_ACTION.removeMeasureAxis }));\n                    }\n                    else {\n                        return configuratorReducer(state, __assign({}, action, { type: PIVOT_CONFIGURATOR_ACTION.addMeasureAxis }));\n                    }\n                }\n                else if (payload_1.type === 'kpi') {\n                    var measures = buildKPIMeasures(payload_1);\n                    if (measures.every(function (m) { return state.measureAxes.some(function (s) { return compareAxisWithField(s, m); }); })) {\n                        return configuratorReducer(state, __assign({}, action, { type: PIVOT_CONFIGURATOR_ACTION.removeMeasureAxes, payload: measures }));\n                    }\n                    else {\n                        return configuratorReducer(state, __assign({}, action, { type: PIVOT_CONFIGURATOR_ACTION.addMeasureAxes, payload: measures.filter(function (m) { return !state.measureAxes.some(function (s) { return compareAxisWithField(s, m); }); }) }));\n                    }\n                }\n                else if (action.payload.kpi) {\n                    if (state.measureAxes.some(function (s) { return compareAxisWithField(s, payload_1); })) {\n                        return configuratorReducer(state, __assign({}, action, { type: PIVOT_CONFIGURATOR_ACTION.removeMeasureAxis }));\n                    }\n                    else {\n                        return configuratorReducer(state, __assign({}, action, { type: PIVOT_CONFIGURATOR_ACTION.addMeasureAxis }));\n                    }\n                }\n                else {\n                    if (state.columnAxes.some(function (s) { return compareAxisWithField(s, payload_1); })) {\n                        return configuratorReducer(state, __assign({}, action, { type: PIVOT_CONFIGURATOR_ACTION.removeColumnAxis }));\n                    }\n                    else if (state.rowAxes.some(function (s) { return compareAxisWithField(s, payload_1); })) {\n                        return configuratorReducer(state, __assign({}, action, { type: PIVOT_CONFIGURATOR_ACTION.removeRowAxis }));\n                    }\n                    else if ((state.columnAxes && state.columnAxes.length) && (!state.rowAxes || !state.rowAxes.length)) {\n                        return configuratorReducer(state, __assign({}, action, { type: PIVOT_CONFIGURATOR_ACTION.addRowAxis }));\n                    }\n                    else {\n                        return configuratorReducer(state, __assign({}, action, { type: PIVOT_CONFIGURATOR_ACTION.addColumnAxis }));\n                    }\n                }\n            }\n            break;\n        }\n        case PIVOT_CONFIGURATOR_ACTION.addColumnAxis: {\n            newColumns = (state.columnAxes || []).concat([\n                { name: [action.payload.defaultHierarchy || action.payload.uniqueName] }\n            ]);\n            break;\n        }\n        case PIVOT_CONFIGURATOR_ACTION.addColumnAxes: {\n            // TODO;\n            break;\n        }\n        case PIVOT_CONFIGURATOR_ACTION.removeColumnAxis: {\n            newColumns = (state.columnAxes || []).filter(function (s) { return !compareAxisWithField(s, action.payload); }).slice();\n            filterField(newColumns, action.payload);\n            break;\n        }\n        case PIVOT_CONFIGURATOR_ACTION.removeColumnAxes: {\n            // TODO;\n            break;\n        }\n        case PIVOT_CONFIGURATOR_ACTION.addRowAxis: {\n            newRows = (state.rowAxes || []).concat([\n                { name: [action.payload.defaultHierarchy || action.payload.uniqueName] }\n            ]);\n            break;\n        }\n        case PIVOT_CONFIGURATOR_ACTION.addRowAxes: {\n            // TODO;\n            break;\n        }\n        case PIVOT_CONFIGURATOR_ACTION.removeRowAxis: {\n            newRows = (state.rowAxes || []).filter(function (s) { return !compareAxisWithField(s, action.payload); }).slice();\n            filterField(newRows, action.payload);\n            break;\n        }\n        case PIVOT_CONFIGURATOR_ACTION.removeRowAxes: {\n            // TODO;\n            break;\n        }\n        case PIVOT_CONFIGURATOR_ACTION.addMeasureAxis: {\n            newMeasures = (state.measureAxes || []).concat([\n                { name: [action.payload.defaultHierarchy || action.payload.uniqueName] }\n            ]);\n            break;\n        }\n        case PIVOT_CONFIGURATOR_ACTION.removeMeasureAxis: {\n            newMeasures = (state.measureAxes || []).filter(function (s) { return !compareAxisWithField(s, action.payload); }).slice();\n            break;\n        }\n        case PIVOT_CONFIGURATOR_ACTION.addMeasureAxes: {\n            newMeasures = (state.measureAxes || []).concat((action.payload || []).map(function (p) { return ({ name: [p.defaultHierarchy || p.uniqueName] }); }));\n            break;\n        }\n        case PIVOT_CONFIGURATOR_ACTION.removeMeasureAxes: {\n            newMeasures = (state.measureAxes || []).filter(function (s) { return !action.payload.some(function (p) { return compareAxisWithField(s, p); }); }).slice();\n            break;\n        }\n        case PIVOT_CONFIGURATOR_ACTION.remove: {\n            if (state.columnAxes.some(function (s) { return compareAxes(s, action.payload); })) {\n                newColumns = state.columnAxes.filter(function (s) { return !compareAxes(s, action.payload); }).slice();\n                filterField(newColumns, { uniqueName: action.payload.name });\n            }\n            if (state.rowAxes.some(function (s) { return compareAxes(s, action.payload); })) {\n                newRows = state.rowAxes.filter(function (s) { return !compareAxes(s, action.payload); }).slice();\n                filterField(newRows, { uniqueName: action.payload.name });\n            }\n            if (state.measureAxes.some(function (s) { return compareAxes(s, action.payload); })) {\n                newMeasures = state.measureAxes.filter(function (s) { return !compareAxes(s, action.payload); }).slice();\n            }\n            break;\n        }\n        case PIVOT_CONFIGURATOR_ACTION.setDragItem:\n            newDragitem = action.payload;\n            break;\n        case PIVOT_CONFIGURATOR_ACTION.setDropZone:\n            newDropZone = action.payload;\n            break;\n        case PIVOT_CONFIGURATOR_ACTION.setDropTarget:\n            newDropTarget = action.payload;\n            break;\n        case PIVOT_CONFIGURATOR_ACTION.setDropDirection:\n            newDropDirection = action.payload;\n            break;\n        case PIVOT_CONFIGURATOR_ACTION.drop:\n            if (state.dragItem && state.dropZone) {\n                var currentColumn = state.columnAxes.find(function (s) { return compareAxes(s, action.payload); });\n                var currentRow = state.rowAxes.find(function (s) { return compareAxes(s, action.payload); });\n                var currentMeasure = state.measureAxes.find(function (s) { return compareAxes(s, action.payload); });\n                var current = void 0;\n                if (currentColumn) {\n                    current = currentColumn;\n                    newColumns = state.columnAxes.filter(function (s) { return !compareAxes(s, action.payload); }).slice();\n                    filterField(newColumns, { uniqueName: action.payload.name });\n                }\n                if (currentRow) {\n                    current = currentRow;\n                    newRows = state.rowAxes.filter(function (s) { return !compareAxes(s, action.payload); }).slice();\n                    filterField(newRows, { uniqueName: action.payload.name });\n                }\n                if (currentMeasure) {\n                    current = currentMeasure;\n                    newMeasures = state.measureAxes.filter(function (s) { return !compareAxes(s, action.payload); }).slice();\n                }\n                switch (state.dropZone) {\n                    case 'columnAxes': {\n                        newColumns = newColumns || state.columnAxes.slice();\n                        insertAxis(newColumns, current, state);\n                        break;\n                    }\n                    case 'rowAxes': {\n                        newRows = newRows || state.rowAxes.slice();\n                        insertAxis(newRows, current, state);\n                        break;\n                    }\n                    case 'measureAxes': {\n                        newMeasures = newMeasures || state.measureAxes.slice();\n                        insertAxis(newMeasures, current, state);\n                        break;\n                    }\n                    default:\n                        break;\n                }\n            }\n            newDragitem = null;\n            newDropZone = null;\n            newDropTarget = null;\n            break;\n        case PIVOT_CONFIGURATOR_ACTION.setSort:\n            newSort = action.payload;\n            break;\n        case PIVOT_CONFIGURATOR_ACTION.setFilter:\n            if (Array.isArray(action.payload)) {\n                newFilter = action.payload;\n            }\n            else {\n                newFilter = [action.payload];\n            }\n            break;\n        case PIVOT_CONFIGURATOR_ACTION.addFilter:\n            newFilter = (state.filter || []).slice();\n            if (Array.isArray(action.payload)) {\n                newFilter.push.apply(newFilter, action.payload);\n            }\n            else {\n                newFilter.push(action.payload);\n            }\n            break;\n        case PIVOT_CONFIGURATOR_ACTION.changeFilter:\n            newFilter = (Array.isArray(action.payload)\n                ? (state.filter || []).map(function (f) { return action.payload.some(function (a) { return a.field === f.field; })\n                    ? action.payload.find(function (a) { return a.field === f.field; })\n                    : f; })\n                : (state.filter || []).map(function (f) { return f.field === action.payload.field\n                    ? action.payload\n                    : f; }));\n            break;\n        case PIVOT_CONFIGURATOR_ACTION.removeFilter:\n            newFilter = (state.filter || []).slice();\n            if (Array.isArray(action.payload)) {\n                newFilter = newFilter.filter(function (f) { return !action.payload.some(function (p) { return p.field === f.field &&\n                    p.operator === f.operator; }); });\n            }\n            else {\n                newFilter = newFilter.filter(function (f) { return !(f.field === action.payload.field\n                    && f.operator === action.payload.operator); });\n            }\n            break;\n        default:\n            break;\n    }\n    return {\n        dragItem: newDragitem,\n        dropTarget: newDropTarget,\n        dropDirection: newDropDirection,\n        dropZone: newDropZone,\n        columnAxes: newColumns,\n        rowAxes: newRows,\n        measureAxes: newMeasures,\n        filter: newFilter,\n        sort: newSort\n    };\n};\n\n// tslint:disable:object-literal-sort-keys\n/**\n * Represents the aggregate object which calculates the total value. Applicable for local data binding.\n */\nvar sumAggregate = {\n    init: function (data) {\n        if (('sum' in data) === false) {\n            data.sum = 0;\n        }\n    },\n    merge: function (src, dest) {\n        dest.sum += src.sum;\n    },\n    accumulate: function (acc, value) {\n        acc.sum += value;\n    },\n    result: function (data) { return data.sum; },\n    format: function (value) { return value.toFixed(2); }\n};\n/**\n * Represents the aggregate object which calculates the count value. Applicable for local data binding.\n */\nvar countAggregate = {\n    init: function (data) {\n        if (('countA' in data) === false) {\n            data.countA = 0;\n        }\n    },\n    merge: function (src, dest) {\n        dest.countA += src.countA;\n    },\n    accumulate: function (acc, _value) {\n        acc.countA += 1;\n    },\n    result: function (data) { return data.countA; },\n    format: function (value) { return value.toFixed(); }\n};\n/**\n * Represents the aggregate object which calculates the minimum value. Applicable for local data binding.\n */\nvar minAggregate = {\n    init: function (data) {\n        if (('min' in data) === false) {\n            data.min = Number.POSITIVE_INFINITY;\n        }\n    },\n    merge: function (src, dest) {\n        dest.min = Math.min(src.min, dest.min);\n    },\n    accumulate: function (acc, value) {\n        acc.min = Math.min(value, acc.min);\n    },\n    result: function (data) { return Number.isFinite(data.min) ? data.min : NaN; },\n    format: function (value) { return value.toFixed(2); }\n};\n/**\n * Represents the aggregate object which calculates the maximum value. Applicable for local data binding.\n */\nvar maxAggregate = {\n    init: function (data) {\n        if (('max' in data) === false) {\n            data.max = Number.NEGATIVE_INFINITY;\n        }\n    },\n    merge: function (src, dest) {\n        dest.max = Math.max(src.max, dest.max);\n    },\n    accumulate: function (acc, value) {\n        acc.max = Math.max(value, acc.max);\n    },\n    result: function (data) { return Number.isFinite(data.max) ? data.max : NaN; },\n    format: function (value) { return value.toFixed(2); }\n};\n/**\n * Represents the aggregate object which calculates the average value. Applicable for local data binding.\n */\nvar averageAggregate = {\n    init: function (data) {\n        if (('count' in data) === false) {\n            data.sumA = 0;\n            data.count = 0;\n        }\n    },\n    merge: function (src, dest) {\n        dest.sumA += src.sumA;\n        dest.count += src.count;\n    },\n    accumulate: function (acc, value) {\n        acc.sumA += value;\n        acc.count += 1;\n    },\n    result: function (data) { return data.sumA / data.count; },\n    format: function (value) { return value.toFixed(2); }\n};\n\nfunction forEachDesc(desc, callbackfn) {\n    if ('filters' in desc) {\n        desc.filters.map(function (child) { return forEachDesc(child, callbackfn); });\n    }\n    else {\n        callbackfn(desc);\n    }\n}\nvar filterFields = function (filter, callback) {\n    var descriptors = Array.isArray(filter) ? filter : filter.filters;\n    descriptors.forEach(function (desc) { return forEachDesc(desc, callback); });\n};\n/** @hidden */\nvar initializeFiltering = function (rows, columns, filter) {\n    var compositeFilter = filter ?\n        (Array.isArray(filter) ? { logic: 'and', filters: filter } : filter) : undefined;\n    var predicate = compositeFilter ? compileFilter(compositeFilter) : function () { return true; };\n    var axes = rows.concat(columns);\n    var fieldValues = [];\n    filterFields(filter || [], function (desc) {\n        if ('field' in desc && desc.field) {\n            fieldValues.push(desc.field);\n        }\n    });\n    var result = { hasFilter: false, predicate: predicate, filteringAxes: [] };\n    if (fieldValues.some(function (f) { return typeof f === 'function'; })) {\n        result.filteringAxes = axes.slice();\n    }\n    else if (fieldValues.length > 0) {\n        var filteringFields_1 = Array.from(new Set(fieldValues).values());\n        var filteringAxes = axes.filter(function (a) { return filteringFields_1.indexOf(a.key) >= 0; });\n        result.filteringAxes = filteringAxes;\n    }\n    result.hasFilter = result.filteringAxes.length > 0;\n    return result;\n};\n\n/** @hidden */\nvar subNode = function (node, field, initialNode) {\n    var childNode = node.get(field);\n    if (!childNode) {\n        childNode = initialNode || new Map();\n        node.set(field, childNode);\n    }\n    return childNode;\n};\nvar separator = '&';\n/** @hidden */\nvar createKey = function (key, value) { return key + separator + value; };\n/** @hidden */\nvar splitKeyValue = function (keyValue) {\n    var separatorIndex = keyValue.indexOf(separator);\n    if (separatorIndex !== -1) {\n        var key = keyValue.substring(0, separatorIndex);\n        var value = keyValue.substring(separatorIndex + 1);\n        return [key, value];\n    }\n    else {\n        return [keyValue, undefined];\n    }\n};\n\nvar calculateColumnData = function (node, measures, dataField) {\n    node.forEach(function (childNode, k) {\n        if (k !== dataField) {\n            if (childNode.size > 0) {\n                calculateColumnData(childNode, measures, dataField);\n            }\n            var childData_1 = childNode.get(dataField);\n            var parentData_1 = subNode(node, dataField, {});\n            measures.forEach(function (m) {\n                m.aggregate.init(parentData_1);\n                m.aggregate.merge(childData_1, parentData_1);\n            });\n        }\n    });\n};\n/** @hidden */\nvar mergeTrees = function (src, dest, measures, dataField) {\n    src.forEach(function (srcChild, k) {\n        var destChild;\n        if (k !== dataField) {\n            destChild = subNode(dest, k);\n            mergeTrees(srcChild, destChild, measures, dataField);\n        }\n        else {\n            destChild = subNode(dest, k, {});\n            measures.forEach(function (m) {\n                m.aggregate.init(destChild);\n                m.aggregate.merge(srcChild, destChild);\n            });\n        }\n    });\n};\nvar calculateColumns = function (node, measures, columnsData, dataField) {\n    node.forEach(function (childNode, k) {\n        if (k !== columnsData) {\n            if (childNode.size > 0) {\n                calculateColumns(childNode, measures, columnsData, dataField);\n            }\n            var srcColumns = subNode(childNode, columnsData);\n            var destColumns = subNode(node, columnsData);\n            mergeTrees(srcColumns, destColumns, measures, dataField);\n        }\n    });\n};\n/** @hidden */\nvar createDataTree = function (data, rows, columns, measures, fields, filter) {\n    var result = new Map();\n    var cache = new Map();\n    var axes = rows.concat(columns);\n    var leafNodes = new Set();\n    var dataField = fields.dataField, columnsData = fields.columnsData;\n    var _a = initializeFiltering(rows, columns, filter), hasFilter = _a.hasFilter, predicate = _a.predicate, filteringAxes = _a.filteringAxes;\n    var empty = '';\n    data.forEach(function (dataItem) {\n        if (hasFilter) {\n            var filteringDataItem_1 = {};\n            filteringAxes.forEach(function (axis) { filteringDataItem_1[axis.key] = axis.displayValue(dataItem); });\n            if (!predicate(filteringDataItem_1)) {\n                return;\n            }\n        }\n        var values = axes.map(function (a) { return a.displayValue(dataItem); });\n        var dataKey = empty.concat.apply(empty, values);\n        var nodeData = cache.get(dataKey);\n        if (!nodeData) {\n            var node_1 = result;\n            var eachAxis = function (axis) {\n                node_1 = subNode(node_1, createKey(axis.key, axis.displayValue(dataItem)));\n            };\n            rows.forEach(eachAxis);\n            node_1 = subNode(node_1, columnsData);\n            leafNodes.add(node_1);\n            columns.forEach(eachAxis);\n            nodeData = {};\n            node_1.set(dataField, nodeData);\n            cache.set(dataKey, nodeData);\n            measures.forEach(function (m) {\n                m.aggregate.init(nodeData);\n            });\n        }\n        measures.forEach(function (m) {\n            m.aggregate.accumulate(nodeData, m.value(dataItem));\n        });\n    });\n    leafNodes.forEach(function (leaf) { return calculateColumnData(leaf, measures, dataField); });\n    calculateColumns(result, measures, columnsData, dataField);\n    return result;\n};\n/** @hidden */\nvar cloneDataTree = function (dataTree, dataField, measures) {\n    var result = new Map();\n    mergeTrees(dataTree, result, measures, dataField);\n    return result;\n};\n\nvar createPath = function (name, axes, path) {\n    var _a = splitKeyValue(name), key = _a[0], value = _a[1];\n    var result = path.slice();\n    if (key && value) {\n        var axis = axes.find(function (a) { return a.key === key; });\n        var caption_1 = axis ? axis.caption : '';\n        return result.map(function (p) { return p === caption_1 ? name : p; });\n    }\n    return result;\n};\nvar membersNode = function (tree, members, field, axisSettings, measures, dataField, cache) {\n    var cacheData = cache || new Map();\n    var path = axisSettings.map(function (a) { return a.caption; });\n    while (members.length > 1 && axisSettings.some(function (a) { return a.caption === members[members.length - 1].caption; })) {\n        members.pop();\n        path.pop();\n    }\n    var node = tree;\n    members.forEach(function (m, i) {\n        path = createPath(m.name, axisSettings, path);\n        if (node && !axisSettings.some(function (a) { return a.caption === m.name; })) {\n            if (!node.has(m.name) && !cacheData.has(path.slice(0, path.indexOf(m.name) + 1).join('-'))) {\n                var currentLevel = Array.from(node).find(function (n) { return n[0] !== field; });\n                var currentLevelNode = currentLevel && currentLevel[0];\n                var levelField_1 = currentLevelNode && splitKeyValue(currentLevelNode)[0];\n                var depth = levelField_1 ? i - axisSettings.findIndex(function (a) { return a.key === levelField_1; }) : 0;\n                var _loop_1 = function (t) {\n                    var data = [];\n                    node.forEach(function (value, key) {\n                        if (key !== field) {\n                            data.push.apply(data, Array.from(value).filter(function (d) { return d[0] !== field; }));\n                        }\n                    });\n                    var next = new Map();\n                    data.forEach(function (item) {\n                        if (next.has(item[0])) {\n                            var dest = next.get(item[0]);\n                            var src = item[1];\n                            var newDest = new Map();\n                            mergeTrees(dest, newDest, measures, dataField);\n                            mergeTrees(src, newDest, measures, dataField);\n                            next.set(item[0], newDest);\n                        }\n                        else {\n                            next.set(item[0], new Map(item[1]));\n                        }\n                    });\n                    var currentPath = path.slice(0, path.indexOf(m.name));\n                    next.forEach(function (value, key) {\n                        cacheData.set(createPath(key, axisSettings, currentPath.concat([key])).join('-'), value);\n                    });\n                    next.set(field, node.get(field));\n                    node = next;\n                };\n                for (var t = 0; t < depth; t++) {\n                    _loop_1(t);\n                }\n            }\n            node = node.get(m.name) || cacheData.get(path.slice(0, path.indexOf(m.name) + 1).join('-'));\n        }\n    });\n    return node;\n};\n/** @hidden */\nvar readData = function (dataTree, rowTuples, columnTuples, fields, columnSettings, rowSettings, measures) {\n    var data = [];\n    var dataField = fields.dataField, columnsData = fields.columnsData;\n    var rowsCache = new Map();\n    rowTuples.forEach(function (row) {\n        var rowNode = membersNode(dataTree, row.members.slice(), columnsData, rowSettings, measures, dataField, rowsCache);\n        var rowColumnsNode = rowNode && rowNode.get(columnsData);\n        columnTuples.forEach(function (col) {\n            var members = col.members.slice();\n            var measure = measures[0];\n            if (members[members.length - 1].levelName === \"[Measures].[MeasuresLevel]\") {\n                var measuresMember_1 = members.pop();\n                measure = measures.find(function (m) { return String(m.name) === measuresMember_1.caption; }) || measure;\n            }\n            var colNode = rowColumnsNode && membersNode(rowColumnsNode, members, dataField, columnSettings, measures, dataField);\n            var value = '', fmtValue = '', ordinal = 0;\n            if (colNode && measure) {\n                var result = measure.aggregate.result(colNode.get(dataField));\n                value = String(result);\n                fmtValue = measure.aggregate.format(result);\n            }\n            data.push({\n                columnTuple: col,\n                data: { fmtValue: fmtValue, ordinal: ordinal, value: value },\n                rowTuple: row\n            });\n        });\n    });\n    return data;\n};\n\nvar getTopMembersTuple = function (parentFields, axesSettings) {\n    var allTuple = { members: [] };\n    parentFields.forEach(function (topField) {\n        var axis = axesSettings.find(function (a) { return a.key === topField; });\n        var caption = axis ? axis.caption : \"\";\n        var member = {\n            caption: caption,\n            children: [],\n            hasChildren: true,\n            parentName: \"\",\n            levelNum: 0,\n            levelName: caption,\n            hierarchy: topField,\n            name: caption\n        };\n        allTuple.members.push(member);\n    });\n    return allTuple;\n};\nvar sortFunc = function (descriptor, axe) {\n    return function (a, b) {\n        var order = descriptor.dir;\n        var sortableA = axe.sortValue(splitKeyValue(a[0])[1]);\n        var sortableB = axe.sortValue(splitKeyValue(b[0])[1]);\n        if (sortableA < sortableB) {\n            return order === \"asc\" ? -1 : 1;\n        }\n        if (sortableA > sortableB) {\n            return order === \"asc\" ? 1 : -1;\n        }\n        return 0;\n    };\n};\nvar mergeData = function (src, dest, exclude) {\n    src.forEach(function (srcChild, k) {\n        if (!exclude[k]) {\n            var destChild = subNode(dest, k);\n            mergeData(srcChild, destChild, exclude);\n        }\n    });\n};\nvar childrenByKeys = function (dataTree, keys, exclude) {\n    var result = [];\n    var nodeData = function (node) { return Array.from(node).filter(function (n) { return !exclude[n[0]]; }); };\n    var element = new Map(dataTree);\n    var next;\n    var _loop_1 = function (i) {\n        next = element.get(keys[i]);\n        if (next) {\n            element = new Map(next);\n        }\n        else if (i < keys.length - 1 && Array.from(element).some(function (e) { return splitKeyValue(e[0])[0] === keys[i]; })) {\n            var curLevel_1 = [];\n            element.forEach(function (child, key) {\n                if (!exclude[key]) {\n                    curLevel_1.push.apply(curLevel_1, nodeData(new Map(child)));\n                }\n            });\n            element = new Map();\n            curLevel_1.forEach(function (item) {\n                if (element.has(item[0])) {\n                    var dest = element.get(item[0]);\n                    var src = item[1];\n                    var newDest = new Map();\n                    mergeData(dest, newDest, exclude);\n                    mergeData(src, newDest, exclude);\n                    element.set(item[0], newDest);\n                }\n                else {\n                    element.set(item[0], new Map(item[1]));\n                }\n            });\n        }\n        else if (i === 0 || i === keys.length - 1) {\n            if (Array.from(element).some(function (e) { return splitKeyValue(e[0])[0] === keys[i]; })) {\n                result.push.apply(result, nodeData(element));\n            }\n        }\n    };\n    for (var i = 0; i < keys.length; i++) {\n        _loop_1(i);\n    }\n    return result;\n};\n/** @hidden */\nvar rootFields = function (definitions) {\n    var fields = new Set();\n    definitions.forEach(function (item) {\n        if (item.name.length === 1 && !splitKeyValue(item.name[0])[1]) {\n            fields.add(item.name[0]);\n        }\n    });\n    return fields;\n};\n/** @hidden */\nvar createTuples = function (axesSettings, definitions, dataTree, sortDescriptors, excludeFields) {\n    var parentFields = rootFields(definitions);\n    var flatMembers = [];\n    var topTuple = getTopMembersTuple(parentFields, axesSettings);\n    flatMembers.push(topTuple);\n    var _loop_2 = function (i) {\n        var currDef = definitions[i];\n        if (currDef.name.length === 1 && !currDef.expand && parentFields.has(currDef.name[0])) {\n            return \"continue\";\n        }\n        var keysToAdd = new Set(parentFields.keys());\n        var currDefMembers = [];\n        var keys = [];\n        var tuples = [];\n        var axe;\n        currDef.name.forEach(function (element, index) {\n            var _a;\n            var _b = splitKeyValue(element), field = _b[0], value = _b[1];\n            axe = axesSettings.find(function (a) { return a.key === field; });\n            if (value) {\n                keysToAdd.delete(field);\n                keys.push(element);\n                var member = {\n                    children: [],\n                    caption: value,\n                    hierarchy: field,\n                    levelNum: 1,\n                    levelName: field + \" \" + field,\n                    name: element,\n                    parentName: axe ? axe.caption : \"\"\n                };\n                currDefMembers.push(member);\n            }\n            else if (currDef.expand && currDef.name.length - 1 === index) {\n                keysToAdd.delete(element);\n                keys.push(element);\n                var children = childrenByKeys(dataTree, keys, excludeFields);\n                var descriptor = sortDescriptors.find(function (desc) { return desc.field === field; });\n                if (descriptor && descriptor.dir) {\n                    children.sort(sortFunc(descriptor, axe));\n                }\n                for (var c = 0; c < children.length; c++) {\n                    var leafValue = children[c][0];\n                    var leafTuple = { members: [] };\n                    tuples.push(leafTuple);\n                    var caption = splitKeyValue(leafValue)[1];\n                    axe = axesSettings.find(function (a) { return a.key === element; });\n                    var member = {\n                        caption: caption,\n                        children: [],\n                        levelName: element + \" \" + element,\n                        levelNum: 1,\n                        parentName: axe ? axe.caption : \"\",\n                        hierarchy: element,\n                        name: leafValue\n                    };\n                    (_a = leafTuple.members).push.apply(_a, currDefMembers);\n                    leafTuple.members.push(member);\n                }\n            }\n            else if (currDef.expand) {\n                axe = axesSettings.find(function (a) { return a.key === element; });\n                var axisCaption = axe ? axe.caption : \"\";\n                keysToAdd.delete(element);\n                keys.push(element);\n                var member = {\n                    children: [],\n                    caption: axisCaption,\n                    hierarchy: element,\n                    levelName: axisCaption,\n                    levelNum: 0,\n                    name: axisCaption,\n                    parentName: \"\"\n                };\n                currDefMembers.push(member);\n            }\n            keysToAdd.forEach(function (key) {\n                tuples.forEach(function (tuple) {\n                    axe = axesSettings.find(function (a) { return a.key === key; });\n                    var curCaption = axe ? axe.caption : \"\";\n                    var member = {\n                        children: [],\n                        hasChildren: true,\n                        caption: curCaption,\n                        hierarchy: key,\n                        levelName: curCaption,\n                        levelNum: 0,\n                        name: curCaption,\n                        parentName: \"\"\n                    };\n                    tuple.members.push(member);\n                });\n            });\n            flatMembers.push.apply(flatMembers, tuples);\n        });\n    };\n    for (var i = 0; i < definitions.length; i++) {\n        _loop_2(i);\n    }\n    return flatMembers;\n};\nvar measureToMember = function (measure) {\n    return {\n        caption: String(measure.name),\n        children: [],\n        hasChildren: false,\n        hierarchy: \"[Measures]\",\n        levelName: \"[Measures].[MeasuresLevel]\",\n        levelNum: 0,\n        name: \"[Measures].[\" + measure.name + \"]\",\n        parentName: \"\"\n    };\n};\nvar addMeasure = function (tuple, measure) {\n    var measureMember = measureToMember(measure);\n    var tupleCopy = copy(tuple);\n    tupleCopy.members.push(measureMember);\n    return tupleCopy;\n};\n/** @hidden */\nvar addMultipleMeasures = function (tuples, measures) {\n    if (measures.length < 2) {\n        return tuples;\n    }\n    var result = tuples.slice();\n    for (var i = result.length - 1; i >= 0; i--) {\n        var tuple = result[i];\n        result[i] = addMeasure(result[i], measures[0]);\n        for (var m = 1; m < measures.length; m++) {\n            var tupleWithMeasure = addMeasure(tuple, measures[m]);\n            result.splice(i + m, 0, tupleWithMeasure);\n        }\n    }\n    return reverseColumnsByMeasures(result);\n};\n/** @hidden */\nvar createLocalDataState = function (args) {\n    var _a;\n    var dataTree = args.dataTree, rowSettings = args.rowSettings, columnSettings = args.columnSettings, rowAxes = args.rowAxes, columnAxes = args.columnAxes, measures = args.measures, sort = args.sort, fields = args.fields;\n    var exclude = (_a = {}, _a[fields.columnsData] = fields.columnsData, _a[fields.dataField] = fields.dataField, _a);\n    var colTuples = columnAxes.length ?\n        createTuples(columnSettings, columnAxes, dataTree.get(fields.columnsData), sort, exclude) :\n        measures.map(function (m) { return ({ members: [measureToMember(m)] }); });\n    var columnTuples = columnAxes.length > 0 ? addMultipleMeasures(colTuples, measures) : colTuples;\n    var rowTuples = rowAxes.length ? createTuples(rowSettings, rowAxes, dataTree, sort, exclude) : [{ members: [] }];\n    var resultData = readData(dataTree, rowTuples, columnTuples, fields, columnSettings, rowSettings, measures);\n    return {\n        columns: columnTuples,\n        data: resultData,\n        rows: rowTuples\n    };\n};\n\n/** @hidden */\nvar createFlatSchemaDimensions = function (dimensions, measures) {\n    var result = Object.keys(dimensions).map(function (dim) { return ({\n        caption: dim,\n        defaultHierarchy: dim,\n        description: '',\n        name: dim,\n        uniqueName: dim,\n        hierarchyUniqueName: dim,\n        measure: true,\n        type: 1 // https://github.com/telerik/kendo-pivotgrid-common/blob/develop/src/models/responseDiscover.ts#L12-L14\n    }); });\n    if (measures.length) {\n        result.push({\n            caption: 'Measures',\n            children: measures.map(function (m) { return ({\n                aggregator: '1',\n                caption: String(m.name),\n                defaultFormat: '',\n                description: '',\n                displayFolder: '',\n                groupName: String(m.name),\n                name: String(m.name),\n                uniqueName: String(m.name)\n            }); }),\n            type: 2,\n            description: '',\n            name: 'Measures',\n            uniqueName: '[Measures]'\n        });\n    }\n    return result;\n};\n\nvar Navigation = /** @class */ (function () {\n    function Navigation(options) {\n        this.tabIndex = 0;\n        this.root = null;\n        this.eventHandlers = {};\n        this.update = function () { };\n        this.tabIndex = options.tabIndex;\n    }\n    Object.defineProperty(Navigation.prototype, \"elements\", {\n        get: function () {\n            return this.root ? Array.from(this.root.querySelectorAll(this.selectors.join(','))) : [];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Navigation.prototype, \"first\", {\n        get: function () {\n            return (this.root && this.root.querySelector(this.selectors.join(','))) || null;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Navigation.prototype, \"last\", {\n        get: function () {\n            var all = this.elements;\n            return all[all.length - 1] || null;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Navigation.prototype, \"current\", {\n        get: function () {\n            return this.elements.find(function (el) { return el.matches(':focus'); });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Navigation.prototype.start = function (root) {\n        var _this = this;\n        this.root = root;\n        var _loop_1 = function (eventType) {\n            if (this_1.mouseEvents[eventType]) {\n                this_1.eventHandlers[eventType] = (function (ev) {\n                    var target = ev.target instanceof Element && ev.target.closest(_this.selectors.join(','));\n                    if (target) {\n                        _this.mouseEvents[eventType].call(undefined, target, _this, ev);\n                    }\n                });\n                root.addEventListener(eventType, this_1.eventHandlers[eventType]);\n            }\n        };\n        var this_1 = this;\n        for (var eventType in this.mouseEvents) {\n            _loop_1(eventType);\n        }\n        var _loop_2 = function (eventType) {\n            if (this_2.keyboardEvents[eventType]) {\n                this_2.eventHandlers[eventType] = (function (ev) {\n                    var target = ev.target instanceof Element && ev.target.closest(_this.selectors.join(','));\n                    var key = ev.key === ' ' ? 'Space' : ev.key;\n                    if (target && _this.keyboardEvents[eventType][key]) {\n                        _this.keyboardEvents[eventType][key].call(undefined, target, _this, ev);\n                    }\n                });\n                root.addEventListener(eventType, this_2.eventHandlers[eventType]);\n            }\n        };\n        var this_2 = this;\n        for (var eventType in this.keyboardEvents) {\n            _loop_2(eventType);\n        }\n    };\n    Navigation.prototype.stop = function () {\n        if (this.root) {\n            for (var eventType in this.eventHandlers) {\n                if (this.eventHandlers[eventType]) {\n                    this.root.removeEventListener(eventType, this.eventHandlers[eventType]);\n                }\n            }\n        }\n        this.root = null;\n    };\n    Navigation.prototype.focusElement = function (element, previous) {\n        if (element) {\n            if (previous) {\n                previous.removeAttribute('tabindex');\n                previous.classList.remove('k-focus');\n            }\n            element.setAttribute('tabindex', String(this.tabIndex));\n            element.focus({ preventScroll: true });\n        }\n    };\n    return Navigation;\n}());\n\nvar scrollableValuesSel = '.k-pivotgrid .k-pivotgrid-values';\nvar scrollableColumnHeaderSel = '.k-pivotgrid .k-pivotgrid-column-headers';\nvar scrollableRowHeaderSel = '.k-pivotgrid .k-pivotgrid-row-headers';\nvar emptyCellSel = '.k-pivotgrid > .k-pivotgrid-empty-cell';\nvar tableSel = 'table.k-pivotgrid-table';\nvar cellSel = '.k-pivotgrid-cell';\nvar scrollables = [scrollableValuesSel, scrollableColumnHeaderSel, scrollableRowHeaderSel].join(',');\nvar selectors$1 = [\n    emptyCellSel,\n    [scrollableColumnHeaderSel, tableSel, cellSel].join(' '),\n    [scrollableRowHeaderSel, tableSel, cellSel].join(' '),\n    [scrollableValuesSel, tableSel, cellSel].join(' ')\n];\nvar onEnter = function (target, nav, ev) {\n    var icon = target.querySelector('.k-icon, .k-svg-icon');\n    if (icon) {\n        var index_1 = nav.elements.indexOf(target);\n        nav.update = function () {\n            nav.focusElement(nav.elements[index_1], null);\n            nav.update = function () { };\n        };\n        icon.click();\n        ev.preventDefault();\n    }\n};\nvar tryScrollLeft = function (target, scrollable, elToScroll) {\n    if (target.offsetLeft < scrollable.scrollLeft) {\n        elToScroll.scrollLeft = target.offsetLeft;\n    }\n};\nvar tryScrollRight = function (target, scrollable, elToScroll) {\n    if (target.offsetLeft + target.offsetWidth > scrollable.scrollLeft + scrollable.offsetWidth &&\n        target.offsetWidth < scrollable.offsetWidth) {\n        elToScroll.scrollLeft = target.offsetLeft + target.offsetWidth - scrollable.offsetWidth;\n    }\n};\nvar tryScrollUp = function (target, scrollable, elToScroll) {\n    if (scrollable.scrollTop && target.offsetTop < scrollable.scrollTop) {\n        elToScroll.scrollTop = target.offsetTop;\n    }\n};\nvar tryScrollDown = function (target, scrollable, elToScroll) {\n    if (target.offsetTop + target.offsetHeight > scrollable.scrollTop + scrollable.offsetHeight &&\n        target.offsetHeight < scrollable.offsetHeight) {\n        elToScroll.scrollTop = target.offsetTop + target.offsetHeight - scrollable.offsetHeight;\n    }\n};\nvar scrollTo = function (target, root, scrollFunc) {\n    var elToScroll = root.querySelector(scrollableValuesSel);\n    var scrollable = target && target.closest(scrollables);\n    if (!elToScroll || !scrollable || !target) {\n        return;\n    }\n    scrollFunc.forEach(function (scroll) { return scroll(target, scrollable, elToScroll); });\n};\nvar tableMap = function (table) {\n    var rows = Array.from(table.rows);\n    var colsCount = Array.from((rows && rows[0] && rows[0].cells) || [])\n        .map(function (c) { return c.colSpan; })\n        .reduce(function (prev, cur) { return prev + cur; }, 0);\n    var map = rows.map(function () { return new Array(colsCount); });\n    rows.forEach(function (row, r) {\n        var curColSpan = 0;\n        Array.from(row.cells).forEach(function (c) {\n            for (var colSp = 0; colSp < c.colSpan; colSp++) {\n                for (var rowSp = 0; rowSp < c.rowSpan; rowSp++) {\n                    var ind = map[r + rowSp].findIndex(function (val, curInd) { return curInd >= curColSpan && !val; });\n                    map[r + rowSp][ind] = c;\n                }\n                curColSpan++;\n            }\n        });\n    });\n    return map;\n};\nvar navigationMap = function (root) {\n    var columnHeader = tableMap(root.querySelector([scrollableColumnHeaderSel, tableSel].join(' ')));\n    var rowHeader = tableMap(root.querySelector([scrollableRowHeaderSel, tableSel].join(' ')));\n    var values = tableMap(root.querySelector([scrollableValuesSel, tableSel].join(' ')));\n    var emptyCell = root.querySelector(emptyCellSel);\n    var emptyCellRow = new Array(rowHeader[0].length).fill(emptyCell);\n    var map = [];\n    for (var i = 0; i < columnHeader.length; i++) {\n        map.push(emptyCellRow.concat(columnHeader[i]));\n    }\n    for (var i = 0; i < rowHeader.length; i++) {\n        map.push(rowHeader[i].concat(values[i]));\n    }\n    return map;\n};\nvar getTargetPos = function (map, target) {\n    for (var r = 0; r < map.length; r++) {\n        for (var c = 0; c < map[r].length; c++) {\n            if (map[r][c] === target) {\n                return [r, c];\n            }\n        }\n    }\n    return [-1, -1];\n};\nvar ctrlKey = function (ev) { return ev.ctrlKey || ev.metaKey; };\nvar cellAt = function (root, target, pos) {\n    var map = navigationMap(root);\n    var targetPos = getTargetPos(map, target);\n    var nextPos = [targetPos[0] + pos[0], targetPos[1] + pos[1]];\n    var next = map[nextPos[0]] && map[nextPos[0]][nextPos[1]];\n    while (next && next === target) {\n        nextPos = [nextPos[0] + pos[0], nextPos[1] + pos[1]];\n        next = map[nextPos[0]] && map[nextPos[0]][nextPos[1]];\n    }\n    return next;\n};\nvar keyboardEvents$1 = {\n    keydown: {\n        ArrowLeft: function (target, nav, ev) {\n            ev.preventDefault();\n            var next = cellAt(nav.root, target, [0, -1]);\n            nav.focusElement(next, target);\n            scrollTo(next, nav.root, [tryScrollRight, tryScrollLeft, tryScrollDown, tryScrollUp]);\n        },\n        ArrowRight: function (target, nav, ev) {\n            ev.preventDefault();\n            var next = cellAt(nav.root, target, [0, 1]);\n            nav.focusElement(next, target);\n            scrollTo(next, nav.root, [tryScrollLeft, tryScrollRight, tryScrollDown, tryScrollUp]);\n        },\n        ArrowUp: function (target, nav, ev) {\n            ev.preventDefault();\n            var next = cellAt(nav.root, target, [-1, 0]);\n            nav.focusElement(next, target);\n            scrollTo(next, nav.root, [tryScrollRight, tryScrollLeft, tryScrollDown, tryScrollUp]);\n        },\n        ArrowDown: function (target, nav, ev) {\n            ev.preventDefault();\n            var next = cellAt(nav.root, target, [1, 0]);\n            nav.focusElement(next, target);\n            scrollTo(next, nav.root, [tryScrollRight, tryScrollLeft, tryScrollUp, tryScrollDown]);\n        },\n        o: function (_target, nav, _ev) {\n            if (!nav.root) {\n                return;\n            }\n            var next = nav.root.nextElementSibling;\n            if (next && next instanceof HTMLElement && next.matches('div.k-pivotgrid-configurator-button')) {\n                next.click();\n                setTimeout(function () {\n                    if (nav.root.parentNode) {\n                        var confHeader = nav.root.parentNode.querySelector('.k-pivotgrid-configurator-content .k-form-field .k-fields-list-wrapper .k-treeview');\n                        if (confHeader instanceof HTMLElement) {\n                            confHeader.setAttribute('tabindex', String(nav.tabIndex));\n                            confHeader.focus();\n                        }\n                    }\n                }, 0);\n            }\n        },\n        Enter: onEnter,\n        Space: onEnter,\n        Home: function (target, nav, ev) {\n            var map = navigationMap(nav.root);\n            var ctrl = ctrlKey(ev);\n            var row = ctrl ? map[0] : (map.find(function (ro) { return Boolean(ro.find(function (x) { return x === target; })); }) || []);\n            var next = row[0];\n            if (next) {\n                nav.focusElement(next, target);\n                scrollTo(next, nav.root, [tryScrollRight, tryScrollLeft, tryScrollDown, tryScrollUp]);\n                ev.preventDefault();\n            }\n        },\n        End: function (target, nav, ev) {\n            var map = navigationMap(nav.root);\n            var ctrl = ctrlKey(ev);\n            var row = ctrl ? map[map.length - 1] : (map.find(function (ro) { return Boolean(ro.find(function (x) { return x === target; })); }) || []);\n            var next = row && row[row.length - 1] || null;\n            if (next) {\n                nav.focusElement(next, target);\n                scrollTo(next, nav.root, [tryScrollLeft, tryScrollRight, tryScrollUp, tryScrollDown]);\n                ev.preventDefault();\n            }\n        }\n    }\n};\nvar mouseEvents$1 = {\n    click: function (target, nav) {\n        if (target && target instanceof HTMLElement) {\n            var prev = nav.elements.find(function (c) { return c.hasAttribute('tabindex'); }) || null;\n            nav.focusElement(target, prev);\n        }\n    }\n};\n/**\n * The PivotGrid keyboard navigation functionality.\n *\n * Usage:\n *\n * On Initialize\n * const navigation = new PivotGridNavigation({ tabindex: 0 });\n *\n * Turn on\n * navigation.start(rootDomElement);\n *\n * On After Update\n * navigation.update();\n *\n * On Destroy / Turn off\n * navigation.stop();\n */\nvar PivotGridNavigation = /** @class */ (function (_super) {\n    __extends(PivotGridNavigation, _super);\n    function PivotGridNavigation() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.selectors = selectors$1;\n        _this.mouseEvents = mouseEvents$1;\n        _this.keyboardEvents = keyboardEvents$1;\n        return _this;\n    }\n    return PivotGridNavigation;\n}(Navigation));\n\nvar selectors = [\n    '.k-pivotgrid-configurator-content .k-form-field .k-fields-list-wrapper .k-treeview',\n    '.k-pivotgrid-configurator-content .k-chip',\n    '.k-pivotgrid-configurator-actions button'\n];\nvar onEscape = function (_target, nav, ev) {\n    if (ev.target instanceof HTMLElement) {\n        if (nav.root) {\n            var pivot = nav.root.previousElementSibling;\n            var confButton = nav.root.nextElementSibling;\n            var pivotCell = Array.from(pivot instanceof HTMLElement ? pivot.querySelectorAll('[tabindex]') : []).find(function (c) { return c.tabIndex >= 0; });\n            if (pivotCell instanceof HTMLElement) {\n                pivotCell.focus();\n                if (confButton instanceof HTMLElement) {\n                    confButton.click();\n                }\n            }\n        }\n    }\n};\nvar navigate = function (target, nav, ev, dir) {\n    ev.preventDefault();\n    var all = nav.elements;\n    var index = all.indexOf(target) + dir;\n    if (index < 0) {\n        index = all.length - 1;\n    }\n    nav.focusElement(all[index % all.length], target);\n};\nvar onDelete = function (target, nav, ev) {\n    if (ev.target instanceof HTMLElement) {\n        var deleteButton = ev.target.querySelector('.k-icon.k-i-x-circle, .k-svg-icon.k-svg-i-x-circle');\n        if (deleteButton instanceof HTMLElement) {\n            ev.preventDefault();\n            navigate(target, nav, ev, -1);\n        }\n    }\n};\nvar keyboardEvents = {\n    keydown: {\n        Tab: function (target, nav, ev) {\n            navigate(target, nav, ev, ev.shiftKey ? -1 : 1);\n        },\n        Escape: onEscape,\n        Delete: onDelete,\n        Backspace: onDelete\n    }\n};\nvar mouseEvents = {\n    click: function (target, nav) {\n        if (target && target instanceof HTMLElement) {\n            var prev = nav.elements.find(function (c) { return c.hasAttribute('tabindex'); }) || null;\n            nav.focusElement(target, prev);\n        }\n    }\n};\n/**\n * The PivotGrid Configurator keyboard navigation functionality.\n *\n * Usage:\n *\n * On Initialize\n * const navigation = new ConfiguratorNavigation({ tabindex: 0 });\n *\n * Turn on\n * navigation.start(rootDomElement);\n *\n * On After Update\n * navigation.update();\n *\n * On Destroy / Turn off\n * navigation.stop();\n */\nvar ConfiguratorNavigation = /** @class */ (function (_super) {\n    __extends(ConfiguratorNavigation, _super);\n    function ConfiguratorNavigation() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.selectors = selectors;\n        _this.mouseEvents = mouseEvents;\n        _this.keyboardEvents = keyboardEvents;\n        return _this;\n    }\n    return ConfiguratorNavigation;\n}(Navigation));\n\nexport { discoverCommands as A, mergeTrees as B, parseResponse as C, readData as D, rootFields as E, setFilter as F, setSort as G, ConfiguratorNavigation as H, PIVOT_CONFIGURATOR_ACTION as I, PivotGridNavigation as P, createLocalDataState as a, averageAggregate as b, createDataTree as c, maxAggregate as d, countAggregate as e, fetchData as f, createDataState as g, fetchDiscover as h, headersReducer as i, toTree as j, toColumns as k, toRows as l, minAggregate as m, addKPI as n, addMultipleMeasures as o, buildKPIMeasures as p, cloneDataTree as q, compareAxes as r, sumAggregate as s, toData as t, configuratorReducer as u, createAxisDescriptors as v, createDiscoverBody as w, createFlatSchemaDimensions as x, createRequestBody as y, createTuples as z };\nexport { __meta__ };"]}