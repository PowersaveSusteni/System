/**
 * Kendo UI v2024.4.1112 (http://www.telerik.com/kendo-ui)
 * Copyright 2024 Progress Software Corporation and/or one of its subsidiaries or affiliates. All rights reserved.
 *
 * Kendo UI commercial licenses may be obtained at
 * http://www.telerik.com/purchase/license-agreement/kendo-ui-complete
 * If you do not own a commercial license, this file shall be governed by the trial license terms.
 */
import{J as JSZip}from"./kendo.jszip-esm.cmn.chunk.js";const __meta__={id:"ooxml.cmn.chunk",name:"OoxmlCmnChunk",category:"web",description:"A reusable outputed chunk of code",depends:["jszip-esm.cmn.chunk"],hidden:!0,chunk:!0};var current$1={compile:function(e){return e}},TemplateService=function(){};TemplateService.register=function(e){current$1=e},TemplateService.compile=function(e){return current$1.compile(e)};var FIELD_REGEX=/\[(?:(\d+)|['"](.*?)['"])\]|((?:(?!\[.*?\]|\.).)+)/g,getterCache={},UNDEFINED="undefined";function getter(e){if(getterCache[e])return getterCache[e];var t=[];return e.replace(FIELD_REGEX,(function(e,n,r,o){t.push(typeof n!==UNDEFINED?n:r||o)})),getterCache[e]=function(e){for(var n=e,r=0;r<t.length&&n;r++)n=n[t[r]];return n},getterCache[e]}function map(e,t){return e.reduce((function(e,n,r){var o=t(n,r);return null!=o&&e.push(o),e}),[])}function defaultGroupHeaderTemplate(e){return e.title+": "+e.value}function createArray(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n}function defaultItemId(e){return e.id}getterCache[UNDEFINED]=function(e){return e};var ExcelExporter=function(e){e.columns=this._trimColumns(e.columns||[]),this.allColumns=map(this._leafColumns(e.columns||[]),this._prepareColumn),this.columns=this._visibleColumns(this.allColumns),this.options=e,this.data=e.data||[],this.aggregates=e.aggregates||{},this.groups=[].concat(e.groups||[]),this.hasGroups=this.groups.length>0,this.hierarchy=e.hierarchy,this.hasGroupHeaderColumn=this.columns.some((function(e){return e.groupHeaderColumnTemplate})),this.collapsible=this.options.collapsible};ExcelExporter.prototype.workbook=function(){var e={sheets:[{columns:this._columns(),rows:this.hierarchy?this._hierarchyRows():this._rows(),freezePane:this._freezePane(),filter:this._filter()}]};return e},ExcelExporter.prototype._trimColumns=function(e){var t=this;return e.filter((function(e){var n=Boolean(e.field);return!n&&e.columns&&(n=t._trimColumns(e.columns).length>0),n}))},ExcelExporter.prototype._leafColumns=function(e){for(var t=[],n=0;n<e.length;n++)e[n].columns?t=t.concat(this._leafColumns(e[n].columns)):t.push(e[n]);return t},ExcelExporter.prototype._prepareColumn=function(e){if(!e.field)return null;var t=function(t){return getter(e.field,!0)(t)},n=null;return e.values&&(n={},e.values.forEach((function(e){n[e.value]=e.text})),t=function(t){return n[getter(e.field,!0)(t)]}),Object.assign({},e,{value:t,values:n,groupHeaderTemplate:e.groupHeaderTemplate?TemplateService.compile(e.groupHeaderTemplate):defaultGroupHeaderTemplate,groupHeaderColumnTemplate:e.groupHeaderColumnTemplate?TemplateService.compile(e.groupHeaderColumnTemplate):null,groupFooterTemplate:e.groupFooterTemplate?TemplateService.compile(e.groupFooterTemplate):null,footerTemplate:e.footerTemplate?TemplateService.compile(e.footerTemplate):null})},ExcelExporter.prototype._filter=function(){if(!this.options.filterable)return null;var e=this._depth();return{from:e,to:e+this.columns.length-1}},ExcelExporter.prototype._createPaddingCells=function(e){var t=this;return createArray(e,(function(){return Object.assign({background:"#dfdfdf",color:"#333"},t.options.paddingCellOptions)}))},ExcelExporter.prototype._dataRow=function(e,t,n){var r=this._createPaddingCells(t);if(this.hasGroups&&n&&e.items){r=r.concat(this._groupHeaderCells(e,t,n));var o=this._dataRows(e.items,t+1);return o.unshift({type:"group-header",cells:r,level:this.collapsible?t:null}),o.concat(this._footer(e,t))}for(var i=[],a=0;a<this.columns.length;a++)i[a]=this._cell(e,this.columns[a]);return this.hierarchy&&(i[0].colSpan=n-t+1),[{type:"data",cells:r.concat(i),level:this.collapsible?t:null}]},ExcelExporter.prototype._groupHeaderCells=function(e,t,n){var r=[],o=this.allColumns.filter((function(t){return t.field===e.field}))[0]||{},i=o&&o.title?o.title:e.field,a=o?o.groupHeaderTemplate||o.groupHeaderColumnTemplate:null,s=Object.assign({title:i,field:e.field,value:o&&o.values?o.values[e.value]:e.value,aggregates:e.aggregates,items:e.items},e.aggregates[e.field]),l=a?a(s):i+": "+e.value;return r.push(Object.assign({value:l,background:"#dfdfdf",color:"#333",colSpan:(this.hasGroupHeaderColumn?1:this.columns.length)+n-t},o.groupHeaderCellOptions)),this.hasGroupHeaderColumn&&this.columns.forEach((function(t,n){n>0&&r.push(Object.assign({background:"#dfdfdf",color:"#333",value:t.groupHeaderColumnTemplate?t.groupHeaderColumnTemplate(Object.assign({group:s},s,e.aggregates[t.field])):void 0},t.groupHeaderCellOptions))})),r},ExcelExporter.prototype._dataRows=function(e,t){for(var n=this._depth(),r=[],o=0;o<e.length;o++)r.push.apply(r,this._dataRow(e[o],t,n));return r},ExcelExporter.prototype._hierarchyRows=function(){var e,t=this._depth(),n=this.data,r=this.hierarchy.itemLevel,o=this.hierarchy.itemId||defaultItemId,i=this._hasFooterTemplate(),a=[],s=[],l=0;i||(this.collapsible=!1);for(var c=0;c<n.length;c++){var p=n[c],u=r(p,c);i&&(u>l?s.push({id:e,level:l}):u<l&&a.push.apply(a,this._hierarchyFooterRows(s,u,t)),l=u,e=o(p,c)),a.push.apply(a,this._dataRow(p,u+1,t))}if(i){a.push.apply(a,this._hierarchyFooterRows(s,0,t));var m=n.length?this.aggregates[n[0].parentId]:{};a.push(this._hierarchyFooter(m,0,t))}return this._prependHeaderRows(a),a},ExcelExporter.prototype._hierarchyFooterRows=function(e,t,n){for(var r=[];e.length&&e[e.length-1].level>=t;){var o=e.pop();r.push(this._hierarchyFooter(this.aggregates[o.id],o.level+1,n))}return r},ExcelExporter.prototype._hasFooterTemplate=function(){for(var e=this.columns,t=0;t<e.length;t++)if(e[t].footerTemplate)return!0},ExcelExporter.prototype._hierarchyFooter=function(e,t,n){var r=this.columns.map((function(r,o){var i=o?1:n-t+1;if(r.footerTemplate){var a=(e||{})[r.field];return Object.assign({background:"#dfdfdf",color:"#333",colSpan:i,value:r.footerTemplate(Object.assign({aggregates:e},a))},r.footerCellOptions)}return Object.assign({background:"#dfdfdf",color:"#333",colSpan:i},r.footerCellOptions)}));return{type:"footer",cells:this._createPaddingCells(t).concat(r),level:this.collapsible?t:null}},ExcelExporter.prototype._footer=function(e,t){var n,r,o=[],i=this.columns.some((function(e){return e.groupFooterTemplate}));i&&(r={group:{items:e.items,field:e.field,value:e.value}},n={},Object.keys(e.aggregates).forEach((function(t){n[t]=Object.assign({},e.aggregates[t],r)})));var a=this.columns.map((function(t){if(t.groupFooterTemplate){var o=Object.assign({},n,e.aggregates[t.field],r);return Object.assign({background:"#dfdfdf",color:"#333",value:t.groupFooterTemplate(o)},t.groupFooterCellOptions)}return Object.assign({background:"#dfdfdf",color:"#333"},t.groupFooterCellOptions)}));return i&&o.push({type:"group-footer",cells:this._createPaddingCells(this.groups.length).concat(a),level:this.collapsible?t:null}),o},ExcelExporter.prototype._isColumnVisible=function(e){return this._visibleColumns([e]).length>0&&(e.field||e.columns)},ExcelExporter.prototype._visibleColumns=function(e){var t=this;return e.filter((function(e){var n=e.exportable;"object"==typeof n&&(n=e.exportable.excel);var r=!e.hidden&&!1!==n,o=e.hidden&&!0===n,i=r||o;return i&&e.columns&&(i=t._visibleColumns(e.columns).length>0),i}))},ExcelExporter.prototype._headerRow=function(e,t){var n=this,r=e.cells.map((function(t){return Object.assign(t,{colSpan:t.colSpan>1?t.colSpan:1,rowSpan:e.rowSpan>1&&!t.colSpan?e.rowSpan:1})}));return this.hierarchy&&r[0].firstCell&&(r[0].colSpan+=this._depth()),{type:"header",cells:createArray(t.length,(function(){return Object.assign({background:"#7a7a7a",color:"#fff"},n.options.headerPaddingCellOptions)})).concat(r)}},ExcelExporter.prototype._prependHeaderRows=function(e){var t=this.groups,n=[{rowSpan:1,cells:[],index:0}];this._prepareHeaderRows(n,this.options.columns);for(var r=n.length-1;r>=0;r--)e.unshift(this._headerRow(n[r],t))},ExcelExporter.prototype._prepareHeaderRows=function(e,t,n,r){for(var o=this,i=r||e[e.length-1],a=e[i.index+1],s=0,l=0;l<t.length;l++){var c=t[l];if(o._isColumnVisible(c)){var p=Object.assign({background:"#7a7a7a",color:"#fff",value:c.title||c.field,colSpan:0,firstCell:0===l&&(!n||n.firstCell)},c.headerCellOptions);i.cells.push(p),c.columns&&c.columns.length&&(a||(a={rowSpan:0,cells:[],index:e.length},e.push(a)),p.colSpan=o._trimColumns(o._visibleColumns(c.columns)).length,o._prepareHeaderRows(e,c.columns,p,a),s+=p.colSpan-1,i.rowSpan=e.length-i.index)}}n&&(n.colSpan+=s)},ExcelExporter.prototype._rows=function(){var e=this,t=this._dataRows(this.data,0);if(this.columns.length){this._prependHeaderRows(t);var n=!1,r=this.columns.map((function(t){return t.footerTemplate?(n=!0,Object.assign({background:"#dfdfdf",color:"#333",value:t.footerTemplate(Object.assign({},e.aggregates,e.aggregates[t.field]))},t.footerCellOptions)):Object.assign({background:"#dfdfdf",color:"#333"},t.footerCellOptions)}));n&&t.push({type:"footer",cells:this._createPaddingCells(this.groups.length).concat(r)})}return t},ExcelExporter.prototype._headerDepth=function(e){for(var t=0,n=0;n<e.length;n++)if(e[n].columns){var r=this._headerDepth(e[n].columns);r>t&&(t=r)}return 1+t},ExcelExporter.prototype._freezePane=function(){var e=this._visibleColumns(this.options.columns||[]),t=this._visibleColumns(this._trimColumns(this._leafColumns(e.filter((function(e){return e.locked}))))).length;return{rowSplit:this._headerDepth(e),colSplit:t?t+this.groups.length:0}},ExcelExporter.prototype._cell=function(e,t){return Object.assign({value:t.value(e)},t.cellOptions)},ExcelExporter.prototype._depth=function(){return this.hierarchy?this.hierarchy.depth:this.groups.length},ExcelExporter.prototype._columns=function(){return createArray(this._depth(),(function(){return{width:20}})).concat(this.columns.map((function(e){return{width:parseInt(e.width,10),autoWidth:!e.width}})))};var current={toString:function(e){return e}},IntlService=function(){};function createZip(){return new JSZip}function dateToJulianDays(e,t,n){return(1461*(e+4800+((t-13)/12|0))/4|0)+(367*(t-1-12*((t-13)/12|0))/12|0)-(3*((e+4900+((t-13)/12|0))/100|0)/4|0)+n-32075}IntlService.register=function(e){current=e},IntlService.toString=function(e,t){return current.toString(e,t)};var BASE_DATE=dateToJulianDays(1900,0,-1);function packDate(e,t,n){return dateToJulianDays(e,t,n)-BASE_DATE}function packTime(e,t,n,r){return(e+(t+(n+r/1e3)/60)/60)/24}function dateToSerial(e){var t=packTime(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),n=packDate(e.getFullYear(),e.getMonth(),e.getDate());return n<0?n-1+t:n+t}var MIME_TYPE="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",DATA_URL_PREFIX="data:"+MIME_TYPE+";base64,",DATA_URL_OPTIONS={compression:"DEFLATE",type:"base64"},BLOB_OPTIONS={compression:"DEFLATE",type:"blob"},ARRAYBUFFER_OPTIONS={compression:"DEFLATE",type:"arraybuffer"};function toDataURI(e){return DATA_URL_PREFIX+e}function indexOf(e,t){return t.indexOf(e)}var parseJSON=JSON.parse.bind(JSON);function ESC(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#39;")}function repeat(e,t){for(var n="",r=0;r<e;++r)n+=t(r);return n}function foreach(e,t){var n="";if(null!=e)if(Array.isArray(e))for(var r=0;r<e.length;++r)n+=t(e[r],r);else"object"==typeof e&&Object.keys(e).forEach((function(r,o){n+=t(e[r],r,o)}));return n}var XMLHEAD='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r',RELS=XMLHEAD+'\n            <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\n               <Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/>\n               <Relationship Id="rId2" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/>\n               <Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/>\n            </Relationships>',CORE=function(e){var t=e.creator,n=e.lastModifiedBy,r=e.created,o=e.modified;return XMLHEAD+'\n <cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties"\n   xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/"\n   xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\n   <dc:creator>'+ESC(t)+"</dc:creator>\n   <cp:lastModifiedBy>"+ESC(n)+'</cp:lastModifiedBy>\n   <dcterms:created xsi:type="dcterms:W3CDTF">'+ESC(r)+'</dcterms:created>\n   <dcterms:modified xsi:type="dcterms:W3CDTF">'+ESC(o)+"</dcterms:modified>\n</cp:coreProperties>"},APP=function(e){var t=e.sheets;return XMLHEAD+'\n<Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes">\n  <Application>Microsoft Excel</Application>\n  <DocSecurity>0</DocSecurity>\n  <ScaleCrop>false</ScaleCrop>\n  <HeadingPairs>\n    <vt:vector size="2" baseType="variant">\n      <vt:variant>\n        <vt:lpstr>Worksheets</vt:lpstr>\n      </vt:variant>\n      <vt:variant>\n        <vt:i4>'+t.length+'</vt:i4>\n      </vt:variant>\n    </vt:vector>\n  </HeadingPairs>\n  <TitlesOfParts>\n    <vt:vector size="'+t.length+'" baseType="lpstr">'+foreach(t,(function(e,t){return e.options.title?"<vt:lpstr>"+ESC(e.options.title)+"</vt:lpstr>":"<vt:lpstr>Sheet"+(t+1)+"</vt:lpstr>"}))+"</vt:vector>\n  </TitlesOfParts>\n  <LinksUpToDate>false</LinksUpToDate>\n  <SharedDoc>false</SharedDoc>\n  <HyperlinksChanged>false</HyperlinksChanged>\n  <AppVersion>14.0300</AppVersion>\n</Properties>"},CONTENT_TYPES=function(e){var t=e.sheetCount,n=e.commentFiles,r=e.drawingFiles;return XMLHEAD+'\n<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">\n  <Default Extension="png" ContentType="image/png"/>\n  <Default Extension="gif" ContentType="image/gif"/>\n  <Default Extension="jpg" ContentType="image/jpeg"/>\n  <Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" />\n  <Default Extension="xml" ContentType="application/xml" />\n  <Default Extension="vml" ContentType="application/vnd.openxmlformats-officedocument.vmlDrawing"/>\n  <Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" />\n  <Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/>\n  <Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"/>\n  '+repeat(t,(function(e){return'<Override PartName="/xl/worksheets/sheet'+(e+1)+'.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" />'}))+"\n  "+foreach(n,(function(e){return'<Override PartName="/xl/'+e+'" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"/>'}))+"\n  "+foreach(r,(function(e){return'<Override PartName="/xl/drawings/'+e+'" ContentType="application/vnd.openxmlformats-officedocument.drawing+xml"/>'}))+'\n  <Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml" />\n  <Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml" />\n</Types>'},WORKBOOK=function(e){var t=e.sheets,n=e.filterNames,r=e.userNames;return XMLHEAD+'\n<workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">\n  <fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="9303" />\n  <workbookPr defaultThemeVersion="124226" />\n  <bookViews>\n    <workbookView xWindow="240" yWindow="45" windowWidth="18195" windowHeight="7995" />\n  </bookViews>\n  <sheets>\n  '+foreach(t,(function(e,t){var n=e.options,r=n.name||n.title||"Sheet"+(t+1),o=n.state||"visible";return'<sheet name="'+ESC(r)+'" state="'+o+'" sheetId="'+(t+1)+'" r:id="rId'+(t+1)+'" />'}))+"\n  </sheets>\n  "+(n.length||r.length?"\n    <definedNames>\n      "+foreach(n,(function(e){return'\n         <definedName name="_xlnm._FilterDatabase" hidden="1" localSheetId="'+e.localSheetId+'">'+ESC(quoteSheet(e.name))+"!"+ESC(e.from)+":"+ESC(e.to)+"</definedName>"}))+"\n      "+foreach(r,(function(e){return'\n         <definedName name="'+e.name+'" hidden="'+(e.hidden?1:0)+'" '+(null!=e.localSheetId?'localSheetId="'+e.localSheetId+'"':"")+">"+ESC(e.value)+"</definedName>"}))+"\n    </definedNames>":"")+'\n  <calcPr fullCalcOnLoad="1" calcId="145621" />\n</workbook>'},WORKSHEET=function(e){var t=e.frozenColumns,n=e.frozenRows,r=e.columns,o=e.defaults,i=e.data,a=e.index,s=e.mergeCells,l=e.autoFilter,c=e.filter,p=e.showGridLines,u=e.hyperlinks,m=e.validations,h=e.defaultCellStyleId,f=e.rtl,d=e.legacyDrawing,g=e.drawing,x=e.lastRow,v=e.lastCol,y=e.hasDisabledCells;return XMLHEAD+'\n<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac" mc:Ignorable="x14ac">\n   '+(x&&v?'<dimension ref="A1:'+ref(x-1,v-1)+'" />':"")+"\n\n   <sheetViews>\n     <sheetView "+(f?'rightToLeft="1"':"")+" "+(0===a?'tabSelected="1"':"")+' workbookViewId="0" '+(!1===p?'showGridLines="0"':"")+">\n     "+(n||t?'\n       <pane state="frozen"\n         '+(t?'xSplit="'+t+'"':"")+"\n         "+(n?'ySplit="'+n+'"':"")+'\n         topLeftCell="'+(String.fromCharCode(65+(t||0))+((n||0)+1))+'"\n       />':"")+'\n     </sheetView>\n   </sheetViews>\n\n   <sheetFormatPr x14ac:dyDescent="0.25" '+(o.skipCustomHeight?"":'customHeight="1"')+' defaultRowHeight="'+(o.rowHeight?.75*o.rowHeight:15)+'"\n     '+(o.columnWidth?'defaultColWidth="'+toWidth(o.columnWidth)+'"':"")+" />\n\n   "+(null!=h||r&&r.length>0?"\n     <cols>\n       "+(r&&r.length?"":'\n         <col min="1" max="16384" style="'+h+'"\n              '+(o.columnWidth?'width="'+toWidth(o.columnWidth)+'"':"")+" /> ")+"\n       "+foreach(r,(function(e,t){var n="number"==typeof e.index?e.index+1:t+1;return 0===e.width?"<col "+(null!=h?'style="'+h+'"':"")+'\n                        min="'+n+'" max="'+n+'" hidden="1" customWidth="1" />':"<col "+(null!=h?'style="'+h+'"':"")+'\n                      min="'+n+'" max="'+n+'" customWidth="1"\n                      '+(e.autoWidth?'width="'+(7*e.width+5)/7*256/256+'" bestFit="1"':'width="'+toWidth(e.width)+'"')+" />"}))+"\n     </cols>":"")+"\n\n   <sheetData>\n     "+foreach(i,(function(e,t){return'\n         <row r="'+("number"==typeof e.index?e.index+1:t+1)+'" x14ac:dyDescent="0.25"\n              '+(e.level?'outlineLevel="'+e.level+'"':"")+"\n              "+(0===e.height?'hidden="1"':e.height?'ht="'+toHeight(e.height)+'" customHeight="1"':"")+">\n           "+foreach(e.data,(function(e){return'\n             <c r="'+e.ref+'" '+(e.style?'s="'+e.style+'"':"")+" "+(e.type?'t="'+e.type+'"':"")+">\n               "+(null!=e.formula?writeFormula(e.formula):"")+"\n               "+(null!=e.value?"<v>"+ESC(e.value)+"</v>":"")+"\n             </c>"}))+"\n         </row>\n       "}))+"\n   </sheetData>\n\n   "+(y?'<sheetProtection sheet="1" objects="1" scenarios="1"/>':"")+"\n\n   "+(l?'<autoFilter ref="'+l.from+":"+l.to+'"/>':c?spreadsheetFilters(c):"")+"\n\n   "+(s.length?'\n     <mergeCells count="'+s.length+'">\n       '+foreach(s,(function(e){return'<mergeCell ref="'+e+'"/>'}))+"\n     </mergeCells>":"")+"\n\n   "+(m.length?"\n     <dataValidations>\n       "+foreach(m,(function(e){return'\n         <dataValidation sqref="'+e.sqref.join(" ")+'"\n                         showErrorMessage="'+e.showErrorMessage+'"\n                         type="'+ESC(e.type)+'"\n                         '+("list"!==e.type?'operator="'+ESC(e.operator)+'"':"")+'\n                         allowBlank="'+e.allowBlank+'"\n                         showDropDown="'+e.showDropDown+'"\n                         '+(e.error?'error="'+ESC(e.error)+'"':"")+"\n                         "+(e.errorTitle?'errorTitle="'+ESC(e.errorTitle)+'"':"")+">\n           "+(e.formula1?"<formula1>"+ESC(e.formula1)+"</formula1>":"")+"\n           "+(e.formula2?"<formula2>"+ESC(e.formula2)+"</formula2>":"")+"\n         </dataValidation>"}))+"\n     </dataValidations>":"")+"\n\n   "+(u.length?"\n     <hyperlinks>\n       "+foreach(u,(function(e){return'\n         <hyperlink ref="'+e.ref+'" r:id="'+e.rId+'"/>'}))+"\n     </hyperlinks>":"")+'\n\n   <pageMargins left="0.7" right="0.7" top="0.75" bottom="0.75" header="0.3" footer="0.3" />\n   '+(g?'<drawing r:id="'+g+'"/>':"")+"\n   "+(d?'<legacyDrawing r:id="'+d+'"/>':"")+"\n</worksheet>"},WORKBOOK_RELS=function(e){var t=e.count;return XMLHEAD+'\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\n  '+repeat(t,(function(e){return'\n    <Relationship Id="rId'+(e+1)+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet'+(e+1)+'.xml" />'}))+'\n  <Relationship Id="rId'+(t+1)+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml" />\n  <Relationship Id="rId'+(t+2)+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml" />\n</Relationships>'},WORKSHEET_RELS=function(e){var t=e.hyperlinks,n=e.comments,r=e.sheetIndex,o=e.drawings;return XMLHEAD+'\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\n  '+foreach(t,(function(e){return'\n    <Relationship Id="'+e.rId+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink" Target="'+ESC(e.target)+'" TargetMode="External" />'}))+"\n  "+(n.length?'\n    <Relationship Id="comment'+r+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments" Target="../comments'+r+'.xml"/>\n    <Relationship Id="vml'+r+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing" Target="../drawings/vmlDrawing'+r+'.vml"/>':"")+"\n  "+(o.length?'\n    <Relationship Id="drw'+r+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing" Target="../drawings/drawing'+r+'.xml"/>':"")+"\n</Relationships>"},COMMENTS_XML=function(e){var t=e.comments;return XMLHEAD+'\n<comments xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">\n  <authors>\n    <author></author>\n  </authors>\n  <commentList>\n    '+foreach(t,(function(e){return'\n      <comment ref="'+e.ref+'" authorId="0">\n        <text>\n          <r>\n            <rPr>\n              <sz val="8"/>\n              <color indexed="81"/>\n              <rFont val="Tahoma"/>\n              <charset val="1"/>\n            </rPr>\n            <t>'+ESC(e.text)+"</t>\n          </r>\n        </text>\n      </comment>"}))+"\n  </commentList>\n</comments>"},LEGACY_DRAWING=function(e){return'<xml xmlns:v="urn:schemas-microsoft-com:vml"\n     xmlns:o="urn:schemas-microsoft-com:office:office"\n     xmlns:x="urn:schemas-microsoft-com:office:excel">\n  <v:shapetype coordsize="21600,21600" id="_x0000_t202" path="m,l,21600r21600,l21600,xe">\n    <v:stroke joinstyle="miter"/>\n    <v:path gradientshapeok="t" o:connecttype="rect"/>\n  </v:shapetype>\n  '+foreach(e.comments,(function(e){return'\n    <v:shape type="#_x0000_t202" style="visibility: hidden" fillcolor="#ffffe1" o:insetmode="auto">\n      <v:shadow on="t" color="black" obscured="t"/>\n      <x:ClientData ObjectType="Note">\n        <x:MoveWithCells/>\n        <x:SizeWithCells/>\n        <x:Anchor>'+e.anchor+"</x:Anchor>\n        <x:AutoFill>False</x:AutoFill>\n        <x:Row>"+e.row+"</x:Row>\n        <x:Column>"+e.col+"</x:Column>\n      </x:ClientData>\n    </v:shape>"}))+"\n</xml>"},DRAWINGS_XML=function(e){return XMLHEAD+'\n<xdr:wsDr xmlns:xdr="http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing"\n          xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main"\n          xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">\n  '+foreach(e,(function(e,t){return'\n    <xdr:oneCellAnchor editAs="oneCell">\n      <xdr:from>\n        <xdr:col>'+e.col+"</xdr:col>\n        <xdr:colOff>"+e.colOffset+"</xdr:colOff>\n        <xdr:row>"+e.row+"</xdr:row>\n        <xdr:rowOff>"+e.rowOffset+'</xdr:rowOff>\n      </xdr:from>\n      <xdr:ext cx="'+e.width+'" cy="'+e.height+'" />\n      <xdr:pic>\n        <xdr:nvPicPr>\n          <xdr:cNvPr id="'+(t+1)+'" name="Picture '+(t+1)+'"/>\n          <xdr:cNvPicPr/>\n        </xdr:nvPicPr>\n        <xdr:blipFill>\n          <a:blip r:embed="'+e.imageId+'"/>\n          <a:stretch>\n            <a:fillRect/>\n          </a:stretch>\n        </xdr:blipFill>\n        <xdr:spPr>\n          <a:prstGeom prst="rect">\n            <a:avLst/>\n          </a:prstGeom>\n        </xdr:spPr>\n      </xdr:pic>\n      <xdr:clientData/>\n    </xdr:oneCellAnchor>'}))+"\n</xdr:wsDr>"},DRAWINGS_RELS_XML=function(e){return XMLHEAD+'\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\n  '+foreach(e,(function(e){return'\n    <Relationship Id="'+e.rId+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="'+e.target+'"/>'}))+"\n</Relationships>"},SHARED_STRINGS=function(e){var t=e.count,n=e.uniqueCount,r=e.indexes;return XMLHEAD+'\n<sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="'+t+'" uniqueCount="'+n+'">\n  '+foreach(Object.keys(r),(function(e){return'\n    <si><t xml:space="preserve">'+ESC(e.substring(1))+"</t></si>"}))+"\n</sst>"},STYLES=function(e){var t=e.formats,n=e.fonts,r=e.fills,o=e.borders,i=e.styles;return XMLHEAD+'\n<styleSheet\n    xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"\n    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"\n    mc:Ignorable="x14ac"\n    xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">\n  <numFmts count="'+t.length+'">\n  '+foreach(t,(function(e,t){return'\n    <numFmt formatCode="'+ESC(e.format)+'" numFmtId="'+(165+t)+'" />'}))+'\n  </numFmts>\n  <fonts count="'+(n.length+1)+'" x14ac:knownFonts="1">\n    <font>\n       <sz val="11" />\n       <color theme="1" />\n       <name val="Calibri" />\n       <family val="2" />\n       <scheme val="minor" />\n    </font>\n    '+foreach(n,(function(e){return"\n    <font>\n      "+(e.bold?"<b/>":"")+"\n      "+(e.italic?"<i/>":"")+"\n      "+(e.underline?"<u/>":"")+'\n      <sz val="'+(e.fontSize||11)+'" />\n      '+(e.color?'<color rgb="'+ESC(e.color)+'" />':'<color theme="1" />')+"\n      "+(e.fontFamily?'\n        <name val="'+ESC(e.fontFamily)+'" />\n        <family val="2" />\n      ':'\n        <name val="Calibri" />\n        <family val="2" />\n        <scheme val="minor" />\n      ')+"\n    </font>"}))+'\n  </fonts>\n  <fills count="'+(r.length+2)+'">\n      <fill><patternFill patternType="none"/></fill>\n      <fill><patternFill patternType="gray125"/></fill>\n    '+foreach(r,(function(e){return"\n      "+(e.background?'\n        <fill>\n          <patternFill patternType="solid">\n              <fgColor rgb="'+ESC(e.background)+'"/>\n          </patternFill>\n        </fill>\n      ':"")}))+'\n  </fills>\n  <borders count="'+(o.length+1)+'">\n    <border><left/><right/><top/><bottom/><diagonal/></border>\n    '+foreach(o,borderTemplate)+'\n  </borders>\n  <cellStyleXfs count="1">\n    <xf borderId="0" fillId="0" fontId="0" />\n  </cellStyleXfs>\n  <cellXfs count="'+(i.length+1)+'">\n    <xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0" />\n    '+foreach(i,(function(e){return'\n      <xf xfId="0"\n          '+(e.fontId?'fontId="'+e.fontId+'" applyFont="1"':"")+"\n          "+(e.fillId?'fillId="'+e.fillId+'" applyFill="1"':"")+"\n          "+(e.numFmtId?'numFmtId="'+e.numFmtId+'" applyNumberFormat="1"':"")+"\n          "+(e.textAlign||e.verticalAlign||e.wrap?'applyAlignment="1"':"")+"\n          "+(e.borderId?'borderId="'+e.borderId+'" applyBorder="1"':"")+"\n          "+(null!=e.disabled?'applyProtection="1"':"")+">\n        "+(e.textAlign||e.verticalAlign||e.wrap?"\n        <alignment\n          "+(e.textAlign?'horizontal="'+ESC(e.textAlign)+'"':"")+"\n          "+(e.verticalAlign?'vertical="'+ESC(e.verticalAlign)+'"':"")+"\n          "+(e.indent?'indent="'+ESC(e.indent)+'"':"")+"\n          "+(e.wrap?'wrapText="1"':"")+" />\n        ":"")+"\n        "+(null!=e.disabled?'\n        <protection locked="'+(e.disabled?1:0)+'" />\n        ':"")+"\n      </xf>\n    "}))+'\n  </cellXfs>\n  <cellStyles count="1">\n    <cellStyle name="Normal" xfId="0" builtinId="0"/>\n  </cellStyles>\n  <dxfs count="0" />\n  <tableStyles count="0" defaultTableStyle="TableStyleMedium2" defaultPivotStyle="PivotStyleMedium9" />\n</styleSheet>'};function writeFormula(e){return"string"==typeof e?"<f>"+ESC(e)+"</f>":'<f t="array" ref="'+e.ref+'">'+ESC(e.src)+"</f>"}function numChar(e){var t=Math.floor(e/26)-1;return(t>=0?numChar(t):"")+String.fromCharCode(65+e%26)}function ref(e,t){return numChar(t)+(e+1)}function $ref(e,t){return"$"+numChar(t)+"$"+(e+1)}function filterRowIndex(e){return(e.frozenRows||(e.freezePane||{}).rowSplit||1)-1}function toWidth(e){return e/7-Math.floor(128/7)/256}function toHeight(e){return.75*e}function stripFunnyChars(e){return String(e).replace(/[\x00-\x09\x0B\x0C\x0E-\x1F]/g,"").replace(/\r?\n/g,"\r\n")}var Worksheet=function(e,t,n,r){this.options=e,this._strings=t,this._styles=n,this._borders=r,this._validations={},this._comments=[],this._drawings=e.drawings||[],this._hyperlinks=(this.options.hyperlinks||[]).map((function(e,t){return Object.assign({},e,{rId:"link"+t})}))};function countData(e){var t=e.length;return e.forEach((function(e){e.index&&e.index>=t&&(t=e.index+1)})),t}Worksheet.prototype.relsToXML=function(){var e=this._hyperlinks,t=this._comments,n=this._drawings;if(e.length||t.length||n.length)return WORKSHEET_RELS({hyperlinks:e,comments:t,sheetIndex:this.options.sheetIndex,drawings:n})},Worksheet.prototype.toXML=function(e){var t=this,n=this.options.mergedCells||[],r=inflate(this.options.rows||[],n);this._readCells(r);var o,i=this.options.filter;i&&"number"==typeof i.from&&"number"==typeof i.to?i={from:ref(filterRowIndex(this.options),i.from),to:ref(filterRowIndex(this.options),i.to)}:i&&i.ref&&i.columns&&(o=i,i=null);var a=[];for(var s in t._validations)Object.prototype.hasOwnProperty.call(t._validations,s)&&a.push(t._validations[s]);var l=null,c=this.options.defaultCellStyle;this._hasDisabledCells&&(c=c?Object.assign({disabled:!1},c):{disabled:!1}),c&&(l=this._lookupStyle(c));var p=this.options.freezePane||{},u=this.options.defaults||{},m=this.options.rows?this._getLastRow():1,h=this.options.rows?this._getLastCol():1;return WORKSHEET({frozenColumns:this.options.frozenColumns||p.colSplit,frozenRows:this.options.frozenRows||p.rowSplit,columns:this.options.columns,defaults:u,data:r,index:e,mergeCells:n,autoFilter:i,filter:o,showGridLines:this.options.showGridLines,hyperlinks:this._hyperlinks,validations:a,defaultCellStyleId:l,rtl:void 0!==this.options.rtl?this.options.rtl:u.rtl,legacyDrawing:this._comments.length?"vml"+this.options.sheetIndex:null,drawing:this._drawings.length?"drw"+this.options.sheetIndex:null,lastRow:m,lastCol:h,hasDisabledCells:this._hasDisabledCells})},Worksheet.prototype.commentsXML=function(){if(this._comments.length)return COMMENTS_XML({comments:this._comments})},Worksheet.prototype.drawingsXML=function(e){if(this._drawings.length){var t={},n=this._drawings.map((function(n){var r=parseRef(n.topLeftCell),o=t[n.image];return o||(o=t[n.image]={rId:"img"+n.image,target:e[n.image].target}),{col:r.col,colOffset:pixelsToExcel(n.offsetX),row:r.row,rowOffset:pixelsToExcel(n.offsetY),width:pixelsToExcel(n.width),height:pixelsToExcel(n.height),imageId:o.rId}}));return{main:DRAWINGS_XML(n),rels:DRAWINGS_RELS_XML(t)}}},Worksheet.prototype.legacyDrawing=function(){if(this._comments.length)return LEGACY_DRAWING({comments:this._comments})},Worksheet.prototype._lookupString=function(e){var t,n="$"+e,r=this._strings.indexes[n];return void 0!==r?t=r:(t=this._strings.indexes[n]=this._strings.uniqueCount,this._strings.uniqueCount++),this._strings.count++,t},Worksheet.prototype._lookupStyle=function(e){var t=JSON.stringify(e);if("{}"===t)return 0;var n=indexOf(t,this._styles);return n<0&&(n=this._styles.push(t)-1),n+1},Worksheet.prototype._lookupBorder=function(e){var t=JSON.stringify(e);if("{}"!==t){var n=indexOf(t,this._borders);return n<0&&(n=this._borders.push(t)-1),n+1}},Worksheet.prototype._readCells=function(e){for(var t=0;t<e.length;t++){var n=e[t],r=n.cells;n.data=[];for(var o=0;o<r.length;o++){var i=this._cell(r[o],n.index,o);i&&n.data.push(i)}}},Worksheet.prototype._cell=function(e,t,n){var r=this;if(!e||e===EMPTY_CELL)return null;var o=e.value,i={};e.borderLeft&&(i.left=e.borderLeft),e.borderRight&&(i.right=e.borderRight),e.borderTop&&(i.top=e.borderTop),e.borderBottom&&(i.bottom=e.borderBottom),e.dBorders&&(i.diagonal=e.dBorders),i=this._lookupBorder(i);var a,s=this.options.defaultCellStyle||{},l={borderId:i};(a=function(t,n){var r=e[t];if(void 0===r&&(r=s[t]),void 0!==r)return l[n||t]=r,!0})("color"),a("background"),a("bold"),a("italic"),a("underline"),a("fontFamily")||a("fontName","fontFamily"),a("fontSize"),a("format"),a("textAlign")||a("hAlign","textAlign"),a("verticalAlign")||a("vAlign","verticalAlign"),a("wrap"),a("indent"),a("disabled")||a("enable")&&(l.disabled=!l.enable,delete l.enable),l.disabled&&(r._hasDisabledCells=!0);var c=(this.options.columns||[])[n],p=typeof o;if(c&&c.autoWidth&&(!e.colSpan||1===e.colSpan)){var u=o;"number"===p&&(u=IntlService.toString(o,e.format)),c.width=Math.max(c.width||0,String(u).length)}"string"===p?(o=stripFunnyChars(o),o=this._lookupString(o),p="s"):"number"===p?p="n":"boolean"===p?(p="b",o=Number(o)):o&&o.getTime?(p=null,o=dateToSerial(o),l.format||(l.format="mm-dd-yy")):(p=null,o=null),l=this._lookupStyle(l);var m=ref(t,n);if(e.validation&&this._addValidation(e.validation,m),e.comment){var h=[n+1,15,t,10,n+3,15,t+3,4];this._comments.push({ref:m,text:e.comment,row:t,col:n,anchor:h.join(", ")})}return{value:o,formula:e.formula,type:p,style:l,ref:m}},Worksheet.prototype._addValidation=function(e,t){var n={showErrorMessage:"reject"===e.type?1:0,formula1:e.from,formula2:e.to,type:MAP_EXCEL_TYPE[e.dataType]||e.dataType,operator:MAP_EXCEL_OPERATOR[e.comparerType]||e.comparerType,allowBlank:e.allowNulls?1:0,showDropDown:e.showButton?0:1,error:e.messageTemplate,errorTitle:e.titleTemplate},r=JSON.stringify(n);this._validations[r]||(this._validations[r]=n,n.sqref=[]),this._validations[r].sqref.push(t)},Worksheet.prototype._getLastRow=function(){return countData(this.options.rows)},Worksheet.prototype._getLastCol=function(){var e=0;return this.options.rows.forEach((function(t){t.cells&&(e=Math.max(e,countData(t.cells)))})),e};var MAP_EXCEL_OPERATOR={greaterThanOrEqualTo:"greaterThanOrEqual",lessThanOrEqualTo:"lessThanOrEqual"},MAP_EXCEL_TYPE={number:"decimal"},defaultFormats={General:0,0:1,"0.00":2,"#,##0":3,"#,##0.00":4,"0%":9,"0.00%":10,"0.00E+00":11,"# ?/?":12,"# ??/??":13,"mm-dd-yy":14,"d-mmm-yy":15,"d-mmm":16,"mmm-yy":17,"h:mm AM/PM":18,"h:mm:ss AM/PM":19,"h:mm":20,"h:mm:ss":21,"m/d/yy h:mm":22,"#,##0 ;(#,##0)":37,"#,##0 ;[Red](#,##0)":38,"#,##0.00;(#,##0.00)":39,"#,##0.00;[Red](#,##0.00)":40,"mm:ss":45,"[h]:mm:ss":46,"mmss.0":47,"##0.0E+0":48,"@":49,"[$-404]e/m/d":27,"m/d/yy":30,t0:59,"t0.00":60,"t#,##0":61,"t#,##0.00":62,"t0%":67,"t0.00%":68,"t# ?/?":69,"t# ??/??":70};function maybeRGB(e){function t(e){var t=parseInt(e,10).toString(16);return t.length<2?"0"+t:t}var n=/^rgba?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*([0-9.]+)\s*)?\)/i.exec(e.trim());return n?"#"+t(255*(n[4]?parseFloat(n[4]):1)|0)+t(n[1])+t(n[2])+t(n[3]):e}function convertColor(e){var t=maybeRGB(e);return t.length<6&&(t=t.replace(/(\w)/g,(function(e,t){return t+t}))),(t=t.substring(1).toUpperCase()).length<8&&(t="FF"+t),t}var Workbook=function(e){var t=this;this.options=e||{},this._strings={indexes:{},count:0,uniqueCount:0},this._styles=[],this._borders=[],this._images=this.options.images,this._imgId=0,this._sheets=map(this.options.sheets||[],(function(e,n){return e.defaults=t.options,e.sheetIndex=n+1,new Worksheet(e,t._strings,t._styles,t._borders)}))};function borderStyle(e){var t="thin";return 2===e?t="medium":3===e&&(t="thick"),t}function borderSideTemplate(e,t){var n="";return t&&(n+="<"+e+' style="'+borderStyle(t.size)+'">',t.color&&(n+='<color rgb="'+convertColor(t.color)+'"/>'),n+="</"+e+">"),n}function borderTemplate(e){var t=e.diagonal?e.diagonal.type:0;return"<border "+(2&t?'diagonalUp="true"':"")+" "+(1&t?'diagonalDown="true"':"")+">\n      "+borderSideTemplate("left",e.left)+"\n      "+borderSideTemplate("right",e.right)+"\n      "+borderSideTemplate("top",e.top)+"\n      "+borderSideTemplate("bottom",e.bottom)+"\n      "+borderSideTemplate("diagonal",e.diagonal)+"\n    </border>"}Workbook.prototype.imageFilename=function(e){var t=++this._imgId;switch(e){case"image/jpg":case"image/jpeg":return"image"+t+".jpg";case"image/png":return"image"+t+".png";case"image/gif":return"image"+t+".gif";default:return"image"+t+".bin"}},Workbook.prototype.toZIP=function(){var e=this,t=createZip(),n=t.folder("docProps");n.file("core.xml",CORE({creator:this.options.creator||"Kendo UI",lastModifiedBy:this.options.creator||"Kendo UI",created:this.options.date||(new Date).toJSON(),modified:this.options.date||(new Date).toJSON()}));var r=this._sheets.length;n.file("app.xml",APP({sheets:this._sheets})),t.folder("_rels").file(".rels",RELS);var o=t.folder("xl");if(o.folder("_rels").file("workbook.xml.rels",WORKBOOK_RELS({count:r})),this._images){var i=o.folder("media");Object.keys(this._images).forEach((function(t){var n=e._images[t],r=e.imageFilename(n.type);i.file(r,n.data),n.target="../media/"+r}))}var a={};o.file("workbook.xml",WORKBOOK({sheets:this._sheets,filterNames:map(this._sheets,(function(e,t){var n=e.options,r=n.name||n.title||"Sheet"+(t+1);a[r.toLowerCase()]=t;var o=n.filter;if(o){if(o.ref){var i=o.ref.split(":"),s=parseRef(i[0]),l=parseRef(i[1]);return{localSheetId:t,name:r,from:$ref(s.row,s.col),to:$ref(l.row,l.col)}}if(void 0!==o.from&&void 0!==o.to)return{localSheetId:t,name:r,from:$ref(filterRowIndex(n),o.from),to:$ref(filterRowIndex(n),o.to)}}})),userNames:map(this.options.names||[],(function(e){return{name:e.localName,localSheetId:e.sheet?a[e.sheet.toLowerCase()]:null,value:e.value,hidden:e.hidden}}))}));for(var s=o.folder("worksheets"),l=o.folder("drawings"),c=l.folder("_rels"),p=s.folder("_rels"),u=[],m=[],h=0;h<r;h++){var f=e._sheets[h],d="sheet"+(h+1)+".xml",g=f.toXML(h),x=f.relsToXML(),v=f.commentsXML(),y=f.legacyDrawing(),E=f.drawingsXML(e._images);if(x&&p.file(d+".rels",x),v){var _="comments"+f.options.sheetIndex+".xml";o.file(_,v),u.push(_)}if(y&&l.file("vmlDrawing"+f.options.sheetIndex+".vml",y),E){var S="drawing"+f.options.sheetIndex+".xml";l.file(S,E.main),c.file(S+".rels",E.rels),m.push(S)}s.file(d,g)}var b=map(this._borders,parseJSON),w=map(this._styles,parseJSON),C=function(e){return e.underline||e.bold||e.italic||e.color||e.fontFamily||e.fontSize},T=map(w,(function(e){var t,n,r;if(e.fontSize&&(e.fontSize=(t=e.fontSize,(r=Number(t))&&(n=3*r/4),n)),e.color&&(e.color=convertColor(e.color)),C(e))return e})),I=map(w,(function(e){if(e.format&&void 0===defaultFormats[e.format])return e})),R=map(w,(function(e){if(e.background)return e.background=convertColor(e.background),e}));return o.file("styles.xml",STYLES({fonts:T,fills:R,formats:I,borders:b,styles:map(w,(function(e){var t={};return C(e)&&(t.fontId=indexOf(e,T)+1),e.background&&(t.fillId=indexOf(e,R)+2),t.textAlign=e.textAlign,t.indent=e.indent,t.verticalAlign=e.verticalAlign,t.wrap=e.wrap,t.borderId=e.borderId,e.format&&(void 0!==defaultFormats[e.format]?t.numFmtId=defaultFormats[e.format]:t.numFmtId=165+indexOf(e,I)),null!=e.disabled&&(t.disabled=e.disabled),t}))})),o.file("sharedStrings.xml",SHARED_STRINGS(this._strings)),t.file("[Content_Types].xml",CONTENT_TYPES({sheetCount:r,commentFiles:u,drawingFiles:m})),t},Workbook.prototype.toDataURL=function(){var e=this.toZIP();return e.generateAsync?e.generateAsync(DATA_URL_OPTIONS).then(toDataURI):toDataURI(e.generate(DATA_URL_OPTIONS))},Workbook.prototype.toBlob=function(){var e=this.toZIP();return e.generateAsync?e.generateAsync(BLOB_OPTIONS):new Blob([e.generate(ARRAYBUFFER_OPTIONS)],{type:MIME_TYPE})};var EMPTY_CELL={};function inflate(e,t){var n=[],r=[];indexRows(e,(function(e,t){var o={_source:e,index:t,height:e.height,level:e.level,cells:[]};n.push(o),r[t]=o}));for(var o=sortByIndex(n).slice(0),i={rowData:n,rowsByIndex:r,mergedCells:t},a=0;a<o.length;a++)fillCells(o[a],i),delete o[a]._source;return sortByIndex(n)}function indexRows(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r){var o=r.index;"number"!=typeof o&&(o=n),t(r,o)}}}function sortByIndex(e){return e.sort((function(e,t){return e.index-t.index}))}function pushUnique(e,t){e.indexOf(t)<0&&e.push(t)}function getSpan(e,t){for(var n=0;n<e.length;++n){var r=e[n].split(":"),o=r[0];if(o===t){var i=r[1];return o=parseRef(o),{rowSpan:(i=parseRef(i)).row-o.row+1,colSpan:i.col-o.col+1}}}}function parseRef(e){var t,n=/^([a-z]+)(\d+)$/i.exec(e);return{row:(t=n[2],parseInt(t,10)-1),col:function(e){for(var t=e.toUpperCase(),n=0,r=0;r<t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}(n[1])}}function pixelsToExcel(e){return Math.round(9525*e)}function fillCells(e,t){var n=e._source,r=e.index,o=n.cells,i=e.cells;if(o)for(var a=0;a<o.length;a++){var s=o[a]||EMPTY_CELL,l=s.rowSpan||1,c=s.colSpan||1,p=insertCell(i,s),u=ref(r,p);if(1===l&&1===c){var m=getSpan(t.mergedCells,u);m&&(c=m.colSpan,l=m.rowSpan)}if(spanCell(s,i,p,c),(l>1||c>1)&&pushUnique(t.mergedCells,u+":"+ref(r+l-1,p+c-1)),l>1)for(var h=r+1;h<r+l;h++){var f=t.rowsByIndex[h];f||(f=t.rowsByIndex[h]={index:h,cells:[]},t.rowData.push(f)),spanCell(s,f.cells,p-1,c+1)}}}function insertCell(e,t){var n;return"number"==typeof t.index?(n=t.index,insertCellAt(e,t,t.index)):n=appendCell(e,t),n}function insertCellAt(e,t,n){e[n]=t}function appendCell(e,t){for(var n=e.length,r=0;r<e.length+1;r++)if(!e[r]){e[r]=t,n=r;break}return n}function spanCell(e,t,n,r){for(var o=1;o<r;o++){insertCellAt(t,{borderTop:e.borderTop,borderRight:e.borderRight,borderBottom:e.borderBottom,borderLeft:e.borderLeft},n+o)}}var SPREADSHEET_FILTERS=function(e){var t=e.ref,n=e.columns,r=e.generators;return'\n<autoFilter ref="'+t+'">\n  '+foreach(n,(function(e){return'\n    <filterColumn colId="'+e.index+'">\n      '+r[e.filter](e)+"\n    </filterColumn>\n  "}))+"\n</autoFilter>"},SPREADSHEET_CUSTOM_FILTER=function(e){return"\n<customFilters "+("and"===e.logic?'and="1"':"")+">\n"+foreach(e.criteria,(function(e){var t=spreadsheetFilters.customOperator(e);return"<customFilter "+(t?'operator="'+t+'"':"")+' val="'+spreadsheetFilters.customValue(e)+'"/>'}))+"\n</customFilters>"},SPREADSHEET_DYNAMIC_FILTER=function(e){var t=e.type;return'<dynamicFilter type="'+spreadsheetFilters.dynamicFilterType(t)+'" />'},SPREADSHEET_TOP_FILTER=function(e){var t=e.type,n=e.value;return'<top10 percent="'+(/percent$/i.test(t)?1:0)+'"\n       top="'+(/^top/i.test(t)?1:0)+'"\n       val="'+n+'" />'},SPREADSHEET_VALUE_FILTER=function(e){return"<filters "+(e.blanks?'blank="1"':"")+">\n    "+foreach(e.values,(function(e){return'\n      <filter val="'+e+'" />'}))+"\n  </filters>"};function spreadsheetFilters(e){return SPREADSHEET_FILTERS({ref:e.ref,columns:e.columns,generators:{custom:SPREADSHEET_CUSTOM_FILTER,dynamic:SPREADSHEET_DYNAMIC_FILTER,top:SPREADSHEET_TOP_FILTER,value:SPREADSHEET_VALUE_FILTER}})}function quoteSheet(e){return/^\'/.test(e)||/^[a-z_][a-z0-9_]*$/i.test(e)?e:"'"+e.replace(/\x27/g,"\\'")+"'"}spreadsheetFilters.customOperator=function(e){return{eq:"equal",gt:"greaterThan",gte:"greaterThanOrEqual",lt:"lessThan",lte:"lessThanOrEqual",ne:"notEqual",doesnotstartwith:"notEqual",doesnotendwith:"notEqual",doesnotcontain:"notEqual",doesnotmatch:"notEqual"}[e.operator.toLowerCase()]},spreadsheetFilters.customValue=function(e){function t(e){return e.replace(/([*?])/g,"~$1")}switch(e.operator.toLowerCase()){case"startswith":case"doesnotstartwith":return t(e.value)+"*";case"endswith":case"doesnotendwith":return"*"+t(e.value);case"contains":case"doesnotcontain":return"*"+t(e.value)+"*";default:return e.value}},spreadsheetFilters.dynamicFilterType=function(e){return{quarter1:"Q1",quarter2:"Q2",quarter3:"Q3",quarter4:"Q4",january:"M1",february:"M2",march:"M3",april:"M4",may:"M5",june:"M6",july:"M7",august:"M8",september:"M9",october:"M10",november:"M11",december:"M12"}[e.toLowerCase()]||e};export{ExcelExporter as E,IntlService as I,TemplateService as T,Workbook as W,Worksheet as a};export{__meta__};
//# sourceMappingURL=kendo.ooxml.cmn.chunk.js.map
